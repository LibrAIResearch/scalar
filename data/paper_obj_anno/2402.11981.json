{
  "title": "Universal generalization guarantees for Wasserstein distributionally robust models",
  "abstract": "Distributionally robust optimization has emerged as an attractive way to\ntrain robust machine learning models, capturing data uncertainty and\ndistribution shifts. Recent statistical analyses have proved that robust models\nbuilt from Wasserstein ambiguity sets have nice generalization guarantees,\nbreaking the curse of dimensionality. However, these results are obtained in\nspecific cases, at the cost of approximations, or under assumptions difficult\nto verify in practice. In contrast, we establish, in this article, exact\ngeneralization guarantees that cover all practical cases, including any\ntransport cost function and any loss function, potentially non-convex and\nnonsmooth. For instance, our result applies to deep learning, without requiring\nrestrictive assumptions. We achieve this result through a novel proof technique\nthat combines nonsmooth analysis rationale with classical concentration\nresults. Our approach is general enough to extend to the recent versions of\nWasserstein/Sinkhorn distributionally robust problems that involve (double)\nregularizations.",
  "paper_id": "http://arxiv.org/abs/2402.11981v2",
  "markdown_content": "# Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\n\nTam Le\nUniv. Grenoble Alpes, CNRS, Grenoble INP LJK, 38000 Grenoble, FranceJérôme Malick 11footnotemark: 1\n\n###### Abstract\n\nDistributionally robust optimization has emerged as an attractive way\nto train robust machine learning models, capturing data uncertainty and distribution shifts. Recent statistical analyses have proved that robust models built from Wasserstein ambiguity sets have nice generalization guarantees, breaking the curse of dimensionality. However, these results are obtained in specific cases, at the cost of approximations, or under assumptions difficult to verify in practice. In contrast, we establish, in this article, exact generalization guarantees that cover all practical cases, including any transport cost function and any loss function, potentially non-convex and nonsmooth. For instance, our result applies to deep learning, without requiring restrictive assumptions. We achieve this result through a novel proof technique that combines nonsmooth analysis rationale with classical concentration results. Our approach is general enough to extend to the recent versions of Wasserstein/Sinkhorn distributionally robust problems that involve (double) regularizations.\n\n## 1 Introduction\n\n### 1.1 Wasserstein robustness: models and generalization\n\nMachine learning models are challenged in practice by many obstacles,\nsuch as biases in data, adversarial attacks, or data shifts between training and deployment. Towards more resilient and reliable models, distributionally robust optimization has emerged as an attractive paradigm, where training no longer relies on minimizing the empirical risk, but rather on an optimization problem that takes into account potential perturbations in the data distribution; see e.g., the review articles \\[ [23](https://ar5iv.org/html/2402.11981#bib.bib23 \"\"), [9](https://ar5iv.org/html/2402.11981#bib.bib9 \"\")\\].\n\nMore specifically, the approach consists in minimizing the worst-risk among all distributions in a neighborhood of the empirical data distribution. A natural way \\[ [27](https://ar5iv.org/html/2402.11981#bib.bib27 \"\")\\] to define such a neighborhood is to use the optimal transport distance, called the Wasserstein distance \\[ [28](https://ar5iv.org/html/2402.11981#bib.bib28 \"\")\\]. Between two distributions Q𝑄Q and Q′superscript𝑄′Q^{\\\\prime} on a sample space ΞΞ\\\\Xi, the Wasserstein distance is defined as the minimal expected cost among all coupling probability π𝜋\\\\pi on Ξ×ΞΞΞ\\\\Xi\\\\times\\\\Xi having Q𝑄Q and Q′superscript𝑄′Q^{\\\\prime} as marginals:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Wc​(Q,Q′):=infπ∈𝒫​(Ξ×Ξ)\\[π\\]1=Q,\\[π\\]2=Q′𝔼(ξ,ζ)∼π​\\[c​(ξ,ζ)\\],assignsubscript𝑊𝑐𝑄superscript𝑄′subscriptinfimum𝜋𝒫ΞΞformulae-sequencesubscriptdelimited-\\[\\]𝜋1𝑄subscriptdelimited-\\[\\]𝜋2superscript𝑄′subscript𝔼similar-to𝜉𝜁𝜋delimited-\\[\\]𝑐𝜉𝜁W\\_{c}(Q,Q^{\\\\prime}):=\\\\inf\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=Q,\\[\\\\pi\\]\\_{2}=Q^{\\\\prime}\\\\end{subarray}}\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi}\\[c(\\\\xi,\\\\zeta)\\], |  | (1) |\n\nwhere c:Ξ×Ξ→ℝ:𝑐→ΞΞℝc\\\\colon\\\\Xi\\\\times\\\\Xi\\\\rightarrow\\\\mathbb{R} is a transport cost over the sample space ΞΞ\\\\Xi. For a class of loss functions ℱℱ\\\\mathcal{F},\nthe Wasserstein distributionally robust counterpart of the standard empirical risk minimization then writes\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | minf∈ℱ⁡maxQ∈𝒫​(Ξ),Wc​(P^n,Q)≤ρ⁡𝔼ξ∼Q​\\[f​(ξ)\\],subscript𝑓ℱsubscriptformulae-sequence𝑄𝒫Ξsubscript𝑊𝑐subscript^𝑃𝑛𝑄𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]𝑓𝜉\\\\min\\_{f\\\\in\\\\mathcal{F}}~{}~{}\\\\max\\_{Q\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(\\\\widehat{P}\\_{n},Q)\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[f(\\\\xi)\\], |  | (2) |\n\nfor a chosen radius ρ𝜌\\\\rho of the Wasserstein ball centered at the empirical data distribution, denoted P^nsubscript^𝑃𝑛\\\\widehat{P}\\_{n}. In the degenerate case\nρ=0𝜌0\\\\rho=0, we have Q=P^n𝑄subscript^𝑃𝑛Q=\\\\widehat{P}\\_{n} and ( [2](https://ar5iv.org/html/2402.11981#S1.E2 \"Equation 2 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) boils down to empirical risk minimization. If ρ>0𝜌0\\\\rho>0, the training captures data uncertainty and provides more resilient learning models; see the discussions and illustrations \\[ [33](https://ar5iv.org/html/2402.11981#bib.bib33 \"\"), [35](https://ar5iv.org/html/2402.11981#bib.bib35 \"\"), [39](https://ar5iv.org/html/2402.11981#bib.bib39 \"\"), [24](https://ar5iv.org/html/2402.11981#bib.bib24 \"\"), [26](https://ar5iv.org/html/2402.11981#bib.bib26 \"\"), [36](https://ar5iv.org/html/2402.11981#bib.bib36 \"\"), [20](https://ar5iv.org/html/2402.11981#bib.bib20 \"\"), [4](https://ar5iv.org/html/2402.11981#bib.bib4 \"\"), [7](https://ar5iv.org/html/2402.11981#bib.bib7 \"\")\\].\n\nTo support theoretically the modeling versatility and the practical success of these robust models, some statistical guarantees have been proposed in the literature.\nFor a population distribution P𝑃P, i.i.d. samples ξ1,…,ξnsubscript𝜉1…subscript𝜉𝑛\\\\xi\\_{1},\\\\ldots,\\\\xi\\_{n} drawn from P𝑃P,\nand the associated empirical distribution\nP^n:=1n​∑i=1nδξiassignsubscript^𝑃𝑛1𝑛superscriptsubscript𝑖1𝑛subscript𝛿subscript𝜉𝑖\\\\widehat{P}\\_{n}:=\\\\frac{1}{n}\\\\sum\\_{i=1}^{n}\\\\delta\\_{\\\\xi\\_{i}},\nthe best concentration results for the Wasserstein distance \\[ [18](https://ar5iv.org/html/2402.11981#bib.bib18 \"\")\\]\ngives that if the radius ρ𝜌\\\\rho is large enough, then the Wasserstein ball around P^nsubscript^𝑃𝑛\\\\widehat{P}\\_{n} contains the true distribution P𝑃P with high probability, which in turn gives directly \\[ [27](https://ar5iv.org/html/2402.11981#bib.bib27 \"\")\\] a generalization bound of the form\n\n![Refer to caption](https://ar5iv.org/html/2402.11981/assets/x1.png)Figure 1: Probability of the generalization bound ( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to hold, estimated from 500 logistic regression instances and their ℓ1subscriptℓ1\\\\ell\\_{1}-robust counterparts (see at the end of [Section3](https://ar5iv.org/html/2402.11981#S3 \"3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). For large ρ𝜌\\\\rho, the bound always holds, whereas it does not for small ρ𝜌\\\\rho. Our aim is to quantify this phenomenon, which is not explained by existing results.\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | maxQ∈𝒫​(Ξ),Wc​(P^n,Q)≤ρ⁡𝔼ξ∼Q​\\[f​(ξ)\\]≥𝔼ξ∼P​\\[f​(ξ)\\].subscriptformulae-sequence𝑄𝒫Ξsubscript𝑊𝑐subscript^𝑃𝑛𝑄𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]𝑓𝜉subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑓𝜉\\\\max\\_{Q\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(\\\\widehat{P}\\_{n},Q)\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[f(\\\\xi)\\]\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\]. |  | (3) |\n\nThis exact bound is particularly attractive: the quantity that we compute from data and optimize by training provides a control on the idealistic population risk. However, the direct application of \\[ [18](https://ar5iv.org/html/2402.11981#bib.bib18 \"\")\\] requires a number of training samples growing exponentially in the dimension.\n\nRecent works have improved this direct approach by establishing, in various situations, generalization bounds that do not suffer from the curse of dimensionality, and rather feature radius ρ𝜌\\\\rho scaling as O​(1/n)𝑂1𝑛O(1/\\\\sqrt{n})\\[ [35](https://ar5iv.org/html/2402.11981#bib.bib35 \"\"), [10](https://ar5iv.org/html/2402.11981#bib.bib10 \"\"), [3](https://ar5iv.org/html/2402.11981#bib.bib3 \"\"), [19](https://ar5iv.org/html/2402.11981#bib.bib19 \"\"), [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\"), [11](https://ar5iv.org/html/2402.11981#bib.bib11 \"\")\\]. Yet no existing result is general enough to cover all situations encountered in machine learning and to explain nice generalization properties usually observed in practice (as illustrated in [Figure1](https://ar5iv.org/html/2402.11981#S1.F1 \"In 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n\n### 1.2 Contributions and outline\n\nIn this paper, we provide exact generalization guarantees of the form ( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), that are universal, in the sense that they apply to all machine learning situations, without restrictive assumptions. Indeed, our results apply to any kind of data lying in a metric space (e.g. classification and regression tasks with mixed features), as well as general classes of continuous loss functions (e.g. from standard regression tasks to deep learning models).\n\nWe prove these universal results by dealing directly with the nonsmoothness of the robust objective function ( [2](https://ar5iv.org/html/2402.11981#S1.E2 \"Equation 2 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) that we tackle with\ntools from variational analysis \\[ [14](https://ar5iv.org/html/2402.11981#bib.bib14 \"\"), [31](https://ar5iv.org/html/2402.11981#bib.bib31 \"\"), [1](https://ar5iv.org/html/2402.11981#bib.bib1 \"\")\\].\nAs a nice outcome of this approach, our results are able to cover deep learning models involving nonsmooth elementary blocks, such as the popular ReLUReLU\\\\operatorname{ReLU} activation function, the max-pooling operator, or optimization layers \\[ [2](https://ar5iv.org/html/2402.11981#bib.bib2 \"\")\\]. Moreover, our approach is systematic enough to extend to the recent versions of Wasserstein distributionally robust problems that involve (double) regularizations \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\"), [38](https://ar5iv.org/html/2402.11981#bib.bib38 \"\")\\].\n\nThe paper is structured as follows.\nFirst, [Section2](https://ar5iv.org/html/2402.11981#S2 \"2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") introduces and illustrates the setting of this work. Then [Section3](https://ar5iv.org/html/2402.11981#S3 \"3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") presents and discusses the main results (Theorems [3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n[Section4](https://ar5iv.org/html/2402.11981#S4 \"4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") highlights our proof techniques, combining classical concentration lemma and advanced nonsmooth analysis aspects.\nFinally, [Section5](https://ar5iv.org/html/2402.11981#S5 \"5 On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") sheds some light on generalization constants and other quantities of interest appearing in the results and the proof. We differ, to the supplementary, the proofs of the succession of lemmas, as well as complementary results discussing technical assumptions of existing works.\n\n### 1.3 Related work\n\nOur work stands out from a recent line of research establishing generalization guarantees for Wasserstein distributionally robust models, breaking the curse of dimensionality.\nNotably, important results on the topic include \\[ [10](https://ar5iv.org/html/2402.11981#bib.bib10 \"\"), [11](https://ar5iv.org/html/2402.11981#bib.bib11 \"\")\\] about asymptotical results for smooth losses, and \\[ [13](https://ar5iv.org/html/2402.11981#bib.bib13 \"\"), [34](https://ar5iv.org/html/2402.11981#bib.bib34 \"\")\\] about non-asymptotically results for linear models and for smooth loss functions.\nFor nonsmooth losses, the only work we are aware of is \\[ [3](https://ar5iv.org/html/2402.11981#bib.bib3 \"\")\\] which derives results on piece-wise smooth losses (at the cost of abstract approximating constants).\nWe underline that none of existing results covers deep learning models involving nonsmooth elementary blocks.\n\nThe closest work to our paper is \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] which establishes generalization results similar to ours, namely: exact bounds ( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in a regime where ρ>O​(1/n)𝜌𝑂1𝑛\\\\rho>O(1/\\\\sqrt{n}). In sharp contrast with our work though, these results rely on a restrictive context and some needless assumptions (the squared norm for c𝑐c, a Gaussian reference distribution, additional growth conditions, and abstract compactness conditions111We show in [PropositionF.3](https://ar5iv.org/html/2402.11981#A6.Thmproposition3 \"Proposition F.3. ‣ F.3 On the compactness condition, Assumption 5.1 from [5] ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary that the compactness assumptions hide strong conditions on the maximizers.). Throughout our developments, we will point out further technical differences with this work.\n\n### 1.4 Notations\n\n##### On probability spaces.\n\nGiven a measurable space ΞΞ\\\\Xi, we denote the space of probability measures on ΞΞ\\\\Xi by 𝒫​(Ξ)𝒫Ξ\\\\mathcal{P}(\\\\Xi). For all π∈𝒫​(Ξ×Ξ)𝜋𝒫ΞΞ\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi), i∈{1,2}𝑖12i\\\\in\\\\{1,2\\\\}, we denote the ithsuperscript𝑖thi^{\\\\text{th}} marginal of π𝜋\\\\pi by \\[π\\]isubscriptdelimited-\\[\\]𝜋𝑖\\[\\\\pi\\]\\_{i}. We denote the Dirac mass at ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi by δξsubscript𝛿𝜉\\\\delta\\_{\\\\xi}. Given a measurable function g:Ξ→ℝ:𝑔→Ξℝg:\\\\Xi\\\\to\\\\mathbb{R}, we denote the expectation of g𝑔g with respect to Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) by 𝔼ξ∼Q​\\[g​(ξ)\\]subscript𝔼similar-to𝜉𝑄delimited-\\[\\]𝑔𝜉\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[g(\\\\xi)\\] and we may also use the shorthand 𝔼Q​\\[f\\]subscript𝔼𝑄delimited-\\[\\]𝑓\\\\mathbb{E}\\_{Q}\\[f\\].\n\n##### On function spaces.\n\nIn (𝒳,dist)𝒳dist(\\\\mathcal{X},\\\\operatorname{dist}) a metric space, the uniform norm of a function f𝑓f is ‖f‖∞=supx∈𝒳\\|f​(x)\\|subscriptnorm𝑓subscriptsupremum𝑥𝒳𝑓𝑥\\\\\\|f\\\\\\|\\_{\\\\infty}=\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\|f(x)\\|. If ℱℱ\\\\mathcal{F} is a family of functions, we denote ‖ℱ‖∞=supf∈ℱ‖f‖∞subscriptnormℱsubscriptsupremum𝑓ℱsubscriptnorm𝑓\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}=\\\\sup\\_{f\\\\in\\\\mathcal{F}}\\\\\\|f\\\\\\|\\_{\\\\infty}. We say f𝑓f is _Lipschitz_ with constant L𝐿L if for all x,y∈𝒳𝑥𝑦𝒳x,y\\\\in\\\\mathcal{X}, \\|f​(x)−f​(y)\\|≤L​dist⁡(x,y)𝑓𝑥𝑓𝑦𝐿dist𝑥𝑦\\|f(x)-f(y)\\|\\\\leq L\\\\operatorname{dist}(x,y). For ϕ:ℝ×𝒳→ℝ:italic-ϕ→ℝ𝒳ℝ\\\\phi\\\\colon\\\\mathbb{R}\\\\times\\\\mathcal{X}\\\\to\\\\mathbb{R}, we denote ∂λ+ϕsubscriptsuperscript𝜆italic-ϕ\\\\partial^{+}\\_{\\\\lambda}\\\\phi the right-sided derivative with respect to λ∈ℝ𝜆ℝ\\\\lambda\\\\in\\\\mathbb{R}, and ∂λϕsubscript𝜆italic-ϕ\\\\partial\\_{\\\\lambda}\\\\phi its derivative, whenever well-defined.\n\n## 2 Assumption and examples\n\nIn this section, we present the general framework illustrated by standard examples.\nThroughout the paper, we will make the following assumptions on the sample space ΞΞ\\\\Xi, the transport cost of the Wasserstein distance, and the space ℱℱ\\\\mathcal{F} of loss functions from ΞΞ\\\\Xi to ℝℝ\\\\mathbb{R}.\n\n###### Assumption 2.1.\n\n- •\n\n\n(Ξ,d)Ξ𝑑(\\\\Xi,d) is a compact metric space.\n\n- •\n\n\nc:Ξ×Ξ→ℝ:𝑐→ΞΞℝc:\\\\Xi\\\\times\\\\Xi\\\\to\\\\mathbb{R} is jointly continuous with respect to d𝑑d, non-negative and c​(ξ,ζ)=0𝑐𝜉𝜁0c(\\\\xi,\\\\zeta)=0 if and only if ξ=ζ𝜉𝜁\\\\xi=\\\\zeta.\n\n- •\n\n\n(ℱ,∥⋅∥∞)(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) is compact and every f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} is continuous.\n\n\nThis setting encompasses a wide range of machine learning scenarios, as illustrated below.\n\n##### Sample space and transport costs.\n\nThe choice of the transport cost c𝑐c depends on the nature of the data and of the potential data uncertainty. For instance, if the variables are continuous with Ξ⊂ℝmΞsuperscriptℝ𝑚\\\\Xi\\\\subset\\\\mathbb{R}^{m}, we consider the distance d=∥⋅−⋅∥pd=\\\\\\|\\\\cdot-\\\\cdot\\\\\\|\\_{p} induced by ℓpsubscriptℓ𝑝\\\\ell\\_{p}-norm (p∈\\[1,∞\\]𝑝1p\\\\in\\[1,\\\\infty\\]) and the cost as a power (q∈\\[1,∞)𝑞1q\\\\in\\[1,\\\\infty)) of the distance\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | c​(ξ,ξ′)=‖ξ−ξ′‖pq.𝑐𝜉superscript𝜉′superscriptsubscriptnorm𝜉superscript𝜉′𝑝𝑞c(\\\\xi,\\\\xi^{\\\\prime})=\\\\\\|\\\\xi-\\\\xi^{\\\\prime}\\\\\\|\\_{p}^{q}. |  |\\\n\\\nIf the variables are discrete with Ξ⊂{1,…,J}mΞsuperscript1…𝐽𝑚\\\\Xi\\\\subset\\\\left\\\\{1,\\\\ldots,J\\\\right\\\\}^{m}, we consider the distance\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | d​(ξ,ξ′)=∑i=1m𝟙{ξi≠ξi′}𝑑𝜉superscript𝜉′superscriptsubscript𝑖1𝑚subscript1subscript𝜉𝑖superscriptsubscript𝜉𝑖′d(\\\\xi,\\\\xi^{\\\\prime})=\\\\sum\\_{i=1}^{m}\\\\mathds{1}\\_{\\\\left\\\\{\\\\xi\\_{i}\\\\neq\\\\xi\\_{i}^{\\\\prime}\\\\right\\\\}} |  |\\\n\\\nand the cost as a power of this distance.\\\nFinally, If we deal with mixed data, i.e. they contain both continuous and discrete variables, a sum of the previous costs can be considered. In classification, for instance, with the samples composed of features x∈ℝm𝑥superscriptℝ𝑚x\\\\in\\\\mathbb{R}^{m} and a target y∈{−1,1}𝑦11y\\\\in\\\\left\\\\{-1,1\\\\right\\\\}, we may take, for a chosen κ>0𝜅0\\\\kappa>0\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | c​((x,y),(x′,y′))=‖x−x′‖pq+κ​𝟙{y≠y′}𝑐𝑥𝑦superscript𝑥′superscript𝑦′superscriptsubscriptnorm𝑥superscript𝑥′𝑝𝑞𝜅subscript1𝑦superscript𝑦′c((x,y),(x^{\\\\prime},y^{\\\\prime}))=\\\\\\|x-x^{\\\\prime}\\\\\\|\\_{p}^{q}+\\\\kappa\\\\mathds{1}\\_{\\\\left\\\\{y\\\\neq y^{\\\\prime}\\\\right\\\\}} |  | (4) |\\\n\\\nwhich is obviously continuous with respect to\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | d​((x,y),(x′,y′))=‖x−x′‖p+𝟙{y≠y′}.𝑑𝑥𝑦superscript𝑥′superscript𝑦′subscriptnorm𝑥superscript𝑥′𝑝subscript1𝑦superscript𝑦′d((x,y),(x^{\\\\prime},y^{\\\\prime}))=\\\\\\|x-x^{\\\\prime}\\\\\\|\\_{p}+\\\\mathds{1}\\_{\\\\left\\\\{y\\\\neq y^{\\\\prime}\\\\right\\\\}}. |  | (5) |\\\n\\\nThis extends to mixed data with categorical, binary, and continuous variables; see e.g. \\[ [7](https://ar5iv.org/html/2402.11981#bib.bib7 \"\")\\].\\\n\\\n##### Parametric models and loss functions.\\\n\\\nOur setting covers all standard machine learning models.\\\nConsider a parametric family ℱ={f​(θ,⋅):θ∈Θ}ℱconditional-set𝑓𝜃⋅𝜃Θ\\\\mathcal{F}=\\\\left\\\\{f(\\\\theta,\\\\cdot)\\ :\\ \\\\theta\\\\in\\\\Theta\\\\right\\\\},\\\nwhere the parameter space Θ⊂ℝpΘsuperscriptℝ𝑝\\\\Theta\\\\subset\\\\mathbb{R}^{p} compact and the loss function f:Θ×Ξ→ℝ:𝑓→ΘΞℝf\\\\colon\\\\Theta\\\\times\\\\Xi\\\\to\\\\mathbb{R} is jointly continuous. If ΞΞ\\\\Xi is compact, such a family is compact regarding ∥⋅∥∞\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. This situation covers regression models, k-means clustering, and neural networks.\\\nFor example: least-squares regression\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,(x,y))=(⟨θ,x⟩−y)2,Ξ⊂ℝm×ℝ,formulae-sequence𝑓𝜃𝑥𝑦superscript𝜃𝑥𝑦2Ξsuperscriptℝ𝑚ℝf(\\\\theta,(x,y))=(\\\\langle\\\\theta,x\\\\rangle-y)^{2},\\\\quad\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\mathbb{R}, |  |\\\n\\\nlogistic regression\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,(x,y))=log⁡(1+e−y​⟨θ,x⟩),Ξ⊂ℝm×{−1,1},formulae-sequence𝑓𝜃𝑥𝑦1superscript𝑒𝑦𝜃𝑥Ξsuperscriptℝ𝑚11f(\\\\theta,(x,y))=\\\\log\\\\left(1+e^{-y\\\\langle\\\\theta,x\\\\rangle}\\\\right),\\\\quad\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\{-1,1\\\\}, |  |\\\n\\\nand support vector machines with hinge loss\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,(x,y))=max⁡{0,1−y​⟨θ,x⟩},Ξ⊂ℝm×{−1,1}formulae-sequence𝑓𝜃𝑥𝑦01𝑦𝜃𝑥Ξsuperscriptℝ𝑚11f(\\\\theta,(x,y))=\\\\max\\\\left\\\\{0,1-y\\\\langle\\\\theta,x\\\\rangle\\\\right\\\\},\\\\hskip 8.00003pt\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\{-1,1\\\\} |  |\\\n\\\nNote that this function is not differentiable, due to the max term. The k-means model also introduces a non-differentiable loss function:\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,x)=mini∈{1,…,K}⁡‖θi−x‖22,Θ⊂ℝK×m,Ξ⊂ℝm.formulae-sequence𝑓𝜃𝑥subscript𝑖1…𝐾superscriptsubscriptnormsubscript𝜃𝑖𝑥22formulae-sequenceΘsuperscriptℝ𝐾𝑚Ξsuperscriptℝ𝑚f(\\\\theta,x)=\\\\min\\_{i\\\\in\\\\left\\\\{1,\\\\ldots,K\\\\right\\\\}}\\\\\\|\\\\theta\\_{i}-x\\\\\\|\\_{2}^{2},\\\\quad\\\\Theta\\\\subset\\\\mathbb{R}^{K\\\\times m}\\\\!,~{}\\\\Xi\\\\subset\\\\mathbb{R}^{m}. |  |\\\n\\\nFinally, most deep learning models fall in our setting. Indeed, they involve loss functions of the form\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,(x,y))=ℓ​(h​(θ,x),y),𝑓𝜃𝑥𝑦ℓℎ𝜃𝑥𝑦f(\\\\theta,(x,y))=\\\\ell(h(\\\\theta,x),y), |  |\\\n\\\nwhere ℓℓ\\\\ell is a dissimilarity measure, and hℎh is a parameterized prediction function, built as a composition of affine transformations (which are the parameters to train) with activation functions (see e.g. \\[ [22](https://ar5iv.org/html/2402.11981#bib.bib22 \"\"), [25](https://ar5iv.org/html/2402.11981#bib.bib25 \"\"), [30](https://ar5iv.org/html/2402.11981#bib.bib30 \"\")\\]). Our setting is general enough to encompass all continuous activation functions, even non-differentiable ones (as ReLU=max⁡(0,⋅)ReLU0⋅\\\\operatorname{ReLU}=\\\\max(0,\\\\cdot))\\\nas well as other nonsmooth elementary blocks (as max-pooling \\[ [21](https://ar5iv.org/html/2402.11981#bib.bib21 \"\")\\], sorting procedures \\[ [32](https://ar5iv.org/html/2402.11981#bib.bib32 \"\")\\], and optimization layers \\[ [2](https://ar5iv.org/html/2402.11981#bib.bib2 \"\")\\]).\\\nAs already underlined in introduction, these examples involving non-differentiable terms are not covered by existing results.\\\n\\\n## 3 Main results\\\n\\\n### 3.1 Wasserstein robust models\\\n\\\nOur main result establishes a generalization bound ( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) for Wasserstein distributionally robust optimization (WDRO). Given a distribution Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) and a loss f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, the robust risk around Q𝑄Q with radius ρ>0𝜌0\\\\rho>0 is then defined as\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Rρ,Q​(f):=maxQ′∈𝒫​(Ξ),Wc​(Q,Q′)≤ρ⁡𝔼ξ∼Q′​\\[f​(ξ)\\].assignsubscript𝑅𝜌𝑄𝑓subscriptformulae-sequencesuperscript𝑄′𝒫Ξsubscript𝑊𝑐𝑄superscript𝑄′𝜌subscript𝔼similar-to𝜉superscript𝑄′delimited-\\[\\]𝑓𝜉R\\_{\\\\rho,Q}(f):=\\\\max\\_{Q^{\\\\prime}\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(Q,Q^{\\\\prime})\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q^{\\\\prime}}\\[f(\\\\xi)\\]. |  | (6) |\\\n\\\nIn particular, taking Q=P^n𝑄subscript^𝑃𝑛Q=\\\\widehat{P}\\_{n} and Q=P𝑄𝑃Q=P in the above expression, we consider the empirical robust risk, R^ρ​(f)subscript^𝑅𝜌𝑓\\\\widehat{R}\\_{\\\\rho}(f), and the true robust risk, Rρ​(f)subscript𝑅𝜌𝑓R\\_{\\\\rho}(f):\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^ρ​(f):=Rρ,P^n​(f)​ and ​Rρ​(f):=Rρ,P​(f).assignsubscript^𝑅𝜌𝑓subscript𝑅𝜌subscript^𝑃𝑛𝑓 and subscript𝑅𝜌𝑓assignsubscript𝑅𝜌𝑃𝑓\\\\widehat{R}\\_{\\\\rho}(f):=R\\_{\\\\rho,\\\\widehat{P}\\_{n}}(f)\\\\text{ \\\\quad and \\\\quad}R\\_{\\\\rho}(f):=R\\_{\\\\rho,P}(f). |  | (7) |\\\n\\\nOur generalization result states as follows:\\\n\\\n###### Theorem 3.1(Generalization guarantee for Wasserstein robust models).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exist α,β>0𝛼𝛽0\\\\alpha,\\\\beta>0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | αn<ρ<ρcrit2−βn,𝛼𝑛𝜌subscript𝜌crit2𝛽𝑛\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}, |  |\\\n\\\nthen with probability at least 1−δ1𝛿1-\\\\delta,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∀f∈ℱ,R^ρ​(f)≥𝔼ξ∼P​\\[f​(ξ)\\].formulae-sequencefor-all𝑓ℱsubscript^𝑅𝜌𝑓subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑓𝜉\\\\forall f\\\\in\\\\mathcal{F},\\\\quad\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\]. |  |\\\n\\\nThe quantity ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}} is a _critical radius_,\\\na relevant threshold that excludes degenerated problems and flat losses for which Rρ​(f)=maxΞ⁡fsubscript𝑅𝜌𝑓subscriptΞ𝑓R\\_{\\\\rho}(f)=\\\\max\\_{\\\\Xi}f. The exact generalization guarantee thus holds for a wide range of radius ρ𝜌\\\\rho, growing with the sample size between the two extreme cases 00 and ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}}. As in Theorem 3.1 from \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\], but adding the wide setting of [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), the sample rates are dimension-free. The constants α𝛼\\\\alpha and β𝛽\\\\beta depend on the problem quantities, see [Section5](https://ar5iv.org/html/2402.11981#S5 \"5 On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for a detailed discussion.\\\n\\\n### 3.2 Regularized Wasserstein robust models\\\n\\\nPart of the success of optimal transport in machine learning is the use of regularization, and specifically entropic regularization, opening the way to nice properties and efficient computational schemes \\[ [15](https://ar5iv.org/html/2402.11981#bib.bib15 \"\"), [28](https://ar5iv.org/html/2402.11981#bib.bib28 \"\")\\]. Recall that the entropy-regularized Wasserstein distance writes, for a reference coupling π0∈𝒫​(Ξ×Ξ)subscript𝜋0𝒫ΞΞ\\\\pi\\_{0}\\\\in\\\\mathcal{P}(\\\\Xi\\\\!\\\\times\\\\!\\\\Xi)\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Wcτ​(P,Q)=infπ∈𝒫​(Ξ×Ξ)\\[π\\]1=P,\\[π2\\]=Q{𝔼π​\\[c\\]+τ​KL⁡(π∥π0)}subscriptsuperscript𝑊𝜏𝑐𝑃𝑄subscriptinfimum𝜋𝒫ΞΞformulae-sequencesubscriptdelimited-\\[\\]𝜋1𝑃delimited-\\[\\]subscript𝜋2𝑄subscript𝔼𝜋delimited-\\[\\]𝑐𝜏KLconditional𝜋subscript𝜋0W^{\\\\tau}\\_{c}(P,Q)=\\\\inf\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P,\\[\\\\pi\\_{2}\\]=Q\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\} |  | (8) |\\\n\\\nwhere KLKL\\\\operatorname{KL} is the Kullback-Leibler divergence w.r.t. π0subscript𝜋0\\\\pi\\_{0}:\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | KL⁡(π∥π0)={∫Ξ×Ξlog⁡d​πd​π0​d​πwhen ​π≪π0∞otherwise.KLconditional𝜋subscript𝜋0casessubscriptΞΞd𝜋dsubscript𝜋0d𝜋much-less-thanwhen 𝜋subscript𝜋0otherwise.\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})=\\\\begin{cases}\\\\int\\_{\\\\Xi\\\\times\\\\Xi}\\\\log\\\\frac{\\\\mathrm{d}\\\\pi}{\\\\mathrm{d}\\\\pi\\_{0}}\\\\,\\\\mathrm{d}\\\\pi&\\\\text{when }\\\\pi\\\\ll\\\\pi\\_{0}\\\\\\<br>\\\\infty&\\\\text{otherwise.}\\\\end{cases} |  |\\\n\\\nRegularization have been recently studied in the context of WDRO: \\[ [38](https://ar5iv.org/html/2402.11981#bib.bib38 \"\")\\] introduces an entropic regularization in constraints for computational interests, \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] considers an entropic regularization in the objective for generalization, and \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\] studies a general regularization in both constraints and objective.\\\n\\\nFollowing the most general case \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\], we consider\\\nthe robust risk with double regularization\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Rρ,Qτ,ϵ​(f):=supπ∈𝒫​(Ξ×Ξ),\\[π\\]1=Q𝔼π​\\[c\\]+τ​KL⁡(π∥π0)≤ρ{𝔼\\[π\\]2​\\[f\\]−ϵ​KL⁡(π∥π0)}.assignsuperscriptsubscript𝑅𝜌𝑄𝜏italic-ϵ𝑓subscriptsupremumformulae-sequence𝜋𝒫ΞΞsubscriptdelimited-\\[\\]𝜋1𝑄subscript𝔼𝜋delimited-\\[\\]𝑐𝜏KLconditional𝜋subscript𝜋0𝜌subscript𝔼subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]𝑓italic-ϵKLconditional𝜋subscript𝜋0R\\_{\\\\rho,Q}^{\\\\tau,\\\\epsilon}(f):=\\\\!\\\\!\\\\!\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),~{}\\[\\\\pi\\]\\_{1}=Q\\\\\\<br>\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\leq\\\\rho\\\\end{subarray}}\\\\!\\\\!\\\\!\\\\left\\\\{\\\\mathbb{E}\\_{\\[\\\\pi\\]\\_{2}}\\[f\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}. |  |\\\n\\\nwith two parameters ϵ>0italic-ϵ0\\\\epsilon>0 and τ≥0𝜏0\\\\tau\\\\geq 0.\\\nIntroducing the conditional moment of π0subscript𝜋0\\\\pi\\_{0}:\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | mc=maxξ∈Ξ⁡𝔼ζ∼π0(⋅\\|ξ)​\\[c​(ξ,ζ)\\],m\\_{c}=\\\\max\\_{\\\\xi\\\\in\\\\Xi}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[c(\\\\xi,\\\\zeta)\\], |  | (9) |\\\n\\\nthe generalization guarantee in this setting states as follows.\\\n\\\n###### Theorem 3.2(Generalization for double regularization).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exist ατ,ϵ,βτ,ϵ>0superscript𝛼𝜏italic-ϵsuperscript𝛽𝜏italic-ϵ0\\\\alpha^{\\\\tau,\\\\epsilon}\\\\!,\\\\beta^{\\\\tau,\\\\epsilon}\\\\!>\\\\!0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | max⁡{mc,ατ,ϵn}<ρ<ρcritτ,ϵ2−βτ,ϵn,subscript𝑚𝑐superscript𝛼𝜏italic-ϵ𝑛𝜌superscriptsubscript𝜌crit𝜏italic-ϵ2superscript𝛽𝜏italic-ϵ𝑛\\\\max\\\\left\\\\{m\\_{c},\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}\\\\right\\\\}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}-\\\\frac{\\\\beta^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}, |  |\\\n\\\nthen with probability at least 1−δ1𝛿1-\\\\delta, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} and all Q𝑄Q such that Wcτ​(P,Q)≤ρsubscriptsuperscript𝑊𝜏𝑐𝑃𝑄𝜌W^{\\\\tau}\\_{c}(P,Q)\\\\leq\\\\rho,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ρτ,ϵ​(f)≥𝔼ζ∼Q​\\[f​(ζ)\\]−ϵ​KL⁡(πP,Q∥π0),subscriptsuperscript^𝑅𝜏italic-ϵ𝜌𝑓subscript𝔼similar-to𝜁𝑄delimited-\\[\\]𝑓𝜁italic-ϵKLconditionalsuperscript𝜋𝑃𝑄subscript𝜋0\\\\widehat{R}^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0}), |  |\\\n\\\nwhere πP,Qsuperscript𝜋𝑃𝑄\\\\pi^{P,Q} is the optimal coupling in ( [8](https://ar5iv.org/html/2402.11981#S3.E8 \"Equation 8 ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nThis result is similar to the one of [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), it is also similar to the only other generalization result existing for regularized WDRO \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\]. Let us explicit below the main differences. We will discuss in [Section5](https://ar5iv.org/html/2402.11981#S5 \"5 On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), the generalization constants such as the critical radius ρcritτ,ϵsuperscriptsubscript𝜌crit𝜏italic-ϵ\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}.\\\n\\\nUnlike Wasserstein robust models ( [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), regularization leads to an inexact generalization guarantee, where the regularized empirical robust risk bounds a proxy for the true risk 𝔼P​\\[f\\]subscript𝔼𝑃delimited-\\[\\]𝑓\\\\mathbb{E}\\_{P}\\[f\\]. This is in line with the regularization in optimal transport that induces a bias in the Wasserstein metric, preventing Wcτ​(P,P)subscriptsuperscript𝑊𝜏𝑐𝑃𝑃W^{\\\\tau}\\_{c}(P,P) from being null.\\\n\\\nCompared to \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\], we underline that our result covers also the double regularization case. Moreover, it is valid for an arbitrary π0subscript𝜋0\\\\pi\\_{0} whereas the one of \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] relies on the specific form π0subscript𝜋0\\\\pi\\_{0} involving a Gaussian term. Our result is thus more flexible, allowing to choose conjointly c𝑐c and π0subscript𝜋0\\\\pi\\_{0}. For example, a Laplace distribution can be chosen when c𝑐c is the ℓ1subscriptℓ1\\\\ell\\_{1}-norm.\\\n\\\nBefore moving on to the proof of the generalization results, let us come back to [Figure1](https://ar5iv.org/html/2402.11981#S1.F1 \"In 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). To get this plot, we generated 500 instances of logistic regression problems with synthetic classification data (n=100𝑛100n=100, d=5𝑑5d=5), for which we solve an associated robust counterpart (with an ℓ1subscriptℓ1\\\\ell\\_{1}-cost c𝑐c and a Laplace distribution π0(⋅\\|ξ)\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | minθ⁡max𝔼π\\[∥⋅∥1\\]≤ρ\\[π\\]1=P^n\\\\displaystyle\\\\min\\_{\\\\theta}\\\\max\\_{\\\\begin{subarray}{c}\\\\mathbb{E}\\_{\\\\pi}\\[\\\\\\|{\\\\cdot}\\\\\\|\\_{1}\\]\\\\leq\\\\rho\\\\\\<br>\\[\\\\pi\\]\\_{1}=\\\\widehat{P}\\_{n}\\\\end{subarray}} | 𝔼(x,y)∼\\[π\\]2​\\[log⁡(1+ey​⟨θ,x⟩)\\].subscript𝔼similar-to𝑥𝑦subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]1superscript𝑒𝑦𝜃𝑥\\\\displaystyle\\\\mathbb{E}\\_{(x,y)\\\\sim\\[\\\\pi\\]\\_{2}}\\[\\\\log(1+e^{y\\\\langle\\\\theta,x\\\\rangle})\\]. |  |\\\n\\\nThis setting is covered by [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") but not by existing results in previous works. Let us check the realizations of the bound ( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Using 105superscript10510^{5} samples, we estimate the true risk 𝔼P​\\[f\\]subscript𝔼𝑃delimited-\\[\\]𝑓\\\\mathbb{E}\\_{P}\\[f\\] for computed optimal solutions f𝑓f of the 500 instances.\\\nOn the figure, we report the proportion of instances for which the bound holds and we observe that when ρ𝜌\\\\rho increases, the bound does hold true.\\\n\\\n## 4 Proof strategy\\\n\\\nThis section presents our strategy to prove the generalization results of Section [3](https://ar5iv.org/html/2402.11981#S3 \"3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") (Theorems [3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\nThe strength of our approach is to use\\\nflexible nonsmooth analysis arguments, able to cover the general situation of arbitrary (continuous) cost and objective functions. After an overview of the proof in [Section4.2](https://ar5iv.org/html/2402.11981#S4.SS2 \"4.2 Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we explain the key mechanisms in Sections [4.3](https://ar5iv.org/html/2402.11981#S4.SS3 \"4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and how they combine with a concentration theorem ( [Section4.1](https://ar5iv.org/html/2402.11981#S4.SS1 \"4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to show the results.\\\n\\\nIn Sections [4.2](https://ar5iv.org/html/2402.11981#S4.SS2 \"4.2 Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), [4.3](https://ar5iv.org/html/2402.11981#S4.SS3 \"4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") we consider the standard WDRO setting of [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The extension to the regularized setting of [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is then explained in [Section4.5](https://ar5iv.org/html/2402.11981#S4.SS5 \"4.5 Extension to (double) regularization. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Furthermore, in order to focus on the rationale we do not include the proofs in the core of the paper and we refer precisely to corresponding results in the supplementary. We also underline the fundamental results of probability and (nonsmooth) analysis that are used all along. All the statements of this section implicitly assume that our [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") holds.\\\n\\\n### 4.1 Uniform concentration inequality\\\n\\\nIn order to obtain high-probability bounds guarantees, uniform on ℱℱ\\\\mathcal{F}, we rely on a standard uniform concentration inequality on a compact metric space. We recall the essential result below, highlighting the two crucial properties on the random variable: _(i) boundedness_ and _(ii) global Lipschitzness_.\\\nWe refer to e.g. \\[ [12](https://ar5iv.org/html/2402.11981#bib.bib12 \"\")\\] for general discussions, and to [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). ‣ A.1 Uniform concentration inequality ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for one-sided alternatives.\\\n\\\n###### Theorem 4.1(Uniform concentration).\\\n\\\nLet (𝒳,dist)𝒳dist(\\\\mathcal{X},\\\\operatorname{dist}) be a compact metric space, and X:𝒳×Ξ→ℝ:𝑋→𝒳ΞℝX:\\\\mathcal{X}\\\\times\\\\Xi\\\\to\\\\mathbb{R} be a measurable function. Assume the following:\\\n\\\n1. (i)\\\n\\\n\\\nThere exist a,b∈ℝ𝑎𝑏ℝa,b\\\\in\\\\mathbb{R} such that X​(x,ξ)∈\\[a,b\\]𝑋𝑥𝜉𝑎𝑏X(x,\\\\xi)\\\\in\\[a,b\\] for all (x,ξ)∈𝒳×Ξ𝑥𝜉𝒳Ξ(x,\\\\xi)\\\\in\\\\mathcal{X}\\\\times\\\\Xi.\\\n\\\n2. (ii)\\\n\\\n\\\nX​(⋅,ξ)𝑋⋅𝜉X(\\\\cdot,\\\\xi) is L𝐿L-Lipschitz for all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi.\\\n\\\n\\\nThen with probability at least 1−δ1𝛿1-\\\\delta,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | supx∈𝒳\\|𝔼ξ∼P^n​\\[X​(x,ξ)\\]−𝔼ξ∼P​\\[X​(x,ξ)\\]\\|≤Mn.subscriptsupremum𝑥𝒳subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]𝑋𝑥𝜉subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑋𝑥𝜉𝑀𝑛\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\\\left\\|\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[X(x,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[X(x,\\\\xi)\\]\\\\right\\|\\\\leq\\\\frac{M}{\\\\sqrt{n}}. |  |\\\n\\\nM𝑀M is a problem-dependent constant having the expression222The constant ℐ​(𝒳,dist)ℐ𝒳dist\\\\mathcal{I}({\\\\mathcal{X},\\\\operatorname{dist}}) is the standard Dudley’s entropy integral measuring the complexity of the space 𝒳𝒳\\\\mathcal{X}, that we further discuss in [DefinitionA.4](https://ar5iv.org/html/2402.11981#A1.Thmdefinition4 \"Definition A.4. ‣ A.1 Uniform concentration inequality ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | M=48​L​ℐ​(𝒳,dist)+(b−a)​2​log⁡(2/δ).𝑀48𝐿ℐ𝒳dist𝑏𝑎22𝛿M=48\\\\,L\\\\,\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist})+\\ (b-a)\\\\sqrt{2\\\\log(2/\\\\delta)}. |  |\\\n\\\nWe will apply this concentration result to two families of functions (ψ𝜓\\\\psi and ϕitalic-ϕ\\\\phi) appearing in our proof; to this end, we will establish the two points (i) and (ii) in [Lemma4.1](https://ar5iv.org/html/2402.11981#S4.Thmlemma1 \"Lemma 4.1. ‣ 4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [Lemma4.3](https://ar5iv.org/html/2402.11981#S4.Thmlemma3 \"Lemma 4.3. ‣ Dual bound on the empirical risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") respectively.\\\n\\\n### 4.2 Proof’s overview\\\n\\\nCompared to the original formulation ( [6](https://ar5iv.org/html/2402.11981#S3.E6 \"Equation 6 ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), the dual representation of WDRO significantly diminishes the problem’s degrees of freedom, and is usually the starting point of most studies.\\\nGiven any distribution Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi), it holds that\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Rρ,Q​(f)=infλ≥0{λ​ρ+𝔼ξ∼Q​\\[ϕ​(λ,f,ξ)\\]},subscript𝑅𝜌𝑄𝑓subscriptinfimum𝜆0𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]italic-ϕ𝜆𝑓𝜉R\\_{\\\\rho,Q}(f)=\\\\inf\\_{\\\\lambda\\\\geq 0}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  | (10) |\\\n\\\nwhere the _dual generator_ ϕitalic-ϕ\\\\phi is a convex function with respect to λ𝜆\\\\lambda, and Lipschitz continuous with respect to f𝑓f. For Wasserstein robust models, ϕitalic-ϕ\\\\phi has the expression (see e.g. \\[ [8](https://ar5iv.org/html/2402.11981#bib.bib8 \"\")\\])\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ϕ​(λ,f,ξ)=supζ∈Ξ{f​(ζ)−λ​c​(ξ,ζ)}.italic-ϕ𝜆𝑓𝜉subscriptsupremum𝜁Ξ𝑓𝜁𝜆𝑐𝜉𝜁\\\\phi(\\\\lambda,f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\\\right\\\\}. |  |\\\n\\\nObserve that ϕitalic-ϕ\\\\phi is naturally convex in λ𝜆\\\\lambda, but also nonsmooth. The originality of our approach is to build on this nonsmoothness by using a rationale of nonsmooth analysis. Note also that the convexity of ϕitalic-ϕ\\\\phi will be a key property (see e.g. the argument of [Figure3](https://ar5iv.org/html/2402.11981#S4.F3 \"In Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nLet us then outline the main steps to establish [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n1. 1.\\\n\\\n\\\nWe establish in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") the existence of a dual lower bound λlowsubscript𝜆low\\\\lambda\\_{\\\\operatorname{low}}, which holds with high probability and uniformly on ℱℱ\\\\mathcal{F}, whenever ρ<ρcrit2−βn𝜌subscript𝜌crit2𝛽𝑛\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}:\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ρ​(f)=infλ∈\\[λlow,∞){λ​ρ+𝔼P^n​\\[ϕ​(λ,f)\\]}.subscript^𝑅𝜌𝑓subscriptinfimum𝜆subscript𝜆low𝜆𝜌subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓\\\\widehat{R}\\_{\\\\rho}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\infty)}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f)\\]\\\\right\\\\}. |  |\\\n\\\n2. 2.\\\n\\\n\\\nAs explained in [Section4.3](https://ar5iv.org/html/2402.11981#S4.SS3 \"4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), this leads to\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ρ​(f)≥Rρ−αn​(f).subscript^𝑅𝜌𝑓subscript𝑅𝜌𝛼𝑛𝑓\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f). |  |\\\n\\\n3. 3.\\\n\\\n\\\nFinally, if furthermore αn<ρ𝛼𝑛𝜌\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho, then we capture the true risk on the right:\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ρ​(f)≥𝔼P​\\[f\\].subscript^𝑅𝜌𝑓subscript𝔼𝑃delimited-\\[\\]𝑓\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{P}\\[f\\]. |  |\\\n\\\n\\\n### 4.3 Concentration aspects by dual lower bound\\\n\\\nWe assume in this section that the empirical dual solution is lower bounded by a value λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 (with high probability), which means that the infimum in ( [10](https://ar5iv.org/html/2402.11981#S4.E10 \"Equation 10 ‣ 4.2 Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), with Q=P^n𝑄subscript^𝑃𝑛Q=\\\\widehat{P}\\_{n}, may be taken over \\[λlow,0)subscript𝜆low0\\[\\\\lambda\\_{\\\\operatorname{low}},0) instead of ℝ+subscriptℝ\\\\mathbb{R}\\_{+}. In this case, we can proceed as follows. For a distribution Q𝑄Q, we use the shorthand 𝔼Q​\\[ϕ\\]=𝔼ξ∼Q​\\[ϕ​(λ,f,ξ)\\]subscript𝔼𝑄delimited-\\[\\]italic-ϕsubscript𝔼similar-to𝜉𝑄delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\mathbb{E}\\_{Q}\\[\\\\phi\\]=\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]. Then we can write for λ≥λlow𝜆subscript𝜆low\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}},\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | λ​ρ+𝔼P^n​\\[ϕ\\]𝜆𝜌subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ\\\\displaystyle\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi\\] | ≥λ​(ρ−(𝔼P​\\[ϕ\\]−𝔼P^n​\\[ϕ\\]λ))+𝔼P​\\[ϕ\\]absent𝜆𝜌subscript𝔼𝑃delimited-\\[\\]italic-ϕsubscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆subscript𝔼𝑃delimited-\\[\\]italic-ϕ\\\\displaystyle\\\\geq\\\\lambda\\\\left(\\\\rho-\\\\left(\\\\frac{\\\\mathbb{E}\\_{P}\\[\\\\phi\\]-\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi\\]}{\\\\lambda}\\\\right)\\\\right)+\\\\mathbb{E}\\_{P}\\[\\\\phi\\] |  |\\\n|  |  | ≥λ​(ρ−αn)+𝔼P​\\[ϕ\\],absent𝜆𝜌subscript𝛼𝑛subscript𝔼𝑃delimited-\\[\\]italic-ϕ\\\\displaystyle\\\\geq\\\\lambda(\\\\rho-\\\\alpha\\_{n})+\\\\mathbb{E}\\_{P}\\[\\\\phi\\], |  | (11) |\\\n\\\nwhere αnsubscript𝛼𝑛\\\\alpha\\_{n} is a formal lower bound on the quotient term (formally defined ( [4.3](https://ar5iv.org/html/2402.11981#S4.Ex22 \"4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"))).\\\nTaking the infimum over λ≥λlow𝜆subscript𝜆low\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}}, we obtain\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^ρ​(f)≥Rρ−αn​(f)≥𝔼ξ∼P​\\[f​(ξ)\\],subscript^𝑅𝜌𝑓subscript𝑅𝜌subscript𝛼𝑛𝑓subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑓𝜉\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\alpha\\_{n}}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\], |  | (12) |\\\n\\\nwhenever ρ>αn𝜌subscript𝛼𝑛\\\\rho>\\\\alpha\\_{n}. This is the desired inequality of [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Thus, in order to have ( [4.3](https://ar5iv.org/html/2402.11981#S4.Ex21 \"4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) with high probability for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, we introduce the function ψ𝜓\\\\psi of the variable μ=λ−1𝜇superscript𝜆1\\\\mu=\\\\lambda^{-1}:\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | ψ​(μ,f,ξ)𝜓𝜇𝑓𝜉\\\\displaystyle\\\\psi(\\\\mu,\\\\!f,\\\\xi) | :=μ​ϕ​(μ−1,f,ξ)=supζ∈Ξ{μ​f​(ζ)−c​(ξ,ζ)}assignabsent𝜇italic-ϕsuperscript𝜇1𝑓𝜉subscriptsupremum𝜁Ξ𝜇𝑓𝜁𝑐𝜉𝜁\\\\displaystyle\\\\!:=\\\\!\\\\mu\\\\phi(\\\\mu^{-1}\\\\!,\\\\!f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)\\\\!-\\\\!c(\\\\xi,\\\\zeta)\\\\right\\\\} |  | (13) |\\\n\\\nand we study the gap αnsubscript𝛼𝑛\\\\alpha\\_{n} defined by\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | αn:=supassignsubscript𝛼𝑛supremum\\\\displaystyle\\\\alpha\\_{n}:=\\\\sup | {𝔼ξ∼P\\[ψ(μ,f,ξ)\\]−𝔼ξ∼P^n\\[ψ(μ,f,ξ)\\]\\\\displaystyle\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]\\\\right. |  |\\\n|  |  | :(μ,f)∈(0,λlow−1\\]×ℱ}.\\\\displaystyle\\ :\\ \\\\left.(\\\\mu,f)\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}\\\\right\\\\}. |  | (14) |\\\n\\\nIn order to obtain a high probability bound of the form αn≤αnsubscript𝛼𝑛𝛼𝑛\\\\alpha\\_{n}\\\\leq\\\\frac{\\\\alpha}{\\\\sqrt{n}}, boundedness (i) and Lipschitz continuity (ii) of (μ,f)↦ψ​(μ,f,ξ)maps-to𝜇𝑓𝜓𝜇𝑓𝜉(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) are required by the concentration theorem [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). In the expression ( [13](https://ar5iv.org/html/2402.11981#S4.E13 \"Equation 13 ‣ 4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we remark that the Lipschitz constant of ψ​(μ,f,ξ)𝜓𝜇𝑓𝜉\\\\psi(\\\\mu,f,\\\\xi) explodes as μ→∞→𝜇\\\\mu\\\\to\\\\infty, hence we must bound μ=λ−1𝜇superscript𝜆1\\\\mu=\\\\lambda^{-1} above. Thus, if a lower bound λlowsubscript𝜆low\\\\lambda\\_{\\\\operatorname{low}} holds on λ𝜆\\\\lambda, ψ𝜓\\\\psi satisfies the requirements of [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n###### Lemma 4.1.\\\n\\\nGiven λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0, then for almost all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi,\\\n\\\n1. (i)\\\n\\\n\\\nFor all μ∈(0,λlow−1\\]𝜇0superscriptsubscript𝜆low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ψ​(μ,f,ξ)∈\\[−‖ℱ‖∞λlow,‖ℱ‖∞λlow\\].𝜓𝜇𝑓𝜉subscriptnormℱsubscript𝜆lowsubscriptnormℱsubscript𝜆low\\\\psi(\\\\mu,f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\]. |  |\\\n\\\n2. (ii)\\\n\\\n\\\n(μ,f)↦ψ​(μ,f,ξ)maps-to𝜇𝑓𝜓𝜇𝑓𝜉(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) is Lipschitz continuous on (0,λlow−1\\]×ℱ0superscriptsubscript𝜆low1ℱ(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F} with constant ‖ℱ‖∞+λlow−1subscriptnormℱsuperscriptsubscript𝜆low1\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\n\n\n###### Proof.\n\nSee [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). ‣ C.1 Standard WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").2 in the supplementary.\n∎\n\n### 4.4 Getting a dual lower bound.\n\nIn order to get a dual lower bound, we proceed in two steps:\n\n1. 1.\n\n\nWe show the existence of a dual lower bound on the true robust risk. This involves the definition of an inherent maximal radius, which plays the role of a degeneracy threshold.\n\n2. 2.\n\n\nWe show that the lower bound on the true robust risk transposes to the empirical robust risk, with high probability and uniformly on ℱℱ\\\\mathcal{F}. This is done by expressing a slope condition and applying the concentration inequality [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n\n##### Dual bound on the true risk.\n\nIn order to obtain a dual lower bound on the true robust risk, it is sufficient for the (right-sided) derivative of λ↦λ​ρ+𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]maps-to𝜆𝜆𝜌subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\lambda\\\\mapsto\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\] to be negative for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} on an interval \\[0,2​λlow\\]02subscript𝜆low\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\]333Although the factor 2 may not seem necessary at the moment, its role will become clearer in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4.SSS0.Px2 \"Dual bound on the empirical risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), with λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0. This writes:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ρ≤𝔼ξ∼P​\\[−∂λ+ϕ​(λ,f,ξ)\\],𝜌subscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscriptsuperscript𝜆italic-ϕ𝜆𝑓𝜉\\\\rho\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\], |  | (15) |\n\nwhich implies that ρ𝜌\\\\rho has to be small. To obtain the condition ( [15](https://ar5iv.org/html/2402.11981#S4.E15 \"Equation 15 ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) uniformly in f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, we introduce the maximal value of ρ𝜌\\\\rho allowed at a given λ≥0𝜆0\\\\lambda\\\\geq 0 (illustrated in [Figure2](https://ar5iv.org/html/2402.11981#S4.F2 \"In Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n![Refer to caption](https://ar5iv.org/html/2402.11981/assets/x2.png)Figure 2: A central object of our analysis: the maximal radius ρmaxsubscript𝜌\\\\rho\\_{\\\\max}, defined from the lower envelope of derivatives of ϕitalic-ϕ\\\\phi.\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ρmax​(λ)=inff∈ℱ𝔼ξ∼P​\\[−∂λ+ϕ​(λ,f,ξ)\\].subscript𝜌𝜆subscriptinfimum𝑓ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscriptsubscript𝜆italic-ϕ𝜆𝑓𝜉\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]. |  | (16) |\n\nAs illustrated by [Figure2](https://ar5iv.org/html/2402.11981#S4.F2 \"In Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), ρmaxsubscript𝜌\\\\rho\\_{\\\\max} reaches its highest value at zero. This is the _critical radius_,\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρcrit=ρmax​(0).subscript𝜌critsubscript𝜌0\\\\rho\\_{\\\\operatorname{crit}}=\\\\rho\\_{\\\\max}(0). |  |\n\nThis particular quantity will be discussed in [Section5.2](https://ar5iv.org/html/2402.11981#S5.SS2 \"5.2 The critical radius ‣ 5 On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). As a central result of this work, we show that ρmaxsubscript𝜌\\\\rho\\_{\\\\max} can be made arbitrarily close to ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}} as λ→0+→𝜆superscript0\\\\lambda\\\\to 0^{+}.\n\n###### Lemma 4.2.\n\nlimλ→0+ρmax​(λ)=ρcritsubscript→𝜆superscript0subscript𝜌𝜆subscript𝜌crit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}. In particular, there exists λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that for all λ∈\\[0,2​λlow\\]𝜆02subscript𝜆low\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\], for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | 𝔼ξ∼P​\\[∂λ+ϕ​(λ,f,ξ)\\]≤−ρcrit2.subscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscriptsuperscript𝜆italic-ϕ𝜆𝑓𝜉subscript𝜌crit2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}. |  | (17) |\n\n###### Proof.\n\nSee [LemmaD.1](https://ar5iv.org/html/2402.11981#A4.Thmlemma1 \"Lemma D.1. ‣ D.1 Standard WDRO: continuity at zero of the maximal radius ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\n∎\n\nThis means that the derivative condition ( [15](https://ar5iv.org/html/2402.11981#S4.E15 \"Equation 15 ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) is satisfied whenever ρ≤ρcrit2𝜌subscript𝜌crit2\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}. In order to transpose the inequality ( [17](https://ar5iv.org/html/2402.11981#S4.E17 \"Equation 17 ‣ Lemma 4.2. ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to the empirical problem, precisely to obtain 𝔼ξ∼P^n​\\[∂λ+ϕ​(λ,f,ξ)\\]≤−ρcrit2subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]subscriptsuperscript𝜆italic-ϕ𝜆𝑓𝜉subscript𝜌crit2\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2} with high probability, we would like to apply the concentration theorem ( [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Unfortunately, the derivative ∂λ+ϕ​(λ,⋅,ξ)subscriptsuperscript𝜆italic-ϕ𝜆⋅𝜉\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,\\\\cdot,\\\\xi) is discontinuous and doesn’t satisfy the Lipschitz condition (ii) from [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Indeed, its expression is inherently given by the envelope formula (Theorem 2.8.2, \\[ [14](https://ar5iv.org/html/2402.11981#bib.bib14 \"\")\\]) involving an arg max:\n\n|     |     |     |\n| --- | --- | --- |\n|  | ∂λ+ϕ(λ,f,ξ)=−minζ∈Ξ{c(ζ,arg​maxΞ{f−λc(ξ,⋅)}}.\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)=-\\\\min\\_{\\\\zeta\\\\in\\\\Xi}\\\\{c(\\\\zeta,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\}\\\\}. |  |\n\n![Refer to caption](https://ar5iv.org/html/2402.11981/assets/x3.png)Figure 3: Bounding from below the empirical dual solution λ∗superscript𝜆\\\\lambda^{\\*} expresses as a slope condition (thanks to convexity of the objective).\n\n##### Dual bound on the empirical risk.\n\nWe propose a simple way to overcome the limitation highlighted above by relying on the convexity of ϕitalic-ϕ\\\\phi. Indeed, given a convex function g𝑔g over ℝ+superscriptℝ\\\\mathbb{R}^{+}, the infimum of g𝑔g has to occur on an interval \\[λlow,+∞\\]subscript𝜆low\\[\\\\lambda\\_{\\\\operatorname{low}},+\\\\infty\\] if g𝑔g has a negative slope between λlowsubscript𝜆low\\\\lambda\\_{\\\\operatorname{low}} and 2​λlow2subscript𝜆low2\\\\lambda\\_{\\\\operatorname{low}} ( [Figure3](https://ar5iv.org/html/2402.11981#S4.F3 \"In Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n|     |     |     |\n| --- | --- | --- |\n|  | g​(2​λlow)−g​(λlow)λlow≤0⟹infλ≥λlowg​(λ)=infλ≥0g​(λ).𝑔2subscript𝜆low𝑔subscript𝜆lowsubscript𝜆low0subscriptinfimum𝜆subscript𝜆low𝑔𝜆subscriptinfimum𝜆0𝑔𝜆\\\\frac{g(2\\\\lambda\\_{\\\\operatorname{low}})-g(\\\\lambda\\_{\\\\operatorname{low}})}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\leq 0\\\\implies\\\\inf\\_{\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}}}g(\\\\lambda)=\\\\inf\\_{\\\\lambda\\\\geq 0}g(\\\\lambda). |  |\n\nWe want this condition satisfied for the empirical Lagrangian function g​(λ)=λ​ρ+𝔼P^n​\\[ϕ​(λ,f)\\]𝑔𝜆𝜆𝜌subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓g(\\\\lambda)=\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f)\\] with high probability. For convenience, this can be expressed with the slope of 𝔼P^n​\\[ϕ​(⋅,f)\\]subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ⋅𝑓\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\cdot,f)\\]:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | s^​(f):=𝔼P^n​\\[ϕ​(2​λlow,f)\\]−𝔼P^n​\\[ϕ​(λlow,f)\\]λlow≤−ρ.assign^𝑠𝑓subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ2subscript𝜆low𝑓subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕsubscript𝜆low𝑓subscript𝜆low𝜌\\\\widehat{s}(f)\\\\!:=\\\\!\\\\frac{\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\]-\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f)\\]}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\leq-\\\\rho. |  | (18) |\n\nThis is the condition we aim to obtain. To this end, we proceed by comparing the empirical slope to the true one,\n\n|     |     |     |\n| --- | --- | --- |\n|  | s​(f):=𝔼P​\\[ϕ​(2​λlow,f)\\]−𝔼P​\\[ϕ​(λlow,f)\\]λlow.assign𝑠𝑓subscript𝔼𝑃delimited-\\[\\]italic-ϕ2subscript𝜆low𝑓subscript𝔼𝑃delimited-\\[\\]italic-ϕsubscript𝜆low𝑓subscript𝜆lows(f):=\\\\frac{\\\\mathbb{E}\\_{P}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\]-\\\\mathbb{E}\\_{P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f)\\]}{\\\\lambda\\_{\\\\operatorname{low}}}. |  |\n\nIndeed, we can show that any function (f,ξ)↦ϕ​(λ,f,ξ)maps-to𝑓𝜉italic-ϕ𝜆𝑓𝜉(f,\\\\xi)\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi), with λ∈ℝ+𝜆subscriptℝ\\\\lambda\\\\in\\\\mathbb{R}\\_{+}, satisfies the requirements for the concentration theorem ( [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n###### Lemma 4.3.\n\nFor almost all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi we have\n\n1. (i)\n\n\nFor all λ≥0𝜆0\\\\lambda\\\\geq 0 and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | ϕ​(λ,f,ξ)∈\\[−‖ℱ‖∞,‖ℱ‖∞\\].italic-ϕ𝜆𝑓𝜉subscriptnormℱsubscriptnormℱ\\\\phi(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\]. |  |\n\n2. (ii)\n\n\nFor all λ≥0𝜆0\\\\lambda\\\\geq 0, f↦ϕ​(λ,f,ξ)maps-to𝑓italic-ϕ𝜆𝑓𝜉f\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi) is Lipschitz continuous on ℱℱ\\\\mathcal{F} with constant 111.\n\n\n###### Proof.\n\nSee [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). ‣ C.1 Standard WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").1.\n∎\n\nConsequently, we can apply the concentration theorem twice, on each function ϕ​(2​λlow,⋅,⋅)italic-ϕ2subscript𝜆low⋅⋅\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},\\\\cdot,\\\\cdot) and ϕ​(2​λlow,⋅,⋅)italic-ϕ2subscript𝜆low⋅⋅\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},\\\\cdot,\\\\cdot), to obtain that s^​(f)^𝑠𝑓\\\\widehat{s}(f) approximates s​(f)𝑠𝑓s(f) with high probability, up to a term of the form βn𝛽𝑛\\\\frac{\\\\beta}{\\\\sqrt{n}}:\n\n|     |     |     |\n| --- | --- | --- |\n|  | ∀f∈ℱ,s^​(f)≤s​(f)+βn.formulae-sequencefor-all𝑓ℱ^𝑠𝑓𝑠𝑓𝛽𝑛\\\\forall f\\\\in\\\\mathcal{F},\\\\quad\\\\widehat{s}(f)\\\\leq s(f)+\\\\frac{\\\\beta}{\\\\sqrt{n}}. |  |\n\nOn the other hand, s​(f)≤𝔼P​\\[∂λ+ϕ​(2​λlow,f)\\]𝑠𝑓subscript𝔼𝑃delimited-\\[\\]subscriptsuperscript𝜆italic-ϕ2subscript𝜆low𝑓s(f)\\\\leq\\\\mathbb{E}\\_{P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\] by convexity of ϕitalic-ϕ\\\\phi, hence s​(f)≤−ρcrit2𝑠𝑓subscript𝜌crit2s(f)\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2} by ( [17](https://ar5iv.org/html/2402.11981#S4.E17 \"Equation 17 ‣ Lemma 4.2. ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). This means\n\n|     |     |     |\n| --- | --- | --- |\n|  | s^​(f)≤βn−ρcrit2,^𝑠𝑓𝛽𝑛subscript𝜌crit2\\\\widehat{s}(f)\\\\leq\\\\frac{\\\\beta}{\\\\sqrt{n}}-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}, |  |\n\nhence we have the desired condition ( [18](https://ar5iv.org/html/2402.11981#S4.E18 \"Equation 18 ‣ Dual bound on the empirical risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) when\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρ<ρcrit2−βn.𝜌subscript𝜌crit2𝛽𝑛\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}. |  |\n\n### 4.5 Extension to (double) regularization.\n\nThe strategy of [Section4.2](https://ar5iv.org/html/2402.11981#S4.SS2 \"4.2 Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is flexible enough to be extended to the regularized setting of [Section3.2](https://ar5iv.org/html/2402.11981#S3.SS2 \"3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Indeed, the regularized problem also has a dual representation, with a dual generator defined by\n\n|     |     |     |\n| --- | --- | --- |\n|  | ϕτ,ϵ​(λ,f,ξ)=(ϵ+λ​τ)​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\],\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\], |  |\n\nwhere ϵ>0italic-ϵ0\\\\epsilon>0 and τ≥0𝜏0\\\\tau\\\\geq 0. Strong duality has been shown in \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\]. We explain in [AppendixB](https://ar5iv.org/html/2402.11981#A2 \"Appendix B Strong duality ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), [PropositionB.2](https://ar5iv.org/html/2402.11981#A2.Thmproposition2 \"Proposition B.2 (Strong duality, regularized WDRO). ‣ Appendix B Strong duality ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") how it applies to our general setting. This regularized dual generator leads to smooth counterparts of the key nonsmooth functions ψ𝜓\\\\psi, ρmaxsubscript𝜌\\\\rho\\_{\\\\max} and ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}} of the proof. In particular, we can show the regularized version of [Lemma4.2](https://ar5iv.org/html/2402.11981#S4.Thmlemma2 \"Lemma 4.2. ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n###### Lemma 4.4.\n\nlimλ→0+ρmaxτ,ϵ​(λ)=ρcritτ,ϵsubscript→𝜆superscript0superscriptsubscript𝜌𝜏italic-ϵ𝜆superscriptsubscript𝜌crit𝜏italic-ϵ\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}. In particular, there exists λlowτ,ϵ>0superscriptsubscript𝜆low𝜏italic-ϵ0\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}>0 such that for all λ∈\\[0,2​λlowτ,ϵ\\]𝜆02superscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}\\], ∀f∈ℱfor-all𝑓ℱ\\\\forall f\\\\in\\\\mathcal{F},\n\n|     |     |     |\n| --- | --- | --- |\n|  | 𝔼ξ∼P​\\[∂λϕτ,ϵ​(λ,f,ξ)\\]≤−ρcritτ,ϵ2.subscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscript𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉superscriptsubscript𝜌crit𝜏italic-ϵ2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}. |  |\n\nThen we obtain [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") by repeating the proof scheme of [Section4.2](https://ar5iv.org/html/2402.11981#S4.SS2 \"4.2 Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The core results that simultaneously lead to Theorems [3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") are gathered in [SectionE.1](https://ar5iv.org/html/2402.11981#A5.SS1 \"E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Due to the smoothness of ρmaxτ,ϵsuperscriptsubscript𝜌𝜏italic-ϵ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}, an expression of λlowτ,ϵsuperscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} can also be obtained; see [LemmaD.2](https://ar5iv.org/html/2402.11981#A4.Thmlemma2 \"Lemma D.2. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\nThe key difference brought by regularization is that the Lipschitz property of ψτ,ϵsuperscript𝜓𝜏italic-ϵ\\\\psi^{\\\\tau,\\\\epsilon} is lost when μ→0→𝜇0\\\\mu\\\\to 0. This is an inherent peculiarity of the regularized setting which may occur over the whole family ℱℱ\\\\mathcal{F} and the space ΞΞ\\\\Xi; see the example of [PropositionF.2](https://ar5iv.org/html/2402.11981#A6.Thmproposition2 \"Proposition F.2. ‣ F.2 Necessity of the dual upper-bound ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). This prevents to use the concentration result without guaranteeing that we can set a lower bound on μ𝜇\\\\mu or equivalently an upper-bound on λ𝜆\\\\lambda. This is the purpose of the next lemma which establishes the existence of such an upper-bound, for any distribution.\n\n###### Lemma 4.5.\n\nLet Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) and λup:=2​‖ℱ‖∞ρ−mcassignsubscript𝜆up2subscriptnormℱ𝜌subscript𝑚𝑐\\\\lambda\\_{\\\\operatorname{up}}:=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}. Then for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\n\n|     |     |     |\n| --- | --- | --- |\n|  | Rρ,Q​(f)=infλ∈\\[0,λup\\]{λ​ρ+𝔼ξ∼Q​\\[ϕ​(λ,f,ξ)\\]}.subscript𝑅𝜌𝑄𝑓subscriptinfimum𝜆0subscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]italic-ϕ𝜆𝑓𝜉R\\_{\\\\rho,Q}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}}\\]}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\n\n###### Proof.\n\nSee [LemmaD.3](https://ar5iv.org/html/2402.11981#A4.Thmlemma3 \"Lemma D.3 (Upper bound for the regularized problem Lemma 4.5). ‣ D.2.2 Dual upper-bound ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\n∎\n\n## 5 On the generalization constants\n\nIn this section, we put our generalization results into perspective by further discussing the bounds α,β𝛼𝛽\\\\alpha,\\\\beta, the critical radius ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}} appearing in [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), as well as their regularized counterparts of [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n### 5.1 Sample complexity\n\nWe give the complete expressions of α𝛼\\\\alpha, β𝛽\\\\beta, ατ,ϵsuperscript𝛼𝜏italic-ϵ\\\\alpha^{\\\\tau,\\\\epsilon} and βτ,ϵsuperscript𝛽𝜏italic-ϵ\\\\beta^{\\\\tau,\\\\epsilon} in the detailed versions of Theorems [3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in [SectionE.2](https://ar5iv.org/html/2402.11981#A5.SS2 \"E.2 Proof of the main results ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Here we highlight their dependence from the problem’s constants.\n\nFirst, in the setting of [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), α𝛼\\\\alpha and β𝛽\\\\beta grow essentially with the size and the complexity of ℱℱ\\\\mathcal{F}. Indeed, we have\n\n|     |     |     |     |     |\n| --- | --- | --- | --- | --- |\n|  | α𝛼\\\\displaystyle\\\\alpha | =O(ℐ(ℱ,∥⋅∥∞)×∥ℱ∥∞),\\\\displaystyle=O\\\\big{(}\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\times\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\\\big{)}, |  | (19) |\n|  | β𝛽\\\\displaystyle\\\\beta | =O(∥ℱ∥∞+ℐ(ℱ,∥⋅∥∞)).\\\\displaystyle=O\\\\big{(}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\big{)}. |  |\n\nThe Dudley’s entropy ℐ(ℱ,∥⋅∥∞)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) quantifies the complexity of ℱℱ\\\\mathcal{F}. In the large class of Lipschitz functions, this quantity is exponential in the data dimension. In practice, most machine learning problems involve a Lipschitz parametric family of losses ( [Section2](https://ar5iv.org/html/2402.11981#S2 \"2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in which case ℐ(ℱ,∥⋅∥∞)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) becomes proportional to p𝑝\\\\sqrt{p}, where p𝑝p is the parameter’s dimension (see e.g. Chapter 5.1 from \\[ [37](https://ar5iv.org/html/2402.11981#bib.bib37 \"\")\\]).\n\nThe constants α𝛼\\\\alpha and β𝛽\\\\beta also grow with 1/λlow1subscript𝜆low1/\\\\lambda\\_{\\\\operatorname{low}} and we have α=O​(1/λlow2)𝛼𝑂1superscriptsubscript𝜆low2\\\\alpha=O\\\\left(1/{\\\\lambda\\_{\\\\operatorname{low}}^{2}}\\\\right) and β=O​(1/λlow)𝛽𝑂1subscript𝜆low\\\\beta=O\\\\left(1/{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right). The constant λlowsubscript𝜆low{\\\\lambda\\_{\\\\operatorname{low}}} is implicitly defined and depends on the regularity at 00 of ρmaxsubscript𝜌\\\\rho\\_{\\\\max} ( [16](https://ar5iv.org/html/2402.11981#S4.E16 \"Equation 16 ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), hence it may depend on ℱℱ\\\\mathcal{F}, ΞΞ\\\\Xi, c𝑐c and P𝑃P.\n\nIn the setting of [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we have similar interpretations. In addition to the conditional moment mcsubscript𝑚𝑐m\\_{c} ( [9](https://ar5iv.org/html/2402.11981#S3.E9 \"Equation 9 ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), the constants ατ,ϵsuperscript𝛼𝜏italic-ϵ\\\\alpha^{\\\\tau,\\\\epsilon} and βτ,ϵsuperscript𝛽𝜏italic-ϵ\\\\beta^{\\\\tau,\\\\epsilon} also involve the second order conditional moment:\n\n|     |     |     |\n| --- | --- | --- |\n|  | m2,c=maxξ∈Ξ⁡𝔼ζ∼π0(⋅\\|ξ)​\\[c​(ξ,ζ)2\\].m\\_{2,c}=\\\\max\\_{\\\\xi\\\\in\\\\Xi}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[c(\\\\xi,\\\\zeta)^{2}\\]. |  |\n\nThey are parameters that may be chosen in practice and related to the reference coupling π0subscript𝜋0\\\\pi\\_{0}. For instance, if π0(⋅\\|ξ)\\\\pi\\_{0}(\\\\cdot\\|\\\\xi) is a truncated Gaussian π0(⋅\\|ξ)∝e−∥⋅−ξ∥22​σ2𝟙Ξ\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\propto e^{-\\\\frac{\\\\\\|\\\\cdot-\\\\xi\\\\\\|^{2}}{2\\\\sigma^{2}}}\\\\mathds{1}\\_{\\\\Xi} and c​(ξ,ζ)=12​‖ξ−ζ‖2𝑐𝜉𝜁12superscriptnorm𝜉𝜁2c(\\\\xi,\\\\zeta)=\\\\frac{1}{2}\\\\\\|\\\\xi-\\\\zeta\\\\\\|^{2} we have mc∝σ2proportional-tosubscript𝑚𝑐superscript𝜎2m\\_{c}\\\\propto\\\\sigma^{2} and m2,c∝σ4proportional-tosubscript𝑚2𝑐superscript𝜎4m\\_{2,c}\\\\propto\\\\sigma^{4}.\n\nThe coefficients ατ,ϵsuperscript𝛼𝜏italic-ϵ\\\\alpha^{\\\\tau,\\\\epsilon} and βτ,ϵsuperscript𝛽𝜏italic-ϵ\\\\beta^{\\\\tau,\\\\epsilon} exhibit similar relations with λlowτ,ϵsuperscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}, ‖ℱ‖∞subscriptnormℱ\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}, and ℐ(ℱ,∥⋅∥∞)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) to their counterparts α𝛼\\\\alpha and β𝛽\\\\beta ( [19](https://ar5iv.org/html/2402.11981#S5.E19 \"Equation 19 ‣ 5.1 Sample complexity ‣ 5 On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Regarding the hyperparameters mcsubscript𝑚𝑐m\\_{c}, ϵitalic-ϵ\\\\epsilon, τ𝜏\\\\tau and ρ𝜌\\\\rho, they should be of comparable order according to the expression of ατ,ϵsuperscript𝛼𝜏italic-ϵ\\\\alpha^{\\\\tau,\\\\epsilon} ( [TheoremE.2](https://ar5iv.org/html/2402.11981#A5.Thmtheorem2 \"Theorem E.2 (Generalization guarantee, regularized WDRO). ‣ E.2 Proof of the main results ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Compared to the standard setting, we have an estimate of the lower bound λlowτ,ϵsuperscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} ( [LemmaD.2](https://ar5iv.org/html/2402.11981#A4.Thmlemma2 \"Lemma D.2. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) showing dependence on the loss family: 1/λlowτ,ϵ=O​(e‖ℱ‖∞ϵ)1superscriptsubscript𝜆low𝜏italic-ϵ𝑂superscript𝑒subscriptnormℱitalic-ϵ1/{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}=O\\\\big{(}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\big{)}.\n\n### 5.2 The critical radius\n\nIn the standard setting, the critical radius has the expression\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρcrit=𝔼ξ∼P​\\[min⁡{c​(ξ,ζ):ζ∈arg​maxΞ⁡f}\\].subscript𝜌critsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]:𝑐𝜉𝜁𝜁subscriptargmaxΞ𝑓\\\\rho\\_{\\\\operatorname{crit}}=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\min\\\\left\\\\{c(\\\\xi,\\\\zeta)\\ :\\ \\\\zeta\\\\in\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\\\right\\\\}\\\\right\\]. |  |\n\nAssuming ρcrit>0subscript𝜌crit0\\\\rho\\_{\\\\operatorname{crit}}>0 excludes losses that remain constant across all samples from the ground truth distribution P𝑃P. This assumption reasonably aligns with practice and appeared in previous works \\[ [3](https://ar5iv.org/html/2402.11981#bib.bib3 \"\"), [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\]. For instance, obtaining a predictor that precisely interpolates the ground truth distribution (leading to a loss equal to zero everywhere) is unrealistic. It also defines a threshold to exclude degenerated problems: if ρ>ρcrit𝜌subscript𝜌crit\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}, then there exists f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} such that Rρ​(f)=maxΞ⁡fsubscript𝑅𝜌𝑓subscriptΞ𝑓R\\_{\\\\rho}(f)=\\\\max\\_{\\\\Xi}f and the problem becomes independent from ρ𝜌\\\\rho, see \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\].\n\nA similar interpretation can be made in the regularized case with smoothed counterparts. Indeed, we can verify that if ρ>ρcritτ,ϵ𝜌superscriptsubscript𝜌crit𝜏italic-ϵ\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}, then there exists f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} such that\n\n|     |     |     |\n| --- | --- | --- |\n|  | Rρτ,ϵ​(f)=supπ∈𝒫​(Ξ×Ξ),\\[π\\]1=P{𝔼\\[π\\]2​\\[f\\]−KL⁡(π∥π0)},subscriptsuperscript𝑅𝜏italic-ϵ𝜌𝑓subscriptsupremumformulae-sequence𝜋𝒫ΞΞsubscriptdelimited-\\[\\]𝜋1𝑃subscript𝔼subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]𝑓KLconditional𝜋subscript𝜋0R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)=\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\[\\\\pi\\]\\_{2}}\\[f\\]-\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}, |  |\n\nand the problem becomes independent from ρ𝜌\\\\rho, see in particular [PropositionF.1](https://ar5iv.org/html/2402.11981#A6.Thmproposition1 \"Proposition F.1. ‣ F.1 Interpretation of the critical radius in the regularized case. ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\n\n## 6 Conclusion\n\nIn this work, we provide exact generalization guarantees of (regularized) Wasserstein robust models, covering all usual machine learning situations, without restrictive assumptions (on the Wasserstein metric or the class of functions). We achieve these universal results by directly addressing the intrinsic nonsmoothness of robust problems. Our results thus give users freedom when choosing the radius ρ𝜌\\\\rho: for all usual situations, it is not necessary to consider specific regimes for ρ𝜌\\\\rho in order to expect good generalization from robust models. Further research can now focus on practical aspects: it would be of premier interest to design efficient practical procedures for selecting ρ𝜌\\\\rho, and more generally, scalable algorithms for solving distributionally robust optimization problems.\n\n## Acknowledgements\n\nThis research was partially supported by MIAI@Grenoble Alpes (ANR-19-P3IA-0003).\n\n## References\n\n- \\[1\\]C. Aliprantis and K. Border, Infinite Dimensional Analysis,\nSpringer Berlin, Heidelberg, 2006.\n\n- \\[2\\]B. Amos and J. Z. Kolter, Optnet: Differentiable optimization as a\nlayer in neural networks, in International Conference on Machine Learning,\nPMLR, 2017, pp. 136–145.\n\n- \\[3\\]Y. An and R. Gao, Generalization bounds for (wasserstein) robust\noptimization, in Advances in Neural Information Processing Systems, vol. 34,\n2021, pp. 10382–10392.\n\n- \\[4\\]A. Arrigo, C. Ordoudis, J. Kazempour, Z. De Grève, J.-F. Toubeau, and\nF. Vallée, Wasserstein distributionally robust chance-constrained\noptimization for energy and reserve dispatch: An exact and physically-bounded\nformulation, European Journal of Operational Research, 296 (2022),\npp. 304–322.\n\n- \\[5\\]W. Azizian, F. Iutzeler, and J. Malick, Exact generalization\nguarantees for (regularized) wasserstein distributionally robust models,\narXiv preprint arXiv:2305.17076, (2023).\n\n- \\[6\\], Regularization for\nwasserstein distributionally robust optimization, ESAIM: Control,\nOptimisation and Calculus of Variations, 29 (2023), p. 33.\n\n- \\[7\\]R. Belbasi, A. Selvi, and W. Wiesemann, It’s all in the mix:\nWasserstein machine learning with mixed features, arXiv preprint\narXiv:2312.12230, (2023).\n\n- \\[8\\]J. Blanchet and K. Murthy, Quantifying distributional model risk via\noptimal transport, Mathematics of Operations Research, 44 (2019),\npp. 565–600.\n\n- \\[9\\]J. Blanchet, K. Murthy, and V. A. Nguyen, Statistical analysis of\nwasserstein distributionally robust estimators, in Tutorials in Operations\nResearch: Emerging Optimization Methods and Modeling Techniques with\nApplications, INFORMS, 2021, pp. 227–254.\n\n- \\[10\\]J. Blanchet, K. Murthy, and N. Si, Confidence regions in\nWasserstein distributionally robust estimation, Biometrika, 109 (2021),\npp. 295–315.\n\n- \\[11\\]J. Blanchet and A. Shapiro, Statistical limit theorems in\ndistributionally robust optimization, 2023.\n\n- \\[12\\]S. Boucheron, G. Lugosi, and P. Massart, Concentration\nInequalities: A Nonasymptotic Theory of Independence, Oxford University\nPress, 2013.\n\n- \\[13\\]R. Chen and I. C. Paschalidis, A robust learning approach for\nregression models based on distributionally robust optimization, Journal of\nMachine Learning Research, 19 (2018), pp. 1–48.\n\n- \\[14\\]F. Clarke, Optimization and Nonsmooth Analysis, Classics in Applied\nMathematics, Society for Industrial and Applied Mathematics, 1990.\n\n- \\[15\\]M. Cuturi, Sinkhorn distances: Lightspeed computation of optimal\ntransport, in Advances in Neural Information Processing Systems, vol. 26,\n2013.\n\n- \\[16\\]M. D. Donsker and S. R. S. Varadhan, Asymptotic evaluation of\ncertain markov process expectations for large time, i, Communications on\nPure and Applied Mathematics, 28 (1975), pp. 1–47.\n\n- \\[17\\]R. Durrett, Probability: Theory and Examples, Cambridge Series in\nStatistical and Probabilistic Mathematics, Cambridge University Press, 2010.\n\n- \\[18\\]N. Fournier and A. Guillin, On the rate of convergence in\nwasserstein distance of the empirical measure, Probability Theory and\nRelated Fields, 162 (2015), pp. 707–738.\n\n- \\[19\\]R. Gao, Finite-sample guarantees for wasserstein distributionally\nrobust optimization: Breaking the curse of dimensionality, Oper. Res., 71\n(2022), p. 2291–2306.\n\n- \\[20\\]R. Gao, X. Chen, and A. J. Kleywegt, Wasserstein distributionally\nrobust optimization and variation regularization, Operations Research,\n(2022).\n\n- \\[21\\]K. He, X. Zhang, S. Ren, and J. Sun, Deep residual learning for\nimage recognition, in Proceedings of the IEEE Conference on Computer Vision\nand Pattern Recognition (CVPR), June 2016.\n\n- \\[22\\]A. Krizhevsky, I. Sutskever, and G. E. Hinton, Imagenet\nclassification with deep convolutional neural networks, in Advances in\nNeural Information Processing Systems, vol. 25, 2012.\n\n- \\[23\\]D. Kuhn, P. M. Esfahani, V. A. Nguyen, and S. Shafieezadeh-Abadeh, Wasserstein distributionally robust optimization: Theory and applications in\nmachine learning, in Operations research & management science in the age of\nanalytics, Informs, 2019, pp. 130–166.\n\n- \\[24\\]Y. Kwon, W. Kim, J.-H. Won, and M. C. Paik, Principled learning\nmethod for wasserstein distributionally robust optimization with local\nperturbations, in International Conference on Machine Learning, PMLR, 2020,\npp. 5567–5576.\n\n- \\[25\\]Y. LeCun, Y. Bengio, and G. Hinton, Deep learning, Nature, 521\n(2015), pp. 436–444.\n\n- \\[26\\]J. Li, C. Chen, and A. M.-C. So, Fast epigraphical projection-based\nincremental algorithms for wasserstein distributionally robust support vector\nmachine, in Advances in Neural Information Processing Systems, vol. 33,\n2020, pp. 4029–4039.\n\n- \\[27\\]P. Mohajerin Esfahani and D. Kuhn, Data-driven distributionally\nrobust optimization using the wasserstein metric: performance guarantees and\ntractable reformulations, Mathematical Programming, 171 (2018),\npp. 115–166.\n\n- \\[28\\]G. Peyré and M. Cuturi, Computational optimal transport: With\napplications to data science, Found. Trends Mach. Learn., 11 (2019),\np. 355–607.\n\n- \\[29\\]Y. Polyanskiy and Y. Wu., Information theory: From coding to\nlearning.\n\nprepublication, 2023.\n\n- \\[30\\]J. Redmon, S. Divvala, R. Girshick, and A. Farhadi, You only look\nonce: Unified, real-time object detection, in 2016 IEEE Conference on\nComputer Vision and Pattern Recognition (CVPR), Los Alamitos, CA, USA, 2016,\nIEEE Computer Society, pp. 779–788.\n\n- \\[31\\]R. T. Rockafellar and R. J. B. Wets, Variational Analysis, Springer\nBerlin Heidelberg, 1998.\n\n- \\[32\\]M. E. Sander, J. Puigcerver, J. Djolonga, G. Peyré, and M. Blondel,\nFast, differentiable and sparse top-k: A convex analysis perspective,\nin Proceedings of the 40th International Conference on Machine Learning,\nICML’23, JMLR.org, 2023.\n\n- \\[33\\]S. Shafieezadeh-Abadeh, P. M. Esfahani, and D. Kuhn, Distributionally robust logistic regression, in Proceedings of the 28th\nInternational Conference on Neural Information Processing Systems - Volume 1,\nNIPS’15, Cambridge, MA, USA, 2015, MIT Press, p. 1576–1584.\n\n- \\[34\\]S. Shafieezadeh-Abadeh, D. Kuhn, and P. M. Esfahani, Regularization\nvia mass transportation, Journal of Machine Learning Research, 20 (2019),\npp. 1–68.\n\n- \\[35\\]A. Sinha, H. Namkoong, and J. C. Duchi, Certifying some\ndistributional robustness with principled adversarial training, in 6th\nInternational Conference on Learning Representations, 2018.\n\n- \\[36\\]B. Taskesen, M.-C. Yue, J. Blanchet, D. Kuhn, and V. A. Nguyen, Sequential domain adaptation by synthesizing distributionally robust\nexperts, in International Conference on Machine Learning, PMLR, 2021,\npp. 10162–10172.\n\n- \\[37\\]M. J. Wainwright, High-Dimensional Statistics: A Non-Asymptotic\nViewpoint, Cambridge Series in Statistical and Probabilistic Mathematics,\nCambridge University Press, 2019.\n\n- \\[38\\]J. Wang, R. Gao, and Y. Xie, Sinkhorn distributionally robust\noptimization, 2023.\n\n- \\[39\\]C. Zhao and Y. Guan, Data-driven risk-averse stochastic optimization\nwith wasserstein metric, Operations Research Letters, 46 (2018),\npp. 262–267.\n\n\nSupplementary Material\n\nThis supplementary gathers recalls, technical results, and examples, as well as, the detailed proof of the results of the main text. The core of our contributions are presented in Appendices [D](https://ar5iv.org/html/2402.11981#A4 \"Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [E](https://ar5iv.org/html/2402.11981#A5 \"Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\nThe whole supplementary is organized as follows:\n\n\\- In [AppendixA](https://ar5iv.org/html/2402.11981#A1 \"Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we recall some essential mathematical tools. They include a uniform concentration inequality ( [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). ‣ A.1 Uniform concentration inequality ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), continuity notions in nonsmooth analysis, and the envelope formula to differentiate supremum functions ( [TheoremA.1](https://ar5iv.org/html/2402.11981#A1.Thmtheorem1 \"Theorem A.1 (Envelope formula, Corollary 1, Chapter 2.8 in [14]). ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n\n\\- In [AppendixB](https://ar5iv.org/html/2402.11981#A2 \"Appendix B Strong duality ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we present strong duality results for WDRO and its regularized version. We explain in particular how the duality theorem from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\] can be easily adapted to our setting.\n\n\\- [AppendixC](https://ar5iv.org/html/2402.11981#A3 \"Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") contains preliminary computations in view of applying the uniform concentration theorem.\n\n\\- In [AppendixD](https://ar5iv.org/html/2402.11981#A4 \"Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we demonstrate the existence of a dual lower bound in the standard and regularized cases. In particular, the proofs involve the maximal radius introduced in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n\\- By using these preliminary results, in [AppendixE](https://ar5iv.org/html/2402.11981#A5 \"Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we prove our main generalization theorems ( [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Detailed versions with constants’ expressions are proved, [TheoremE.1](https://ar5iv.org/html/2402.11981#A5.Thmtheorem1 \"Theorem E.1 (Generalization guarantee, standard WDRO). ‣ E.2 Proof of the main results ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for the standard setting, and [TheoremE.2](https://ar5iv.org/html/2402.11981#A5.Thmtheorem2 \"Theorem E.2 (Generalization guarantee, regularized WDRO). ‣ E.2 Proof of the main results ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for the regularized setting.\n\n\\- [AppendixF](https://ar5iv.org/html/2402.11981#A6 \"Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") contains minor results supporting several remarks found in the article. They include the interpretation of the critical radius in the regularized case, a counter-example justifying the upper-bound in the regularized case and the interpretation of the restrictive compactness assumptions used in \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\].\n\n## Notations\n\nThroughout the proofs will use the following notations:\n\nIn Wasserstein robust models:\n\n- •\n\n\nϕ​(λ,f,ξ)=supζ∈Ξ{f​(ζ)−λ​c​(ξ,ζ)}italic-ϕ𝜆𝑓𝜉subscriptsupremum𝜁Ξ𝑓𝜁𝜆𝑐𝜉𝜁\\\\phi(\\\\lambda,f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\\\right\\\\}\n\n- •\n\n\nψ​(μ,f,ξ)=μ​ϕ​(μ−1,f,ξ)𝜓𝜇𝑓𝜉𝜇italic-ϕsuperscript𝜇1𝑓𝜉\\\\psi(\\\\mu,f,\\\\xi)=\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi)\n\n\nIn Wasserstein robust models with double regularization:\n\n- •\n\n\nϕτ,ϵ​(λ,f,ξ)=(ϵ+λ​τ)​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\n\n- •\n\n\nψτ,ϵ​(μ,f,ξ)=μ​ϕτ,ϵ​(μ−1,f,ξ)superscript𝜓𝜏italic-ϵ𝜇𝑓𝜉𝜇superscriptitalic-ϕ𝜏italic-ϵsuperscript𝜇1𝑓𝜉\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi)=\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},f,\\\\xi)\n\n\nGiven a measurable function h:Ξ→ℝ:ℎ→Ξℝh:\\\\Xi\\\\to\\\\mathbb{R} and π∈𝒫​(Ξ)𝜋𝒫Ξ\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi) the Gibbs distribution πhsuperscript𝜋ℎ\\\\pi^{h} is defined as\n\n|     |     |     |\n| --- | --- | --- |\n|  | d​πh∝eh​d​π.proportional-todsuperscript𝜋ℎsuperscript𝑒ℎd𝜋\\\\mathrm{d}\\\\pi^{h}\\\\propto e^{h}\\\\mathrm{d}\\\\pi. |  |\n\n## Appendix A Recalls and technical preliminaries\n\nIn this part, we use the notation G:𝒳⇉𝒴:𝐺⇉𝒳𝒴G:\\\\mathcal{X}\\\\rightrightarrows\\\\mathcal{Y} to denote a function G𝐺G defined on 𝒳𝒳\\\\mathcal{X} and valued in the set of subsets of 𝒴𝒴\\\\mathcal{Y}.\n\nSemicontinuity notions will be necessary to understand the proof of [LemmaD.1](https://ar5iv.org/html/2402.11981#A4.Thmlemma1 \"Lemma D.1. ‣ D.1 Standard WDRO: continuity at zero of the maximal radius ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). They are regularity notions recurrently arising when manipulating nonsmooth convex functions.\n\n###### Definition A.1(Lower and upper semicontinuity, 2.42 in \\[ [1](https://ar5iv.org/html/2402.11981\\#bib.bib1 \"\")\\]).\n\nLet (𝒳,dist)𝒳dist(\\\\mathcal{X},\\\\operatorname{dist}) be a metric space and let f:𝒳→ℝ:𝑓→𝒳ℝf:\\\\mathcal{X}\\\\to\\\\mathbb{R}. Then\n\n1. 1.\n\n\nf𝑓f is called _lower semicontinuous_ if for all x∈𝒳𝑥𝒳x\\\\in\\\\mathcal{X}, lim infy→xf​(y)≥f​(x)subscriptlimit-infimum→𝑦𝑥𝑓𝑦𝑓𝑥\\\\liminf\\_{y\\\\to x}f(y)\\\\geq f(x).\n\n2. 2.\n\n\nf𝑓f is called _upper semicontinuous_ if for all x∈𝒳𝑥𝒳x\\\\in\\\\mathcal{X}, lim supy→xf​(y)≤f​(x)subscriptlimit-supremum→𝑦𝑥𝑓𝑦𝑓𝑥\\\\limsup\\_{y\\\\to x}f(y)\\\\leq f(x).\n\n\nIn particular, if f𝑓f is lower semicontinuous, then −f𝑓-f is upper semicontinuous.\n\n_Outer semicontinuity_ can be seen as the set-valued counterpart of upper semicontinuity:\n\n###### Definition A.2(Outer semicontinuity).\n\nLet 𝒳𝒳\\\\mathcal{X} and 𝒴𝒴\\\\mathcal{Y} two metric spaces. Then a measurable and compact-valued map G:𝒳⇉𝒴:𝐺⇉𝒳𝒴G:\\\\mathcal{X}\\\\rightrightarrows\\\\mathcal{Y} is called _outer semicontinuous_ at x∈𝒳𝑥𝒳x\\\\in\\\\mathcal{X} if for all open subset V⊂𝒴𝑉𝒴V\\\\subset\\\\mathcal{Y} containing G​(x)𝐺𝑥G(x), there exists a neighborhood U𝑈U of x𝑥x which is such that for all w∈U𝑤𝑈w\\\\in U, G​(w)⊂V𝐺𝑤𝑉G(w)\\\\subset V.\n\nSemicontinuity of maximum and arg​maxargmax\\\\operatorname\\*{arg\\\\,max} functions are central to the proof of [LemmaD.1](https://ar5iv.org/html/2402.11981#A4.Thmlemma1 \"Lemma D.1. ‣ D.1 Standard WDRO: continuity at zero of the maximal radius ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\n\n###### Lemma A.1(17.30 in \\[ [1](https://ar5iv.org/html/2402.11981\\#bib.bib1 \"\")\\]).\n\nLet 𝒳𝒳\\\\mathcal{X} and ΞΞ\\\\Xi be two metric spaces and let G:𝒳⇉Ξ:𝐺⇉𝒳ΞG:\\\\mathcal{X}\\\\rightrightarrows\\\\Xi be outer semicontinuous with nonempty compact values, h:Ξ×Ξ→ℝ:ℎ→ΞΞℝh:\\\\Xi\\\\times\\\\Xi\\\\rightarrow\\\\mathbb{R} continuous. Then the function\n\n|     |     |     |\n| --- | --- | --- |\n|  | x↦max⁡{h​(x,v):v∈G​(x)}maps-to𝑥:ℎ𝑥𝑣𝑣𝐺𝑥x\\\\mapsto\\\\max\\\\{h(x,v)\\ :\\ v\\\\in G(x)\\\\} |  |\n\nis upper semicontinuous. In particular, u↦min⁡{h​(u,v):v∈G​(x)}maps-to𝑢:ℎ𝑢𝑣𝑣𝐺𝑥u\\\\mapsto\\\\min\\\\{h(u,v)\\ :\\ v\\\\in G(x)\\\\} is lower semicontinuous.\n\n###### Lemma A.2(17.31 in \\[ [1](https://ar5iv.org/html/2402.11981\\#bib.bib1 \"\")\\]).\n\nIf 𝒳𝒳\\\\mathcal{X} is a metric space, (Ξ,d)Ξ𝑑(\\\\Xi,d) is a compact metric space, and h:𝒳×Ξ→ℝ:ℎ→𝒳Ξℝh:\\\\mathcal{X}\\\\times\\\\Xi\\\\to\\\\mathbb{R} is continuous, then the function x↦maxz∈Ξ⁡h​(x,z)maps-to𝑥subscript𝑧Ξℎ𝑥𝑧x\\\\mapsto\\\\max\\_{z\\\\in\\\\Xi}h(x,z) is continuous, and the set-valued map x↦arg​maxz∈Ξ⁡h​(x,z)maps-to𝑥subscriptargmax𝑧Ξℎ𝑥𝑧x\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{z\\\\in\\\\Xi}h(x,z) is outer semicontinuous.\n\nWe recall the definition of gradient for a nonsmooth convex function. This the _subdifferential_.\n\n###### Definition A.3(Subdifferential of convex function).\n\nLet ϕ:ℝm→ℝ:italic-ϕ→superscriptℝ𝑚ℝ\\\\phi:\\\\mathbb{R}^{m}\\\\to\\\\mathbb{R} be a convex function. Then we call subdifferential of ϕitalic-ϕ\\\\phi the set-valued map ∂ϕ:ℝm⇉ℝm:italic-ϕ⇉superscriptℝ𝑚superscriptℝ𝑚\\\\partial\\\\phi:\\\\mathbb{R}^{m}\\\\rightrightarrows\\\\mathbb{R}^{m} such that for all x∈ℝm𝑥superscriptℝ𝑚x\\\\in\\\\mathbb{R}^{m} and y∈ℝm𝑦superscriptℝ𝑚y\\\\in\\\\mathbb{R}^{m},\n\n|     |     |     |\n| --- | --- | --- |\n|  | ϕ​(y)≥ϕ​(x)+⟨v,y−x⟩​ for all ​v∈∂ϕ​(x).italic-ϕ𝑦italic-ϕ𝑥𝑣𝑦𝑥 for all 𝑣italic-ϕ𝑥\\\\phi(y)\\\\geq\\\\phi(x)+\\\\langle v,y-x\\\\rangle\\\\text{ for all }v\\\\in\\\\partial\\\\phi(x). |  |\n\nIn particular, we may apply the envelope formula to compute the subdifferential of a maximum function:\n\n###### Theorem A.1(Envelope formula, Corollary 1, Chapter 2.8 in \\[ [14](https://ar5iv.org/html/2402.11981\\#bib.bib14 \"\")\\]).\n\nLet (Ξ,d)Ξ𝑑(\\\\Xi,d) be a compact metric space and g:ℝm×Ξ→ℝ:𝑔→superscriptℝ𝑚Ξℝg:\\\\mathbb{R}^{m}\\\\times\\\\Xi\\\\to\\\\mathbb{R} such that\n\n1. 1.\n\n\nFor all x∈ℝm𝑥superscriptℝ𝑚x\\\\in\\\\mathbb{R}^{m}, g​(x,⋅)𝑔𝑥⋅g(x,\\\\cdot) is continuous.\n\n2. 2.\n\n\nFor all ζ∈Ξ𝜁Ξ\\\\zeta\\\\in\\\\Xi, g​(⋅,ζ)𝑔⋅𝜁g(\\\\cdot,\\\\zeta) is convex with subdifferential ∂xg​(⋅,ζ)subscript𝑥𝑔⋅𝜁\\\\partial\\_{x}g(\\\\cdot,\\\\zeta).\n\n\nThen G:=supζ∈Ξg​(⋅,ζ)assign𝐺subscriptsupremum𝜁Ξ𝑔⋅𝜁G:=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}g(\\\\cdot,\\\\zeta) is convex on ℝmsuperscriptℝ𝑚\\\\mathbb{R}^{m}, and its subdifferential is given for all x∈ℝm𝑥superscriptℝ𝑚x\\\\in\\\\mathbb{R}^{m} by\n\n|     |     |     |\n| --- | --- | --- |\n|  | ∂G​(x):=conv⁡{v:v∈∂xg​(x,ζ),ζ∈arg​maxΞ⁡g​(x,⋅)}.assign𝐺𝑥conv:𝑣formulae-sequence𝑣subscript𝑥𝑔𝑥𝜁𝜁subscriptargmaxΞ𝑔𝑥⋅\\\\partial G(x):=\\\\operatorname{conv}\\\\{v\\ :\\ v\\\\in\\\\partial\\_{x}g(x,\\\\zeta),\\\\,\\\\zeta\\\\in\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g(x,\\\\cdot)\\\\}. |  |\n\nwhere convconv\\\\operatorname{conv} denotes the convex hull of a set.\n\n### A.1 Uniform concentration inequality\n\nWe recall a concentration inequality that gives a high probability uniform bound for a family of bounded and Lipschitz functions. This is an extended version of [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") which details the one-sided inequalities (without the absolute value). We refer the reader to \\[ [12](https://ar5iv.org/html/2402.11981#bib.bib12 \"\")\\] for a complete reference on concentration inequalities, and Lemma G.2 in \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] for the proof of such a result.\n\n###### Theorem A.2(Uniform concentration inequality, Lemma G.2 in \\[ [5](https://ar5iv.org/html/2402.11981\\#bib.bib5 \"\")\\]).\n\nLet (𝒳,dist)𝒳dist(\\\\mathcal{X},\\\\text{dist}) be a (totally bounded) separable metric space, P𝑃P a probability distribution on a probability space ΞΞ\\\\Xi, and P^n=1n​∑i=1nδξisubscript^𝑃𝑛1𝑛superscriptsubscript𝑖1𝑛subscript𝛿subscript𝜉𝑖\\\\widehat{P}\\_{n}=\\\\frac{1}{n}\\\\sum\\_{i=1}^{n}\\\\delta\\_{\\\\xi\\_{i}} with ξ1,…,ξn​∼i.i.d.​Psubscript𝜉1…subscript𝜉𝑛i.i.d.similar-to𝑃\\\\xi\\_{1},\\\\ldots,\\\\xi\\_{n}\\\\overset{\\\\text{i.i.d.}}{\\\\sim}P. Consider a measurable mapping X:𝒳×Ξ→ℝ:𝑋→𝒳ΞℝX:\\\\mathcal{X}\\\\times\\\\Xi\\\\rightarrow\\\\mathbb{R} and assume that,\n\n1. (i)\n\n\nThere is a constant L>0𝐿0L>0 such that, for each ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, x↦X​(x,ξ)maps-to𝑥𝑋𝑥𝜉x\\\\mapsto X(x,\\\\xi) is L𝐿L-Lipschitz.\n\n2. (ii)\n\n\nX​(⋅,ξ)𝑋⋅𝜉X(\\\\cdot,\\\\xi) almost surely belongs to \\[a,b\\]𝑎𝑏\\[a,b\\].\n\n\nThen, for any δ∈(0,1)𝛿01\\\\delta\\\\in(0,1), we respectively have\n\n1. 1.\n\n\nWith probability at least 1−δ1𝛿1-\\\\delta,\n\n\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | supx∈𝒳{𝔼ξ∼P^n​\\[X​(x,ξ)\\]−𝔼ξ∼P​\\[X​(x,ξ)\\]}≤48​L​ℐ​(𝒳,dist)n+(b−a)​2​log⁡1δn.subscriptsupremum𝑥𝒳subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]𝑋𝑥𝜉subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑋𝑥𝜉48𝐿ℐ𝒳dist𝑛𝑏𝑎21𝛿𝑛\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[X(x,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[X(x,\\\\xi)\\]\\\\right\\\\}\\\\leq\\\\frac{48L\\\\mathcal{I(\\\\mathcal{X,\\\\operatorname{dist}})}}{\\\\sqrt{n}}+(b-a)\\\\sqrt{2\\\\frac{\\\\log\\\\frac{1}{\\\\delta}}{n}}. |  |\n\n2. 2.\n\n\nWith probability at least 1−δ1𝛿1-\\\\delta,\n\n\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | supx∈𝒳{𝔼ξ∼P​\\[X​(x,ξ)\\]−𝔼ξ∼P^n​\\[X​(x,ξ)\\]}≤48​L​ℐ​(𝒳,dist)n+(b−a)​2​log⁡1δn.subscriptsupremum𝑥𝒳subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑋𝑥𝜉subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]𝑋𝑥𝜉48𝐿ℐ𝒳dist𝑛𝑏𝑎21𝛿𝑛\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[X(x,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[X(x,\\\\xi)\\]\\\\right\\\\}\\\\leq\\\\frac{48L\\\\mathcal{I(\\\\mathcal{X,\\\\operatorname{dist}})}}{\\\\sqrt{n}}+(b-a)\\\\sqrt{2\\\\frac{\\\\log\\\\frac{1}{\\\\delta}}{n}}. |  |\n\n\nThe quantity ℐ​(𝒳,dist)ℐ𝒳dist\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist}) is defined as follows:\n\n###### Definition A.4.\n\nGiven a compact metric space (𝒳,dist)𝒳dist(\\\\mathcal{X},\\\\operatorname{dist}), _Dudley’s entropy integral_, ℐ​(𝒳,dist)ℐ𝒳dist\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist}), is defined as\n\n|     |     |     |\n| --- | --- | --- |\n|  | ℐ​(𝒳,dist):=∫0∞log⁡N​(t,𝒳,dist)​𝑑tassignℐ𝒳distsuperscriptsubscript0𝑁𝑡𝒳distdifferential-d𝑡\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist}):=\\\\int\\_{0}^{\\\\infty}\\\\sqrt{\\\\log N(t,\\\\mathcal{X},\\\\operatorname{dist})}dt |  |\n\nwhere N​(t,𝒳,dist)𝑁𝑡𝒳distN(t,\\\\mathcal{X},\\\\text{dist}) denotes the t𝑡t-packing number of 𝒳𝒳\\\\mathcal{X}, which is the maximal number of points in 𝒳𝒳\\\\mathcal{X} that are at least at a distance t𝑡t from each other.\n\nWe may recall some properties of Dudley’s entropy for Cartesian products and segments from ℝℝ\\\\mathbb{R}. These are known results, see e.g. \\[ [37](https://ar5iv.org/html/2402.11981#bib.bib37 \"\")\\] and Lemmas G.3 and G.4 from \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] for proofs.\n\n###### Lemma A.3(Dudley’s integral estimates).\n\n2. 1.\n\n\n(on Cartesian products) Let (𝒳1,dist1)subscript𝒳1subscriptdist1(\\\\mathcal{X}\\_{1},\\\\operatorname{dist}\\_{1}) and (𝒳2,dist2)subscript𝒳2subscriptdist2(\\\\mathcal{X}\\_{2},\\\\operatorname{dist}\\_{2}) be two metric spaces. Consider the product space 𝒳:=𝒳1×𝒳2assign𝒳subscript𝒳1subscript𝒳2\\\\mathcal{X}:=\\\\mathcal{X}\\_{1}\\\\times\\\\mathcal{X}\\_{2} equipped with the distance dist:=dist1+dist2assigndistsubscriptdist1subscriptdist2\\\\operatorname{dist}:=\\\\operatorname{dist}\\_{1}+\\\\operatorname{dist}\\_{2}. Then we have the inequality\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | ℐ​(𝒳,dist)≤ℐ​(𝒳1,dist1)+ℐ​(𝒳2,dist2).ℐ𝒳distℐsubscript𝒳1subscriptdist1ℐsubscript𝒳2subscriptdist2\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist})\\\\leq\\\\mathcal{I}(\\\\mathcal{X}\\_{1},\\\\operatorname{dist}\\_{1})+\\\\mathcal{I}(\\\\mathcal{X}\\_{2},\\\\operatorname{dist}\\_{2}). |  |\n\n3. 2.\n\n\n(on ℝℝ\\\\mathbb{R}) Let c>0𝑐0c>0. Then we have the inequality\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | ℐ(\\[0,c\\],\\|⋅\\|)≤3​c2.\\\\mathcal{I}(\\[0,c\\],\\|\\\\cdot\\|)\\\\leq\\\\frac{3c}{2}. |  |\n\n\n## Appendix B Strong duality\n\nIn this section, we recall duality results for WDRO \\[ [8](https://ar5iv.org/html/2402.11981#bib.bib8 \"\")\\] and its regularized version \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\]. We recall the Wasserstein distance with cost c𝑐c for (Q,Q′)∈𝒫​(Ξ)×𝒫​(Ξ)𝑄superscript𝑄′𝒫Ξ𝒫Ξ(Q,Q^{\\\\prime})\\\\in\\\\mathcal{P}(\\\\Xi)\\\\times\\\\mathcal{P}(\\\\Xi):\n\n|     |     |     |\n| --- | --- | --- |\n|  | Wc​(Q,Q′)=inf{𝔼(ξ,ζ)∼π​\\[c​(ξ,ζ)\\]:π∈𝒫​(Ξ×Ξ),\\[π\\]1=Q,\\[π\\]2=Q′}.subscript𝑊𝑐𝑄superscript𝑄′infimumconditional-setsubscript𝔼similar-to𝜉𝜁𝜋delimited-\\[\\]𝑐𝜉𝜁formulae-sequence𝜋𝒫ΞΞformulae-sequencesubscriptdelimited-\\[\\]𝜋1𝑄subscriptdelimited-\\[\\]𝜋2superscript𝑄′W\\_{c}(Q,Q^{\\\\prime})=\\\\inf\\\\left\\\\{\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi}\\[c(\\\\xi,\\\\zeta)\\]\\ :\\ \\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),\\[\\\\pi\\]\\_{1}=Q,\\[\\\\pi\\]\\_{2}=Q^{\\\\prime}\\\\right\\\\}. |  |\n\n###### Proposition B.1(Strong duality, standard WDRO).\n\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), for any Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) and ρ>0𝜌0\\\\rho>0,\n\n|     |     |     |\n| --- | --- | --- |\n|  | maxWc​(Q,Q′)≤ρ⁡𝔼ξ∼Q′​\\[f​(ξ)\\]=infλ≥0{λ​ρ+𝔼ξ∼Q​\\[ϕ​(λ,f,ξ)\\]}.subscriptsubscript𝑊𝑐𝑄superscript𝑄′𝜌subscript𝔼similar-to𝜉superscript𝑄′delimited-\\[\\]𝑓𝜉subscriptinfimum𝜆0𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\max\\_{W\\_{c}(Q,Q^{\\\\prime})\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q^{\\\\prime}}\\[f(\\\\xi)\\]=\\\\inf\\_{\\\\lambda\\\\geq 0}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\n\n###### Proof.\n\nThis is an application of Theorem 1 from \\[ [8](https://ar5iv.org/html/2402.11981#bib.bib8 \"\")\\]. In particular, Assumptions 1 and 2 from \\[ [8](https://ar5iv.org/html/2402.11981#bib.bib8 \"\")\\] are satisfied through [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n∎\n\n###### Proposition B.2(Strong duality, regularized WDRO).\n\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), for any Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) and ρ>0𝜌0\\\\rho>0,\n\n|     |     |     |\n| --- | --- | --- |\n|  | maxπ∈𝒫​(Ξ×Ξ)\\[π\\]1=Q𝔼π​\\[c\\]+τ​KL⁡(π∥π0)≤ρ⁡{𝔼ξ∼\\[π\\]2​\\[f​(ζ)\\]−ϵ​KL⁡(π∥π0)}=infλ≥0{λ​ρ+𝔼ξ∼Q​\\[ϕτ,ϵ​(λ,f,ξ)\\]}.subscript𝜋𝒫ΞΞsubscriptdelimited-\\[\\]𝜋1𝑄subscript𝔼𝜋delimited-\\[\\]𝑐𝜏KLconditional𝜋subscript𝜋0𝜌subscript𝔼similar-to𝜉subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]𝑓𝜁italic-ϵKLconditional𝜋subscript𝜋0subscriptinfimum𝜆0𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\max\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=Q\\\\\\<br>\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\leq\\\\rho\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim\\[\\\\pi\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\geq 0}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\n\n###### Proof.\n\nThis is an application of Theorem 3.1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\], which is a corollary to Theorem 2.1 \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\]. Note that the proofs of Theorems 2.1 and 3.1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\] can be easily extended to a general compact metric space (Ξ,d)Ξ𝑑(\\\\Xi,d), without being rewritten entirely. Precisely, only two arguments in their proofs rely on the real-valued setting \\[ [31](https://ar5iv.org/html/2402.11981#bib.bib31 \"\")\\] but can be directly extended to a general metric space as follows:\n\n- •\n\n\nIn the proof of Theorem 2.1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\], one needs to justify\n\n\n\n\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | sup{𝔼ξ∼P​\\[φ​(ξ,ζ​(ξ))\\]:ζ:Ξ→Ξ​ measurable}≥𝔼ξ∼P​\\[supζ∈Ξφ​(ξ,ζ)\\].supremumconditional-setsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝜑𝜉𝜁𝜉:𝜁→ΞΞ measurablesubscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscriptsupremum𝜁Ξ𝜑𝜉𝜁\\\\sup\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\varphi(\\\\xi,\\\\zeta(\\\\xi))\\\\right\\]\\ :\\ \\\\zeta:\\\\Xi\\\\to\\\\Xi\\\\text{ measurable}\\\\right\\\\}\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\varphi(\\\\xi,\\\\zeta)\\\\right\\]. |  | (20) |\n\n\n\nTo this end, the authors use the notion of normal integrand from \\[ [31](https://ar5iv.org/html/2402.11981#bib.bib31 \"\")\\]. Actually, ( [20](https://ar5iv.org/html/2402.11981#A2.E20 \"Equation 20 ‣ 1st item ‣ Proof. ‣ Appendix B Strong duality ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) holds true in a compact metric space: if φ𝜑\\\\varphi is continuous, then by compactness of ΞΞ\\\\Xi, the set-valued map ξ↦arg​maxζ∈Ξ⁡φ​(ξ,ζ)maps-to𝜉subscriptargmax𝜁Ξ𝜑𝜉𝜁\\\\xi\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{\\\\zeta\\\\in\\\\Xi}\\\\varphi(\\\\xi,\\\\zeta) admits a measurable selection ζ∗superscript𝜁\\\\zeta^{\\*}, by the measurable maximum theorem, see 18.19 in \\[ [1](https://ar5iv.org/html/2402.11981#bib.bib1 \"\")\\]. Such a selection ζ∗superscript𝜁\\\\zeta^{\\*} then satisfies φ​(ξ,ζ∗​(ξ))=supζ∈Ξφ​(ξ,ζ)𝜑𝜉superscript𝜁𝜉subscriptsupremum𝜁Ξ𝜑𝜉𝜁\\\\varphi(\\\\xi,\\\\zeta^{\\*}(\\\\xi))=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\varphi(\\\\xi,\\\\zeta) for all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, hence the result.\n\n- •\n\n\nIn the proof of Theorem 3.1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\], gφ=supζ∈Ξφ​(⋅,ζ)superscript𝑔𝜑subscriptsupremum𝜁Ξ𝜑⋅𝜁g^{\\\\varphi}=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\varphi(\\\\cdot,\\\\zeta) is actually continuous by [LemmaA.2](https://ar5iv.org/html/2402.11981#A1.Thmlemma2 \"Lemma A.2 (17.31 in [1]). ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and the approximation by the infimal convolutions (gkφ)k∈ℕsubscriptsuperscriptsubscript𝑔𝑘𝜑𝑘ℕ(g\\_{k}^{\\\\varphi})\\_{k\\\\in\\\\mathbb{N}} need not be done.\n\n\nNote also that the convexity of ΞΞ\\\\Xi is not required in this proof (although stated in Assumption 1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\]).\n∎\n\n## Appendix C Concentration constants\n\nIn this part, we compute several constants in view of applying [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). ‣ A.1 Uniform concentration inequality ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for the main proofs of [AppendixE](https://ar5iv.org/html/2402.11981#A5 \"Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n### C.1 Standard WDRO\n\nThe following lemma gathers [Lemma4.1](https://ar5iv.org/html/2402.11981#S4.Thmlemma1 \"Lemma 4.1. ‣ 4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [Lemma4.3](https://ar5iv.org/html/2402.11981#S4.Thmlemma3 \"Lemma 4.3. ‣ Dual bound on the empirical risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). We compute bounds (i) and global Lipschitz constants (ii) for ϕitalic-ϕ\\\\phi and ψ𝜓\\\\psi.\n\n###### Lemma C.1(Concentration conditions for WDRO).\n\nwe have the following:\n\n1. 1.\n\n\n1. (i)\n\n\nFor all λ≥0𝜆0\\\\lambda\\\\geq 0, f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} and ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, ϕ​(λ,f,ξ)∈\\[−‖ℱ‖∞,‖ℱ‖∞\\].italic-ϕ𝜆𝑓𝜉subscriptnormℱsubscriptnormℱ\\\\phi(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\].\n\n2. (ii)\n\n\nFor all λ≥0𝜆0\\\\lambda\\\\geq 0 and ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, f↦ϕ​(λ,f,ξ)maps-to𝑓italic-ϕ𝜆𝑓𝜉f\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi) is Lipschitz continuous on ℱℱ\\\\mathcal{F} with constant 111.\n\n\n2. 2.\n\n\n1. (i)\n\n\nGiven λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0, for all μ∈(0,λlow−1\\]𝜇0superscriptsubscript𝜆low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\nψ​(μ,f,ξ)∈\\[−‖ℱ‖∞λlow,‖ℱ‖∞λlow\\]𝜓𝜇𝑓𝜉subscriptnormℱsubscript𝜆lowsubscriptnormℱsubscript𝜆low\\\\psi(\\\\mu,f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\].\n\n2. (ii)\n\n\nFor all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, (μ,f)↦ψ​(μ,f,ξ)maps-to𝜇𝑓𝜓𝜇𝑓𝜉(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) is Lipschitz continuous on (0,λlow−1\\]0superscriptsubscript𝜆low1(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] with constant ‖ℱ‖∞+λlow−1subscriptnormℱsuperscriptsubscript𝜆low1\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\n\n\n###### Proof.\n\n1\\. (i) Let (λ,f,ξ)∈ℝ+×ℱ×Ξ𝜆𝑓𝜉subscriptℝℱΞ(\\\\lambda,f,\\\\xi)\\\\in\\\\mathbb{R}\\_{+}\\\\times\\\\mathcal{F}\\\\times\\\\Xi. Recall that ϕ​(λ,f,ξ):=supζ∈Ξ{f​(ζ)−λ​c​(ξ,ζ)}assignitalic-ϕ𝜆𝑓𝜉subscriptsupremum𝜁Ξ𝑓𝜁𝜆𝑐𝜉𝜁\\\\phi(\\\\lambda,f,\\\\xi):=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\\\right\\\\}. Since c𝑐c is nonnegative, we have ϕ​(λ,f,ξ)≤‖ℱ‖∞italic-ϕ𝜆𝑓𝜉subscriptnormℱ\\\\phi(\\\\lambda,f,\\\\xi)\\\\leq\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}. On the other hand, since c​(ξ,ξ)=0𝑐𝜉𝜉0c(\\\\xi,\\\\xi)=0, we also have ϕ​(λ,f,ξ)≥f​(ξ)≥−‖ℱ‖∞italic-ϕ𝜆𝑓𝜉𝑓𝜉subscriptnormℱ\\\\phi(\\\\lambda,f,\\\\xi)\\\\geq f(\\\\xi)\\\\geq-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}. Finally, we have ϕ​(λ,f,ξ)∈\\[−‖ℱ‖∞,‖ℱ‖∞\\]italic-ϕ𝜆𝑓𝜉subscriptnormℱsubscriptnormℱ\\\\phi(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\].\n\n(ii) Let λ≥0𝜆0\\\\lambda\\\\geq 0, ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi and (f,f′)∈ℱ×ℱ𝑓superscript𝑓′ℱℱ(f,f^{\\\\prime})\\\\in\\\\mathcal{F}\\\\times\\\\mathcal{F}. For all ζ∈Ξ𝜁Ξ\\\\zeta\\\\in\\\\Xi, we have\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | f​(ζ)−λ​c​(ξ,ζ)−ϕ​(λ,f′,ξ)𝑓𝜁𝜆𝑐𝜉𝜁italic-ϕ𝜆superscript𝑓′𝜉\\\\displaystyle f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)-\\\\phi(\\\\lambda,f^{\\\\prime},\\\\xi) | ≤f​(ζ)−λ​c​(ξ,ζ)−(f′​(ζ)−λ​c​(ξ,ζ))absent𝑓𝜁𝜆𝑐𝜉𝜁superscript𝑓′𝜁𝜆𝑐𝜉𝜁\\\\displaystyle\\\\leq f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)-(f^{\\\\prime}(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)) |  |\n|  |  | ≤f​(ζ)−f′​(ζ)absent𝑓𝜁superscript𝑓′𝜁\\\\displaystyle\\\\leq f(\\\\zeta)-f^{\\\\prime}(\\\\zeta) |  |\n|  |  | ≤‖f−f′‖∞.absentsubscriptnorm𝑓superscript𝑓′\\\\displaystyle\\\\leq\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. |  |\n\nTaking the supremum over ζ∈Ξ𝜁Ξ\\\\zeta\\\\in\\\\Xi on the left-hand side gives ϕ​(λ,f,ξ)−ϕ​(λ,f′,ξ)≤‖f−f′‖∞italic-ϕ𝜆𝑓𝜉italic-ϕ𝜆superscript𝑓′𝜉subscriptnorm𝑓superscript𝑓′\\\\phi(\\\\lambda,f,\\\\xi)-\\\\phi(\\\\lambda,f^{\\\\prime},\\\\xi)\\\\leq\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. Permuting the roles of f𝑓f and f′superscript𝑓′f^{\\\\prime} yields \\|ϕ​(λ,f,ξ)−ϕ​(λ,f′,ξ)\\|≤‖f−f′‖∞italic-ϕ𝜆𝑓𝜉italic-ϕ𝜆superscript𝑓′𝜉subscriptnorm𝑓superscript𝑓′\\|\\\\phi(\\\\lambda,f,\\\\xi)-\\\\phi(\\\\lambda,f^{\\\\prime},\\\\xi)\\|\\\\leq\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. We proved that ϕ​(λ,⋅,ξ)italic-ϕ𝜆⋅𝜉\\\\phi(\\\\lambda,\\\\cdot,\\\\xi) is 111-Lipschitz continuous.\n\n2\\. (i) Now, let λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 and let (μ,f,ξ)∈(0,λlow−1\\]×ℱ×Ξ𝜇𝑓𝜉0superscriptsubscript𝜆low1ℱΞ(\\\\mu,f,\\\\xi)\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}\\\\times\\\\Xi be arbitrary. Then we have\n\n|     |     |     |\n| --- | --- | --- |\n|  | μ​ϕ​(μ−1,f,ξ)=supζ∈Ξ{μ​f​(ζ)−c​(ξ,ζ)}≤‖ℱ‖∞λlow.𝜇italic-ϕsuperscript𝜇1𝑓𝜉subscriptsupremum𝜁Ξ𝜇𝑓𝜁𝑐𝜉𝜁subscriptnormℱsubscript𝜆low\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)\\\\right\\\\}\\\\leq\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}. |  |\n\nOn the other hand, using c​(ξ,ξ)=0𝑐𝜉𝜉0c(\\\\xi,\\\\xi)=0 we obtain\n\n|     |     |     |\n| --- | --- | --- |\n|  | supζ∈Ξ{μ​f​(ζ)−c​(ξ,ζ)}≥μ​f​(ξ)≥−‖ℱ‖∞λlow,subscriptsupremum𝜁Ξ𝜇𝑓𝜁𝑐𝜉𝜁𝜇𝑓𝜉subscriptnormℱsubscript𝜆low\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)\\\\right\\\\}\\\\geq\\\\mu f(\\\\xi)\\\\geq-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}, |  |\n\nwhence we have μ​ϕ​(μ−1,f,ξ)∈\\[−‖ℱ‖∞λlow,‖ℱ‖∞λlow\\]𝜇italic-ϕsuperscript𝜇1𝑓𝜉subscriptnormℱsubscript𝜆lowsubscriptnormℱsubscript𝜆low\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\].\n\n(ii) Toward a proof of 2. (ii), let λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0, and ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi and μ∈(0,λlow\\]𝜇0subscript𝜆low\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}\\]. Remark that μ​ϕ​(μ−1,f,ξ)=supζ∈Ξ{μ​f​(ζ)−c​(ξ,ζ)}𝜇italic-ϕsuperscript𝜇1𝑓𝜉subscriptsupremum𝜁Ξ𝜇𝑓𝜁𝑐𝜉𝜁\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)\\\\right\\\\}. The function (μ,f)↦μ​ϕ​(μ−1,f,ξ)maps-to𝜇𝑓𝜇italic-ϕsuperscript𝜇1𝑓𝜉(\\\\mu,f)\\\\mapsto\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi) write as a composition u∘v𝑢𝑣u\\\\circ v where u​(h):=supζ∈Ξ{h​(ζ)−c​(ξ,ζ)}assign𝑢ℎsubscriptsupremum𝜁Ξℎ𝜁𝑐𝜉𝜁u(h):=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{h(\\\\zeta)-c(\\\\xi,\\\\zeta)\\\\right\\\\} for h∈C​(Ξ,ℝ)ℎ𝐶Ξℝh\\\\in C(\\\\Xi,\\\\mathbb{R}), and v​(μ,f):=μ​fassign𝑣𝜇𝑓𝜇𝑓v(\\\\mu,f):=\\\\mu f for μ∈(0,λlow−1\\]𝜇0superscriptsubscript𝜆low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]. u𝑢u is 1-Lipschitz continuous with respect to ∥⋅∥∞\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. As to v𝑣v, we can write\n\n|     |     |     |\n| --- | --- | --- |\n|  | μ​f−μ′​f′=μ​(f−f′)+f′​(μ−μ′),𝜇𝑓superscript𝜇′superscript𝑓′𝜇𝑓superscript𝑓′superscript𝑓′𝜇superscript𝜇′\\\\mu f-\\\\mu^{\\\\prime}f^{\\\\prime}=\\\\mu(f-f^{\\\\prime})+f^{\\\\prime}(\\\\mu-\\\\mu^{\\\\prime}), |  |\n\nwhence v𝑣v is clearly (‖ℱ‖∞+λlow−1)subscriptnormℱsuperscriptsubscript𝜆low1(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1})-Lipschitz continuous on (0,λlow−1\\]×ℱ0superscriptsubscript𝜆low1ℱ(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}. By composition, u∘v𝑢𝑣u\\\\circ v is Lipschitz continuous with constant ‖ℱ‖∞+λlow−1subscriptnormℱsuperscriptsubscript𝜆low1\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\n∎\n\n### C.2 Regularized WDRO\n\nWe will use the following lemma repeatedly:\n\n###### Lemma C.2(Lemma G.7 in \\[ [5](https://ar5iv.org/html/2402.11981\\#bib.bib5 \"\")\\]).\n\nLet g:Ξ→ℝ:𝑔→Ξℝg:\\\\Xi\\\\to\\\\mathbb{R} be a measurable bounded function and Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi). Then one has the inequality\n\n|     |     |     |\n| --- | --- | --- |\n|  | log⁡𝔼ζ∼Q​\\[eg​(ζ)\\]≤𝔼ζ∼Q​\\[g​(ζ)​eg​(ζ)\\]𝔼ζ∼Q​\\[eg​(ζ)\\].subscript𝔼similar-to𝜁𝑄delimited-\\[\\]superscript𝑒𝑔𝜁subscript𝔼similar-to𝜁𝑄delimited-\\[\\]𝑔𝜁superscript𝑒𝑔𝜁subscript𝔼similar-to𝜁𝑄delimited-\\[\\]superscript𝑒𝑔𝜁\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\\\left\\[e^{g(\\\\zeta)}\\\\right\\]\\\\leq\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[g(\\\\zeta)e^{g(\\\\zeta)}\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[e^{g(\\\\zeta)}\\]}. |  |\n\nWe prove the regularized version of [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). ‣ C.1 Standard WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\n\n###### Lemma C.3(Concentration conditions for regularized WDRO).\n\nLet ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi. Then\n\n1. 1.\n\n\n1. (i)\n\n\nFor all λ≥0𝜆0\\\\lambda\\\\geq 0 and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, ϕτ,ϵ​(λ,f,ξ)∈\\[−‖ℱ‖∞−λ​mc,‖ℱ‖∞\\].superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉subscriptnormℱ𝜆subscript𝑚𝑐subscriptnormℱ\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\in\\\\left\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\lambda m\\_{c},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\\\right\\].\n\n2. (ii)\n\n\nFor all λ≥0𝜆0\\\\lambda\\\\geq 0, f↦ϕτ,ϵ​(λ,f,ξ)maps-to𝑓superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉f\\\\mapsto\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi) is Lipschitz continuous with constant 111.\n\n\n2. 2.\n\n\n1. (i)\n\n\nGiven λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0, for all μ∈\\[λup−1,λlow−1\\]𝜇superscriptsubscript𝜆up1superscriptsubscript𝜆low1\\\\mu\\\\in\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, ψτ,ϵ​(μ,f,ξ)∈\\[−‖ℱ‖∞λlow−mc,‖ℱ‖∞λlow\\].superscript𝜓𝜏italic-ϵ𝜇𝑓𝜉subscriptnormℱsubscript𝜆lowsubscript𝑚𝑐subscriptnormℱsubscript𝜆low\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}-m\\_{c},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\].\n\n2. (ii)\n\n\nGiven λup>0subscript𝜆up0\\\\lambda\\_{\\\\operatorname{up}}>0, (μ,f)↦ψτ,ϵ​(μ,f,ξ)maps-to𝜇𝑓superscript𝜓𝜏italic-ϵ𝜇𝑓𝜉(\\\\mu,f)\\\\mapsto\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi) is Lipschitz continuous on \\[λup−1,λlow−1\\]×ℱsuperscriptsubscript𝜆up1superscriptsubscript𝜆low1ℱ\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F} with constant ‖ℱ‖∞+λlow−1+(λup​ϵϵ+λup​τ)​mcsubscriptnormℱsuperscriptsubscript𝜆low1subscript𝜆upitalic-ϵitalic-ϵsubscript𝜆up𝜏subscript𝑚𝑐\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}+\\\\left(\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}\\\\epsilon}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}\\\\right)m\\_{c}.\n\n\n###### Proof.\n\n1\\. (i) Let (λ,f,ξ)∈ℝ+×ℱ×Ξ𝜆𝑓𝜉subscriptℝℱΞ(\\\\lambda,f,\\\\xi)\\\\in\\\\mathbb{R}\\_{+}\\\\times\\\\mathcal{F}\\\\times\\\\Xi. For all ζ∈Ξ𝜁Ξ\\\\zeta\\\\in\\\\Xi, ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ≤e‖ℱ‖∞ϵ+λ​τsuperscript𝑒𝑓𝜁𝜆𝑐𝜉𝜁italic-ϵ𝜆𝜏superscript𝑒subscriptnormℱitalic-ϵ𝜆𝜏e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\leq e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon+\\\\lambda\\\\tau}}. This gives\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ϕτ,ϵ​(λ,f,ξ)≤(ϵ+λ​τ)​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[e‖ℱ‖∞ϵ+λ​τ\\]=‖ℱ‖∞.\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\leq(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]=\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}. |  | (21) |\n\nOn the other hand, ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ≥e−‖ℱ‖∞−λ​c​(ξ,ζ)ϵ+λ​τsuperscript𝑒𝑓𝜁𝜆𝑐𝜉𝜁italic-ϵ𝜆𝜏superscript𝑒subscriptnormℱ𝜆𝑐𝜉𝜁italic-ϵ𝜆𝜏e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\geq e^{\\\\frac{-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}, which gives\n\n|     |     |     |     |     |\n| --- | --- | --- | --- | --- |\n|  | ϕτ,ϵ​(λ,f,ξ)superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\displaystyle\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi) | ≥(ϵ+λ​τ)​log⁡(e−‖ℱ‖∞ϵ+λ​τ​𝔼ζ∼π0(⋅\\|ξ)​\\[e−λ​c​(ξ,ζ)ϵ+λ​τ\\])\\\\displaystyle\\\\geq(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\left(e^{-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{-\\\\frac{\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\\\\right) |  |\n|  |  | ≥−‖ℱ‖∞+(ϵ+λ​τ)​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[e−λ​c​(ξ,ζ)ϵ+λ​τ\\]\\\\displaystyle\\\\geq-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{-\\\\frac{\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\] |  |\n|  |  | ≥−‖ℱ‖∞−λ​mc,absentsubscriptnormℱ𝜆subscript𝑚𝑐\\\\displaystyle\\\\geq-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\lambda m\\_{c}, |  | (22) |\n\nwhere for the last inequality we used Jensen’s inequality on the convex function s↦e−λ​sϵ+λ​τmaps-to𝑠superscript𝑒𝜆𝑠italic-ϵ𝜆𝜏s\\\\mapsto e^{-\\\\frac{\\\\lambda s}{\\\\epsilon+\\\\lambda\\\\tau}}.\n\nCombining ( [21](https://ar5iv.org/html/2402.11981#A3.E21 \"Equation 21 ‣ Proof. ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [C.2](https://ar5iv.org/html/2402.11981#A3.Ex57 \"Proof. ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives\n\n|     |     |     |\n| --- | --- | --- |\n|  | ϕτ,ϵ​(λ,f,ξ)∈\\[−‖ℱ‖∞−λ​mc,‖ℱ‖∞\\].superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉subscriptnormℱ𝜆subscript𝑚𝑐subscriptnormℱ\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\lambda m\\_{c},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\]. |  |\n\n(ii) Let ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi and λ≥0𝜆0\\\\lambda\\\\geq 0. To compute the Lipschitz constant of f↦ϕτ,ϵ​(λ,f,ξ)maps-to𝑓superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉f\\\\mapsto\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi), we compute the derivative of hv:t↦ϕτ,ϵ​(λ,f+t​v,ξ):subscriptℎ𝑣maps-to𝑡superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝑡𝑣𝜉h\\_{v}:t\\\\mapsto\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f+tv,\\\\xi) where t∈ℝ𝑡ℝt\\\\in\\\\mathbb{R} and for an arbitrary direction v∈ℱ𝑣ℱv\\\\in\\\\mathcal{F}. We have\n\n|     |     |     |\n| --- | --- | --- |\n|  | hv​(t)=(ϵ+λ​τ)​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)+t​v​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\].h\\_{v}(t)=(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)+tv(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]. |  |\n\nIt is easy to verify that hv′​(t)=𝔼ζ∼π0f+t​v−λ​c​(ξ,⋅)ϵ+λ​τ(⋅\\|ξ)​\\[v​(ζ)\\],h\\_{v}^{\\\\prime}(t)=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f+tv-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[v(\\\\zeta)\\\\right\\], whence \\|hv′​(t)\\|≤‖v‖∞subscriptsuperscriptℎ′𝑣𝑡subscriptnorm𝑣\\|h^{\\\\prime}\\_{v}(t)\\|\\\\leq\\\\\\|v\\\\\\|\\_{\\\\infty}. This means that ϕτ,ϵ​(λ,⋅,ξ)superscriptitalic-ϕ𝜏italic-ϵ𝜆⋅𝜉\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,\\\\cdot,\\\\xi) has Lipschitz constant 111.\n\n2\\. (i) Let λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 and (μ,f,ξ)∈(0,λlow−1\\]×ℱ×Ξ𝜇𝑓𝜉0superscriptsubscript𝜆low1ℱΞ(\\\\mu,f,\\\\xi)\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}\\\\times\\\\Xi. λ𝜆\\\\lambda. We deduce from ( [21](https://ar5iv.org/html/2402.11981#A3.E21 \"Equation 21 ‣ Proof. ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [C.2](https://ar5iv.org/html/2402.11981#A3.Ex57 \"Proof. ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), with λ=μ−1𝜆superscript𝜇1\\\\lambda=\\\\mu^{-1}, that\n\n|     |     |     |\n| --- | --- | --- |\n|  | μ​ϕτ,ϵ​(μ−1,f,ξ)∈\\[−‖ℱ‖∞λlow−mc,‖ℱ‖∞λlow\\].𝜇superscriptitalic-ϕ𝜏italic-ϵsuperscript𝜇1𝑓𝜉subscriptnormℱsubscript𝜆lowsubscript𝑚𝑐subscriptnormℱsubscript𝜆low\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}-m\\_{c},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\]. |  |\n\n(ii) Now, let ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi. Our goal is to compute a Lipschitz constant of (μ,f)↦μ​ϕτ,ϵ​(μ−1,f,ξ)maps-to𝜇𝑓𝜇superscriptitalic-ϕ𝜏italic-ϵsuperscript𝜇1𝑓𝜉(\\\\mu,f)\\\\mapsto\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},f,\\\\xi) on \\[λup−1,λlow−1\\]×ℱsuperscriptsubscript𝜆up1superscriptsubscript𝜆low1ℱ\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}. We first compute a Lipschitz constant of\n\n|     |     |     |\n| --- | --- | --- |\n|  | hf:μ↦μ​ϕτ,ϵ​(μ−1,f,ξ)=(μ​ϵ+τ)​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[eμ​f​(ζ)−c​(ξ,ζ)μ​ϵ+τ\\]h\\_{f}:\\\\mu\\\\mapsto\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},f,\\\\xi)=(\\\\mu\\\\epsilon+\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\] |  |\n\non \\[λup−1,λlow−1\\]superscriptsubscript𝜆up1superscriptsubscript𝜆low1\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\], for an arbitrary f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}. The derivative of hfsubscriptℎ𝑓h\\_{f} is\n\n|     |     |     |\n| --- | --- | --- |\n|  | hf′​(μ)=1μ​ϵ+τ​𝔼ζ∼π0(⋅\\|ξ)​\\[(ϵ​c​(ξ,ζ)+τ​f​(ζ))​eμ​f​(ζ)−c​(ξ,ζ)μ​ϵ+τ\\]𝔼ζ∼π0(⋅\\|ξ)​\\[eμ​f​(ζ)−c​(ξ,ζ)μ​ϵ+τ\\]+ϵ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[eμ​f​(ζ)−c​(ξ,ζ)μ​ϵ+τ\\],h\\_{f}^{\\\\prime}(\\\\mu)=\\\\frac{1}{\\\\mu\\\\epsilon+\\\\tau}\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[(\\\\epsilon c(\\\\xi,\\\\zeta)+\\\\tau f(\\\\zeta))e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]}+\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\], |  |\n\nwhich we write\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | hf′​(μ)=𝔼π0μ​f−c​(ξ,⋅)μ​ϵ+τ(⋅\\|ξ)​\\[ϵ​c​(ξ,ζ)+τ​f​(ζ)μ​ϵ+τ\\]+ϵ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[eμ​f​(ζ)−c​(ξ,ζ)μ​ϵ+τ\\].h\\_{f}^{\\\\prime}(\\\\mu)=\\\\mathbb{E}\\_{\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\epsilon c(\\\\xi,\\\\zeta)+\\\\tau f(\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}\\\\right\\]+\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]. |  | (23) |\n\nWe bound hf′​(μ)subscriptsuperscriptℎ′𝑓𝜇h^{\\\\prime}\\_{f}(\\\\mu) above. By [LemmaC.2](https://ar5iv.org/html/2402.11981#A3.Thmlemma2 \"Lemma C.2 (Lemma G.7 in [5]). ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") with Q=π0(⋅\\|ξ)Q=\\\\pi\\_{0}(\\\\cdot\\|\\\\xi) and g=μ​f−c​(ξ,⋅)μ​ϵ+τ𝑔𝜇𝑓𝑐𝜉⋅𝜇italic-ϵ𝜏g=\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}, we have that\n\n|     |     |     |\n| --- | --- | --- |\n|  | ϵ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[eμ​f​(ζ)−c​(ξ,ζ)μ​ϵ+τ\\]≤𝔼ζ∼π0μ​f−c​(ξ,⋅)μ​ϵ+τ(⋅\\|ξ)​\\[ϵ​μ​f​(ζ)−ϵ​c​(ξ,ζ)μ​ϵ+τ\\]\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]\\\\leq\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\epsilon\\\\mu f(\\\\zeta)-\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}\\\\right\\] |  |\n\nwhich gives hf′​(μ)≤𝔼ζ∼π0μ​f−c​(ξ,⋅)μ​ϵ+τ​\\[f​(ζ)\\]≤‖ℱ‖∞superscriptsubscriptℎ𝑓′𝜇subscript𝔼similar-to𝜁superscriptsubscript𝜋0𝜇𝑓𝑐𝜉⋅𝜇italic-ϵ𝜏delimited-\\[\\]𝑓𝜁subscriptnormℱh\\_{f}^{\\\\prime}(\\\\mu)\\\\leq\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}}}\\[f(\\\\zeta)\\]\\\\leq\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}.\n\nNow we bound hf′​(μ)superscriptsubscriptℎ𝑓′𝜇h\\_{f}^{\\\\prime}(\\\\mu) below. We start with the first term in ( [23](https://ar5iv.org/html/2402.11981#A3.E23 \"Equation 23 ‣ Proof. ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Since c𝑐c is nonnegative, we clearly have\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | 𝔼π0μ​f−c​(ξ,⋅)μ​ϵ+τ(⋅\\|ξ)​\\[ϵ​c​(ξ,ζ)+τ​f​(ζ)μ​ϵ+τ\\]≥−τ​‖ℱ‖∞μ​ϵ+τ\\\\mathbb{E}\\_{\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\epsilon c(\\\\xi,\\\\zeta)+\\\\tau f(\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}\\\\right\\]\\\\geq\\\\frac{-\\\\tau\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\mu\\\\epsilon+\\\\tau} |  | (24) |\n\nAs to the second term of ( [23](https://ar5iv.org/html/2402.11981#A3.E23 \"Equation 23 ‣ Proof. ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we have by Jensen’s inequality,\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ϵ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[eμ​f​(ζ)−c​(ξ,ζ)μ​ϵ+τ\\]≥−ϵ​μ​‖ℱ‖∞μ​ϵ+τ−ϵ​mcμ​ϵ+τ\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]\\\\geq-\\\\frac{\\\\epsilon\\\\mu\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\mu\\\\epsilon+\\\\tau}-\\\\frac{\\\\epsilon m\\_{c}}{\\\\mu\\\\epsilon+\\\\tau} |  | (25) |\n\nCombining ( [24](https://ar5iv.org/html/2402.11981#A3.E24 \"Equation 24 ‣ Proof. ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [25](https://ar5iv.org/html/2402.11981#A3.E25 \"Equation 25 ‣ Proof. ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives hf′​(μ)≥−‖ℱ‖∞−λup​ϵ​mcϵ+λup​τsubscriptsuperscriptℎ′𝑓𝜇subscriptnormℱsubscript𝜆upitalic-ϵsubscript𝑚𝑐italic-ϵsubscript𝜆up𝜏h^{\\\\prime}\\_{f}(\\\\mu)\\\\geq-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}\\\\epsilon m\\_{c}}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}. Finally, hfsubscriptℎ𝑓h\\_{f} has Lipschitz constant ‖ℱ‖∞+λup​mcϵ+λup​τsubscriptnormℱsubscript𝜆upsubscript𝑚𝑐italic-ϵsubscript𝜆up𝜏\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}m\\_{c}}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}\n\nSince ϕτ,ϵ​(μ−1,⋅,ξ)superscriptitalic-ϕ𝜏italic-ϵsuperscript𝜇1⋅𝜉\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},\\\\cdot,\\\\xi) has Lipschitz constant 111, then μ≤λlow−1𝜇superscriptsubscript𝜆low1\\\\mu\\\\leq\\\\lambda\\_{\\\\operatorname{low}}^{-1}, the function μ​ϕτ,ϵ​(μ−1,⋅,ξ)𝜇superscriptitalic-ϕ𝜏italic-ϵsuperscript𝜇1⋅𝜉\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},\\\\cdot,\\\\xi) has Lipschitz constant λlow−1superscriptsubscript𝜆low1\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\n\nNow, we can obtain a Lipschitz constant for\n\n|     |     |     |\n| --- | --- | --- |\n|  | h:(μ,f)↦(μ​ϵ+τ)​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[eμ​f​(ζ)−c​(ξ,ζ)μ​ϵ+τ\\]=ψτ,ϵ​(μ,f,ξ).h:(\\\\mu,f)\\\\mapsto(\\\\mu\\\\epsilon+\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]=\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi). |  |\n\nIndeed, for (μ,μ′)∈\\[λup−1,λlow−1\\]×\\[λup−1,λlow−1\\]𝜇superscript𝜇′superscriptsubscript𝜆up1superscriptsubscript𝜆low1superscriptsubscript𝜆up1superscriptsubscript𝜆low1(\\\\mu,\\\\mu^{\\\\prime})\\\\in\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and (f,f′)∈ℱ×ℱ𝑓superscript𝑓′ℱℱ(f,f^{\\\\prime})\\\\in\\\\mathcal{F}\\\\times\\\\mathcal{F}, we can write\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | \\|h​(μ,f)−h​(μ′,f′)\\|ℎ𝜇𝑓ℎsuperscript𝜇′superscript𝑓′\\\\displaystyle\\|h(\\\\mu,f)-h(\\\\mu^{\\\\prime},f^{\\\\prime})\\| | ≤\\|h​(μ,f)−h​(μ′,f)\\|+\\|h​(μ′,f)−h​(μ′,f′)\\|absentℎ𝜇𝑓ℎsuperscript𝜇′𝑓ℎsuperscript𝜇′𝑓ℎsuperscript𝜇′superscript𝑓′\\\\displaystyle\\\\leq\\|h(\\\\mu,f)-h(\\\\mu^{\\\\prime},f)\\|+\\|h(\\\\mu^{\\\\prime},f)-h(\\\\mu^{\\\\prime},f^{\\\\prime})\\| |  |\n|  |  | ≤(‖ℱ‖∞+(λup​ϵϵ+λup​τ))​\\|μ−μ′\\|+λlow−1​‖f−f′‖∞.absentsubscriptnormℱsubscript𝜆upitalic-ϵitalic-ϵsubscript𝜆up𝜏𝜇superscript𝜇′superscriptsubscript𝜆low1subscriptnorm𝑓superscript𝑓′\\\\displaystyle\\\\leq\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\left(\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}\\\\epsilon}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}\\\\right)\\\\right)\\|\\\\mu-\\\\mu^{\\\\prime}\\|+\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. |  |\n\nhence hℎh has Lipschitz constant ‖ℱ‖∞+λlow−1+(λup​ϵϵ+λup​τ)​mcsubscriptnormℱsuperscriptsubscript𝜆low1subscript𝜆upitalic-ϵitalic-ϵsubscript𝜆up𝜏subscript𝑚𝑐\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}+\\\\left(\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}\\\\epsilon}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}\\\\right)m\\_{c}.\n∎\n\n## Appendix D Dual bounds and maximal radius\n\nWe establish the existence of a dual lower bound on the true robust risk, for the standard WDRO problem in [D.1](https://ar5iv.org/html/2402.11981#A4.SS1 \"D.1 Standard WDRO: continuity at zero of the maximal radius ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and for regularized WDRO in [D.2](https://ar5iv.org/html/2402.11981#A4.SS2 \"D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The proofs involve the maximal radius introduced in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). For the regularized case, an estimate of the dual lower bound is provided.\n\n### D.1 Standard WDRO: continuity at zero of the maximal radius\n\nFor λ≥0𝜆0\\\\lambda\\\\geq 0, we consider the following quantities:\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρcrit=inff∈ℱ𝔼ξ∼P​\\[−∂λ+ϕ​(0,f,ξ)\\]ρmax​(λ)=inff∈ℱ𝔼ξ∼P​\\[−∂λ+ϕ​(λ,f,ξ)\\].formulae-sequencesubscript𝜌critsubscriptinfimum𝑓ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscriptsubscript𝜆italic-ϕ0𝑓𝜉subscript𝜌𝜆subscriptinfimum𝑓ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscriptsubscript𝜆italic-ϕ𝜆𝑓𝜉\\\\rho\\_{\\\\operatorname{crit}}=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(0,f,\\\\xi)\\]\\\\qquad\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]. |  |\n\n###### Lemma D.1.\n\nlimλ→0+ρmax​(λ)=ρcrit.subscript→𝜆superscript0subscript𝜌𝜆subscript𝜌crit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}.\n\n###### Proof.\n\nFor ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, f−λ​c​(ξ,⋅)𝑓𝜆𝑐𝜉⋅f-\\\\lambda c(\\\\xi,\\\\cdot) is continuous, hence we can apply the envelope formula ( [TheoremA.1](https://ar5iv.org/html/2402.11981#A1.Thmtheorem1 \"Theorem A.1 (Envelope formula, Corollary 1, Chapter 2.8 in [14]). ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and the right-sided derivative of ϕitalic-ϕ\\\\phi with respect to λ𝜆\\\\lambda is ∂λ+ϕ​(λ,f,ξ)=−min⁡{c​(ξ,ζ):ζ∈arg​maxΞ⁡{f−λ​c​(ξ,⋅)}}subscriptsuperscript𝜆italic-ϕ𝜆𝑓𝜉:𝑐𝜉𝜁𝜁subscriptargmaxΞ𝑓𝜆𝑐𝜉⋅\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)=-\\\\min\\\\left\\\\{c(\\\\xi,\\\\zeta)\\ :\\ \\\\zeta\\\\in\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\}\\\\right\\\\}. For convenience, we use the shorthand\n\n|     |     |     |\n| --- | --- | --- |\n|  | c∗​(ξ,K):=min⁡{c​(ξ,z),z∈K}assignsuperscript𝑐𝜉𝐾𝑐𝜉𝑧𝑧𝐾c^{\\*}(\\\\xi,K):=\\\\min\\\\{c(\\\\xi,z),z\\\\in K\\\\} |  |\n\nwhenever K⊂Ξ𝐾ΞK\\\\subset\\\\Xi is compact. By integration, we obtain\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ρmax​(λ)=𝔼ξ∼P​\\[c∗​(ξ,arg​maxΞ⁡{f−λ​c​(ξ,⋅)})\\].subscript𝜌𝜆subscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscript𝑐𝜉subscriptargmaxΞ𝑓𝜆𝑐𝜉⋅\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\})\\]. |  | (26) |\n\nIn particular,\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρcrit=inff∈ℱ​𝔼ξ∼P​\\[c∗​(ξ,arg​maxΞ⁡f)\\].subscript𝜌crit𝑓ℱinfimumsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscript𝑐𝜉subscriptargmaxΞ𝑓\\\\rho\\_{\\\\operatorname{crit}}=\\\\underset{f\\\\in\\\\mathcal{F}}{\\\\inf}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f)\\]. |  |\n\nTo prove the result, it is sufficient to show that lim infk→∞ρmax​(λk)≥ρcritsubscriptlimit-infimum→𝑘subscript𝜌subscript𝜆𝑘subscript𝜌crit\\\\liminf\\_{k\\\\to\\\\infty}\\\\rho\\_{\\\\max}(\\\\lambda\\_{k})\\\\geq\\\\rho\\_{\\\\operatorname{crit}} for any positive sequence (λk)k∈ℕsubscriptsubscript𝜆𝑘𝑘ℕ(\\\\lambda\\_{k})\\_{k\\\\in\\\\mathbb{N}} converging to 00. Indeed, the functions 𝔼ξ∼P​\\[ϕ​(⋅,f,ξ)\\]subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ⋅𝑓𝜉\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\cdot,f,\\\\xi)\\] are convex hence their right-sided derivatives 𝔼ξ∼P​\\[−∂λ+ϕ​(⋅,f,ξ)\\]subscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscriptsuperscript𝜆italic-ϕ⋅𝑓𝜉\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\cdot,f,\\\\xi)\\] are nonincreasing, and ρmaxsubscript𝜌\\\\rho\\_{\\\\max} is nonincreasing since it is an infimum over nonincreasing functions. This means lim supk→∞ρmax​(λk)≤ρmax​(0)subscriptlimit-supremum→𝑘subscript𝜌subscript𝜆𝑘subscript𝜌0\\\\limsup\\_{k\\\\to\\\\infty}\\\\rho\\_{\\\\max}(\\\\lambda\\_{k})\\\\leq\\\\rho\\_{\\\\max}(0) for any sequence λk→0→subscript𝜆𝑘0\\\\lambda\\_{k}\\\\to 0.\n\nNow assume toward a contradiction that there exists ϵ>0italic-ϵ0\\\\epsilon>0 and a sequence (λk)k∈ℕsubscriptsubscript𝜆𝑘𝑘ℕ(\\\\lambda\\_{k})\\_{k\\\\in\\\\mathbb{N}} from ℝ+subscriptℝ\\\\mathbb{R}\\_{+}, such that λk→0→subscript𝜆𝑘0\\\\lambda\\_{k}\\\\to 0 as k→∞→𝑘k\\\\to\\\\infty, and ρmax​(λk)≤ρcrit−ϵsubscript𝜌subscript𝜆𝑘subscript𝜌crititalic-ϵ\\\\rho\\_{\\\\max}(\\\\lambda\\_{k})\\\\leq\\\\rho\\_{\\\\operatorname{crit}}-\\\\epsilon for all k∈ℕ𝑘ℕk\\\\in\\\\mathbb{N}. From the expression of ρmaxsubscript𝜌\\\\rho\\_{\\\\max} ( [26](https://ar5iv.org/html/2402.11981#A4.E26 \"Equation 26 ‣ Proof. ‣ D.1 Standard WDRO: continuity at zero of the maximal radius ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) this means that for each k𝑘k, there exists fksubscript𝑓𝑘f\\_{k} such that\n𝔼ξ∼P​\\[c∗​(ξ,arg​maxΞ⁡fk−λk​c​(ξ,⋅))\\]≤ρcrit−ϵ2subscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscript𝑐𝜉subscriptargmaxΞsubscript𝑓𝑘subscript𝜆𝑘𝑐𝜉⋅subscript𝜌crititalic-ϵ2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\_{k}-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot))\\]\\\\leq\\\\rho\\_{\\\\operatorname{crit}}-\\\\frac{\\\\epsilon}{2}. By compactness of ℱℱ\\\\mathcal{F} with respect to ∥⋅∥∞\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}, we may assume (fk)k∈ℕsubscriptsubscript𝑓𝑘𝑘ℕ(f\\_{k})\\_{k\\\\in\\\\mathbb{N}} to converge to some f∗∈ℱsuperscript𝑓ℱf^{\\*}\\\\in\\\\mathcal{F}. In particular, for ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, fk,−λk​c​(ξ,⋅)subscript𝑓𝑘subscript𝜆𝑘𝑐𝜉⋅f\\_{k},-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot) converges to f∗superscript𝑓f^{\\*} as k→∞→𝑘k\\\\to\\\\infty.\n\nLet ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi be arbitrary. (λ,f)↦arg​maxΞ⁡{f−λ​c​(ξ,⋅)}maps-to𝜆𝑓subscriptargmaxΞ𝑓𝜆𝑐𝜉⋅(\\\\lambda,f)\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\} is outer semicontinuous with compact values ( [LemmaA.2](https://ar5iv.org/html/2402.11981#A1.Thmlemma2 \"Lemma A.2 (17.31 in [1]). ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and c𝑐c is jointly continuous, hence (λ,f)↦c∗(ξ,arg​maxΞ{f−λc(ξ,⋅))}(\\\\lambda,f)\\\\mapsto c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot))\\\\right\\\\} is lower semicontinuous, see [LemmaA.1](https://ar5iv.org/html/2402.11981#A1.Thmlemma1 \"Lemma A.1 (17.30 in [1]). ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). We then have lim infk→∞c∗​(ξ,arg​maxΞ⁡{fk−λk​c​(ξ,⋅)})≥c∗​(ξ,arg​maxΞ⁡f∗)subscriptlimit-infimum→𝑘superscript𝑐𝜉subscriptargmaxΞsubscript𝑓𝑘subscript𝜆𝑘𝑐𝜉⋅superscript𝑐𝜉subscriptargmaxΞsuperscript𝑓\\\\liminf\\_{k\\\\to\\\\infty}c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f\\_{k}-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot)\\\\right\\\\})\\\\geq c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f^{\\*}). By integration with respect to ξ∼Psimilar-to𝜉𝑃\\\\xi\\\\sim P, we obtain\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | 𝔼ξ∼P​\\[c∗​(ξ,arg​maxΞ⁡f∗)\\]subscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscript𝑐𝜉subscriptargmaxΞsuperscript𝑓\\\\displaystyle\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f^{\\*})\\] | ≤𝔼ξ∼P​\\[lim infk→∞c∗​(ξ,arg​maxΞ⁡{fk−λk​c​(ξ,⋅)})\\]absentsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscriptlimit-infimum→𝑘superscript𝑐𝜉subscriptargmaxΞsubscript𝑓𝑘subscript𝜆𝑘𝑐𝜉⋅\\\\displaystyle\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\liminf\\_{k\\\\to\\\\infty}c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f\\_{k}-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot)\\\\right\\\\})\\] |  |\n|  |  | ≤lim infk→∞𝔼ξ∼P​\\[c∗​(ξ,arg​maxΞ⁡{fk−λk​c​(ξ,⋅)})\\]absentsubscriptlimit-infimum→𝑘subscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscript𝑐𝜉subscriptargmaxΞsubscript𝑓𝑘subscript𝜆𝑘𝑐𝜉⋅\\\\displaystyle\\\\leq\\\\liminf\\_{k\\\\to\\\\infty}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f\\_{k}-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot)\\\\right\\\\})\\] |  |\n|  |  | ≤ρcrit−ϵ2.absentsubscript𝜌crititalic-ϵ2\\\\displaystyle\\\\leq\\\\rho\\_{\\\\operatorname{crit}}-\\\\frac{\\\\epsilon}{2}. |  |\n\nSince, ρcrit≤𝔼ξ∼P​\\[c∗​(ξ,arg​maxΞ⁡f∗)\\]subscript𝜌critsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscript𝑐𝜉subscriptargmaxΞsuperscript𝑓\\\\rho\\_{\\\\operatorname{crit}}\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f^{\\*})\\], this yields a contradiction. Finally, limλ→0+ρmax​(λ)=ρcritsubscript→𝜆superscript0subscript𝜌𝜆subscript𝜌crit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}.\n∎\n\n### D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound\n\nFor λ≥0𝜆0\\\\lambda\\\\geq 0, we consider the regularized counterparts\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρcritτ,ϵ=inff∈ℱ𝔼ξ∼P​\\[−∂λϕτ,ϵ​(0,f,ξ)\\],superscriptsubscript𝜌crit𝜏italic-ϵsubscriptinfimum𝑓ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscript𝜆superscriptitalic-ϕ𝜏italic-ϵ0𝑓𝜉\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(0,f,\\\\xi)\\], |  |\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρmaxτ,ϵ​(λ)=inff∈ℱ𝔼ξ∼P​\\[−∂λϕτ,ϵ​(λ,f,ξ)\\].superscriptsubscript𝜌𝜏italic-ϵ𝜆subscriptinfimum𝑓ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscript𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]. |  |\n\n#### D.2.1 Lipschitz continuity of the maximal radius\n\n###### Lemma D.2.\n\nρmaxτ,ϵ:\\[0,∞)→ℝ:superscriptsubscript𝜌𝜏italic-ϵ→0ℝ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}:\\[0,\\\\infty)\\\\to\\\\mathbb{R} is Lipschitz continuous with constant\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | 2ϵ​(τ2ϵ2​‖ℱ‖∞2+m2,c​e‖ℱ‖∞ϵ+min⁡{mcτ,2​‖ℱ‖∞​mc(ρ−mc)​ϵ}).2italic-ϵsuperscript𝜏2superscriptitalic-ϵ2superscriptsubscriptnormℱ2subscript𝑚2𝑐superscript𝑒subscriptnormℱitalic-ϵsubscript𝑚𝑐𝜏2subscriptnormℱsubscript𝑚𝑐𝜌subscript𝑚𝑐italic-ϵ\\\\frac{2}{\\\\epsilon}\\\\left(\\\\frac{\\\\tau^{2}}{\\\\epsilon^{2}}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}^{2}+m\\_{2,c}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}+\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}}\\\\right). |  |\\\n\\\nIn particular, if\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | λlowτ,ϵ:=ϵ​ρcritτ,ϵ8​(τ2ϵ2​‖ℱ‖∞2+m2,c​e‖ℱ‖∞ϵ+min⁡{mcτ,2​‖ℱ‖∞​mc(ρ−mc)​ϵ}),assignsuperscriptsubscript𝜆low𝜏italic-ϵitalic-ϵsuperscriptsubscript𝜌crit𝜏italic-ϵ8superscript𝜏2superscriptitalic-ϵ2superscriptsubscriptnormℱ2subscript𝑚2𝑐superscript𝑒subscriptnormℱitalic-ϵsubscript𝑚𝑐𝜏2subscriptnormℱsubscript𝑚𝑐𝜌subscript𝑚𝑐italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}:=\\\\frac{\\\\epsilon\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{8\\\\left(\\\\frac{\\\\tau^{2}}{\\\\epsilon^{2}}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}^{2}+m\\_{2,c}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}+\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}}\\\\right)}, |  | (27) |\\\n\\\nthen ρmax​(λ)≥ρcrit2subscript𝜌𝜆subscript𝜌crit2\\\\rho\\_{\\\\max}(\\\\lambda)\\\\geq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2} for all λ∈\\[0,2​λlowτ,ϵ\\]𝜆02superscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}\\].\\\n\\\n###### Proof.\\\n\\\nϕτ,ϵsuperscriptitalic-ϕ𝜏italic-ϵ\\\\phi^{\\\\tau,\\\\epsilon} is differentiable with respect to λ𝜆\\\\lambda and we can verify that its derivative is given by\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∂λϕτ,ϵ​(λ,f,ξ)=−𝔼ζ∼π0f−λ​c​(ξ,⋅)ϵ+λ​τ(⋅\\|ξ)​\\[τ​f​(ζ)+ϵ​c​(ξ,ζ)ϵ+λ​τ\\]+τ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\].\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=-\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right\\]+\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]. |  |\\\n\\\nFor f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} and ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, our goal is to compute the Lipschitz constant of λ↦∂λϕτ,ϵ​(λ,f,ξ)maps-to𝜆subscript𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\lambda\\\\mapsto\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi). The Lipschitz constant of ρmaxτ,ϵsuperscriptsubscript𝜌𝜏italic-ϵ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon} will then be obtained by integration and taking the infimum over Lipschitz functions. We compute the appropriate quantities:\\\n\\\n1\\. We compute the derivative with respect to λ𝜆\\\\lambda of u1:(λ,ζ)↦−(τ​f​(ζ)+ϵ​c​(ξ,ζ)ϵ+λ​τ)​ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ:subscript𝑢1maps-to𝜆𝜁𝜏𝑓𝜁italic-ϵ𝑐𝜉𝜁italic-ϵ𝜆𝜏superscript𝑒𝑓𝜁𝜆𝑐𝜉𝜁italic-ϵ𝜆𝜏u\\_{1}:(\\\\lambda,\\\\zeta)\\\\mapsto-\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}. This is\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∂λu1​(λ,ζ)=(τ2​f​(ζ)+ϵ​τ​c​(ξ,ζ)(ϵ+λ​τ)2+(τ​f​(ζ)+ϵ​c​(ξ,ζ))2(ϵ+λ​τ)3)​ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ.subscript𝜆subscript𝑢1𝜆𝜁superscript𝜏2𝑓𝜁italic-ϵ𝜏𝑐𝜉𝜁superscriptitalic-ϵ𝜆𝜏2superscript𝜏𝑓𝜁italic-ϵ𝑐𝜉𝜁2superscriptitalic-ϵ𝜆𝜏3superscript𝑒𝑓𝜁𝜆𝑐𝜉𝜁italic-ϵ𝜆𝜏\\\\partial\\_{\\\\lambda}u\\_{1}(\\\\lambda,\\\\zeta)=\\\\left(\\\\frac{\\\\tau^{2}f(\\\\zeta)+\\\\epsilon\\\\tau c(\\\\xi,\\\\zeta)}{(\\\\epsilon+\\\\lambda\\\\tau)^{2}}+\\\\frac{(\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta))^{2}}{(\\\\epsilon+\\\\lambda\\\\tau)^{3}}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}. |  |\\\n\\\n2\\. We compute the derivative with respect to λ𝜆\\\\lambda of u2:(λ,ζ)↦ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ:subscript𝑢2maps-to𝜆𝜁superscript𝑒𝑓𝜁𝜆𝑐𝜉𝜁italic-ϵ𝜆𝜏u\\_{2}:(\\\\lambda,\\\\zeta)\\\\mapsto e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}, this is\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∂λu2​(λ,ζ)=−(τ​f​(ζ)+ϵ​c​(ξ,ζ)(ϵ+λ​τ)2)​ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ.subscript𝜆subscript𝑢2𝜆𝜁𝜏𝑓𝜁italic-ϵ𝑐𝜉𝜁superscriptitalic-ϵ𝜆𝜏2superscript𝑒𝑓𝜁𝜆𝑐𝜉𝜁italic-ϵ𝜆𝜏\\\\partial\\_{\\\\lambda}u\\_{2}(\\\\lambda,\\\\zeta)=-\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{(\\\\epsilon+\\\\lambda\\\\tau)^{2}}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}. |  |\\\n\\\n3\\. We compute the derivative of U3:λ↦τ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]U\\_{3}:\\\\lambda\\\\mapsto\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]. This is\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | U3′​(λ)=−𝔼ζ∼π0(⋅\\|ξ)​\\[(τ2​f​(ζ)+τ​ϵ​c​(ξ,ζ)(ϵ+λ​τ)2)​ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ2\\]𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\].U\\_{3}^{\\\\prime}(\\\\lambda)=-\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\left(\\\\frac{\\\\tau^{2}f(\\\\zeta)+\\\\tau\\\\epsilon c(\\\\xi,\\\\zeta)}{(\\\\epsilon+\\\\lambda\\\\tau)^{2}}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau^{2}}}\\\\right\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]}. |  |\\\n\\\nCombining 1, 2 and 3, we are able to compute the derivative of ∂λϕτ,ϵsubscript𝜆superscriptitalic-ϕ𝜏italic-ϵ\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}:\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | ∂λ2ϕτ,ϵ​(λ,f,ξ)subscriptsuperscript2𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\displaystyle\\\\partial^{2}\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi) | =−𝔼ζ∼π0(⋅\\|ξ)​\\[u1​(λ,ζ)\\]​𝔼ζ∼π0(⋅\\|ξ)​\\[∂λu2​(λ,ζ)\\]𝔼ζ∼π0(⋅\\|ξ)​\\[u2​(λ,ζ)\\]2+U3′​(λ)\\\\displaystyle=-\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[u\\_{1}(\\\\lambda,\\\\zeta)\\]\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[\\\\partial\\_{\\\\lambda}u\\_{2}(\\\\lambda,\\\\zeta)\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[u\\_{2}(\\\\lambda,\\\\zeta)\\]^{2}}+U^{\\\\prime}\\_{3}(\\\\lambda) |  |\\\n|  |  | =𝔼ζ∼π0(⋅\\|ξ)​\\[(τ​f​(ζ)+ϵ​c​(ξ,ζ))2(ϵ+λ​τ)3​ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]\\\\displaystyle=\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{(\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta))^{2}}{(\\\\epsilon+\\\\lambda\\\\tau)^{3}}e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]} |  |\\\n|  |  | −𝔼ζ∼π0(⋅\\|ξ)​\\[(τ​f​(ζ)+ϵ​c​(ξ,ζ)(ϵ+λ​τ)2)​ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]​𝔼ζ∼π0(⋅\\|ξ)​\\[(τ​f​(ζ)+ϵ​c​(ξ,ζ)ϵ+λ​τ)​ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]\\\\displaystyle\\\\quad-\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{(\\\\epsilon+\\\\lambda\\\\tau)^{2}}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]} |  |\\\n|  |  | =1ϵ+λ​τ​Varζ∼πf−λ​c​(ξ,⋅)ϵ+λ​τ(⋅\\|ξ)⁡(τ​f​(ζ)+ϵ​c​(ξ,ζ)ϵ+λ​τ),\\\\displaystyle=\\\\frac{1}{\\\\epsilon+\\\\lambda\\\\tau}\\\\operatorname{Var}\\_{\\\\zeta\\\\sim\\\\pi^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right), |  |\\\n\\\nwhere Varζ∼πf−λ​c​(ξ,⋅)ϵ+λ​τ(⋅\\|ξ)\\\\operatorname{Var}\\_{\\\\zeta\\\\sim\\\\pi^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)} is the variance with respect to πf−λ​c​(ξ,⋅)ϵ+λ​τ(⋅\\|ξ)\\\\pi^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi).\\\n\\\nNote that all quantities can be differentiated under the (conditional) expectation since the derivatives with respect to λ𝜆\\\\lambda involve functions that are continuous on the compact sample space ΞΞ\\\\Xi (they are therefore bounded by a constant), see e.g. Theorem A.5.3 from \\[ [17](https://ar5iv.org/html/2402.11981#bib.bib17 \"\")\\]. By the property of the variance, we obtain\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | \\|∂λ2ϕτ,ϵ​(λ,f,ξ)\\|subscriptsuperscript2𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\displaystyle\\|\\\\partial^{2}\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\| | ≤1ϵ+λ​τ​𝔼ζ∼π0f−λ​c​(ξ,⋅)ϵ+λ​τ(⋅\\|ξ)​\\[(τ​f​(ζ)+ϵ​c​(ξ,ζ)ϵ+λ​τ)2\\]\\\\displaystyle\\\\leq\\\\frac{1}{\\\\epsilon+\\\\lambda\\\\tau}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right)^{2}\\\\right\\] |  |\\\n|  |  | ≤2ϵ3​𝔼ζ∼π0f−λ​c​(ξ,⋅)ϵ+λ​τ(⋅\\|ξ)​\\[τ2​‖ℱ‖∞2+ϵ2​c​(ξ,ζ)2\\].\\\\displaystyle\\\\leq\\\\frac{2}{\\\\epsilon^{3}}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\tau^{2}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}^{2}+\\\\epsilon^{2}c(\\\\xi,\\\\zeta)^{2}\\\\right\\]. |  | (28) |\\\n\\\nNow we bound the right-hand side of the last inequality. First, we have\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | 𝔼ζ∼π0(⋅\\|ξ)​\\[c​(ξ,ζ)2​ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]≤m2,c​e‖ℱ‖∞ϵ\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[c(\\\\xi,\\\\zeta)^{2}e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\\\\leq m\\_{2,c}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}} |  | (29) |\\\n\\\nOn the other hand, by Jensen’s inequality, we have\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | 𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]≥e−λ​mcϵ+λ​τ−‖ℱ‖∞ϵ\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\\\\geq e^{-\\\\frac{\\\\lambda m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}} |  | (30) |\\\n\\\nWe have the alternatives λ​mcϵ+λ​τ≤λup​mcϵ=2​‖ℱ‖∞​mc(ρ−mc)​ϵ𝜆subscript𝑚𝑐italic-ϵ𝜆𝜏subscript𝜆upsubscript𝑚𝑐italic-ϵ2subscriptnormℱsubscript𝑚𝑐𝜌subscript𝑚𝑐italic-ϵ\\\\frac{\\\\lambda m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}\\\\leq\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}m\\_{c}}{\\\\epsilon}=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon} in any case, and λ​mcϵ+λ​τ≤mcτ𝜆subscript𝑚𝑐italic-ϵ𝜆𝜏subscript𝑚𝑐𝜏\\\\frac{\\\\lambda m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}\\\\leq\\\\frac{m\\_{c}}{\\\\tau} whenever τ>0𝜏0\\\\tau>0. This means λ​mcϵ+λ​τ≤min⁡{mcτ,2​‖ℱ‖∞​mc(ρ−mc)​ϵ}𝜆subscript𝑚𝑐italic-ϵ𝜆𝜏subscript𝑚𝑐𝜏2subscriptnormℱsubscript𝑚𝑐𝜌subscript𝑚𝑐italic-ϵ\\\\frac{\\\\lambda m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}\\\\leq\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}.\\\n\\\nDividing ( [29](https://ar5iv.org/html/2402.11981#A4.E29 \"Equation 29 ‣ Proof. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) by ( [30](https://ar5iv.org/html/2402.11981#A4.E30 \"Equation 30 ‣ Proof. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we obtain 𝔼ζ∼π0f−λ​c​(ξ,⋅)ϵ+λ​τ(⋅\\|ξ)​\\[c​(ξ,ζ)2\\]≤m2,c​emin⁡{mcτ,2​‖ℱ‖∞​mc(ρ−mc)​ϵ}​e2​‖ℱ‖∞ϵ\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[c(\\\\xi,\\\\zeta)^{2}\\\\right\\]\\\\leq m\\_{2,c}e^{\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}}e^{\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}. Reinjecting this inequality in ( [D.2.1](https://ar5iv.org/html/2402.11981#A4.Ex85 \"Proof. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | \\|∂λ2ϕτ,ϵ​(λ,f,ξ)\\|≤2ϵ​(τ2ϵ2​‖ℱ‖∞2+m2,c​e2​‖ℱ‖∞ϵ+min⁡{mcτ,2​‖ℱ‖∞​mc(ρ−mc)​ϵ}):=L.subscriptsuperscript2𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉2italic-ϵsuperscript𝜏2superscriptitalic-ϵ2superscriptsubscriptnormℱ2subscript𝑚2𝑐superscript𝑒2subscriptnormℱitalic-ϵsubscript𝑚𝑐𝜏2subscriptnormℱsubscript𝑚𝑐𝜌subscript𝑚𝑐italic-ϵassign𝐿\\|\\\\partial^{2}\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\|\\\\leq\\\\frac{2}{\\\\epsilon}\\\\left(\\\\frac{\\\\tau^{2}}{\\\\epsilon^{2}}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}^{2}+m\\_{2,c}e^{\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}+\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}}\\\\right):=L. |  | (31) |\\\n\\\nThis means that for f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, the function g:(λ,f)↦𝔼ξ∼P​\\[−∂λϕτ,ϵ​(λ,f,ξ)\\]:𝑔maps-to𝜆𝑓subscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscript𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉g:(\\\\lambda,f)\\\\mapsto\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\] is L𝐿L-Lipschitz where L𝐿L is given by ( [31](https://ar5iv.org/html/2402.11981#A4.E31 \"Equation 31 ‣ Proof. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nWe then show that ρmaxτ,ϵ:=inff∈ℱg​(⋅,f)assignsuperscriptsubscript𝜌𝜏italic-ϵsubscriptinfimum𝑓ℱ𝑔⋅𝑓\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}:=\\\\inf\\_{f\\\\in\\\\mathcal{F}}g(\\\\cdot,f) is L𝐿L-Lipschitz continuous. Let (λ,λ′)∈ℝ2𝜆superscript𝜆′superscriptℝ2(\\\\lambda,\\\\lambda^{\\\\prime})\\\\in\\\\mathbb{R}^{2}, and let (fk)k∈ℕsubscriptsubscript𝑓𝑘𝑘ℕ(f\\_{k})\\_{k\\\\in\\\\mathbb{N}} be a sequence from ℱℱ\\\\mathcal{F} such that g​(λ′,fk)​→k→∞​ρmaxτ,ϵ​(λ′)𝑔superscript𝜆′subscript𝑓𝑘→𝑘→superscriptsubscript𝜌𝜏italic-ϵsuperscript𝜆′g(\\\\lambda^{\\\\prime},f\\_{k})\\\\underset{k\\\\to\\\\infty}{\\\\to}\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda^{\\\\prime}). Then by definition of ρmaxτ,ϵsuperscriptsubscript𝜌𝜏italic-ϵ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}, we have for all k∈ℕ𝑘ℕk\\\\in\\\\mathbb{N},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ρmaxτ,ϵ​(λ)−g​(λ′,fk)≤g​(λ,fk)−g​(λ′,fk)≤L​\\|λ−λ′\\|.superscriptsubscript𝜌𝜏italic-ϵ𝜆𝑔superscript𝜆′subscript𝑓𝑘𝑔𝜆subscript𝑓𝑘𝑔superscript𝜆′subscript𝑓𝑘𝐿𝜆superscript𝜆′\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)-g(\\\\lambda^{\\\\prime},f\\_{k})\\\\leq g(\\\\lambda,f\\_{k})-g(\\\\lambda^{\\\\prime},f\\_{k})\\\\leq L\\|\\\\lambda-\\\\lambda^{\\\\prime}\\|. |  |\\\n\\\nTaking the limit as k→∞→𝑘k\\\\to\\\\infty gives ρmaxτ,ϵ​(λ)−ρmaxτ,ϵ​(λ′)≤L​\\|λ−λ′\\|superscriptsubscript𝜌𝜏italic-ϵ𝜆superscriptsubscript𝜌𝜏italic-ϵsuperscript𝜆′𝐿𝜆superscript𝜆′\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)-\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda^{\\\\prime})\\\\leq L\\|\\\\lambda-\\\\lambda^{\\\\prime}\\|. Exchanging the roles of λ𝜆\\\\lambda and λ′superscript𝜆′\\\\lambda^{\\\\prime} gives \\|ρmaxτ,ϵ​(λ)−ρmaxτ,ϵ​(λ′)\\|≤L​\\|λ−λ′\\|superscriptsubscript𝜌𝜏italic-ϵ𝜆superscriptsubscript𝜌𝜏italic-ϵsuperscript𝜆′𝐿𝜆superscript𝜆′\\|\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)-\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda^{\\\\prime})\\|\\\\leq L\\|\\\\lambda-\\\\lambda^{\\\\prime}\\|, hence ρmaxτ,ϵsuperscriptsubscript𝜌𝜏italic-ϵ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon} is L𝐿L-Lipschitz.\\\n\\\nNow, set 2​λlowτ,ϵ:=sup{λ∈ℝ+:ρmaxτ,ϵ​(λ)≥ρcritτ,ϵ/2}assign2superscriptsubscript𝜆low𝜏italic-ϵsupremumconditional-set𝜆subscriptℝsuperscriptsubscript𝜌𝜏italic-ϵ𝜆superscriptsubscript𝜌crit𝜏italic-ϵ22\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}:=\\\\sup\\\\left\\\\{\\\\lambda\\\\in\\\\mathbb{R}\\_{+}\\ :\\ \\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)\\\\geq\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}/2\\\\right\\\\}. Then either λlowτ,ϵ=∞superscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}=\\\\infty (in which case any value λlowτ,ϵsuperscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} satisfies the desired property), or by continuity of ρmaxτ,ϵsuperscriptsubscript𝜌𝜏italic-ϵ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}, ρmaxτ,ϵ​(2​λlowτ,ϵ)=ρcritτ,ϵ/2superscriptsubscript𝜌𝜏italic-ϵ2superscriptsubscript𝜆low𝜏italic-ϵsuperscriptsubscript𝜌crit𝜏italic-ϵ2\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon})=\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}/2 and we have ρcritτ,ϵ−2​L​λlowτ,ϵ≤ρmax​(2​λlowτ,ϵ)=ρcritτ,ϵ/2superscriptsubscript𝜌crit𝜏italic-ϵ2𝐿superscriptsubscript𝜆low𝜏italic-ϵsubscript𝜌2superscriptsubscript𝜆low𝜏italic-ϵsuperscriptsubscript𝜌crit𝜏italic-ϵ2\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}-2L\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}\\\\leq\\\\rho\\_{\\\\max}(2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon})=\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}/2. Finally we thus get ( [27](https://ar5iv.org/html/2402.11981#A4.E27 \"Equation 27 ‣ Lemma D.2. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n∎\\\n\\\n#### D.2.2 Dual upper-bound\\\n\\\nThe following result allows to bound the dual solution above. This requirement is specific to the regularized setting, see in particular [PropositionF.2](https://ar5iv.org/html/2402.11981#A6.Thmproposition2 \"Proposition F.2. ‣ F.2 Necessity of the dual upper-bound ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for an example.\\\n\\\n###### Lemma D.3(Upper bound for the regularized problem [Lemma4.5](https://ar5iv.org/html/2402.11981\\#S4.Thmlemma5 \"Lemma 4.5. ‣ 4.5 Extension to (double) regularization. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nAssume ρ>mc𝜌subscript𝑚𝑐\\\\rho>m\\_{c} and let λup:=2​‖ℱ‖∞ρ−mcassignsubscript𝜆up2subscriptnormℱ𝜌subscript𝑚𝑐\\\\lambda\\_{\\\\operatorname{up}}:=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}. For all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} and Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi),\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infλ∈\\[0,∞){λ​ρ+𝔼ξ∼Q​\\[ϕτ,ϵ​(λ,f,ξ)\\]}=infλ∈\\[0,λup){λ​ρ+𝔼ξ∼Q​\\[ϕτ,ϵ​(λ,f,ξ)\\]}.subscriptinfimum𝜆0𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉subscriptinfimum𝜆0subscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\\\n\\\n###### Proof.\\\n\\\nLet ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi be arbitrary. Recall that\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∂λϕτ,ϵ​(λ,f,ξ)=−𝔼ζ∼π0f−λ​c​(ξ,⋅)ϵ+λ​τ(⋅\\|ξ)​\\[τ​f​(ζ)+ϵ​c​(ξ,ζ)ϵ+λ​τ\\]+τ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\].\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=-\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right\\]+\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]. |  |\\\n\\\nWe bound −∂λϕτ,ϵ​(λ,f,ξ)subscript𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi) above, uniformly in f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} and ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi. For readability of the proof, we set π~0=π0f−λ​c​(ξ,⋅)ϵ+λ​τsubscript~𝜋0superscriptsubscript𝜋0𝑓𝜆𝑐𝜉⋅italic-ϵ𝜆𝜏\\\\tilde{\\\\pi}\\_{0}=\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}} with a slight abuse of notation. In this case, we have\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | 𝔼ζ∼π~0(⋅\\|ξ)​\\[τ​f​(ζ)+ϵ​c​(ξ,ζ)ϵ+λ​τ\\]\\\\displaystyle\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\tilde{\\\\pi}\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right\\] | =𝔼ζ∼π~0(⋅\\|ξ)​\\[λ​τ​f​(ζ)+λ​ϵ​c​(ξ,ζ)−ϵ​f​(ζ)+ϵ​f​(ζ)λ​(ϵ+λ​τ)\\]\\\\displaystyle=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\tilde{\\\\pi}\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\lambda\\\\tau f(\\\\zeta)+\\\\lambda\\\\epsilon c(\\\\xi,\\\\zeta)-\\\\epsilon f(\\\\zeta)+\\\\epsilon f(\\\\zeta)}{\\\\lambda(\\\\epsilon+\\\\lambda\\\\tau)}\\\\right\\] |  |\\\n|  |  | =1λ​𝔼ζ∼π~0(⋅\\|ξ)​\\[f​(ζ)\\]−ϵλ​𝔼ζ∼π~0(⋅\\|ξ)​\\[f​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]\\\\displaystyle=\\\\frac{1}{\\\\lambda}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\tilde{\\\\pi}\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[f(\\\\zeta)\\\\right\\]-\\\\frac{\\\\epsilon}{\\\\lambda}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\tilde{\\\\pi}\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right\\] |  |\\\n|  |  | ≤‖ℱ‖∞λ−ϵλ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]\\\\displaystyle\\\\leq\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda}-\\\\frac{\\\\epsilon}{\\\\lambda}\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\] |  |\\\n|  |  | ≤‖ℱ‖∞λ−ϵλ​(ϵ+λ​τ)​(𝔼ζ∼π0(⋅\\|ξ)​\\[f​(ζ)−λ​c​(ξ,ζ)\\])\\\\displaystyle\\\\leq\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda}-\\\\frac{\\\\epsilon}{\\\\lambda(\\\\epsilon+\\\\lambda\\\\tau)}\\\\left(\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\]\\\\right) |  |\\\n|  |  | ≤‖ℱ‖∞λ+ϵ​‖ℱ‖∞λ​(ϵ+λ​τ)+ϵ​mcϵ+λ​τ,absentsubscriptnormℱ𝜆italic-ϵsubscriptnormℱ𝜆italic-ϵ𝜆𝜏italic-ϵsubscript𝑚𝑐italic-ϵ𝜆𝜏\\\\displaystyle\\\\leq\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda}+\\\\frac{\\\\epsilon\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda(\\\\epsilon+\\\\lambda\\\\tau)}+\\\\frac{\\\\epsilon m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}, |  | (32) |\\\n\\\nwhere for the third line, we used [LemmaC.2](https://ar5iv.org/html/2402.11981#A3.Thmlemma2 \"Lemma C.2 (Lemma G.7 in [5]). ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and for the fourth line, we used Jensen’s inequality. On the other hand,\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | −τ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\]\\\\displaystyle-\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\] | ≤−τϵ+λ​τ​𝔼ζ∼π0(⋅\\|ξ)​\\[f​(ζ)−λ​c​(ξ,ζ)\\]\\\\displaystyle\\\\leq-\\\\frac{\\\\tau}{\\\\epsilon+\\\\lambda\\\\tau}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\] |  |\\\n|  |  | ≤λ​τλ​(ϵ+λ​τ)​‖ℱ‖∞+λ​τϵ+λ​τ​mcabsent𝜆𝜏𝜆italic-ϵ𝜆𝜏subscriptnormℱ𝜆𝜏italic-ϵ𝜆𝜏subscript𝑚𝑐\\\\displaystyle\\\\leq\\\\frac{\\\\lambda\\\\tau}{\\\\lambda(\\\\epsilon+\\\\lambda\\\\tau)}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{\\\\lambda\\\\tau}{\\\\epsilon+\\\\lambda\\\\tau}m\\_{c} |  | (33) |\\\n\\\nSumming ( [D.2.2](https://ar5iv.org/html/2402.11981#A4.Ex89 \"Proof. ‣ D.2.2 Dual upper-bound ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [D.2.2](https://ar5iv.org/html/2402.11981#A4.Ex93 \"Proof. ‣ D.2.2 Dual upper-bound ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | −∂λϕτ,ϵ​(λ,f,ξ)≤2​‖ℱ‖∞λ+mc,subscript𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉2subscriptnormℱ𝜆subscript𝑚𝑐-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\leq\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda}+m\\_{c}, |  |\\\n\\\nwhence assuming ρ>mc𝜌subscript𝑚𝑐\\\\rho>m\\_{c}, and taking λ=λup:=2​‖ℱ‖∞ρ−mc𝜆subscript𝜆upassign2subscriptnormℱ𝜌subscript𝑚𝑐\\\\lambda=\\\\lambda\\_{\\\\operatorname{up}}:=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}, we obtain for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} and all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | 0≤ρ+∂λϕτ,ϵ​(λup,f,ξ).0𝜌subscript𝜆superscriptitalic-ϕ𝜏italic-ϵsubscript𝜆up𝑓𝜉0\\\\leq\\\\rho+\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda\\_{\\\\operatorname{up}},f,\\\\xi). |  |\\\n\\\nIntegrating with respect to a distribution Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) yields\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | 0≤ρ+𝔼ξ∼Q​\\[∂λϕτ,ϵ​(λup,f,ξ)\\],0𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]subscript𝜆superscriptitalic-ϕ𝜏italic-ϵsubscript𝜆up𝑓𝜉0\\\\leq\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda\\_{\\\\operatorname{up}},f,\\\\xi)\\], |  |\\\n\\\nwhich is the derivative at λupsubscript𝜆up\\\\lambda\\_{\\\\operatorname{up}} of the convex function λ↦λ​ρ+𝔼ξ∼Q​\\[ϕτ,ϵ​(λ,f,ξ)\\]maps-to𝜆𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\lambda\\\\mapsto\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\\\left\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\right\\]. This means\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infλ∈\\[0,∞){λ​ρ+𝔼ξ∼Q​\\[ϕτ,ϵ​(λ,f,ξ)\\]}=infλ∈\\[0,λup){λ​ρ+𝔼ξ∼P^n​\\[ϕτ,ϵ​(λ,f,ξ)\\]}.subscriptinfimum𝜆0𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉subscriptinfimum𝜆0subscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\\\left\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\right\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\\\left\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\right\\]\\\\right\\\\}. |  |\\\n\\\n∎\\\n\\\n## Appendix E Proof of the main results\\\n\\\nIn this section, we prove the main results of the paper: Theorems [3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). First, we establish the core concentration results in [E.1](https://ar5iv.org/html/2402.11981#A5.SS1 \"E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") that apply to standard and regularized WDRO. In particular, the slope condition presented in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4.SSS0.Px2 \"Dual bound on the empirical risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is used there to establish the dual lower bound with high probability. Then we deduce the main theorems in [E.2](https://ar5iv.org/html/2402.11981#A5.SS2 \"E.2 Proof of the main results ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and compute the generalization constants.\\\n\\\n### E.1 Dual bounds with high probability on the empirical problem\\\n\\\nAll the results of this subsection hold for both standard and regularized cases. The proofs hold _as is_, replacing ϕitalic-ϕ\\\\phi, ψ𝜓\\\\psi, ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}}, ρmaxsubscript𝜌\\\\rho\\_{\\\\max} and λlowsubscript𝜆low\\\\lambda\\_{\\\\operatorname{low}} by ϕτ,ϵsuperscriptitalic-ϕ𝜏italic-ϵ\\\\phi^{\\\\tau,\\\\epsilon}, ψτ,ϵsuperscript𝜓𝜏italic-ϵ\\\\psi^{\\\\tau,\\\\epsilon}, ρcritτ,ϵsuperscriptsubscript𝜌crit𝜏italic-ϵ\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}, ρmaxτ,ϵsuperscriptsubscript𝜌𝜏italic-ϵ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon} and λlowτ,ϵsuperscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} respectively.\\\n\\\nFor λ≥0𝜆0\\\\lambda\\\\geq 0, we recall the quantities\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ρcrit=inff∈ℱ𝔼ξ∼P​\\[−∂λ+ϕ​(0,f,ξ)\\],ρmax​(λ)=inff∈ℱ𝔼ξ∼P​\\[−∂λ+ϕ​(λ,f,ξ)\\].formulae-sequencesubscript𝜌critsubscriptinfimum𝑓ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscriptsubscript𝜆italic-ϕ0𝑓𝜉subscript𝜌𝜆subscriptinfimum𝑓ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscriptsubscript𝜆italic-ϕ𝜆𝑓𝜉\\\\rho\\_{\\\\operatorname{crit}}=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(0,f,\\\\xi)\\],\\\\qquad\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]. |  |\\\n\\\n##### Problem’s constants.\\\n\\\nBefore proving the next results, we introduce several quantities:\\\n\\\n###### Proposition E.1(Dual lower bound in the true problem).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exists λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that for all λ∈\\[0,2​λlow\\]𝜆02subscript𝜆low\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\], ρmax​(λ)≥ρcrit2subscript𝜌𝜆subscript𝜌crit2\\\\rho\\_{\\\\max}(\\\\lambda)\\\\geq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}. In particular, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, 𝔼ξ∼P​\\[∂λ+ϕ​(λ,f,ξ)\\]≤−ρcrit2subscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscriptsuperscript𝜆italic-ϕ𝜆𝑓𝜉subscript𝜌crit2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}.\\\n\\\n###### Proof.\\\n\\\nThis comes from limλ→0+ρmax​(λ)=ρcritsubscript→𝜆superscript0subscript𝜌𝜆subscript𝜌crit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}. See [lemmaD.1](https://ar5iv.org/html/2402.11981#A4.Thmlemma1 \"Lemma D.1. ‣ D.1 Standard WDRO: continuity at zero of the maximal radius ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for standard WDRO and [lemmaD.2](https://ar5iv.org/html/2402.11981#A4.Thmlemma2 \"Lemma D.2. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for the regularized case.\\\n∎\\\n\\\nLet λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 be given by [PropositionE.1](https://ar5iv.org/html/2402.11981#A5.Thmproposition1 \"Proposition E.1 (Dual lower bound in the true problem). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). For the next results, we define the following quantities:\\\n\\\n- •\\\n\\\n\\\nΦΦ\\\\Phi is the length of a segment I𝐼I such that ϕ​(λ,f,ξ)∈Iitalic-ϕ𝜆𝑓𝜉𝐼\\\\phi(\\\\lambda,f,\\\\xi)\\\\in I for all λ∈{λlow,2​λlow}𝜆subscript𝜆low2subscript𝜆low\\\\lambda\\\\in\\\\{\\\\lambda\\_{\\\\operatorname{low}},2\\\\lambda\\_{\\\\operatorname{low}}\\\\}, f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} and ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi,\\\n\\\n- •\\\n\\\n\\\nΨΨ\\\\Psi is the length of a segment J𝐽J such that ψ​(μ,f,ξ)∈J𝜓𝜇𝑓𝜉𝐽\\\\psi(\\\\mu,f,\\\\xi)\\\\in J for all μ∈(0,λlow−1\\]𝜇0superscriptsubscript𝜆low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\], f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} and ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi,\\\n\\\n- •\\\n\\\n\\\nLψsubscript𝐿𝜓L\\_{\\\\psi} and λup∈\\[0,∞\\]subscript𝜆up0\\\\lambda\\_{\\\\operatorname{up}}\\\\in\\[0,\\\\infty\\] are such that ψ​(⋅,⋅,ξ)𝜓⋅⋅𝜉\\\\psi(\\\\cdot,\\\\cdot,\\\\xi) is Lψsubscript𝐿𝜓L\\_{\\\\psi}-Lipschitz on \\[λup−1,λlow−1\\]×ℱsuperscriptsubscript𝜆up1superscriptsubscript𝜆low1ℱ\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F} for all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi.\\\n\\\n\\\nWith the above quantities, we can prove the following:\\\n\\\n###### Proposition E.2(Dual lower bound with high probability).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), let λlowsubscript𝜆low\\\\lambda\\_{\\\\operatorname{low}} be given by [PropositionE.1](https://ar5iv.org/html/2402.11981#A5.Thmproposition1 \"Proposition E.1 (Dual lower bound in the true problem). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and λup∈\\[λlow,∞\\]subscript𝜆upsubscript𝜆low\\\\lambda\\_{\\\\operatorname{up}}\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\infty\\]. If ρ≤ρcrit2−2​C​(δ)λlow​n𝜌subscript𝜌crit22𝐶𝛿subscript𝜆low𝑛\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}\\\nwhere C(δ):=48ℐ(ℱ,∥⋅∥∞)+Φ2​log⁡4δC(\\\\delta):=48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\Phi\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}, then with probability 1−δ21𝛿21-\\\\frac{\\\\delta}{2}, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infλ∈\\[0,λup){λρ+𝔼ξ∼P^n\\[ϕ(,λ,f,ξ)\\]}=infλ∈\\[λlow,λup){λρ+𝔼ξ∼P^n\\[ϕ(λ,f,ξ)\\]}.\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(,\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\\\n\\\n###### Proof.\\\n\\\nLet λ∈{λlow,2​λlow}𝜆subscript𝜆low2subscript𝜆low\\\\lambda\\\\in\\\\{\\\\lambda\\_{\\\\operatorname{low}},2\\\\lambda\\_{\\\\operatorname{low}}\\\\}. For ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, the function f↦ϕ​(λ,f,ξ)maps-to𝑓italic-ϕ𝜆𝑓𝜉f\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi) is Lipschitz with constant 111, see [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). ‣ C.1 Standard WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [LemmaC.3](https://ar5iv.org/html/2402.11981#A3.Thmlemma3 \"Lemma C.3 (Concentration conditions for regularized WDRO). ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Then we can apply [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). ‣ A.1 Uniform concentration inequality ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), to have with probability at least 1−δ41𝛿41-\\\\frac{\\\\delta}{4}, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | 𝔼ξ∼P^n​\\[ϕ​(2​λlow,f,ξ)\\]−𝔼ξ∼P​\\[ϕ​(2​λlow,f,ξ)\\]≤48ℐ(ℱ,∥⋅∥∞)n+Φ​2​log⁡4δn\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]\\\\leq\\\\frac{48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\sqrt{n}}+\\\\Phi\\\\sqrt{\\\\frac{2\\\\log\\\\frac{4}{\\\\delta}}{n}} |  | (34) |\\\n\\\nand with probability at least 1−δ41𝛿41-\\\\frac{\\\\delta}{4}, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | 𝔼ξ∼P​\\[ϕ​(λlow,f,ξ)\\]−𝔼ξ∼P^n​\\[ϕ​(λlow,f,ξ)\\]≤48ℐ(ℱ,∥⋅∥∞)n+Φ​2​log⁡4δn.\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]\\\\leq\\\\frac{48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\sqrt{n}}+\\\\Phi\\\\sqrt{\\\\frac{2\\\\log\\\\frac{4}{\\\\delta}}{n}}. |  | (35) |\\\n\\\nWe set C(δ):=48ℐ(ℱ,∥⋅∥∞)+Φ2​log⁡4δC(\\\\delta):=48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\Phi\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}. Intersecting the events ( [34](https://ar5iv.org/html/2402.11981#A5.E34 \"Equation 34 ‣ Proof. ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [35](https://ar5iv.org/html/2402.11981#A5.E35 \"Equation 35 ‣ Proof. ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we obtain that with probability 1−δ21𝛿21-\\\\frac{\\\\delta}{2}, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  |  | 𝔼ξ∼P^n​\\[ϕ​(2​λlow,f,ξ)\\]−𝔼ξ∼P^n​\\[ϕ​(λlow,f,ξ)\\]λlowsubscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ2subscript𝜆low𝑓𝜉subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕsubscript𝜆low𝑓𝜉subscript𝜆low\\\\displaystyle\\\\frac{\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]}{\\\\lambda\\_{\\\\operatorname{low}}} |  |\\\n|  |  | ≤1λlow​(𝔼ξ∼P​\\[ϕ​(2​λlow,f,ξ)\\]−𝔼ξ∼P​\\[ϕ​(λlow,f,ξ)\\]+2​C​(δ)n)absent1subscript𝜆lowsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ2subscript𝜆low𝑓𝜉subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕsubscript𝜆low𝑓𝜉2𝐶𝛿𝑛\\\\displaystyle\\\\leq\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\left(\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]+\\\\frac{2C(\\\\delta)}{\\\\sqrt{n}}\\\\right) |  |\\\n|  |  | ≤𝔼ξ∼P​\\[∂λ+ϕ​(2​λlow,f,ξ)\\]+2​C​(δ)λlow​nabsentsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscriptsubscript𝜆italic-ϕ2subscript𝜆low𝑓𝜉2𝐶𝛿subscript𝜆low𝑛\\\\displaystyle\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial\\_{\\\\lambda}^{+}\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]+\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}} |  |\\\n|  |  | ≤−ρcrit2+2​C​(δ)λlow​n,absentsubscript𝜌crit22𝐶𝛿subscript𝜆low𝑛\\\\displaystyle\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}+\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}, |  | (36) |\\\n\\\nwhere we recall that for λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0, satisfies for all λ∈\\[0,2​λlow\\]𝜆02subscript𝜆low\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\] and all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, 𝔼ξ∼P​\\[∂+ϕ​(λ,f,ξ)\\]≤−ρcrit2subscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscriptitalic-ϕ𝜆𝑓𝜉subscript𝜌crit2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}.\\\nFor λ≥0𝜆0\\\\lambda\\\\geq 0 and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, we set gf​(λ)=λ​ρ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]subscript𝑔𝑓𝜆𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉g\\_{f}(\\\\lambda)=\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]. Then from ( [E.1](https://ar5iv.org/html/2402.11981#A5.Ex100 \"Proof. ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we deduce with probability at least 1−δ21𝛿21-\\\\frac{\\\\delta}{2}, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | gf​(2​λlow)−gf​(λlow)λlow=ρ−ρcrit2+2​C​(δ)λlow​n.subscript𝑔𝑓2subscript𝜆lowsubscript𝑔𝑓subscript𝜆lowsubscript𝜆low𝜌subscript𝜌crit22𝐶𝛿subscript𝜆low𝑛\\\\displaystyle\\\\frac{g\\_{f}(2\\\\lambda\\_{\\\\operatorname{low}})-g\\_{f}(\\\\lambda\\_{\\\\operatorname{low}})}{\\\\lambda\\_{\\\\operatorname{low}}}=\\\\rho-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}+\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}. |  |\\\n\\\nThis means that if ρ≤ρcrit2−2​C​(δ)λlow​n𝜌subscript𝜌crit22𝐶𝛿subscript𝜆low𝑛\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}, then with probability at least 1−δ21𝛿21-\\\\frac{\\\\delta}{2}, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infλ∈\\[0,λup){λ​ρ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]}=infλ∈\\[λlow,λup){λ​ρ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]}.subscriptinfimum𝜆0subscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉subscriptinfimum𝜆subscript𝜆lowsubscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\\\n\\\n∎\\\n\\\nThis implies a generalization bound on the dual problem of (regularized) WDRO:\\\n\\\n###### Proposition E.3(Generalization bound on the dual problem).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), let λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 be given by [PropositionE.1](https://ar5iv.org/html/2402.11981#A5.Thmproposition1 \"Proposition E.1 (Dual lower bound in the true problem). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). If B​(δ)n≤ρ≤ρcrit2−2​C​(δ)λlow​n𝐵𝛿𝑛𝜌subscript𝜌crit22𝐶𝛿subscript𝜆low𝑛\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\leq\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}} where\\\n\\\n- •\\\n\\\n\\\nB(δ)=48Lψ(ℐ(ℱ,∥⋅∥∞)+2λlow)+Ψ2​log⁡2δB(\\\\delta)=48L\\_{\\\\psi}\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)+\\\\Psi\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}},\\\n\\\n- •\\\n\\\n\\\nC(δ)=48ℐ(ℱ,∥⋅∥∞)+Φ2​log⁡4δC(\\\\delta)=48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\Phi\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}},\\\n\\\n\\\nthen with probability at least 1−δ1𝛿1-\\\\delta, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infλ∈\\[0,λup){λ​ρ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]}≥infλ∈\\[0,∞){λ​(ρ−B​(δ)n)+𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]}.subscriptinfimum𝜆0subscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉subscriptinfimum𝜆0𝜆𝜌𝐵𝛿𝑛subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\left(\\\\rho-\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\right)+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\\\n\\\n###### Proof.\\\n\\\nWe assume λup>λlowsubscript𝜆upsubscript𝜆low\\\\lambda\\_{\\\\operatorname{up}}>\\\\lambda\\_{\\\\operatorname{low}}. By [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). ‣ A.1 Uniform concentration inequality ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), applied to (μ,f)↦μ​ϕ​(μ−1,f,ξ)maps-to𝜇𝑓𝜇italic-ϕsuperscript𝜇1𝑓𝜉(\\\\mu,f)\\\\mapsto\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi), we obtain with probability at least 1−δ21𝛿21-\\\\frac{\\\\delta}{2},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | αn:=sup(μ,f)∈(λup−1,λlow−1\\]×ℱ{𝔼ξ∼P​\\[ψ​(μ,f,ξ)\\]−𝔼ξ∼P^n​\\[ψ​(μ,f,ξ)\\]}≤B​(δ)nassignsubscript𝛼𝑛subscriptsupremum𝜇𝑓superscriptsubscript𝜆up1superscriptsubscript𝜆low1ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝜓𝜇𝑓𝜉subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]𝜓𝜇𝑓𝜉𝐵𝛿𝑛\\\\alpha\\_{n}:=\\\\sup\\_{(\\\\mu,f)\\\\in(\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}}\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]\\\\}\\\\leq\\\\frac{B(\\\\delta)}{\\\\sqrt{n}} |  | (37) |\\\n\\\nwhere B​(δ)=48​Lψ​ℐ​(\\[0,λlow−1\\]×ℱ,dist)+Ψ​2​log⁡2δ𝐵𝛿48subscript𝐿𝜓ℐ0superscriptsubscript𝜆low1ℱdistΨ22𝛿B(\\\\delta)=48L\\_{\\\\psi}\\\\mathcal{I}(\\[0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F},\\\\operatorname{dist})+\\\\Psi\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}} and dist⁡((μ,f),(μ′,f′)):=\\|μ−μ′\\|+‖f−f′‖∞assigndist𝜇𝑓superscript𝜇′superscript𝑓′𝜇superscript𝜇′subscriptnorm𝑓superscript𝑓′\\\\operatorname{dist}((\\\\mu,f),(\\\\mu^{\\\\prime},f^{\\\\prime})):=\\|\\\\mu-\\\\mu^{\\\\prime}\\|+\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. Furthermore, we have the inequality\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ℐ(\\[0,λlow−1\\]×ℱ)≤ℐ(ℱ,∥⋅∥∞)+12​λlow(1+2log2)≤ℐ(ℱ,∥⋅∥∞)+2λlow,\\\\mathcal{I}(\\[0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F})\\\\leq\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{1}{2\\\\lambda\\_{\\\\operatorname{low}}}(1+2\\\\log 2)\\\\leq\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}, |  |\\\n\\\nsee [LemmaA.3](https://ar5iv.org/html/2402.11981#A1.Thmlemma3 \"Lemma A.3 (Dudley’s integral estimates). ‣ A.1 Uniform concentration inequality ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), hence we may refine B​(δ)𝐵𝛿B(\\\\delta) as B(δ)=48Lψ(ℐ(ℱ,∥⋅∥∞)+2λlow)+Ψ2​log⁡2δ.B(\\\\delta)=48L\\_{\\\\psi}\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)+\\\\Psi\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}.\\\n\\\nBy [PropositionE.2](https://ar5iv.org/html/2402.11981#A5.Thmproposition2 \"Proposition E.2 (Dual lower bound with high probability). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), if ρ≤ρcrit2−2​C​(δ)λlow​n𝜌subscript𝜌crit22𝐶𝛿subscript𝜆low𝑛\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}\\\nwhere C(δ):=48ℐ(ℱ,∥⋅∥∞)+Φ2​log⁡4δC(\\\\delta):=48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\Phi\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}, then with probability at least 1−δ21𝛿21-\\\\frac{\\\\delta}{2}, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | infλ∈\\[0,λup){λ​ρ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]}=infλ∈\\[λlow,λup){λ​ρ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]}.subscriptinfimum𝜆0subscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉subscriptinfimum𝜆subscript𝜆lowsubscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  | (38) |\\\n\\\nFinally, combining ( [38](https://ar5iv.org/html/2402.11981#A5.E38 \"Equation 38 ‣ Proof. ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [37](https://ar5iv.org/html/2402.11981#A5.E37 \"Equation 37 ‣ Proof. ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), and if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | B​(δ)n≤ρ≤ρcrit2−2​C​(δ)λlow​n,𝐵𝛿𝑛𝜌subscript𝜌crit22𝐶𝛿subscript𝜆low𝑛\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\leq\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}, |  |\\\n\\\nwe can write with probability 1−δ1𝛿1-\\\\delta, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infλ∈\\[0,λup){λ​ρ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]}=infλ∈\\[λlow,λup){λ​ρ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]}subscriptinfimum𝜆0subscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉subscriptinfimum𝜆subscript𝜆lowsubscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\displaystyle\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} |  |\\\n|  | ≥infλ∈\\[λlow,λup){λ​ρ+𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]−λ​𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]−𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]λ}absentsubscriptinfimum𝜆subscript𝜆lowsubscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉𝜆subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉𝜆\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]-\\\\lambda\\\\frac{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]}{\\\\lambda}\\\\right\\\\} |  |\\\n|  | ≥infλ∈\\[λlow,λup){λ​ρ+𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]−λ​αn}absentsubscriptinfimum𝜆subscript𝜆lowsubscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉𝜆subscript𝛼𝑛\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]-\\\\lambda\\\\alpha\\_{n}\\\\right\\\\} |  |\\\n|  | ≥infλ∈\\[λlow,λup){λ​(ρ−B​(δ)n)+𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]}absentsubscriptinfimum𝜆subscript𝜆lowsubscript𝜆up𝜆𝜌𝐵𝛿𝑛subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\left(\\\\rho-\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\right)+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} |  |\\\n|  | ≥infλ∈\\[0,∞){λ​(ρ−B​(δ)n)+𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]},absentsubscriptinfimum𝜆0𝜆𝜌𝐵𝛿𝑛subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\left(\\\\rho-\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\right)+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  |\\\n\\\nIf λup≤λlowsubscript𝜆upsubscript𝜆low\\\\lambda\\_{\\\\operatorname{up}}\\\\leq\\\\lambda\\_{\\\\operatorname{low}}, this means, by convexity of the inner function,\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | infλ∈\\[0,λup){λ​ρ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]}subscriptinfimum𝜆0subscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\displaystyle\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} | =λlow​ρ+𝔼ξ∼P^n​\\[ϕ​(λlow,f,ξ)\\]absentsubscript𝜆low𝜌subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕsubscript𝜆low𝑓𝜉\\\\displaystyle=\\\\lambda\\_{\\\\operatorname{low}}\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\] |  |\\\n|  |  | ≥λlow​(ρ−αn′)+𝔼ξ∼P​\\[ϕ​(λlow,f,ξ)\\]absentsubscript𝜆low𝜌superscriptsubscript𝛼𝑛′subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕsubscript𝜆low𝑓𝜉\\\\displaystyle\\\\geq\\\\lambda\\_{\\\\operatorname{low}}(\\\\rho-\\\\alpha\\_{n}^{\\\\prime})+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\] |  |\\\n|  |  | ≥infλ∈\\[0,∞){λ​(ρ−B​(δ)n)+𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]},absentsubscriptinfimum𝜆0𝜆𝜌𝐵𝛿𝑛subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\left(\\\\rho-\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\right)+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  |\\\n\\\nwhere we refined αnsubscript𝛼𝑛\\\\alpha\\_{n} into αn′=supf∈ℱ{𝔼ξ∼P​\\[ψ​(λlow−1,f,ξ)\\]−𝔼ξ∼P^n​\\[ψ​(λlow−1,f,ξ)\\]}superscriptsubscript𝛼𝑛′subscriptsupremum𝑓ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝜓superscriptsubscript𝜆low1𝑓𝜉subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]𝜓superscriptsubscript𝜆low1𝑓𝜉\\\\alpha\\_{n}^{\\\\prime}=\\\\sup\\_{f\\\\in\\\\mathcal{F}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\psi(\\\\lambda\\_{\\\\operatorname{low}}^{-1},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\psi(\\\\lambda\\_{\\\\operatorname{low}}^{-1},f,\\\\xi)\\]\\\\right\\\\}.\\\n∎\\\n\\\n### E.2 Proof of the main results\\\n\\\nWe are now ready to prove our main results.\\\n\\\nThe following is an extended version of the generalization result in standard WDRO ( [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Note that the extended bound ( [39](https://ar5iv.org/html/2402.11981#A5.E39 \"Equation 39 ‣ Theorem E.1 (Generalization guarantee, standard WDRO). ‣ E.2 Proof of the main results ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) involves a control of Rρ−αn​(f)subscript𝑅𝜌𝛼𝑛𝑓R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f), which means that R^ρ​(f)subscript^𝑅𝜌𝑓\\\\widehat{R}\\_{\\\\rho}(f) also generalize well against for distribution shifts.\\\n\\\n###### Theorem E.1(Generalization guarantee, standard WDRO).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exists λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | αn<ρ<ρcrit2−βn,𝛼𝑛𝜌subscript𝜌crit2𝛽𝑛\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}, |  |\\\n\\\nwhere\\\n\\\n- •\\\n\\\n\\\nα=48(∥ℱ∥∞+1λlow)(ℐ(ℱ,∥⋅∥∞)+2λlow)+2​‖ℱ‖∞λlow2​log⁡2δ\\\\alpha=48\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}\\\n\\\n- •\\\n\\\n\\\nβ=96ℐ(ℱ,∥⋅∥∞)λlow+4​‖ℱ‖∞λlow​2​log⁡4δ\\\\beta=\\\\frac{96\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\lambda\\_{\\\\operatorname{low}}}+\\\\frac{4\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}},\\\n\\\n\\\nthen with probability at least 1−δ1𝛿1-\\\\delta, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^ρ​(f)≥Rρ−αn​(f)≥𝔼ξ∼P​\\[f​(ζ)\\].subscript^𝑅𝜌𝑓subscript𝑅𝜌𝛼𝑛𝑓subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑓𝜁\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\zeta)\\]. |  | (39) |\\\n\\\n###### Proof.\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), let λlowsubscript𝜆low\\\\lambda\\_{\\\\operatorname{low}} be given by [PropositionE.2](https://ar5iv.org/html/2402.11981#A5.Thmproposition2 \"Proposition E.2 (Dual lower bound with high probability). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Our goal is to apply [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the standard WDRO case and to compute its constants thanks to [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). ‣ C.1 Standard WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). By [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). ‣ C.1 Standard WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we have the following constants:\\\n\\\n- •\\\n\\\n\\\nΦ=2​‖ℱ‖∞Φ2subscriptnormℱ\\\\Phi=2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\n\\\n- •\\\n\\\n\\\nΨ=2​‖ℱ‖∞λlowΨ2subscriptnormℱsubscript𝜆low\\\\Psi=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\n\\\n- •\\\n\\\n\\\nλup=∞subscript𝜆up\\\\lambda\\_{\\\\operatorname{up}}=\\\\infty, and Lψ=‖ℱ‖∞+λlow−1subscript𝐿𝜓subscriptnormℱsuperscriptsubscript𝜆low1L\\_{\\\\psi}=\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\\\n\\\n\\\nα𝛼\\\\alpha corresponds to B​(δ)𝐵𝛿B(\\\\delta) in [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and β𝛽\\\\beta corresponds 2​C​(δ)λlow2𝐶𝛿subscript𝜆low\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}}, whence we obtain\\\n\\\n- •\\\n\\\n\\\nα=48(∥ℱ∥∞+1λlow)(ℐ(ℱ,∥⋅∥∞)+2λlow)+2​‖ℱ‖∞λlow2​log⁡2δ\\\\alpha=48\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}\\\n\\\n- •\\\n\\\n\\\nβ=2λlow(48ℐ(ℱ,∥⋅∥∞)+2∥ℱ∥∞2​log⁡4δ)=96ℐ(ℱ,∥⋅∥∞)λlow+4​‖ℱ‖∞λlow2​log⁡4δ\\\\beta=\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\left(48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}\\\\right)=\\\\frac{96\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\lambda\\_{\\\\operatorname{low}}}+\\\\frac{4\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}.\\\n\\\n\\\nBy strong duality, [PropositionB.1](https://ar5iv.org/html/2402.11981#A2.Thmproposition1 \"Proposition B.1 (Strong duality, standard WDRO). ‣ Appendix B Strong duality ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), Rϱ​(f)subscript𝑅italic-ϱ𝑓R\\_{\\\\varrho}(f) and R^ϱ​(f)subscript^𝑅italic-ϱ𝑓\\\\widehat{R}\\_{\\\\varrho}(f) admit the representations\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Rϱ​(f)=infλ∈\\[0,∞){λ​ϱ+𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]}subscript𝑅italic-ϱ𝑓subscriptinfimum𝜆0𝜆italic-ϱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉R\\_{\\\\varrho}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\varrho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} |  |\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ϱ​(f)=infλ∈\\[0,∞){λ​ϱ+𝔼ξ∼P^n​\\[ϕ​(λ,f,ξ)\\]},subscript^𝑅italic-ϱ𝑓subscriptinfimum𝜆0𝜆italic-ϱsubscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\widehat{R}\\_{\\\\varrho}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\varrho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  |\\\n\\\nfor any ϱ>0italic-ϱ0\\\\varrho>0 and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}. By [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), if αn<ρ<ρcrit2−βn𝛼𝑛𝜌subscript𝜌crit2𝛽𝑛\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}, then with probability at least 1−δ1𝛿1-\\\\delta, we have for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, R^ρ​(f)≥Rρ−αn​(f)subscript^𝑅𝜌𝑓subscript𝑅𝜌𝛼𝑛𝑓\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f), hence the result.\\\n∎\\\n\\\nThe next result corresponds to the generalization guarantee for WDRO with double regularization, [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n###### Theorem E.2(Generalization guarantee, regularized WDRO).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exists λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | max⁡{mc,ατ,ϵn}<ρ<ρcritτ,ϵ2−βτ,ϵnsubscript𝑚𝑐superscript𝛼𝜏italic-ϵ𝑛𝜌superscriptsubscript𝜌crit𝜏italic-ϵ2superscript𝛽𝜏italic-ϵ𝑛\\\\max\\\\left\\\\{m\\_{c},\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}\\\\right\\\\}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}-\\\\frac{\\\\beta^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}} |  |\\\n\\\nwhere\\\n\\\n- •\\\n\\\n\\\nατ,ϵ=48(∥ℱ∥∞+1λlowτ,ϵ+2​‖ℱ‖∞​mc​ϵϵ​(ρ−mc)+2​τ​‖ℱ‖∞)(ℐ(ℱ,∥⋅∥∞)+2λlowτ,ϵ)+(2​‖ℱ‖∞λlowτ,ϵ+mc)2​log⁡2δ\\\\alpha^{\\\\tau,\\\\epsilon}=48\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}\\\\epsilon}{\\\\epsilon(\\\\rho-m\\_{c})+2\\\\tau\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}\\\\right)\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}\\\\right)+\\\\left(\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\\right)\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}\\\n\\\n- •\\\n\\\n\\\nβτ,ϵ=96ℐ(ℱ,∥⋅∥∞)λlowτ,ϵ+4​(‖ℱ‖∞λlowτ,ϵ+mc)​2​log⁡4δ\\\\beta^{\\\\tau,\\\\epsilon}=\\\\frac{96\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+4\\\\left(\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\\right)\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}},\\\n\\\n\\\nthen with probability at least 1−δ1𝛿1-\\\\delta, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ρτ,ϵ​(f)≥Rρ−ατ,ϵnτ,ϵ​(f)≥𝔼ζ∼Q​\\[f​(ζ)\\]−ϵ​KL⁡(πP,Q∥π0)superscriptsubscript^𝑅𝜌𝜏italic-ϵ𝑓superscriptsubscript𝑅𝜌superscript𝛼𝜏italic-ϵ𝑛𝜏italic-ϵ𝑓subscript𝔼similar-to𝜁𝑄delimited-\\[\\]𝑓𝜁italic-ϵKLconditionalsuperscript𝜋𝑃𝑄subscript𝜋0\\\\widehat{R}\\_{\\\\rho}^{\\\\tau,\\\\epsilon}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}}^{\\\\tau,\\\\epsilon}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0}) |  |\\\n\\\nwhenever Wcτ​(P,Q)≤ρsubscriptsuperscript𝑊𝜏𝑐𝑃𝑄𝜌W^{\\\\tau}\\_{c}(P,Q)\\\\leq\\\\rho.\\\n\\\n###### Proof.\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), let λlowτ,ϵ>0superscriptsubscript𝜆low𝜏italic-ϵ0\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}>0 be given by [PropositionE.2](https://ar5iv.org/html/2402.11981#A5.Thmproposition2 \"Proposition E.2 (Dual lower bound with high probability). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and assume ρ>mc𝜌subscript𝑚𝑐\\\\rho>m\\_{c}. As for standard WDRO, our goal is to apply [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and to compute its constants thanks to [LemmaC.3](https://ar5iv.org/html/2402.11981#A3.Thmlemma3 \"Lemma C.3 (Concentration conditions for regularized WDRO). ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). By [LemmaC.3](https://ar5iv.org/html/2402.11981#A3.Thmlemma3 \"Lemma C.3 (Concentration conditions for regularized WDRO). ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and taking λup=2​‖ℱ‖∞ρ−mcsubscript𝜆up2subscriptnormℱ𝜌subscript𝑚𝑐\\\\lambda\\_{\\\\operatorname{up}}=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}, we have the following constants:\\\n\\\n- •\\\n\\\n\\\nΦ=‖ℱ‖∞−(−‖ℱ‖∞−2​λlowτ,ϵ​mc)=2​(‖ℱ‖∞+λlowτ,ϵ​mc)Φsubscriptnormℱsubscriptnormℱ2superscriptsubscript𝜆low𝜏italic-ϵsubscript𝑚𝑐2subscriptnormℱsuperscriptsubscript𝜆low𝜏italic-ϵsubscript𝑚𝑐\\\\Phi=\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-(-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}m\\_{c})=2(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}m\\_{c})\\\n\\\n- •\\\n\\\n\\\nΨ=2​‖ℱ‖∞λlowτ,ϵ+mcΨ2subscriptnormℱsuperscriptsubscript𝜆low𝜏italic-ϵsubscript𝑚𝑐\\\\Psi=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\n\\\n- •\\\n\\\n\\\nλup=2​‖ℱ‖∞ρ−mcsubscript𝜆up2subscriptnormℱ𝜌subscript𝑚𝑐\\\\lambda\\_{\\\\operatorname{up}}=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}} and Lψ=‖ℱ‖∞+1λlowτ,ϵ+2​‖ℱ‖∞​mc​ϵϵ​(ρ−mc)+2​τ​‖ℱ‖∞subscript𝐿𝜓subscriptnormℱ1superscriptsubscript𝜆low𝜏italic-ϵ2subscriptnormℱsubscript𝑚𝑐italic-ϵitalic-ϵ𝜌subscript𝑚𝑐2𝜏subscriptnormℱL\\_{\\\\psi}=\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}\\\\epsilon}{\\\\epsilon(\\\\rho-m\\_{c})+2\\\\tau\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}.\\\n\\\n\\\nIn [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), ατ,ϵsuperscript𝛼𝜏italic-ϵ\\\\alpha^{\\\\tau,\\\\epsilon} corresponds to B​(δ)𝐵𝛿B(\\\\delta) and βτ,ϵsuperscript𝛽𝜏italic-ϵ\\\\beta^{\\\\tau,\\\\epsilon} corresponds to 2​C​(δ)λlowτ,ϵ2𝐶𝛿superscriptsubscript𝜆low𝜏italic-ϵ\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}. In this case, we have:\\\n\\\n- •\\\n\\\n\\\nατ,ϵ=48(∥ℱ∥∞+1λlowτ,ϵ+2​‖ℱ‖∞​mc​ϵϵ​(ρ−mc)+2​τ​‖ℱ‖∞)(ℐ(ℱ,∥⋅∥∞)+2λlowτ,ϵ)+(2​‖ℱ‖∞λlowτ,ϵ+mc)2​log⁡2δ\\\\alpha^{\\\\tau,\\\\epsilon}=48\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}\\\\epsilon}{\\\\epsilon(\\\\rho-m\\_{c})+2\\\\tau\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}\\\\right)\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}\\\\right)+\\\\left(\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\\right)\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}\\\n\\\n- •\\\n\\\n\\\nβτ,ϵ=2λlowτ,ϵ(48ℐ(ℱ,∥⋅∥∞)+2(∥ℱ∥∞+λlowτ,ϵmc)2​log⁡4δ)\\\\beta^{\\\\tau,\\\\epsilon}=\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}\\\\left(48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+2(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}m\\_{c})\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}\\\\right)\\\n\\\n\\\n\\\n\\\n\\\n=96ℐ(ℱ,∥⋅∥∞)λlowτ,ϵ+4​(‖ℱ‖∞λlowτ,ϵ+mc)​2​log⁡4δ\\\\quad\\\\quad=\\\\frac{96\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+4\\\\left(\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\\right)\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}.\\\n\\\n\\\nBy strong duality, [PropositionB.2](https://ar5iv.org/html/2402.11981#A2.Thmproposition2 \"Proposition B.2 (Strong duality, regularized WDRO). ‣ Appendix B Strong duality ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and by the dual upper-bound, [LemmaD.3](https://ar5iv.org/html/2402.11981#A4.Thmlemma3 \"Lemma D.3 (Upper bound for the regularized problem Lemma 4.5). ‣ D.2.2 Dual upper-bound ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), Rϱτ,ϵ​(f)superscriptsubscript𝑅italic-ϱ𝜏italic-ϵ𝑓R\\_{\\\\varrho}^{\\\\tau,\\\\epsilon}(f) and R^ϱτ,ϵ​(f)superscriptsubscript^𝑅italic-ϱ𝜏italic-ϵ𝑓\\\\widehat{R}\\_{\\\\varrho}^{\\\\tau,\\\\epsilon}(f) admit the representations\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Rϱτ,ϵ​(f)=infλ∈\\[0,λup){λ​ϱ+𝔼ξ∼P​\\[ϕτ,ϵ​(λ,f,ξ)\\]}superscriptsubscript𝑅italic-ϱ𝜏italic-ϵ𝑓subscriptinfimum𝜆0subscript𝜆up𝜆italic-ϱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉R\\_{\\\\varrho}^{\\\\tau,\\\\epsilon}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\varrho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} |  |\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ϱτ,ϵ​(f)=infλ∈\\[0,λup){λ​ϱ+𝔼ξ∼P^n​\\[ϕτ,ϵ​(λ,f,ξ)\\]},superscriptsubscript^𝑅italic-ϱ𝜏italic-ϵ𝑓subscriptinfimum𝜆0subscript𝜆up𝜆italic-ϱsubscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉\\\\widehat{R}\\_{\\\\varrho}^{\\\\tau,\\\\epsilon}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\varrho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  |\\\n\\\nfor any ϱ>0italic-ϱ0\\\\varrho>0 and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}. Recall that ρ>mc𝜌subscript𝑚𝑐\\\\rho>m\\_{c}. If furthermore ατ,ϵn<ρ<ρcritτ,ϵ2−βτ,ϵnsuperscript𝛼𝜏italic-ϵ𝑛𝜌superscriptsubscript𝜌crit𝜏italic-ϵ2superscript𝛽𝜏italic-ϵ𝑛\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}-\\\\frac{\\\\beta^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}, then with probability at least 1−δ1𝛿1-\\\\delta, we have for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, R^ρτ,ϵ​(f)≥Rρ−αnτ,ϵ​(f)superscriptsubscript^𝑅𝜌𝜏italic-ϵ𝑓superscriptsubscript𝑅𝜌𝛼𝑛𝜏italic-ϵ𝑓\\\\widehat{R}\\_{\\\\rho}^{\\\\tau,\\\\epsilon}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}^{\\\\tau,\\\\epsilon}(f) by [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). ‣ Problem’s constants. ‣ E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") hence we obtain the first inequality.\\\n\\\nNow, toward the second inequality, let Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) such that Wcτ​(P,Q)≤ρsubscriptsuperscript𝑊𝜏𝑐𝑃𝑄𝜌W^{\\\\tau}\\_{c}(P,Q)\\\\leq\\\\rho. Let πP,Q∈𝒫​(Ξ×Ξ)superscript𝜋𝑃𝑄𝒫ΞΞ\\\\pi^{P,Q}\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi) satisfying \\[πP,Q\\]1=Psubscriptdelimited-\\[\\]superscript𝜋𝑃𝑄1𝑃\\[\\\\pi^{P,Q}\\]\\_{1}=P, \\[πP,Q\\]2=Qsubscriptdelimited-\\[\\]superscript𝜋𝑃𝑄2𝑄\\[\\\\pi^{P,Q}\\]\\_{2}=Q and 𝔼(ξ,ζ)∼πP,Q​\\[c​(ξ,ζ)\\]+τ​KL⁡(πP,Q∥π0)=Wcτ​(P,Q)subscript𝔼similar-to𝜉𝜁superscript𝜋𝑃𝑄delimited-\\[\\]𝑐𝜉𝜁𝜏KLconditionalsuperscript𝜋𝑃𝑄subscript𝜋0subscriptsuperscript𝑊𝜏𝑐𝑃𝑄\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi^{P,Q}}\\[c(\\\\xi,\\\\zeta)\\]+\\\\tau\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0})=W^{\\\\tau}\\_{c}(P,Q). We finally obtain for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, Rρ−αn​(f)≥𝔼ζ∼Q​\\[f​(ζ)\\]−ϵ​KL⁡(πP,Q∥π0)subscript𝑅𝜌𝛼𝑛𝑓subscript𝔼similar-to𝜁𝑄delimited-\\[\\]𝑓𝜁italic-ϵKLconditionalsuperscript𝜋𝑃𝑄subscript𝜋0R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0}).\\\n\\\n∎\\\n\\\n## Appendix F Side remarks\\\n\\\nThis part contains results supporting various remarks made in the main text.\\\n\\\n### F.1 Interpretation of the critical radius in the regularized case.\\\n\\\nThe following result gives an interpretation of the critical radius ρcritτ,ϵsuperscriptsubscript𝜌crit𝜏italic-ϵ\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon} in regularized WDRO appearing in [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). We show that when the radius ρ𝜌\\\\rho is larger than this value, then some robust losses become degenerated. Precisely, they become independent of ρ𝜌\\\\rho and are equal to a regularized version of the worst-case loss maxΞ⁡fsubscriptΞ𝑓\\\\max\\_{\\\\Xi}f.\\\n\\\n###### Proposition F.1.\\\n\\\nAssume ρ>ρcritτ,ϵ𝜌superscriptsubscript𝜌crit𝜏italic-ϵ\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}. Then there exists f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} such that\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Rρτ,ϵ​(f)=supπ∈𝒫​(Ξ×Ξ)\\[π\\]1=P{𝔼ζ∼\\[π\\]2​\\[f​(ζ)\\]−ϵ​KL⁡(π∥π0)}.superscriptsubscript𝑅𝜌𝜏italic-ϵ𝑓subscriptsupremum𝜋𝒫ΞΞsubscriptdelimited-\\[\\]𝜋1𝑃subscript𝔼similar-to𝜁subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]𝑓𝜁italic-ϵKLconditional𝜋subscript𝜋0R\\_{\\\\rho}^{\\\\tau,\\\\epsilon}(f)=\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}. |  |\\\n\\\n###### Proof.\\\n\\\nIn the regularized case, we can verify that the critical radius has the expression\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | ρcritτ,ϵ=inff∈ℱ{𝔼ξ∼P​\\[𝔼ζ∼π0f/ϵ(⋅\\|ξ)​\\[τϵ​f​(ζ)+c​(ξ,ζ)\\]−τ​log⁡𝔼ζ∼π0(⋅\\|ξ)​ef​(ζ)ϵ\\]},\\\\displaystyle\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{f/\\\\epsilon}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau}{\\\\epsilon}f(\\\\zeta)+c(\\\\xi,\\\\zeta)\\\\right\\]-\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]\\\\right\\\\}, |  | (40) |\\\n\\\nsee for instance the proof of [LemmaD.2](https://ar5iv.org/html/2402.11981#A4.Thmlemma2 \"Lemma D.2. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Let f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} be arbitrary. Consider a coupling π∗∈𝒫​(Ξ×Ξ)superscript𝜋𝒫ΞΞ\\\\pi^{\\*}\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi) such that \\[π∗\\]1=Psubscriptdelimited-\\[\\]superscript𝜋1𝑃\\[\\\\pi^{\\*}\\]\\_{1}=P and π∗(⋅\\|ξ)=π0fϵ(⋅\\|ξ)\\\\pi^{\\*}(\\\\cdot\\|\\\\xi)=\\\\pi\\_{0}^{\\\\frac{f}{\\\\epsilon}}(\\\\cdot\\|\\\\xi) for almost all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi. We first verify that for a good choice of f𝑓f, it is included in the uncertainty set defining Rρτ,ϵ​(f)subscriptsuperscript𝑅𝜏italic-ϵ𝜌𝑓R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f).\\\n\\\nWe compute KL⁡(π∗∥π0)KLconditionalsuperscript𝜋subscript𝜋0\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0}). Below, we set Z​(ξ):=𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)ϵ\\]Z(\\\\xi):=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\].\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | KL⁡(π∗∥π0)KLconditionalsuperscript𝜋subscript𝜋0\\\\displaystyle\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0}) | =𝔼ξ∼P​\\[𝔼ζ∼π0fϵ(⋅\\|ξ)​\\[log⁡(ef​(ζ)ϵZ​(ξ))\\]\\]\\\\displaystyle=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f}{\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\log\\\\left(\\\\frac{e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}}{Z(\\\\xi)}\\\\right)\\\\right\\]\\\\right\\] |  |\\\n|  |  | =𝔼ξ∼P​\\[𝔼ζ∼π0fϵ(⋅\\|ξ)​\\[f​(ζ)ϵ\\]−log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)ϵ\\]\\]\\\\displaystyle=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f}{\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{f(\\\\zeta)}{\\\\epsilon}\\\\right\\]-\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]\\\\right\\] |  |\\\n|  |  | =𝔼(ξ,ζ)∼π∗​\\[f​(ζ)ϵ\\]−𝔼ξ∼P​\\[log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)ϵ\\]\\].\\\\displaystyle=\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi^{\\*}}\\\\left\\[\\\\frac{f(\\\\zeta)}{\\\\epsilon}\\\\right\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]\\\\right\\]. |  | (41) |\\\n\\\nThis leads to\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | 𝔼(ξ,ζ)∼π∗​\\[c​(ξ,ζ)\\]+τ​KL⁡(π∗∥π0)=𝔼ξ∼P​\\[𝔼ζ∼π0f/ϵ(⋅\\|ξ)​\\[τϵ​f​(ζ)+c​(ξ,ζ)\\]−τ​log⁡𝔼ζ∼π0(⋅\\|ξ)​ef​(ζ)ϵ\\]\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi^{\\*}}\\\\left\\[c(\\\\xi,\\\\zeta)\\\\right\\]+\\\\tau\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0})=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{f/\\\\epsilon}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau}{\\\\epsilon}f(\\\\zeta)+c(\\\\xi,\\\\zeta)\\\\right\\]-\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\] |  |\\\n\\\nwhich is the term in the infimum ( [40](https://ar5iv.org/html/2402.11981#A6.E40 \"Equation 40 ‣ Proof. ‣ F.1 Interpretation of the critical radius in the regularized case. ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Since f𝑓f was chosen arbitrary, this means that if ρ>ρcritτ,ϵ𝜌superscriptsubscript𝜌crit𝜏italic-ϵ\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}, then there exists f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} such that the coupling π∗superscript𝜋\\\\pi^{\\*} defined above (depending on f𝑓f) satisfies 𝔼(ξ,ζ)∼π∗​\\[c​(ξ,ζ)\\]+τ​KL⁡(π∗∥π0)≤ρsubscript𝔼similar-to𝜉𝜁superscript𝜋delimited-\\[\\]𝑐𝜉𝜁𝜏KLconditionalsuperscript𝜋subscript𝜋0𝜌\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi^{\\*}}\\\\left\\[c(\\\\xi,\\\\zeta)\\\\right\\]+\\\\tau\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0})\\\\leq\\\\rho, and we obtain\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Rρτ,ϵ​(f)≥𝔼ζ∼\\[π∗\\]2​\\[f​(ζ)\\]−ϵ​KL⁡(π∗∥π0).subscriptsuperscript𝑅𝜏italic-ϵ𝜌𝑓subscript𝔼similar-to𝜁subscriptdelimited-\\[\\]superscript𝜋2delimited-\\[\\]𝑓𝜁italic-ϵKLconditionalsuperscript𝜋subscript𝜋0R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi^{\\*}\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0}). |  |\\\n\\\nOn the other hand by the computation ( [F.1](https://ar5iv.org/html/2402.11981#A6.Ex124 \"Proof. ‣ F.1 Interpretation of the critical radius in the regularized case. ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we have\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Rρτ,ϵ​(f)≥𝔼ζ∼\\[π∗\\]2​\\[f​(ζ)\\]−ϵ​KL⁡(π∗∥π0)=ϵ​𝔼ξ∼P​\\[log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)ϵ\\]\\].R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi^{\\*}\\]\\_{2}}\\\\left\\[f(\\\\zeta)\\\\right\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0})=\\\\epsilon\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]\\\\right\\]. |  | (42) |\\\n\\\nBy Donsker-Varadhan variational formula \\[ [16](https://ar5iv.org/html/2402.11981#bib.bib16 \"\")\\], for almost all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi, we have\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | log𝔼ζ∼π0(⋅\\|ξ)\\[ef​(ζ)ϵ\\]=supν∈𝒫​(Ξ){𝔼ζ∼ν\\[f(ζ)/ϵ\\]−KL(ν∥π0(⋅\\|ξ))}.\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]=\\\\sup\\_{\\\\nu\\\\in\\\\mathcal{P}(\\\\Xi)}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\nu}\\[f(\\\\zeta)/\\\\epsilon\\]-\\\\operatorname{KL}(\\\\nu\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\\right\\\\}. |  | (43) |\\\n\\\nReinjecting ( [43](https://ar5iv.org/html/2402.11981#A6.E43 \"Equation 43 ‣ Proof. ‣ F.1 Interpretation of the critical radius in the regularized case. ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in ( [42](https://ar5iv.org/html/2402.11981#A6.E42 \"Equation 42 ‣ Proof. ‣ F.1 Interpretation of the critical radius in the regularized case. ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Rρτ,ϵ​(f)subscriptsuperscript𝑅𝜏italic-ϵ𝜌𝑓\\\\displaystyle R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f) | ≥ϵ𝔼ξ∼P\\[supν∈𝒫​(Ξ){𝔼ζ∼ν\\[f(ζ)/ϵ\\]−KL(ν∥π0(⋅\\|ξ))}\\]\\\\displaystyle\\\\geq\\\\epsilon\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\sup\\_{\\\\nu\\\\in\\\\mathcal{P}(\\\\Xi)}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\nu}\\[f(\\\\zeta)/\\\\epsilon\\]-\\\\operatorname{KL}(\\\\nu\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\\right\\\\}\\\\right\\] |  |\\\n|  |  | ≥supπ∈𝒫​(Ξ×Ξ)\\[π\\]1=P{𝔼ξ∼P\\[𝔼ζ∼π(⋅\\|ξ)\\[f(ζ)\\]−ϵKL(π(⋅\\|ξ)∥π0(⋅\\|ξ))\\]}\\\\displaystyle\\\\geq\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi(\\\\cdot\\|\\\\xi)}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi(\\\\cdot\\|\\\\xi)\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\\right\\]\\\\right\\\\} |  |\\\n|  |  | =supπ∈𝒫​(Ξ×Ξ)\\[π\\]1=P{𝔼ζ∼\\[π\\]2​\\[f​(ζ)\\]−ϵ​KL⁡(π∥π0)},absentsubscriptsupremum𝜋𝒫ΞΞsubscriptdelimited-\\[\\]𝜋1𝑃subscript𝔼similar-to𝜁subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]𝑓𝜁italic-ϵKLconditional𝜋subscript𝜋0\\\\displaystyle=\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}, |  |\\\n\\\nwhere we used the chain rule for KLKL\\\\operatorname{KL} divergence (see e.g. Theorem 2.15 in \\[ [29](https://ar5iv.org/html/2402.11981#bib.bib29 \"\")\\]): KL(π∥π0)=𝔼ξ∼P\\[KL(π(⋅\\|ξ)∥π0(⋅\\|ξ))\\]+KL(\\[π\\]1∥\\[π0\\]1)≥𝔼ξ∼P\\[KL(π(⋅\\|ξ)∥π0(⋅\\|ξ))\\]\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\operatorname{KL}(\\\\pi(\\\\cdot\\|\\\\xi)\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\]+\\\\operatorname{KL}(\\[\\\\pi\\]\\_{1}\\\\\\|\\[\\\\pi\\_{0}\\]\\_{1})\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\operatorname{KL}(\\\\pi(\\\\cdot\\|\\\\xi)\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\]. Since we clearly have Rρτ,ϵ​(f)≤supπ∈𝒫​(Ξ×Ξ)\\[π\\]1=P​{𝔼ζ∼\\[π\\]2​\\[f​(ζ)\\]−ϵ​KL⁡(π∥π0)}subscriptsuperscript𝑅𝜏italic-ϵ𝜌𝑓𝜋𝒫ΞΞsubscriptdelimited-\\[\\]𝜋1𝑃supremumsubscript𝔼similar-to𝜁subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]𝑓𝜁italic-ϵKLconditional𝜋subscript𝜋0R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\leq\\\\underset{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\\\\n\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}{\\\\sup}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}, this yields the result.\\\n∎\\\n\\\n### F.2 Necessity of the dual upper-bound\\\n\\\nWe exhibit an example where the function μ↦ψτ,ϵ​(μ,f,ξ)maps-to𝜇superscript𝜓𝜏italic-ϵ𝜇𝑓𝜉\\\\mu\\\\mapsto\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi) is not Lipschitz as μ→0→𝜇0\\\\mu\\\\to 0. This justifies the necessity of bounding the dual solution above in the regularized case, as done in [LemmaD.3](https://ar5iv.org/html/2402.11981#A4.Thmlemma3 \"Lemma D.3 (Upper bound for the regularized problem Lemma 4.5). ‣ D.2.2 Dual upper-bound ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\\\n\\\n###### Proposition F.2.\\\n\\\nConsider τ=0𝜏0\\\\tau=0, ϵ>0italic-ϵ0\\\\epsilon>0, Ξ=\\[0,1\\]Ξ01\\\\Xi=\\[0,1\\], c​(ξ,ζ)=\\|ξ−ζ\\|𝑐𝜉𝜁𝜉𝜁c(\\\\xi,\\\\zeta)=\\|\\\\xi-\\\\zeta\\| and assume that the reference distribution is a truncated Laplace π0​(d​ζ\\|ξ)∝e−\\|ξ−ζ\\|​𝟙\\[0,1\\]​(ζ)​d​ζproportional-tosubscript𝜋0conditionald𝜁𝜉superscript𝑒𝜉𝜁subscript101𝜁d𝜁\\\\pi\\_{0}(\\\\mathrm{d}\\\\zeta\\|\\\\xi)\\\\propto e^{-\\|\\\\xi-\\\\zeta\\|}\\\\mathds{1}\\_{\\[0,1\\]}(\\\\zeta)\\\\mathrm{d}\\\\zeta. Assume furthermore ℱℱ\\\\mathcal{F} is a family of functions from \\[0,1\\]01\\[0,1\\] to ℝℝ\\\\mathbb{R} which satisfies e−2​‖ℱ‖∞ϵ≥ϵsuperscript𝑒2subscriptnormℱitalic-ϵitalic-ϵe^{-\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\geq\\\\epsilon.\\\n\\\nThen for almost all ξ∈\\[0,1\\]𝜉01\\\\xi\\\\in\\[0,1\\] and all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, μ↦ψτ,ϵ​(μ,f,ξ)maps-to𝜇superscript𝜓𝜏italic-ϵ𝜇𝑓𝜉\\\\mu\\\\mapsto\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi) is not Lipschitz at 0+superscript00^{+}.\\\n\\\n###### Proof.\\\n\\\nLet ξ∈(0,1)𝜉01\\\\xi\\\\in(0,1) and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}. The expression of the derivative of ψ0,ϵsuperscript𝜓0italic-ϵ\\\\psi^{0,\\\\epsilon} with respect to μ𝜇\\\\mu is given by ( [23](https://ar5iv.org/html/2402.11981#A3.E23 \"Equation 23 ‣ Proof. ‣ C.2 Regularized WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∂μψ0,ϵ​(μ,f,ξ)=𝔼ζ∼π0μ​f−c​(ξ,⋅)μ​ϵ(⋅\\|ξ)​\\[ϵ​c​(ξ,ζ)μ​ϵ\\]+ϵ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[eμ​f​(ζ)−c​(ξ,ζ)μ​ϵ\\].\\\\partial\\_{\\\\mu}\\\\psi^{0,\\\\epsilon}(\\\\mu,f,\\\\xi)=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}\\\\right\\]+\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}}\\\\right\\]. |  |\\\n\\\nIn particular, it satisfies\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | ∂μψ0,ϵ​(μ,f,ξ)≤e2​‖ℱ‖∞ϵ​𝔼ζ∼π0−c​(ξ,⋅)μ​ϵ(⋅\\|ξ)​\\[c​(ξ,ζ)μ\\]+ϵ​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[e−c​(ξ,ζ)μ​ϵ\\]+‖ℱ‖∞.\\\\partial\\_{\\\\mu}\\\\psi^{0,\\\\epsilon}(\\\\mu,f,\\\\xi)\\\\leq e^{\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{-\\\\frac{c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{c(\\\\xi,\\\\zeta)}{\\\\mu}\\\\right\\]+\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{-\\\\frac{c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}}\\\\right\\]+\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}. |  | (44) |\\\n\\\nOn the other hand, by Donsker-Varadhan formula \\[ [16](https://ar5iv.org/html/2402.11981#bib.bib16 \"\")\\], we can write\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | log𝔼ζ∼π0(⋅\\|ξ)\\[e−c​(ξ,ζ)μ​ϵ\\]=𝔼ζ∼π0−c​(ξ,ζ)μ​ϵ(⋅\\|ξ)\\[−c​(ξ,ζ)μ​ϵ\\]−KL(π0−c​(ξ,⋅)μ​ϵ(⋅\\|ξ)∥π0(⋅\\|ξ)).\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}}\\\\right\\]=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}\\\\right\\]-\\\\operatorname{KL}\\\\left(\\\\pi\\_{0}^{\\\\frac{-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)\\\\middle\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\right). |  |\\\n\\\nReinjecting this in ( [44](https://ar5iv.org/html/2402.11981#A6.E44 \"Equation 44 ‣ Proof. ‣ F.2 Necessity of the dual upper-bound ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and using e−2​‖ℱ‖∞ϵ≥ϵsuperscript𝑒2subscriptnormℱitalic-ϵitalic-ϵe^{-\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\geq\\\\epsilon gives\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∂μψτ,ϵ(μ,f,ξ)≤∥ℱ∥∞−KL(π0−c​(ξ,⋅)μ​ϵ(⋅\\|ξ)∥π0(⋅\\|ξ)).\\\\partial\\_{\\\\mu}\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi)\\\\leq\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\operatorname{KL}\\\\left(\\\\pi\\_{0}^{-\\\\frac{c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)\\\\middle\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\right). |  |\\\n\\\nConsequently, to prove non-Lipschitzness of ψ0,ϵ​(⋅,f,ξ)superscript𝜓0italic-ϵ⋅𝑓𝜉\\\\psi^{0,\\\\epsilon}(\\\\cdot,f,\\\\xi) at 00, we show that\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | KL(π0−c​(ξ,⋅)μ​ϵ(⋅\\|ξ)∥π0(⋅\\|ξ))→∞\\\\operatorname{KL}\\\\left(\\\\pi\\_{0}^{-\\\\frac{c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)\\\\middle\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\right)\\\\to\\\\infty |  |\\\n\\\nas μ→0→𝜇0\\\\mu\\\\to 0.\\\nWe show that π0−\\|ξ−⋅\\|μ​ϵ(⋅\\|ξ)\\\\pi\\_{0}^{-\\\\frac{\\|\\\\xi-\\\\cdot\\|}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi) converges in law to δξsubscript𝛿𝜉\\\\delta\\_{\\\\xi}. Let φ:ℝ→ℝ:𝜑→ℝℝ\\\\varphi:\\\\mathbb{R}\\\\to\\\\mathbb{R} be of class C∞superscript𝐶C^{\\\\infty} with compact support. With the change of variable u←ξ−ζμ​ϵ←𝑢𝜉𝜁𝜇italic-ϵu\\\\leftarrow\\\\frac{\\\\xi-\\\\zeta}{\\\\mu\\\\epsilon}, we have\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∫01e−\\|ξ−ζ\\|μ​ϵ​φ​(ζ)​dζ=μ​ϵ​∫ℝ𝟙\\[ξ−1μ​ϵ,ξμ​ϵ\\]​(u)​e−\\|u\\|​φ​(ξ+μ​ϵ​u)​du.superscriptsubscript01superscript𝑒𝜉𝜁𝜇italic-ϵ𝜑𝜁differential-d𝜁𝜇italic-ϵsubscriptℝsubscript1𝜉1𝜇italic-ϵ𝜉𝜇italic-ϵ𝑢superscript𝑒𝑢𝜑𝜉𝜇italic-ϵ𝑢differential-d𝑢\\\\int\\_{0}^{1}e^{-\\\\frac{\\|\\\\xi-\\\\zeta\\|}{\\\\mu\\\\epsilon}}\\\\varphi(\\\\zeta)\\\\mathrm{d}\\\\zeta=\\\\mu\\\\epsilon\\\\int\\_{\\\\mathbb{R}}\\\\mathds{1}\\_{\\\\left\\[\\\\frac{\\\\xi-1}{\\\\mu\\\\epsilon},\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}\\\\right\\]}(u)e^{-\\|u\\|}\\\\varphi(\\\\xi+\\\\mu\\\\epsilon u)\\\\mathrm{d}u. |  |\\\n\\\nAlso, we easily verify that\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∫01e−\\|ξ−ζ\\|μ​ϵ​dζ=∫0ξe−ξ−ζμ​ϵ​dζ+∫ξ1e−ζ−ξμ​ϵ​dζ=μ​ϵ​(2−e−ξμ​ϵ−e−(1−ξ)μ​ϵ),superscriptsubscript01superscript𝑒𝜉𝜁𝜇italic-ϵdifferential-d𝜁superscriptsubscript0𝜉superscript𝑒𝜉𝜁𝜇italic-ϵdifferential-d𝜁superscriptsubscript𝜉1superscript𝑒𝜁𝜉𝜇italic-ϵdifferential-d𝜁𝜇italic-ϵ2superscript𝑒𝜉𝜇italic-ϵsuperscript𝑒1𝜉𝜇italic-ϵ\\\\int\\_{0}^{1}e^{-\\\\frac{\\|\\\\xi-\\\\zeta\\|}{\\\\mu\\\\epsilon}}\\\\mathrm{d}\\\\zeta=\\\\int\\_{0}^{\\\\xi}e^{-\\\\frac{\\\\xi-\\\\zeta}{\\\\mu\\\\epsilon}}\\\\mathrm{d}\\\\zeta+\\\\int\\_{\\\\xi}^{1}e^{-\\\\frac{\\\\zeta-\\\\xi}{\\\\mu\\\\epsilon}}\\\\mathrm{d}\\\\zeta=\\\\mu\\\\epsilon(2-e^{-\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}}-e^{\\\\frac{-(1-\\\\xi)}{\\\\mu\\\\epsilon}}), |  |\\\n\\\nhence we obtain\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | 𝔼ζ∼π0−\\|ξ−⋅\\|μ​ϵ​\\[φ​(ζ)\\]=∫ℝ𝟙\\[ξ−1μ​ϵ,ξμ​ϵ\\]​(u)​e−\\|u\\|​φ​(ξ+μ​ϵ​u)​du2−e−ξμ​ϵ−e−(1−ξ)μ​ϵ.\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{-\\\\frac{\\|\\\\xi-\\\\cdot\\|}{\\\\mu\\\\epsilon}}}\\[\\\\varphi(\\\\zeta)\\]=\\\\frac{\\\\int\\_{\\\\mathbb{R}}\\\\mathds{1}\\_{\\\\left\\[\\\\frac{\\\\xi-1}{\\\\mu\\\\epsilon},\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}\\\\right\\]}(u)e^{-\\|u\\|}\\\\varphi(\\\\xi+\\\\mu\\\\epsilon u)\\\\mathrm{d}u}{2-e^{-\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}}-e^{\\\\frac{-(1-\\\\xi)}{\\\\mu\\\\epsilon}}}. |  | (45) |\\\n\\\nWe then have the following:\\\n\\\n- •\\\n\\\n\\\n2−e−ξμ​ϵ−e−(1−ξ)μ​ϵ2superscript𝑒𝜉𝜇italic-ϵsuperscript𝑒1𝜉𝜇italic-ϵ2-e^{-\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}}-e^{\\\\frac{-(1-\\\\xi)}{\\\\mu\\\\epsilon}} converges to 222 as μ→0→𝜇0\\\\mu\\\\to 0,\\\n\\\n- •\\\n\\\n\\\nFor all u∈ℝ𝑢ℝu\\\\in\\\\mathbb{R}, 𝟙\\[ξ−1μ​ϵ,ξμ​ϵ\\]​(u)​e−\\|u\\|​φ​(ξ+μ​ϵ​u)​d​usubscript1𝜉1𝜇italic-ϵ𝜉𝜇italic-ϵ𝑢superscript𝑒𝑢𝜑𝜉𝜇italic-ϵ𝑢d𝑢\\\\mathds{1}\\_{\\\\left\\[\\\\frac{\\\\xi-1}{\\\\mu\\\\epsilon},\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}\\\\right\\]}(u)e^{-\\|u\\|}\\\\varphi(\\\\xi+\\\\mu\\\\epsilon u)\\\\mathrm{d}u converges to e−\\|u\\|​φ​(ξ)superscript𝑒𝑢𝜑𝜉e^{-\\|u\\|}\\\\varphi(\\\\xi) as μ→0→𝜇0\\\\mu\\\\to 0, hence its integral with respect to u𝑢u converges to 2​φ​(ξ)2𝜑𝜉2\\\\varphi(\\\\xi) by dominated convergence theorem.\\\n\\\n\\\nCombining both limits in ( [45](https://ar5iv.org/html/2402.11981#A6.E45 \"Equation 45 ‣ Proof. ‣ F.2 Necessity of the dual upper-bound ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives 𝔼ζ∼π0−\\|ξ−⋅\\|μ​ϵ(⋅\\|ξ)​\\[φ​(ζ)\\]→φ​(ξ)\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{-\\\\frac{\\|\\\\xi-\\\\cdot\\|}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\[\\\\varphi(\\\\zeta)\\]\\\\to\\\\varphi(\\\\xi). This means that π0−\\|ξ−⋅\\|μ​ϵ(⋅\\|ξ)\\\\pi\\_{0}^{-\\\\frac{\\|\\\\xi-\\\\cdot\\|}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi) converges in law to δξsubscript𝛿𝜉\\\\delta\\_{\\\\xi}. We have KL(δξ∥π0(⋅\\|ξ))=∞\\\\operatorname{KL}(\\\\delta\\_{\\\\xi}\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))=\\\\infty, hence by lower semicontinuity of the KLKL\\\\operatorname{KL}-divergence for the convergence in law (or weak convergence), see e.g. Theorem 4.9 from \\[ [29](https://ar5iv.org/html/2402.11981#bib.bib29 \"\")\\], we obtain KL(π0−c​(ξ,⋅)μ​ϵ(⋅\\|ξ)∥π0(⋅\\|ξ))⟶μ→0∞\\\\operatorname{KL}\\\\left(\\\\pi\\_{0}^{-\\\\frac{c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)\\\\middle\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\right)\\\\underset{\\\\mu\\\\to 0}{\\\\longrightarrow}\\\\infty. This means that ψ0,ϵ​(⋅,f,ξ)superscript𝜓0italic-ϵ⋅𝑓𝜉\\\\psi^{0,\\\\epsilon}(\\\\cdot,f,\\\\xi) is not Lipschitz near 00.\\\n∎\\\n\\\n### F.3 On the compactness condition, Assumption 5.1 from \\[5\\]\\\n\\\nWe justify the importance of relaxing Assumption 5.1 from \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] which corresponds to compactness of ℱℱ\\\\mathcal{F} with respect to the distance Dℱ​(f,g):=‖f−g‖∞+dH​(arg​maxΞ⁡f,arg​maxΞ⁡g)assignsubscript𝐷ℱ𝑓𝑔subscriptnorm𝑓𝑔subscript𝑑𝐻subscriptargmaxΞ𝑓subscriptargmaxΞ𝑔D\\_{\\\\mathcal{F}}(f,g):=\\\\\\|f-g\\\\\\|\\_{\\\\infty}+d\\_{H}(\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g). We show that this condition is actually equivalent to assuming continuity on f↦arg​max⁡fmaps-to𝑓argmax𝑓f\\\\mapsto\\\\operatorname\\*{arg\\\\,max}f, which is a strong condition and difficult to verify in practice.\\\n\\\n###### Proposition F.3.\\\n\\\nFor (f,g)∈ℱ×ℱ𝑓𝑔ℱℱ(f,g)\\\\in\\\\mathcal{F}\\\\times\\\\mathcal{F}, define\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Dℱ​(f,g):=‖f−g‖∞+dH​(arg​maxΞ⁡f,arg​maxΞ⁡g)assignsubscript𝐷ℱ𝑓𝑔subscriptnorm𝑓𝑔subscript𝑑𝐻subscriptargmaxΞ𝑓subscriptargmaxΞ𝑔D\\_{\\\\mathcal{F}}(f,g):=\\\\\\|f-g\\\\\\|\\_{\\\\infty}+d\\_{H}(\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g) |  |\\\n\\\nwhere dHsubscript𝑑𝐻d\\_{H} is the Hausdorff distance on the set of compact subsets of ΞΞ\\\\Xi, 𝒦​(Ξ)𝒦Ξ\\\\mathcal{K}(\\\\Xi) . Assume (ℱ,∥⋅∥∞)(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) is compact. Then we have the equivalence\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | (ℱ,Dℱ) is compact ⟺f↦arg​maxΞf is continuous from (ℱ,∥⋅∥∞) to (𝒦(Ξ),dH).(\\\\mathcal{F},D\\_{\\\\mathcal{F}})\\\\text{ is compact }\\\\Longleftrightarrow f\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\\\text{ is continuous from }(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\text{ to }(\\\\mathcal{K}(\\\\Xi),d\\_{H}). |  |\\\n\\\n###### Proof.\\\n\\\nWe prove (⇒)⇒(\\\\Rightarrow). Assume (ℱ,Dℱ)ℱsubscript𝐷ℱ(\\\\mathcal{F},D\\_{\\\\mathcal{F}}) is compact. Let f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, and let (gk)k∈ℕsubscriptsubscript𝑔𝑘𝑘ℕ(g\\_{k})\\_{k\\\\in\\\\mathbb{N}} be an arbitrary sequence from ℱℱ\\\\mathcal{F} such that gksubscript𝑔𝑘g\\_{k} converges to f𝑓f for ∥⋅∥∞\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. We want to show that arg​maxΞ⁡gksubscriptargmaxΞsubscript𝑔𝑘\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g\\_{k} converges to arg​maxΞ⁡fsubscriptargmaxΞ𝑓\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f for dHsubscript𝑑𝐻d\\_{H}, proving the continuity of the arg max map. By compactness of (ℱ,Dℱ)ℱsubscript𝐷ℱ(\\\\mathcal{F},D\\_{\\\\mathcal{F}}), (gk)k∈ℕsubscriptsubscript𝑔𝑘𝑘ℕ(g\\_{k})\\_{k\\\\in\\\\mathbb{N}} admits accumulation points for Dℱsubscript𝐷ℱD\\_{\\\\mathcal{F}}. Let hℎh be any one of them. We may extract a subsequence from (gk)k∈ℕsubscriptsubscript𝑔𝑘𝑘ℕ(g\\_{k})\\_{k\\\\in\\\\mathbb{N}} converging to hℎh, say gnk​→k→∞​h∈ℱsubscript𝑔subscript𝑛𝑘→𝑘→ℎℱg\\_{n\\_{k}}\\\\underset{k\\\\to\\\\infty}{\\\\to}h\\\\in\\\\mathcal{F}. In particular, gnksubscript𝑔subscript𝑛𝑘g\\_{n\\_{k}} converges to hℎh for ∥⋅∥∞\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. We necessarily have h=fℎ𝑓h=f by definition of the sequence (gk)k∈ℕsubscriptsubscript𝑔𝑘𝑘ℕ(g\\_{k})\\_{k\\\\in\\\\mathbb{N}}. It means that (gk)k∈ℕsubscriptsubscript𝑔𝑘𝑘ℕ(g\\_{k})\\_{k\\\\in\\\\mathbb{N}} admits only one possible accumulation point for Dℱsubscript𝐷ℱD\\_{\\\\mathcal{F}}, which is f𝑓f. This implies gksubscript𝑔𝑘g\\_{k} converges to f𝑓f for Dℱsubscript𝐷ℱD\\_{\\\\mathcal{F}}, hence arg​maxΞ⁡gksubscriptargmaxΞsubscript𝑔𝑘\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g\\_{k} converges to arg​maxΞ⁡fsubscriptargmaxΞ𝑓\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f.\\\n\\\nNow, we prove (⇐)⇐(\\\\Leftarrow). Let (fk)k∈ℕsubscriptsubscript𝑓𝑘𝑘ℕ(f\\_{k})\\_{k\\\\in\\\\mathbb{N}} be a sequence from ℱℱ\\\\mathcal{F}. By compactness of (ℱ,∥⋅∥∞)(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}), we may extract a converging subsequence fnk​→k→∞​fsubscript𝑓subscript𝑛𝑘→𝑘→𝑓f\\_{n\\_{k}}\\\\underset{k\\\\to\\\\infty}{\\\\to}f for ∥⋅∥∞\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. Assuming f↦arg​maxΞ⁡fmaps-to𝑓subscriptargmaxΞ𝑓f\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f is continuous gives that arg​maxΞ⁡fnksubscriptargmaxΞsubscript𝑓subscript𝑛𝑘\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\_{n\\_{k}} converges to arg​maxΞ⁡fsubscriptargmaxΞ𝑓\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f, which is the desired result.\\\n∎\\\n\\\n[◄](https://ar5iv.org/html/2402.11980) [![ar5iv homepage](https://ar5iv.org/assets/ar5iv.png)](https://ar5iv.org/) [Feeling\\\\\n\\\\\nlucky?](https://ar5iv.org/feeling_lucky) [Conversion\\\\\n\\\\\nreport](https://ar5iv.org/log/2402.11981) [Report\\\\\n\\\\\nan issue](https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2402.11981) [View original\\\\\n\\\\\non arXiv](https://arxiv.org/abs/2402.11981) [►](https://ar5iv.org/html/2402.11982)",
  "sections": {
    "1 Introduction": {
      "content": "### 1.1 Wasserstein robustness: models and generalization\n\nMachine learning models are challenged in practice by many obstacles,\nsuch as biases in data, adversarial attacks, or data shifts between training and deployment. Towards more resilient and reliable models, distributionally robust optimization has emerged as an attractive paradigm, where training no longer relies on minimizing the empirical risk, but rather on an optimization problem that takes into account potential perturbations in the data distribution; see e.g., the review articles \\[ [23], [9]\\].\n\nMore specifically, the approach consists in minimizing the worst-risk among all distributions in a neighborhood of the empirical data distribution. A natural way \\[ [27]\\] to define such a neighborhood is to use the optimal transport distance, called the Wasserstein distance \\[ [28]\\]. Between two distributions Q𝑄Q and Q′superscript𝑄′Q^{\\\\prime} on a sample space ΞΞ\\\\Xi, the Wasserstein distance is defined as the minimal expected cost among all coupling probability π𝜋\\\\pi on Ξ×ΞΞΞ\\\\Xi\\\\times\\\\Xi having Q𝑄Q and Q′superscript𝑄′Q^{\\\\prime} as marginals:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Wc​(Q,Q′):=infπ∈𝒫​(Ξ×Ξ)\\[π\\]1=Q,\\[π\\]2=Q′𝔼(ξ,ζ)∼π​\\[c​(ξ,ζ)\\],assignsubscript𝑊𝑐𝑄superscript𝑄′subscriptinfimum𝜋𝒫ΞΞformulae-sequencesubscriptdelimited-\\[\\]𝜋1𝑄subscriptdelimited-\\[\\]𝜋2superscript𝑄′subscript𝔼similar-to𝜉𝜁𝜋delimited-\\[\\]𝑐𝜉𝜁W\\_{c}(Q,Q^{\\\\prime}):=\\\\inf\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=Q,\\[\\\\pi\\]\\_{2}=Q^{\\\\prime}\\\\end{subarray}}\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi}\\[c(\\\\xi,\\\\zeta)\\], |  | (1) |\n\nwhere c:Ξ×Ξ→ℝ:𝑐→ΞΞℝc\\\\colon\\\\Xi\\\\times\\\\Xi\\\\rightarrow\\\\mathbb{R} is a transport cost over the sample space ΞΞ\\\\Xi. For a class of loss functions ℱℱ\\\\mathcal{F},\nthe Wasserstein distributionally robust counterpart of the standard empirical risk minimization then writes\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | minf∈ℱ⁡maxQ∈𝒫​(Ξ),Wc​(P^n,Q)≤ρ⁡𝔼ξ∼Q​\\[f​(ξ)\\],subscript𝑓ℱsubscriptformulae-sequence𝑄𝒫Ξsubscript𝑊𝑐subscript^𝑃𝑛𝑄𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]𝑓𝜉\\\\min\\_{f\\\\in\\\\mathcal{F}}~{}~{}\\\\max\\_{Q\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(\\\\widehat{P}\\_{n},Q)\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[f(\\\\xi)\\], |  | (2) |\n\nfor a chosen radius ρ𝜌\\\\rho of the Wasserstein ball centered at the empirical data distribution, denoted P^nsubscript^𝑃𝑛\\\\widehat{P}\\_{n}. In the degenerate case\nρ=0𝜌0\\\\rho=0, we have Q=P^n𝑄subscript^𝑃𝑛Q=\\\\widehat{P}\\_{n} and ( [2], [35], [39], [24], [26], [36], [20], [4], [7]\\].\n\nTo support theoretically the modeling versatility and the practical success of these robust models, some statistical guarantees have been proposed in the literature.\nFor a population distribution P𝑃P, i.i.d. samples ξ1,…,ξnsubscript𝜉1…subscript𝜉𝑛\\\\xi\\_{1},\\\\ldots,\\\\xi\\_{n} drawn from P𝑃P,\nand the associated empirical distribution\nP^n:=1n​∑i=1nδξiassignsubscript^𝑃𝑛1𝑛superscriptsubscript𝑖1𝑛subscript𝛿subscript𝜉𝑖\\\\widehat{P}\\_{n}:=\\\\frac{1}{n}\\\\sum\\_{i=1}^{n}\\\\delta\\_{\\\\xi\\_{i}},\nthe best concentration results for the Wasserstein distance \\[ [18]\\]\ngives that if the radius ρ𝜌\\\\rho is large enough, then the Wasserstein ball around P^nsubscript^𝑃𝑛\\\\widehat{P}\\_{n} contains the true distribution P𝑃P with high probability, which in turn gives directly \\[ [27]\\] a generalization bound of the form\n\n![Refer to caption]Figure 1: Probability of the generalization bound ( [3]Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to hold, estimated from 500 logistic regression instances and their ℓ1subscriptℓ1\\\\ell\\_{1}-robust counterparts (see at the end of [Section3]Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). For large ρ𝜌\\\\rho, the bound always holds, whereas it does not for small ρ𝜌\\\\rho. Our aim is to quantify this phenomenon, which is not explained by existing results.\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | maxQ∈𝒫​(Ξ),Wc​(P^n,Q)≤ρ⁡𝔼ξ∼Q​\\[f​(ξ)\\]≥𝔼ξ∼P​\\[f​(ξ)\\].subscriptformulae-sequence𝑄𝒫Ξsubscript𝑊𝑐subscript^𝑃𝑛𝑄𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]𝑓𝜉subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑓𝜉\\\\max\\_{Q\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(\\\\widehat{P}\\_{n},Q)\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[f(\\\\xi)\\]\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\]. |  | (3) |\n\nThis exact bound is particularly attractive: the quantity that we compute from data and optimize by training provides a control on the idealistic population risk. However, the direct application of \\[ [18]\\] requires a number of training samples growing exponentially in the dimension.\n\nRecent works have improved this direct approach by establishing, in various situations, generalization bounds that do not suffer from the curse of dimensionality, and rather feature radius ρ𝜌\\\\rho scaling as O​(1/n)𝑂1𝑛O(1/\\\\sqrt{n})\\[ [35], [10], [3], [19], [5], [11]\\]. Yet no existing result is general enough to cover all situations encountered in machine learning and to explain nice generalization properties usually observed in practice (as illustrated in [Figure1]In 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n\n### 1.2 Contributions and outline\n\nIn this paper, we provide exact generalization guarantees of the form ( [3]Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), that are universal, in the sense that they apply to all machine learning situations, without restrictive assumptions. Indeed, our results apply to any kind of data lying in a metric space (e.g. classification and regression tasks with mixed features), as well as general classes of continuous loss functions (e.g. from standard regression tasks to deep learning models).\n\nWe prove these universal results by dealing directly with the nonsmoothness of the robust objective function ( [2]Equation 2 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) that we tackle with\ntools from variational analysis \\[ [14], [31], [1]\\].\nAs a nice outcome of this approach, our results are able to cover deep learning models involving nonsmooth elementary blocks, such as the popular ReLUReLU\\\\operatorname{ReLU} activation function, the max-pooling operator, or optimization layers \\[ [2]\\]. Moreover, our approach is systematic enough to extend to the recent versions of Wasserstein distributionally robust problems that involve (double) regularizations \\[ [6], [38]\\].\n\nThe paper is structured as follows.\nFirst, [Section2]Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") introduces and illustrates the setting of this work. Then [Section3]Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") presents and discusses the main results (Theorems [3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2]Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n[Section4]Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") highlights our proof techniques, combining classical concentration lemma and advanced nonsmooth analysis aspects.\nFinally, [Section5]On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") sheds some light on generalization constants and other quantities of interest appearing in the results and the proof. We differ, to the supplementary, the proofs of the succession of lemmas, as well as complementary results discussing technical assumptions of existing works.\n\n### 1.3 Related work\n\nOur work stands out from a recent line of research establishing generalization guarantees for Wasserstein distributionally robust models, breaking the curse of dimensionality.\nNotably, important results on the topic include \\[ [10], [11]\\] about asymptotical results for smooth losses, and \\[ [13], [34]\\] about non-asymptotically results for linear models and for smooth loss functions.\nFor nonsmooth losses, the only work we are aware of is \\[ [3]\\] which derives results on piece-wise smooth losses (at the cost of abstract approximating constants).\nWe underline that none of existing results covers deep learning models involving nonsmooth elementary blocks.\n\nThe closest work to our paper is \\[ [5]\\] which establishes generalization results similar to ours, namely: exact bounds ( [3]Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in a regime where ρ>O​(1/n)𝜌𝑂1𝑛\\\\rho>O(1/\\\\sqrt{n}). In sharp contrast with our work though, these results rely on a restrictive context and some needless assumptions (the squared norm for c𝑐c, a Gaussian reference distribution, additional growth conditions, and abstract compactness conditions111We show in [PropositionF.3]Proposition F.3. ‣ F.3 On the compactness condition, Assumption 5.1 from [5] ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary that the compactness assumptions hide strong conditions on the maximizers.). Throughout our developments, we will point out further technical differences with this work.\n\n### 1.4 Notations\n\n##### On probability spaces.\n\nGiven a measurable space ΞΞ\\\\Xi, we denote the space of probability measures on ΞΞ\\\\Xi by 𝒫​(Ξ)𝒫Ξ\\\\mathcal{P}(\\\\Xi). For all π∈𝒫​(Ξ×Ξ)𝜋𝒫ΞΞ\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi), i∈{1,2}𝑖12i\\\\in\\\\{1,2\\\\}, we denote the ithsuperscript𝑖thi^{\\\\text{th}} marginal of π𝜋\\\\pi by \\[π\\]isubscriptdelimited-\\[\\]𝜋𝑖\\[\\\\pi\\]\\_{i}. We denote the Dirac mass at ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi by δξsubscript𝛿𝜉\\\\delta\\_{\\\\xi}. Given a measurable function g:Ξ→ℝ:𝑔→Ξℝg:\\\\Xi\\\\to\\\\mathbb{R}, we denote the expectation of g𝑔g with respect to Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) by 𝔼ξ∼Q​\\[g​(ξ)\\]subscript𝔼similar-to𝜉𝑄delimited-\\[\\]𝑔𝜉\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[g(\\\\xi)\\] and we may also use the shorthand 𝔼Q​\\[f\\]subscript𝔼𝑄delimited-\\[\\]𝑓\\\\mathbb{E}\\_{Q}\\[f\\].\n\n##### On function spaces.\n\nIn (𝒳,dist)𝒳dist(\\\\mathcal{X},\\\\operatorname{dist}) a metric space, the uniform norm of a function f𝑓f is ‖f‖∞=supx∈𝒳\\|f​(x)\\|subscriptnorm𝑓subscriptsupremum𝑥𝒳𝑓𝑥\\\\\\|f\\\\\\|\\_{\\\\infty}=\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\|f(x)\\|. If ℱℱ\\\\mathcal{F} is a family of functions, we denote ‖ℱ‖∞=supf∈ℱ‖f‖∞subscriptnormℱsubscriptsupremum𝑓ℱsubscriptnorm𝑓\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}=\\\\sup\\_{f\\\\in\\\\mathcal{F}}\\\\\\|f\\\\\\|\\_{\\\\infty}. We say f𝑓f is _Lipschitz_ with constant L𝐿L if for all x,y∈𝒳𝑥𝑦𝒳x,y\\\\in\\\\mathcal{X}, \\|f​(x)−f​(y)\\|≤L​dist⁡(x,y)𝑓𝑥𝑓𝑦𝐿dist𝑥𝑦\\|f(x)-f(y)\\|\\\\leq L\\\\operatorname{dist}(x,y). For ϕ:ℝ×𝒳→ℝ:italic-ϕ→ℝ𝒳ℝ\\\\phi\\\\colon\\\\mathbb{R}\\\\times\\\\mathcal{X}\\\\to\\\\mathbb{R}, we denote ∂λ+ϕsubscriptsuperscript𝜆italic-ϕ\\\\partial^{+}\\_{\\\\lambda}\\\\phi the right-sided derivative with respect to λ∈ℝ𝜆ℝ\\\\lambda\\\\in\\\\mathbb{R}, and ∂λϕsubscript𝜆italic-ϕ\\\\partial\\_{\\\\lambda}\\\\phi its derivative, whenever well-defined.",
      "citations": [
        {
          "start_pos": 553,
          "end_pos": 557,
          "text": "[23]",
          "paper_id": "bib.bib23",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 559,
          "end_pos": 562,
          "text": "[9]",
          "paper_id": "bib.bib9",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 732,
          "end_pos": 736,
          "text": "[27]",
          "paper_id": "bib.bib27",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 846,
          "end_pos": 850,
          "text": "[28]",
          "paper_id": "bib.bib28",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 2495,
          "end_pos": 2498,
          "text": "[2]",
          "paper_id": "bib.bib33",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2500,
          "end_pos": 2504,
          "text": "[35]",
          "paper_id": "bib.bib35",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2506,
          "end_pos": 2510,
          "text": "[39]",
          "paper_id": "bib.bib39",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2512,
          "end_pos": 2516,
          "text": "[24]",
          "paper_id": "bib.bib24",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2518,
          "end_pos": 2522,
          "text": "[26]",
          "paper_id": "bib.bib26",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2524,
          "end_pos": 2528,
          "text": "[36]",
          "paper_id": "bib.bib36",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2530,
          "end_pos": 2534,
          "text": "[20]",
          "paper_id": "bib.bib20",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2536,
          "end_pos": 2539,
          "text": "[4]",
          "paper_id": "bib.bib4",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2541,
          "end_pos": 2544,
          "text": "[7]",
          "paper_id": "bib.bib7",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 3093,
          "end_pos": 3097,
          "text": "[18]",
          "paper_id": "bib.bib18",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 3306,
          "end_pos": 3310,
          "text": "[27]",
          "paper_id": "bib.bib27",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 4610,
          "end_pos": 4614,
          "text": "[18]",
          "paper_id": "bib.bib18",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 4931,
          "end_pos": 4935,
          "text": "[35]",
          "paper_id": "bib.bib35",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4937,
          "end_pos": 4941,
          "text": "[10]",
          "paper_id": "bib.bib10",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4943,
          "end_pos": 4946,
          "text": "[3]",
          "paper_id": "bib.bib3",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4948,
          "end_pos": 4952,
          "text": "[19]",
          "paper_id": "bib.bib19",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4954,
          "end_pos": 4957,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4959,
          "end_pos": 4963,
          "text": "[11]",
          "paper_id": "bib.bib11",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6327,
          "end_pos": 6331,
          "text": "[14]",
          "paper_id": "bib.bib14",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6333,
          "end_pos": 6337,
          "text": "[31]",
          "paper_id": "bib.bib31",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6339,
          "end_pos": 6342,
          "text": "[1]",
          "paper_id": "bib.bib1",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6594,
          "end_pos": 6597,
          "text": "[2]",
          "paper_id": "bib.bib2",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 6767,
          "end_pos": 6770,
          "text": "[6]",
          "paper_id": "bib.bib6",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6772,
          "end_pos": 6776,
          "text": "[38]",
          "paper_id": "bib.bib38",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8479,
          "end_pos": 8483,
          "text": "[10]",
          "paper_id": "bib.bib10",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8485,
          "end_pos": 8489,
          "text": "[11]",
          "paper_id": "bib.bib11",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8545,
          "end_pos": 8549,
          "text": "[13]",
          "paper_id": "bib.bib13",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8551,
          "end_pos": 8555,
          "text": "[34]",
          "paper_id": "bib.bib34",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8698,
          "end_pos": 8701,
          "text": "[3]",
          "paper_id": "bib.bib3",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 8952,
          "end_pos": 8955,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "2 Assumption and examples": {
      "content": "In this section, we present the general framework illustrated by standard examples.\nThroughout the paper, we will make the following assumptions on the sample space ΞΞ\\\\Xi, the transport cost of the Wasserstein distance, and the space ℱℱ\\\\mathcal{F} of loss functions from ΞΞ\\\\Xi to ℝℝ\\\\mathbb{R}.\n\n###### Assumption 2.1.\n\n- •\n\n\n(Ξ,d)Ξ𝑑(\\\\Xi,d) is a compact metric space.\n\n- •\n\n\nc:Ξ×Ξ→ℝ:𝑐→ΞΞℝc:\\\\Xi\\\\times\\\\Xi\\\\to\\\\mathbb{R} is jointly continuous with respect to d𝑑d, non-negative and c​(ξ,ζ)=0𝑐𝜉𝜁0c(\\\\xi,\\\\zeta)=0 if and only if ξ=ζ𝜉𝜁\\\\xi=\\\\zeta.\n\n- •\n\n\n(ℱ,∥⋅∥∞)(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) is compact and every f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} is continuous.\n\n\nThis setting encompasses a wide range of machine learning scenarios, as illustrated below.\n\n##### Sample space and transport costs.\n\nThe choice of the transport cost c𝑐c depends on the nature of the data and of the potential data uncertainty. For instance, if the variables are continuous with Ξ⊂ℝmΞsuperscriptℝ𝑚\\\\Xi\\\\subset\\\\mathbb{R}^{m}, we consider the distance d=∥⋅−⋅∥pd=\\\\\\|\\\\cdot-\\\\cdot\\\\\\|\\_{p} induced by ℓpsubscriptℓ𝑝\\\\ell\\_{p}-norm (p∈\\[1,∞\\]𝑝1p\\\\in\\[1,\\\\infty\\]) and the cost as a power (q∈\\[1,∞)𝑞1q\\\\in\\[1,\\\\infty)) of the distance\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | c​(ξ,ξ′)=‖ξ−ξ′‖pq.𝑐𝜉superscript𝜉′superscriptsubscriptnorm𝜉superscript𝜉′𝑝𝑞c(\\\\xi,\\\\xi^{\\\\prime})=\\\\\\|\\\\xi-\\\\xi^{\\\\prime}\\\\\\|\\_{p}^{q}. |  |\\\n\\\nIf the variables are discrete with Ξ⊂{1,…,J}mΞsuperscript1…𝐽𝑚\\\\Xi\\\\subset\\\\left\\\\{1,\\\\ldots,J\\\\right\\\\}^{m}, we consider the distance\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | d​(ξ,ξ′)=∑i=1m𝟙{ξi≠ξi′}𝑑𝜉superscript𝜉′superscriptsubscript𝑖1𝑚subscript1subscript𝜉𝑖superscriptsubscript𝜉𝑖′d(\\\\xi,\\\\xi^{\\\\prime})=\\\\sum\\_{i=1}^{m}\\\\mathds{1}\\_{\\\\left\\\\{\\\\xi\\_{i}\\\\neq\\\\xi\\_{i}^{\\\\prime}\\\\right\\\\}} |  |\\\n\\\nand the cost as a power of this distance.\\\nFinally, If we deal with mixed data, i.e. they contain both continuous and discrete variables, a sum of the previous costs can be considered. In classification, for instance, with the samples composed of features x∈ℝm𝑥superscriptℝ𝑚x\\\\in\\\\mathbb{R}^{m} and a target y∈{−1,1}𝑦11y\\\\in\\\\left\\\\{-1,1\\\\right\\\\}, we may take, for a chosen κ>0𝜅0\\\\kappa>0\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | c​((x,y),(x′,y′))=‖x−x′‖pq+κ​𝟙{y≠y′}𝑐𝑥𝑦superscript𝑥′superscript𝑦′superscriptsubscriptnorm𝑥superscript𝑥′𝑝𝑞𝜅subscript1𝑦superscript𝑦′c((x,y),(x^{\\\\prime},y^{\\\\prime}))=\\\\\\|x-x^{\\\\prime}\\\\\\|\\_{p}^{q}+\\\\kappa\\\\mathds{1}\\_{\\\\left\\\\{y\\\\neq y^{\\\\prime}\\\\right\\\\}} |  | (4) |\\\n\\\nwhich is obviously continuous with respect to\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | d​((x,y),(x′,y′))=‖x−x′‖p+𝟙{y≠y′}.𝑑𝑥𝑦superscript𝑥′superscript𝑦′subscriptnorm𝑥superscript𝑥′𝑝subscript1𝑦superscript𝑦′d((x,y),(x^{\\\\prime},y^{\\\\prime}))=\\\\\\|x-x^{\\\\prime}\\\\\\|\\_{p}+\\\\mathds{1}\\_{\\\\left\\\\{y\\\\neq y^{\\\\prime}\\\\right\\\\}}. |  | (5) |\\\n\\\nThis extends to mixed data with categorical, binary, and continuous variables; see e.g. \\[ [7]\\].\\\n\\\n##### Parametric models and loss functions.\\\n\\\nOur setting covers all standard machine learning models.\\\nConsider a parametric family ℱ={f​(θ,⋅):θ∈Θ}ℱconditional-set𝑓𝜃⋅𝜃Θ\\\\mathcal{F}=\\\\left\\\\{f(\\\\theta,\\\\cdot)\\ :\\ \\\\theta\\\\in\\\\Theta\\\\right\\\\},\\\nwhere the parameter space Θ⊂ℝpΘsuperscriptℝ𝑝\\\\Theta\\\\subset\\\\mathbb{R}^{p} compact and the loss function f:Θ×Ξ→ℝ:𝑓→ΘΞℝf\\\\colon\\\\Theta\\\\times\\\\Xi\\\\to\\\\mathbb{R} is jointly continuous. If ΞΞ\\\\Xi is compact, such a family is compact regarding ∥⋅∥∞\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. This situation covers regression models, k-means clustering, and neural networks.\\\nFor example: least-squares regression\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,(x,y))=(⟨θ,x⟩−y)2,Ξ⊂ℝm×ℝ,formulae-sequence𝑓𝜃𝑥𝑦superscript𝜃𝑥𝑦2Ξsuperscriptℝ𝑚ℝf(\\\\theta,(x,y))=(\\\\langle\\\\theta,x\\\\rangle-y)^{2},\\\\quad\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\mathbb{R}, |  |\\\n\\\nlogistic regression\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,(x,y))=log⁡(1+e−y​⟨θ,x⟩),Ξ⊂ℝm×{−1,1},formulae-sequence𝑓𝜃𝑥𝑦1superscript𝑒𝑦𝜃𝑥Ξsuperscriptℝ𝑚11f(\\\\theta,(x,y))=\\\\log\\\\left(1+e^{-y\\\\langle\\\\theta,x\\\\rangle}\\\\right),\\\\quad\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\{-1,1\\\\}, |  |\\\n\\\nand support vector machines with hinge loss\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,(x,y))=max⁡{0,1−y​⟨θ,x⟩},Ξ⊂ℝm×{−1,1}formulae-sequence𝑓𝜃𝑥𝑦01𝑦𝜃𝑥Ξsuperscriptℝ𝑚11f(\\\\theta,(x,y))=\\\\max\\\\left\\\\{0,1-y\\\\langle\\\\theta,x\\\\rangle\\\\right\\\\},\\\\hskip 8.00003pt\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\{-1,1\\\\} |  |\\\n\\\nNote that this function is not differentiable, due to the max term. The k-means model also introduces a non-differentiable loss function:\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,x)=mini∈{1,…,K}⁡‖θi−x‖22,Θ⊂ℝK×m,Ξ⊂ℝm.formulae-sequence𝑓𝜃𝑥subscript𝑖1…𝐾superscriptsubscriptnormsubscript𝜃𝑖𝑥22formulae-sequenceΘsuperscriptℝ𝐾𝑚Ξsuperscriptℝ𝑚f(\\\\theta,x)=\\\\min\\_{i\\\\in\\\\left\\\\{1,\\\\ldots,K\\\\right\\\\}}\\\\\\|\\\\theta\\_{i}-x\\\\\\|\\_{2}^{2},\\\\quad\\\\Theta\\\\subset\\\\mathbb{R}^{K\\\\times m}\\\\!,~{}\\\\Xi\\\\subset\\\\mathbb{R}^{m}. |  |\\\n\\\nFinally, most deep learning models fall in our setting. Indeed, they involve loss functions of the form\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | f​(θ,(x,y))=ℓ​(h​(θ,x),y),𝑓𝜃𝑥𝑦ℓℎ𝜃𝑥𝑦f(\\\\theta,(x,y))=\\\\ell(h(\\\\theta,x),y), |  |\\\n\\\nwhere ℓℓ\\\\ell is a dissimilarity measure, and hℎh is a parameterized prediction function, built as a composition of affine transformations (which are the parameters to train) with activation functions (see e.g. \\[ [22], [25], [30]\\]). Our setting is general enough to encompass all continuous activation functions, even non-differentiable ones (as ReLU=max⁡(0,⋅)ReLU0⋅\\\\operatorname{ReLU}=\\\\max(0,\\\\cdot))\\\nas well as other nonsmooth elementary blocks (as max-pooling \\[ [21]\\], sorting procedures \\[ [32]\\], and optimization layers \\[ [2]\\]).\\\nAs already underlined in introduction, these examples involving non-differentiable terms are not covered by existing results.\\\n\\",
      "citations": [
        {
          "start_pos": 2972,
          "end_pos": 2975,
          "text": "[7]",
          "paper_id": "bib.bib7",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 5453,
          "end_pos": 5457,
          "text": "[22]",
          "paper_id": "bib.bib22",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 5459,
          "end_pos": 5463,
          "text": "[25]",
          "paper_id": "bib.bib25",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 5465,
          "end_pos": 5469,
          "text": "[30]",
          "paper_id": "bib.bib30",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 5710,
          "end_pos": 5714,
          "text": "[21]",
          "paper_id": "bib.bib21",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 5740,
          "end_pos": 5744,
          "text": "[32]",
          "paper_id": "bib.bib32",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 5775,
          "end_pos": 5778,
          "text": "[2]",
          "paper_id": "bib.bib2",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "3 Main results\\": {
      "content": "\\\n### 3.1 Wasserstein robust models\\\n\\\nOur main result establishes a generalization bound ( [3]Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) for Wasserstein distributionally robust optimization (WDRO). Given a distribution Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) and a loss f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, the robust risk around Q𝑄Q with radius ρ>0𝜌0\\\\rho>0 is then defined as\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Rρ,Q​(f):=maxQ′∈𝒫​(Ξ),Wc​(Q,Q′)≤ρ⁡𝔼ξ∼Q′​\\[f​(ξ)\\].assignsubscript𝑅𝜌𝑄𝑓subscriptformulae-sequencesuperscript𝑄′𝒫Ξsubscript𝑊𝑐𝑄superscript𝑄′𝜌subscript𝔼similar-to𝜉superscript𝑄′delimited-\\[\\]𝑓𝜉R\\_{\\\\rho,Q}(f):=\\\\max\\_{Q^{\\\\prime}\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(Q,Q^{\\\\prime})\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q^{\\\\prime}}\\[f(\\\\xi)\\]. |  | (6) |\\\n\\\nIn particular, taking Q=P^n𝑄subscript^𝑃𝑛Q=\\\\widehat{P}\\_{n} and Q=P𝑄𝑃Q=P in the above expression, we consider the empirical robust risk, R^ρ​(f)subscript^𝑅𝜌𝑓\\\\widehat{R}\\_{\\\\rho}(f), and the true robust risk, Rρ​(f)subscript𝑅𝜌𝑓R\\_{\\\\rho}(f):\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^ρ​(f):=Rρ,P^n​(f)​ and ​Rρ​(f):=Rρ,P​(f).assignsubscript^𝑅𝜌𝑓subscript𝑅𝜌subscript^𝑃𝑛𝑓 and subscript𝑅𝜌𝑓assignsubscript𝑅𝜌𝑃𝑓\\\\widehat{R}\\_{\\\\rho}(f):=R\\_{\\\\rho,\\\\widehat{P}\\_{n}}(f)\\\\text{ \\\\quad and \\\\quad}R\\_{\\\\rho}(f):=R\\_{\\\\rho,P}(f). |  | (7) |\\\n\\\nOur generalization result states as follows:\\\n\\\n###### Theorem 3.1(Generalization guarantee for Wasserstein robust models).\\\n\\\nUnder [2.1]Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exist α,β>0𝛼𝛽0\\\\alpha,\\\\beta>0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | αn<ρ<ρcrit2−βn,𝛼𝑛𝜌subscript𝜌crit2𝛽𝑛\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}, |  |\\\n\\\nthen with probability at least 1−δ1𝛿1-\\\\delta,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ∀f∈ℱ,R^ρ​(f)≥𝔼ξ∼P​\\[f​(ξ)\\].formulae-sequencefor-all𝑓ℱsubscript^𝑅𝜌𝑓subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑓𝜉\\\\forall f\\\\in\\\\mathcal{F},\\\\quad\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\]. |  |\\\n\\\nThe quantity ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}} is a _critical radius_,\\\na relevant threshold that excludes degenerated problems and flat losses for which Rρ​(f)=maxΞ⁡fsubscript𝑅𝜌𝑓subscriptΞ𝑓R\\_{\\\\rho}(f)=\\\\max\\_{\\\\Xi}f. The exact generalization guarantee thus holds for a wide range of radius ρ𝜌\\\\rho, growing with the sample size between the two extreme cases 00 and ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}}. As in Theorem 3.1 from \\[ [5]\\], but adding the wide setting of [2.1]Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), the sample rates are dimension-free. The constants α𝛼\\\\alpha and β𝛽\\\\beta depend on the problem quantities, see [Section5]On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for a detailed discussion.\\\n\\\n### 3.2 Regularized Wasserstein robust models\\\n\\\nPart of the success of optimal transport in machine learning is the use of regularization, and specifically entropic regularization, opening the way to nice properties and efficient computational schemes \\[ [15], [28]\\]. Recall that the entropy-regularized Wasserstein distance writes, for a reference coupling π0∈𝒫​(Ξ×Ξ)subscript𝜋0𝒫ΞΞ\\\\pi\\_{0}\\\\in\\\\mathcal{P}(\\\\Xi\\\\!\\\\times\\\\!\\\\Xi)\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Wcτ​(P,Q)=infπ∈𝒫​(Ξ×Ξ)\\[π\\]1=P,\\[π2\\]=Q{𝔼π​\\[c\\]+τ​KL⁡(π∥π0)}subscriptsuperscript𝑊𝜏𝑐𝑃𝑄subscriptinfimum𝜋𝒫ΞΞformulae-sequencesubscriptdelimited-\\[\\]𝜋1𝑃delimited-\\[\\]subscript𝜋2𝑄subscript𝔼𝜋delimited-\\[\\]𝑐𝜏KLconditional𝜋subscript𝜋0W^{\\\\tau}\\_{c}(P,Q)=\\\\inf\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P,\\[\\\\pi\\_{2}\\]=Q\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\} |  | (8) |\\\n\\\nwhere KLKL\\\\operatorname{KL} is the Kullback-Leibler divergence w.r.t. π0subscript𝜋0\\\\pi\\_{0}:\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | KL⁡(π∥π0)={∫Ξ×Ξlog⁡d​πd​π0​d​πwhen ​π≪π0∞otherwise.KLconditional𝜋subscript𝜋0casessubscriptΞΞd𝜋dsubscript𝜋0d𝜋much-less-thanwhen 𝜋subscript𝜋0otherwise.\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})=\\\\begin{cases}\\\\int\\_{\\\\Xi\\\\times\\\\Xi}\\\\log\\\\frac{\\\\mathrm{d}\\\\pi}{\\\\mathrm{d}\\\\pi\\_{0}}\\\\,\\\\mathrm{d}\\\\pi&\\\\text{when }\\\\pi\\\\ll\\\\pi\\_{0}\\\\\\<br>\\\\infty&\\\\text{otherwise.}\\\\end{cases} |  |\\\n\\\nRegularization have been recently studied in the context of WDRO: \\[ [38]\\] introduces an entropic regularization in constraints for computational interests, \\[ [5]\\] considers an entropic regularization in the objective for generalization, and \\[ [6]\\] studies a general regularization in both constraints and objective.\\\n\\\nFollowing the most general case \\[ [6]\\], we consider\\\nthe robust risk with double regularization\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Rρ,Qτ,ϵ​(f):=supπ∈𝒫​(Ξ×Ξ),\\[π\\]1=Q𝔼π​\\[c\\]+τ​KL⁡(π∥π0)≤ρ{𝔼\\[π\\]2​\\[f\\]−ϵ​KL⁡(π∥π0)}.assignsuperscriptsubscript𝑅𝜌𝑄𝜏italic-ϵ𝑓subscriptsupremumformulae-sequence𝜋𝒫ΞΞsubscriptdelimited-\\[\\]𝜋1𝑄subscript𝔼𝜋delimited-\\[\\]𝑐𝜏KLconditional𝜋subscript𝜋0𝜌subscript𝔼subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]𝑓italic-ϵKLconditional𝜋subscript𝜋0R\\_{\\\\rho,Q}^{\\\\tau,\\\\epsilon}(f):=\\\\!\\\\!\\\\!\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),~{}\\[\\\\pi\\]\\_{1}=Q\\\\\\<br>\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\leq\\\\rho\\\\end{subarray}}\\\\!\\\\!\\\\!\\\\left\\\\{\\\\mathbb{E}\\_{\\[\\\\pi\\]\\_{2}}\\[f\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}. |  |\\\n\\\nwith two parameters ϵ>0italic-ϵ0\\\\epsilon>0 and τ≥0𝜏0\\\\tau\\\\geq 0.\\\nIntroducing the conditional moment of π0subscript𝜋0\\\\pi\\_{0}:\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | mc=maxξ∈Ξ⁡𝔼ζ∼π0(⋅\\|ξ)​\\[c​(ξ,ζ)\\],m\\_{c}=\\\\max\\_{\\\\xi\\\\in\\\\Xi}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[c(\\\\xi,\\\\zeta)\\], |  | (9) |\\\n\\\nthe generalization guarantee in this setting states as follows.\\\n\\\n###### Theorem 3.2(Generalization for double regularization).\\\n\\\nUnder [2.1]Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exist ατ,ϵ,βτ,ϵ>0superscript𝛼𝜏italic-ϵsuperscript𝛽𝜏italic-ϵ0\\\\alpha^{\\\\tau,\\\\epsilon}\\\\!,\\\\beta^{\\\\tau,\\\\epsilon}\\\\!>\\\\!0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | max⁡{mc,ατ,ϵn}<ρ<ρcritτ,ϵ2−βτ,ϵn,subscript𝑚𝑐superscript𝛼𝜏italic-ϵ𝑛𝜌superscriptsubscript𝜌crit𝜏italic-ϵ2superscript𝛽𝜏italic-ϵ𝑛\\\\max\\\\left\\\\{m\\_{c},\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}\\\\right\\\\}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}-\\\\frac{\\\\beta^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}, |  |\\\n\\\nthen with probability at least 1−δ1𝛿1-\\\\delta, for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} and all Q𝑄Q such that Wcτ​(P,Q)≤ρsubscriptsuperscript𝑊𝜏𝑐𝑃𝑄𝜌W^{\\\\tau}\\_{c}(P,Q)\\\\leq\\\\rho,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ρτ,ϵ​(f)≥𝔼ζ∼Q​\\[f​(ζ)\\]−ϵ​KL⁡(πP,Q∥π0),subscriptsuperscript^𝑅𝜏italic-ϵ𝜌𝑓subscript𝔼similar-to𝜁𝑄delimited-\\[\\]𝑓𝜁italic-ϵKLconditionalsuperscript𝜋𝑃𝑄subscript𝜋0\\\\widehat{R}^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0}), |  |\\\n\\\nwhere πP,Qsuperscript𝜋𝑃𝑄\\\\pi^{P,Q} is the optimal coupling in ( [8]Equation 8 ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nThis result is similar to the one of [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), it is also similar to the only other generalization result existing for regularized WDRO \\[ [5]\\]. Let us explicit below the main differences. We will discuss in [Section5]On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), the generalization constants such as the critical radius ρcritτ,ϵsuperscriptsubscript𝜌crit𝜏italic-ϵ\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}.\\\n\\\nUnlike Wasserstein robust models ( [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), regularization leads to an inexact generalization guarantee, where the regularized empirical robust risk bounds a proxy for the true risk 𝔼P​\\[f\\]subscript𝔼𝑃delimited-\\[\\]𝑓\\\\mathbb{E}\\_{P}\\[f\\]. This is in line with the regularization in optimal transport that induces a bias in the Wasserstein metric, preventing Wcτ​(P,P)subscriptsuperscript𝑊𝜏𝑐𝑃𝑃W^{\\\\tau}\\_{c}(P,P) from being null.\\\n\\\nCompared to \\[ [5]\\], we underline that our result covers also the double regularization case. Moreover, it is valid for an arbitrary π0subscript𝜋0\\\\pi\\_{0} whereas the one of \\[ [5]\\] relies on the specific form π0subscript𝜋0\\\\pi\\_{0} involving a Gaussian term. Our result is thus more flexible, allowing to choose conjointly c𝑐c and π0subscript𝜋0\\\\pi\\_{0}. For example, a Laplace distribution can be chosen when c𝑐c is the ℓ1subscriptℓ1\\\\ell\\_{1}-norm.\\\n\\\nBefore moving on to the proof of the generalization results, let us come back to [Figure1]In 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). To get this plot, we generated 500 instances of logistic regression problems with synthetic classification data (n=100𝑛100n=100, d=5𝑑5d=5), for which we solve an associated robust counterpart (with an ℓ1subscriptℓ1\\\\ell\\_{1}-cost c𝑐c and a Laplace distribution π0(⋅\\|ξ)\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | minθ⁡max𝔼π\\[∥⋅∥1\\]≤ρ\\[π\\]1=P^n\\\\displaystyle\\\\min\\_{\\\\theta}\\\\max\\_{\\\\begin{subarray}{c}\\\\mathbb{E}\\_{\\\\pi}\\[\\\\\\|{\\\\cdot}\\\\\\|\\_{1}\\]\\\\leq\\\\rho\\\\\\<br>\\[\\\\pi\\]\\_{1}=\\\\widehat{P}\\_{n}\\\\end{subarray}} | 𝔼(x,y)∼\\[π\\]2​\\[log⁡(1+ey​⟨θ,x⟩)\\].subscript𝔼similar-to𝑥𝑦subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]1superscript𝑒𝑦𝜃𝑥\\\\displaystyle\\\\mathbb{E}\\_{(x,y)\\\\sim\\[\\\\pi\\]\\_{2}}\\[\\\\log(1+e^{y\\\\langle\\\\theta,x\\\\rangle})\\]. |  |\\\n\\\nThis setting is covered by [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") but not by existing results in previous works. Let us check the realizations of the bound ( [3]Equation 3 ‣ 1.1 Wasserstein robustness: models and generalization ‣ 1 Introduction ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Using 105superscript10510^{5} samples, we estimate the true risk 𝔼P​\\[f\\]subscript𝔼𝑃delimited-\\[\\]𝑓\\\\mathbb{E}\\_{P}\\[f\\] for computed optimal solutions f𝑓f of the 500 instances.\\\nOn the figure, we report the proportion of instances for which the bound holds and we observe that when ρ𝜌\\\\rho increases, the bound does hold true.\\\n\\",
      "citations": [
        {
          "start_pos": 2730,
          "end_pos": 2733,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 3432,
          "end_pos": 3436,
          "text": "[15]",
          "paper_id": "bib.bib15",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 3438,
          "end_pos": 3442,
          "text": "[28]",
          "paper_id": "bib.bib28",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4730,
          "end_pos": 4734,
          "text": "[38]",
          "paper_id": "bib.bib38",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 4822,
          "end_pos": 4825,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 4909,
          "end_pos": 4912,
          "text": "[6]",
          "paper_id": "bib.bib6",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 5021,
          "end_pos": 5024,
          "text": "[6]",
          "paper_id": "bib.bib6",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 8030,
          "end_pos": 8033,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 9039,
          "end_pos": 9042,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 9203,
          "end_pos": 9206,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "4 Proof strategy\\": {
      "content": "\\\nThis section presents our strategy to prove the generalization results of Section [3]Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") (Theorems [3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2]Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\nThe strength of our approach is to use\\\nflexible nonsmooth analysis arguments, able to cover the general situation of arbitrary (continuous) cost and objective functions. After an overview of the proof in [Section4.2]Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we explain the key mechanisms in Sections [4.3]Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [4.4]Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and how they combine with a concentration theorem ( [Section4.1]Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to show the results.\\\n\\\nIn Sections [4.2]Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), [4.3]Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [4.4]Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") we consider the standard WDRO setting of [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The extension to the regularized setting of [Theorem3.2]Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is then explained in [Section4.5]Extension to (double) regularization. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Furthermore, in order to focus on the rationale we do not include the proofs in the core of the paper and we refer precisely to corresponding results in the supplementary. We also underline the fundamental results of probability and (nonsmooth) analysis that are used all along. All the statements of this section implicitly assume that our [2.1]Assumption 2.1. ‣ 2 Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") holds.\\\n\\\n### 4.1 Uniform concentration inequality\\\n\\\nIn order to obtain high-probability bounds guarantees, uniform on ℱℱ\\\\mathcal{F}, we rely on a standard uniform concentration inequality on a compact metric space. We recall the essential result below, highlighting the two crucial properties on the random variable: _(i) boundedness_ and _(ii) global Lipschitzness_.\\\nWe refer to e.g. \\[ [12]\\] for general discussions, and to [TheoremA.2]Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). ‣ A.1 Uniform concentration inequality ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for one-sided alternatives.\\\n\\\n###### Theorem 4.1(Uniform concentration).\\\n\\\nLet (𝒳,dist)𝒳dist(\\\\mathcal{X},\\\\operatorname{dist}) be a compact metric space, and X:𝒳×Ξ→ℝ:𝑋→𝒳ΞℝX:\\\\mathcal{X}\\\\times\\\\Xi\\\\to\\\\mathbb{R} be a measurable function. Assume the following:\\\n\\\n1. (i)\\\n\\\n\\\nThere exist a,b∈ℝ𝑎𝑏ℝa,b\\\\in\\\\mathbb{R} such that X​(x,ξ)∈\\[a,b\\]𝑋𝑥𝜉𝑎𝑏X(x,\\\\xi)\\\\in\\[a,b\\] for all (x,ξ)∈𝒳×Ξ𝑥𝜉𝒳Ξ(x,\\\\xi)\\\\in\\\\mathcal{X}\\\\times\\\\Xi.\\\n\\\n2. (ii)\\\n\\\n\\\nX​(⋅,ξ)𝑋⋅𝜉X(\\\\cdot,\\\\xi) is L𝐿L-Lipschitz for all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi.\\\n\\\n\\\nThen with probability at least 1−δ1𝛿1-\\\\delta,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | supx∈𝒳\\|𝔼ξ∼P^n​\\[X​(x,ξ)\\]−𝔼ξ∼P​\\[X​(x,ξ)\\]\\|≤Mn.subscriptsupremum𝑥𝒳subscript𝔼similar-to𝜉subscript^𝑃𝑛delimited-\\[\\]𝑋𝑥𝜉subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑋𝑥𝜉𝑀𝑛\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\\\left\\|\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[X(x,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[X(x,\\\\xi)\\]\\\\right\\|\\\\leq\\\\frac{M}{\\\\sqrt{n}}. |  |\\\n\\\nM𝑀M is a problem-dependent constant having the expression222The constant ℐ​(𝒳,dist)ℐ𝒳dist\\\\mathcal{I}({\\\\mathcal{X},\\\\operatorname{dist}}) is the standard Dudley’s entropy integral measuring the complexity of the space 𝒳𝒳\\\\mathcal{X}, that we further discuss in [DefinitionA.4]Definition A.4. ‣ A.1 Uniform concentration inequality ‣ Appendix A Recalls and technical preliminaries ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | M=48​L​ℐ​(𝒳,dist)+(b−a)​2​log⁡(2/δ).𝑀48𝐿ℐ𝒳dist𝑏𝑎22𝛿M=48\\\\,L\\\\,\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist})+\\ (b-a)\\\\sqrt{2\\\\log(2/\\\\delta)}. |  |\\\n\\\nWe will apply this concentration result to two families of functions (ψ𝜓\\\\psi and ϕitalic-ϕ\\\\phi) appearing in our proof; to this end, we will establish the two points (i) and (ii) in [Lemma4.1]Lemma 4.1. ‣ 4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [Lemma4.3]Lemma 4.3. ‣ Dual bound on the empirical risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") respectively.\\\n\\\n### 4.2 Proof’s overview\\\n\\\nCompared to the original formulation ( [6]Equation 6 ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), the dual representation of WDRO significantly diminishes the problem’s degrees of freedom, and is usually the starting point of most studies.\\\nGiven any distribution Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi), it holds that\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Rρ,Q​(f)=infλ≥0{λ​ρ+𝔼ξ∼Q​\\[ϕ​(λ,f,ξ)\\]},subscript𝑅𝜌𝑄𝑓subscriptinfimum𝜆0𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]italic-ϕ𝜆𝑓𝜉R\\_{\\\\rho,Q}(f)=\\\\inf\\_{\\\\lambda\\\\geq 0}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  | (10) |\\\n\\\nwhere the _dual generator_ ϕitalic-ϕ\\\\phi is a convex function with respect to λ𝜆\\\\lambda, and Lipschitz continuous with respect to f𝑓f. For Wasserstein robust models, ϕitalic-ϕ\\\\phi has the expression (see e.g. \\[ [8]\\])\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ϕ​(λ,f,ξ)=supζ∈Ξ{f​(ζ)−λ​c​(ξ,ζ)}.italic-ϕ𝜆𝑓𝜉subscriptsupremum𝜁Ξ𝑓𝜁𝜆𝑐𝜉𝜁\\\\phi(\\\\lambda,f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\\\right\\\\}. |  |\\\n\\\nObserve that ϕitalic-ϕ\\\\phi is naturally convex in λ𝜆\\\\lambda, but also nonsmooth. The originality of our approach is to build on this nonsmoothness by using a rationale of nonsmooth analysis. Note also that the convexity of ϕitalic-ϕ\\\\phi will be a key property (see e.g. the argument of [Figure3]In Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nLet us then outline the main steps to establish [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n1. 1.\\\n\\\n\\\nWe establish in [Section4.4]Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") the existence of a dual lower bound λlowsubscript𝜆low\\\\lambda\\_{\\\\operatorname{low}}, which holds with high probability and uniformly on ℱℱ\\\\mathcal{F}, whenever ρ<ρcrit2−βn𝜌subscript𝜌crit2𝛽𝑛\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}:\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ρ​(f)=infλ∈\\[λlow,∞){λ​ρ+𝔼P^n​\\[ϕ​(λ,f)\\]}.subscript^𝑅𝜌𝑓subscriptinfimum𝜆subscript𝜆low𝜆𝜌subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓\\\\widehat{R}\\_{\\\\rho}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\infty)}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f)\\]\\\\right\\\\}. |  |\\\n\\\n2. 2.\\\n\\\n\\\nAs explained in [Section4.3]Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), this leads to\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ρ​(f)≥Rρ−αn​(f).subscript^𝑅𝜌𝑓subscript𝑅𝜌𝛼𝑛𝑓\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f). |  |\\\n\\\n3. 3.\\\n\\\n\\\nFinally, if furthermore αn<ρ𝛼𝑛𝜌\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho, then we capture the true risk on the right:\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ρ​(f)≥𝔼P​\\[f\\].subscript^𝑅𝜌𝑓subscript𝔼𝑃delimited-\\[\\]𝑓\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{P}\\[f\\]. |  |\\\n\\\n\\\n### 4.3 Concentration aspects by dual lower bound\\\n\\\nWe assume in this section that the empirical dual solution is lower bounded by a value λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 (with high probability), which means that the infimum in ( [10]Equation 10 ‣ 4.2 Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), with Q=P^n𝑄subscript^𝑃𝑛Q=\\\\widehat{P}\\_{n}, may be taken over \\[λlow,0)subscript𝜆low0\\[\\\\lambda\\_{\\\\operatorname{low}},0) instead of ℝ+subscriptℝ\\\\mathbb{R}\\_{+}. In this case, we can proceed as follows. For a distribution Q𝑄Q, we use the shorthand 𝔼Q​\\[ϕ\\]=𝔼ξ∼Q​\\[ϕ​(λ,f,ξ)\\]subscript𝔼𝑄delimited-\\[\\]italic-ϕsubscript𝔼similar-to𝜉𝑄delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\mathbb{E}\\_{Q}\\[\\\\phi\\]=\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]. Then we can write for λ≥λlow𝜆subscript𝜆low\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}},\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | λ​ρ+𝔼P^n​\\[ϕ\\]𝜆𝜌subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ\\\\displaystyle\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi\\] | ≥λ​(ρ−(𝔼P​\\[ϕ\\]−𝔼P^n​\\[ϕ\\]λ))+𝔼P​\\[ϕ\\]absent𝜆𝜌subscript𝔼𝑃delimited-\\[\\]italic-ϕsubscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆subscript𝔼𝑃delimited-\\[\\]italic-ϕ\\\\displaystyle\\\\geq\\\\lambda\\\\left(\\\\rho-\\\\left(\\\\frac{\\\\mathbb{E}\\_{P}\\[\\\\phi\\]-\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi\\]}{\\\\lambda}\\\\right)\\\\right)+\\\\mathbb{E}\\_{P}\\[\\\\phi\\] |  |\\\n|  |  | ≥λ​(ρ−αn)+𝔼P​\\[ϕ\\],absent𝜆𝜌subscript𝛼𝑛subscript𝔼𝑃delimited-\\[\\]italic-ϕ\\\\displaystyle\\\\geq\\\\lambda(\\\\rho-\\\\alpha\\_{n})+\\\\mathbb{E}\\_{P}\\[\\\\phi\\], |  | (11) |\\\n\\\nwhere αnsubscript𝛼𝑛\\\\alpha\\_{n} is a formal lower bound on the quotient term (formally defined ( [4.3]Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"))).\\\nTaking the infimum over λ≥λlow𝜆subscript𝜆low\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}}, we obtain\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^ρ​(f)≥Rρ−αn​(f)≥𝔼ξ∼P​\\[f​(ξ)\\],subscript^𝑅𝜌𝑓subscript𝑅𝜌subscript𝛼𝑛𝑓subscript𝔼similar-to𝜉𝑃delimited-\\[\\]𝑓𝜉\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\alpha\\_{n}}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\], |  | (12) |\\\n\\\nwhenever ρ>αn𝜌subscript𝛼𝑛\\\\rho>\\\\alpha\\_{n}. This is the desired inequality of [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Thus, in order to have ( [4.3]Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) with high probability for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, we introduce the function ψ𝜓\\\\psi of the variable μ=λ−1𝜇superscript𝜆1\\\\mu=\\\\lambda^{-1}:\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | ψ​(μ,f,ξ)𝜓𝜇𝑓𝜉\\\\displaystyle\\\\psi(\\\\mu,\\\\!f,\\\\xi) | :=μ​ϕ​(μ−1,f,ξ)=supζ∈Ξ{μ​f​(ζ)−c​(ξ,ζ)}assignabsent𝜇italic-ϕsuperscript𝜇1𝑓𝜉subscriptsupremum𝜁Ξ𝜇𝑓𝜁𝑐𝜉𝜁\\\\displaystyle\\\\!:=\\\\!\\\\mu\\\\phi(\\\\mu^{-1}\\\\!,\\\\!f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)\\\\!-\\\\!c(\\\\xi,\\\\zeta)\\\\right\\\\} |  | (13) |\\\n\\\nand we study the gap αnsubscript𝛼𝑛\\\\alpha\\_{n} defined by\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | αn:=supassignsubscript𝛼𝑛supremum\\\\displaystyle\\\\alpha\\_{n}:=\\\\sup | {𝔼ξ∼P\\[ψ(μ,f,ξ)\\]−𝔼ξ∼P^n\\[ψ(μ,f,ξ)\\]\\\\displaystyle\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]\\\\right. |  |\\\n|  |  | :(μ,f)∈(0,λlow−1\\]×ℱ}.\\\\displaystyle\\ :\\ \\\\left.(\\\\mu,f)\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}\\\\right\\\\}. |  | (14) |\\\n\\\nIn order to obtain a high probability bound of the form αn≤αnsubscript𝛼𝑛𝛼𝑛\\\\alpha\\_{n}\\\\leq\\\\frac{\\\\alpha}{\\\\sqrt{n}}, boundedness (i) and Lipschitz continuity (ii) of (μ,f)↦ψ​(μ,f,ξ)maps-to𝜇𝑓𝜓𝜇𝑓𝜉(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) are required by the concentration theorem [Theorem4.1]Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). In the expression ( [13]Equation 13 ‣ 4.3 Concentration aspects by dual lower bound ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we remark that the Lipschitz constant of ψ​(μ,f,ξ)𝜓𝜇𝑓𝜉\\\\psi(\\\\mu,f,\\\\xi) explodes as μ→∞→𝜇\\\\mu\\\\to\\\\infty, hence we must bound μ=λ−1𝜇superscript𝜆1\\\\mu=\\\\lambda^{-1} above. Thus, if a lower bound λlowsubscript𝜆low\\\\lambda\\_{\\\\operatorname{low}} holds on λ𝜆\\\\lambda, ψ𝜓\\\\psi satisfies the requirements of [Theorem4.1]Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n###### Lemma 4.1.\\\n\\\nGiven λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0, then for almost all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi,\\\n\\\n1. (i)\\\n\\\n\\\nFor all μ∈(0,λlow−1\\]𝜇0superscriptsubscript𝜆low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ψ​(μ,f,ξ)∈\\[−‖ℱ‖∞λlow,‖ℱ‖∞λlow\\].𝜓𝜇𝑓𝜉subscriptnormℱsubscript𝜆lowsubscriptnormℱsubscript𝜆low\\\\psi(\\\\mu,f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\]. |  |\\\n\\\n2. (ii)\\\n\\\n\\\n(μ,f)↦ψ​(μ,f,ξ)maps-to𝜇𝑓𝜓𝜇𝑓𝜉(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) is Lipschitz continuous on (0,λlow−1\\]×ℱ0superscriptsubscript𝜆low1ℱ(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F} with constant ‖ℱ‖∞+λlow−1subscriptnormℱsuperscriptsubscript𝜆low1\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\n\n\n###### Proof.\n\nSee [LemmaC.1]Lemma C.1 (Concentration conditions for WDRO). ‣ C.1 Standard WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").2 in the supplementary.\n∎\n\n### 4.4 Getting a dual lower bound.\n\nIn order to get a dual lower bound, we proceed in two steps:\n\n1. 1.\n\n\nWe show the existence of a dual lower bound on the true robust risk. This involves the definition of an inherent maximal radius, which plays the role of a degeneracy threshold.\n\n2. 2.\n\n\nWe show that the lower bound on the true robust risk transposes to the empirical robust risk, with high probability and uniformly on ℱℱ\\\\mathcal{F}. This is done by expressing a slope condition and applying the concentration inequality [Theorem4.1]Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n\n##### Dual bound on the true risk.\n\nIn order to obtain a dual lower bound on the true robust risk, it is sufficient for the (right-sided) derivative of λ↦λ​ρ+𝔼ξ∼P​\\[ϕ​(λ,f,ξ)\\]maps-to𝜆𝜆𝜌subscript𝔼similar-to𝜉𝑃delimited-\\[\\]italic-ϕ𝜆𝑓𝜉\\\\lambda\\\\mapsto\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\] to be negative for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} on an interval \\[0,2​λlow\\]02subscript𝜆low\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\]333Although the factor 2 may not seem necessary at the moment, its role will become clearer in [Section4.4]Dual bound on the empirical risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), with λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0. This writes:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ρ≤𝔼ξ∼P​\\[−∂λ+ϕ​(λ,f,ξ)\\],𝜌subscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscriptsuperscript𝜆italic-ϕ𝜆𝑓𝜉\\\\rho\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\], |  | (15) |\n\nwhich implies that ρ𝜌\\\\rho has to be small. To obtain the condition ( [15]Equation 15 ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) uniformly in f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F}, we introduce the maximal value of ρ𝜌\\\\rho allowed at a given λ≥0𝜆0\\\\lambda\\\\geq 0 (illustrated in [Figure2]In Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n![Refer to caption]Figure 2: A central object of our analysis: the maximal radius ρmaxsubscript𝜌\\\\rho\\_{\\\\max}, defined from the lower envelope of derivatives of ϕitalic-ϕ\\\\phi.\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ρmax​(λ)=inff∈ℱ𝔼ξ∼P​\\[−∂λ+ϕ​(λ,f,ξ)\\].subscript𝜌𝜆subscriptinfimum𝑓ℱsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]superscriptsubscript𝜆italic-ϕ𝜆𝑓𝜉\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]. |  | (16) |\n\nAs illustrated by [Figure2]In Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), ρmaxsubscript𝜌\\\\rho\\_{\\\\max} reaches its highest value at zero. This is the _critical radius_,\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρcrit=ρmax​(0).subscript𝜌critsubscript𝜌0\\\\rho\\_{\\\\operatorname{crit}}=\\\\rho\\_{\\\\max}(0). |  |\n\nThis particular quantity will be discussed in [Section5.2]The critical radius ‣ 5 On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). As a central result of this work, we show that ρmaxsubscript𝜌\\\\rho\\_{\\\\max} can be made arbitrarily close to ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}} as λ→0+→𝜆superscript0\\\\lambda\\\\to 0^{+}.\n\n###### Lemma 4.2.\n\nlimλ→0+ρmax​(λ)=ρcritsubscript→𝜆superscript0subscript𝜌𝜆subscript𝜌crit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}. In particular, there exists λlow>0subscript𝜆low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that for all λ∈\\[0,2​λlow\\]𝜆02subscript𝜆low\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\], for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | 𝔼ξ∼P​\\[∂λ+ϕ​(λ,f,ξ)\\]≤−ρcrit2.subscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscriptsuperscript𝜆italic-ϕ𝜆𝑓𝜉subscript𝜌crit2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}. |  | (17) |\n\n###### Proof.\n\nSee [LemmaD.1]Lemma D.1. ‣ D.1 Standard WDRO: continuity at zero of the maximal radius ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\n∎\n\nThis means that the derivative condition ( [15]\\]) involving an arg max:\n\n|     |     |     |\n| --- | --- | --- |\n|  | ∂λ+ϕ(λ,f,ξ)=−minζ∈Ξ{c(ζ,arg​maxΞ{f−λc(ξ,⋅)}}.\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)=-\\\\min\\_{\\\\zeta\\\\in\\\\Xi}\\\\{c(\\\\zeta,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\}\\\\}. |  |\n\n![Refer to caption]Figure 3: Bounding from below the empirical dual solution λ∗superscript𝜆\\\\lambda^{\\*} expresses as a slope condition (thanks to convexity of the objective).\n\n##### Dual bound on the empirical risk.\n\nWe propose a simple way to overcome the limitation highlighted above by relying on the convexity of ϕitalic-ϕ\\\\phi. Indeed, given a convex function g𝑔g over ℝ+superscriptℝ\\\\mathbb{R}^{+}, the infimum of g𝑔g has to occur on an interval \\[λlow,+∞\\]subscript𝜆low\\[\\\\lambda\\_{\\\\operatorname{low}},+\\\\infty\\] if g𝑔g has a negative slope between λlowsubscript𝜆low\\\\lambda\\_{\\\\operatorname{low}} and 2​λlow2subscript𝜆low2\\\\lambda\\_{\\\\operatorname{low}} ( [Figure3]In Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n|     |     |     |\n| --- | --- | --- |\n|  | g​(2​λlow)−g​(λlow)λlow≤0⟹infλ≥λlowg​(λ)=infλ≥0g​(λ).𝑔2subscript𝜆low𝑔subscript𝜆lowsubscript𝜆low0subscriptinfimum𝜆subscript𝜆low𝑔𝜆subscriptinfimum𝜆0𝑔𝜆\\\\frac{g(2\\\\lambda\\_{\\\\operatorname{low}})-g(\\\\lambda\\_{\\\\operatorname{low}})}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\leq 0\\\\implies\\\\inf\\_{\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}}}g(\\\\lambda)=\\\\inf\\_{\\\\lambda\\\\geq 0}g(\\\\lambda). |  |\n\nWe want this condition satisfied for the empirical Lagrangian function g​(λ)=λ​ρ+𝔼P^n​\\[ϕ​(λ,f)\\]𝑔𝜆𝜆𝜌subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ𝜆𝑓g(\\\\lambda)=\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f)\\] with high probability. For convenience, this can be expressed with the slope of 𝔼P^n​\\[ϕ​(⋅,f)\\]subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ⋅𝑓\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\cdot,f)\\]:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | s^​(f):=𝔼P^n​\\[ϕ​(2​λlow,f)\\]−𝔼P^n​\\[ϕ​(λlow,f)\\]λlow≤−ρ.assign^𝑠𝑓subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕ2subscript𝜆low𝑓subscript𝔼subscript^𝑃𝑛delimited-\\[\\]italic-ϕsubscript𝜆low𝑓subscript𝜆low𝜌\\\\widehat{s}(f)\\\\!:=\\\\!\\\\frac{\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\]-\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f)\\]}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\leq-\\\\rho. |  | (18) |\n\nThis is the condition we aim to obtain. To this end, we proceed by comparing the empirical slope to the true one,\n\n|     |     |     |\n| --- | --- | --- |\n|  | s​(f):=𝔼P​\\[ϕ​(2​λlow,f)\\]−𝔼P​\\[ϕ​(λlow,f)\\]λlow.assign𝑠𝑓subscript𝔼𝑃delimited-\\[\\]italic-ϕ2subscript𝜆low𝑓subscript𝔼𝑃delimited-\\[\\]italic-ϕsubscript𝜆low𝑓subscript𝜆lows(f):=\\\\frac{\\\\mathbb{E}\\_{P}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\]-\\\\mathbb{E}\\_{P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f)\\]}{\\\\lambda\\_{\\\\operatorname{low}}}. |  |\n\nIndeed, we can show that any function (f,ξ)↦ϕ​(λ,f,ξ)maps-to𝑓𝜉italic-ϕ𝜆𝑓𝜉(f,\\\\xi)\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi), with λ∈ℝ+𝜆subscriptℝ\\\\lambda\\\\in\\\\mathbb{R}\\_{+}, satisfies the requirements for the concentration theorem ( [Theorem4.1]Theorem 4.1 (Uniform concentration). ‣ 4.1 Uniform concentration inequality ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n###### Lemma 4.3.\n\nFor almost all ξ∈Ξ𝜉Ξ\\\\xi\\\\in\\\\Xi we have\n\n1. (i)\n\n\nFor all λ≥0𝜆0\\\\lambda\\\\geq 0 and f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | ϕ​(λ,f,ξ)∈\\[−‖ℱ‖∞,‖ℱ‖∞\\].italic-ϕ𝜆𝑓𝜉subscriptnormℱsubscriptnormℱ\\\\phi(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\]. |  |\n\n2. (ii)\n\n\nFor all λ≥0𝜆0\\\\lambda\\\\geq 0, f↦ϕ​(λ,f,ξ)maps-to𝑓italic-ϕ𝜆𝑓𝜉f\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi) is Lipschitz continuous on ℱℱ\\\\mathcal{F} with constant 111.\n\n\n###### Proof.\n\nSee [LemmaC.1]Lemma C.1 (Concentration conditions for WDRO). ‣ C.1 Standard WDRO ‣ Appendix C Concentration constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").1.\n∎\n\nConsequently, we can apply the concentration theorem twice, on each function ϕ​(2​λlow,⋅,⋅)italic-ϕ2subscript𝜆low⋅⋅\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},\\\\cdot,\\\\cdot) and ϕ​(2​λlow,⋅,⋅)italic-ϕ2subscript𝜆low⋅⋅\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},\\\\cdot,\\\\cdot), to obtain that s^​(f)^𝑠𝑓\\\\widehat{s}(f) approximates s​(f)𝑠𝑓s(f) with high probability, up to a term of the form βn𝛽𝑛\\\\frac{\\\\beta}{\\\\sqrt{n}}:\n\n|     |     |     |\n| --- | --- | --- |\n|  | ∀f∈ℱ,s^​(f)≤s​(f)+βn.formulae-sequencefor-all𝑓ℱ^𝑠𝑓𝑠𝑓𝛽𝑛\\\\forall f\\\\in\\\\mathcal{F},\\\\quad\\\\widehat{s}(f)\\\\leq s(f)+\\\\frac{\\\\beta}{\\\\sqrt{n}}. |  |\n\nOn the other hand, s​(f)≤𝔼P​\\[∂λ+ϕ​(2​λlow,f)\\]𝑠𝑓subscript𝔼𝑃delimited-\\[\\]subscriptsuperscript𝜆italic-ϕ2subscript𝜆low𝑓s(f)\\\\leq\\\\mathbb{E}\\_{P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\] by convexity of ϕitalic-ϕ\\\\phi, hence s​(f)≤−ρcrit2𝑠𝑓subscript𝜌crit2s(f)\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2} by ( [17]Equation 17 ‣ Lemma 4.2. ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). This means\n\n|     |     |     |\n| --- | --- | --- |\n|  | s^​(f)≤βn−ρcrit2,^𝑠𝑓𝛽𝑛subscript𝜌crit2\\\\widehat{s}(f)\\\\leq\\\\frac{\\\\beta}{\\\\sqrt{n}}-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}, |  |\n\nhence we have the desired condition ( [18]Equation 18 ‣ Dual bound on the empirical risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) when\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρ<ρcrit2−βn.𝜌subscript𝜌crit2𝛽𝑛\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}. |  |\n\n### 4.5 Extension to (double) regularization.\n\nThe strategy of [Section4.2]Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is flexible enough to be extended to the regularized setting of [Section3.2]Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Indeed, the regularized problem also has a dual representation, with a dual generator defined by\n\n|     |     |     |\n| --- | --- | --- |\n|  | ϕτ,ϵ​(λ,f,ξ)=(ϵ+λ​τ)​log⁡𝔼ζ∼π0(⋅\\|ξ)​\\[ef​(ζ)−λ​c​(ξ,ζ)ϵ+λ​τ\\],\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\], |  |\n\nwhere ϵ>0italic-ϵ0\\\\epsilon>0 and τ≥0𝜏0\\\\tau\\\\geq 0. Strong duality has been shown in \\[ [6]\\]. We explain in [AppendixB]Appendix B Strong duality ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), [PropositionB.2]Proposition B.2 (Strong duality, regularized WDRO). ‣ Appendix B Strong duality ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") how it applies to our general setting. This regularized dual generator leads to smooth counterparts of the key nonsmooth functions ψ𝜓\\\\psi, ρmaxsubscript𝜌\\\\rho\\_{\\\\max} and ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}} of the proof. In particular, we can show the regularized version of [Lemma4.2]Lemma 4.2. ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n###### Lemma 4.4.\n\nlimλ→0+ρmaxτ,ϵ​(λ)=ρcritτ,ϵsubscript→𝜆superscript0superscriptsubscript𝜌𝜏italic-ϵ𝜆superscriptsubscript𝜌crit𝜏italic-ϵ\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}. In particular, there exists λlowτ,ϵ>0superscriptsubscript𝜆low𝜏italic-ϵ0\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}>0 such that for all λ∈\\[0,2​λlowτ,ϵ\\]𝜆02superscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}\\], ∀f∈ℱfor-all𝑓ℱ\\\\forall f\\\\in\\\\mathcal{F},\n\n|     |     |     |\n| --- | --- | --- |\n|  | 𝔼ξ∼P​\\[∂λϕτ,ϵ​(λ,f,ξ)\\]≤−ρcritτ,ϵ2.subscript𝔼similar-to𝜉𝑃delimited-\\[\\]subscript𝜆superscriptitalic-ϕ𝜏italic-ϵ𝜆𝑓𝜉superscriptsubscript𝜌crit𝜏italic-ϵ2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}. |  |\n\nThen we obtain [Theorem3.2]Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") by repeating the proof scheme of [Section4.2]Proof’s overview ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The core results that simultaneously lead to Theorems [3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2]Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") are gathered in [SectionE.1]E.1 Dual bounds with high probability on the empirical problem ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Due to the smoothness of ρmaxτ,ϵsuperscriptsubscript𝜌𝜏italic-ϵ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}, an expression of λlowτ,ϵsuperscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} can also be obtained; see [LemmaD.2]Lemma D.2. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\nThe key difference brought by regularization is that the Lipschitz property of ψτ,ϵsuperscript𝜓𝜏italic-ϵ\\\\psi^{\\\\tau,\\\\epsilon} is lost when μ→0→𝜇0\\\\mu\\\\to 0. This is an inherent peculiarity of the regularized setting which may occur over the whole family ℱℱ\\\\mathcal{F} and the space ΞΞ\\\\Xi; see the example of [PropositionF.2]Proposition F.2. ‣ F.2 Necessity of the dual upper-bound ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). This prevents to use the concentration result without guaranteeing that we can set a lower bound on μ𝜇\\\\mu or equivalently an upper-bound on λ𝜆\\\\lambda. This is the purpose of the next lemma which establishes the existence of such an upper-bound, for any distribution.\n\n###### Lemma 4.5.\n\nLet Q∈𝒫​(Ξ)𝑄𝒫ΞQ\\\\in\\\\mathcal{P}(\\\\Xi) and λup:=2​‖ℱ‖∞ρ−mcassignsubscript𝜆up2subscriptnormℱ𝜌subscript𝑚𝑐\\\\lambda\\_{\\\\operatorname{up}}:=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}. Then for all f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F},\n\n|     |     |     |\n| --- | --- | --- |\n|  | Rρ,Q​(f)=infλ∈\\[0,λup\\]{λ​ρ+𝔼ξ∼Q​\\[ϕ​(λ,f,ξ)\\]}.subscript𝑅𝜌𝑄𝑓subscriptinfimum𝜆0subscript𝜆up𝜆𝜌subscript𝔼similar-to𝜉𝑄delimited-\\[\\]italic-ϕ𝜆𝑓𝜉R\\_{\\\\rho,Q}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}}\\]}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\n\n###### Proof.\n\nSee [LemmaD.3]Lemma D.3 (Upper bound for the regularized problem Lemma 4.5). ‣ D.2.2 Dual upper-bound ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\n∎",
      "citations": [
        {
          "start_pos": 3535,
          "end_pos": 3539,
          "text": "[12]",
          "paper_id": "bib.bib12",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 6992,
          "end_pos": 6995,
          "text": "[8]",
          "paper_id": "bib.bib8",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 20320,
          "end_pos": 20324,
          "text": "[15]",
          "paper_id": "bib.bib14",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 27116,
          "end_pos": 27119,
          "text": "[6]",
          "paper_id": "bib.bib6",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "5 On the generalization constants": {
      "content": "In this section, we put our generalization results into perspective by further discussing the bounds α,β𝛼𝛽\\\\alpha,\\\\beta, the critical radius ρcritsubscript𝜌crit\\\\rho\\_{\\\\operatorname{crit}} appearing in [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), as well as their regularized counterparts of [Theorem3.2]Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n### 5.1 Sample complexity\n\nWe give the complete expressions of α𝛼\\\\alpha, β𝛽\\\\beta, ατ,ϵsuperscript𝛼𝜏italic-ϵ\\\\alpha^{\\\\tau,\\\\epsilon} and βτ,ϵsuperscript𝛽𝜏italic-ϵ\\\\beta^{\\\\tau,\\\\epsilon} in the detailed versions of Theorems [3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2]Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in [SectionE.2]E.2 Proof of the main results ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Here we highlight their dependence from the problem’s constants.\n\nFirst, in the setting of [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). ‣ 3.1 Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), α𝛼\\\\alpha and β𝛽\\\\beta grow essentially with the size and the complexity of ℱℱ\\\\mathcal{F}. Indeed, we have\n\n|     |     |     |     |     |\n| --- | --- | --- | --- | --- |\n|  | α𝛼\\\\displaystyle\\\\alpha | =O(ℐ(ℱ,∥⋅∥∞)×∥ℱ∥∞),\\\\displaystyle=O\\\\big{(}\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\times\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\\\big{)}, |  | (19) |\n|  | β𝛽\\\\displaystyle\\\\beta | =O(∥ℱ∥∞+ℐ(ℱ,∥⋅∥∞)).\\\\displaystyle=O\\\\big{(}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\big{)}. |  |\n\nThe Dudley’s entropy ℐ(ℱ,∥⋅∥∞)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) quantifies the complexity of ℱℱ\\\\mathcal{F}. In the large class of Lipschitz functions, this quantity is exponential in the data dimension. In practice, most machine learning problems involve a Lipschitz parametric family of losses ( [Section2]Assumption and examples ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in which case ℐ(ℱ,∥⋅∥∞)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) becomes proportional to p𝑝\\\\sqrt{p}, where p𝑝p is the parameter’s dimension (see e.g. Chapter 5.1 from \\[ [37]\\]).\n\nThe constants α𝛼\\\\alpha and β𝛽\\\\beta also grow with 1/λlow1subscript𝜆low1/\\\\lambda\\_{\\\\operatorname{low}} and we have α=O​(1/λlow2)𝛼𝑂1superscriptsubscript𝜆low2\\\\alpha=O\\\\left(1/{\\\\lambda\\_{\\\\operatorname{low}}^{2}}\\\\right) and β=O​(1/λlow)𝛽𝑂1subscript𝜆low\\\\beta=O\\\\left(1/{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right). The constant λlowsubscript𝜆low{\\\\lambda\\_{\\\\operatorname{low}}} is implicitly defined and depends on the regularity at 00 of ρmaxsubscript𝜌\\\\rho\\_{\\\\max} ( [16]Equation 16 ‣ Dual bound on the true risk. ‣ 4.4 Getting a dual lower bound. ‣ 4 Proof strategy ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), hence it may depend on ℱℱ\\\\mathcal{F}, ΞΞ\\\\Xi, c𝑐c and P𝑃P.\n\nIn the setting of [Theorem3.2]Theorem 3.2 (Generalization for double regularization). ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we have similar interpretations. In addition to the conditional moment mcsubscript𝑚𝑐m\\_{c} ( [9]Equation 9 ‣ 3.2 Regularized Wasserstein robust models ‣ 3 Main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), the constants ατ,ϵsuperscript𝛼𝜏italic-ϵ\\\\alpha^{\\\\tau,\\\\epsilon} and βτ,ϵsuperscript𝛽𝜏italic-ϵ\\\\beta^{\\\\tau,\\\\epsilon} also involve the second order conditional moment:\n\n|     |     |     |\n| --- | --- | --- |\n|  | m2,c=maxξ∈Ξ⁡𝔼ζ∼π0(⋅\\|ξ)​\\[c​(ξ,ζ)2\\].m\\_{2,c}=\\\\max\\_{\\\\xi\\\\in\\\\Xi}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[c(\\\\xi,\\\\zeta)^{2}\\]. |  |\n\nThey are parameters that may be chosen in practice and related to the reference coupling π0subscript𝜋0\\\\pi\\_{0}. For instance, if π0(⋅\\|ξ)\\\\pi\\_{0}(\\\\cdot\\|\\\\xi) is a truncated Gaussian π0(⋅\\|ξ)∝e−∥⋅−ξ∥22​σ2𝟙Ξ\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\propto e^{-\\\\frac{\\\\\\|\\\\cdot-\\\\xi\\\\\\|^{2}}{2\\\\sigma^{2}}}\\\\mathds{1}\\_{\\\\Xi} and c​(ξ,ζ)=12​‖ξ−ζ‖2𝑐𝜉𝜁12superscriptnorm𝜉𝜁2c(\\\\xi,\\\\zeta)=\\\\frac{1}{2}\\\\\\|\\\\xi-\\\\zeta\\\\\\|^{2} we have mc∝σ2proportional-tosubscript𝑚𝑐superscript𝜎2m\\_{c}\\\\propto\\\\sigma^{2} and m2,c∝σ4proportional-tosubscript𝑚2𝑐superscript𝜎4m\\_{2,c}\\\\propto\\\\sigma^{4}.\n\nThe coefficients ατ,ϵsuperscript𝛼𝜏italic-ϵ\\\\alpha^{\\\\tau,\\\\epsilon} and βτ,ϵsuperscript𝛽𝜏italic-ϵ\\\\beta^{\\\\tau,\\\\epsilon} exhibit similar relations with λlowτ,ϵsuperscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}, ‖ℱ‖∞subscriptnormℱ\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}, and ℐ(ℱ,∥⋅∥∞)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) to their counterparts α𝛼\\\\alpha and β𝛽\\\\beta ( [19]Equation 19 ‣ 5.1 Sample complexity ‣ 5 On the generalization constants ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Regarding the hyperparameters mcsubscript𝑚𝑐m\\_{c}, ϵitalic-ϵ\\\\epsilon, τ𝜏\\\\tau and ρ𝜌\\\\rho, they should be of comparable order according to the expression of ατ,ϵsuperscript𝛼𝜏italic-ϵ\\\\alpha^{\\\\tau,\\\\epsilon} ( [TheoremE.2]Theorem E.2 (Generalization guarantee, regularized WDRO). ‣ E.2 Proof of the main results ‣ Appendix E Proof of the main results ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Compared to the standard setting, we have an estimate of the lower bound λlowτ,ϵsuperscriptsubscript𝜆low𝜏italic-ϵ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} ( [LemmaD.2]Lemma D.2. ‣ D.2.1 Lipschitz continuity of the maximal radius ‣ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound ‣ Appendix D Dual bounds and maximal radius ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) showing dependence on the loss family: 1/λlowτ,ϵ=O​(e‖ℱ‖∞ϵ)1superscriptsubscript𝜆low𝜏italic-ϵ𝑂superscript𝑒subscriptnormℱitalic-ϵ1/{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}=O\\\\big{(}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\big{)}.\n\n### 5.2 The critical radius\n\nIn the standard setting, the critical radius has the expression\n\n|     |     |     |\n| --- | --- | --- |\n|  | ρcrit=𝔼ξ∼P​\\[min⁡{c​(ξ,ζ):ζ∈arg​maxΞ⁡f}\\].subscript𝜌critsubscript𝔼similar-to𝜉𝑃delimited-\\[\\]:𝑐𝜉𝜁𝜁subscriptargmaxΞ𝑓\\\\rho\\_{\\\\operatorname{crit}}=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\min\\\\left\\\\{c(\\\\xi,\\\\zeta)\\ :\\ \\\\zeta\\\\in\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\\\right\\\\}\\\\right\\]. |  |\n\nAssuming ρcrit>0subscript𝜌crit0\\\\rho\\_{\\\\operatorname{crit}}>0 excludes losses that remain constant across all samples from the ground truth distribution P𝑃P. This assumption reasonably aligns with practice and appeared in previous works \\[ [3], [5]\\]. For instance, obtaining a predictor that precisely interpolates the ground truth distribution (leading to a loss equal to zero everywhere) is unrealistic. It also defines a threshold to exclude degenerated problems: if ρ>ρcrit𝜌subscript𝜌crit\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}, then there exists f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} such that Rρ​(f)=maxΞ⁡fsubscript𝑅𝜌𝑓subscriptΞ𝑓R\\_{\\\\rho}(f)=\\\\max\\_{\\\\Xi}f and the problem becomes independent from ρ𝜌\\\\rho, see \\[ [5]\\].\n\nA similar interpretation can be made in the regularized case with smoothed counterparts. Indeed, we can verify that if ρ>ρcritτ,ϵ𝜌superscriptsubscript𝜌crit𝜏italic-ϵ\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}, then there exists f∈ℱ𝑓ℱf\\\\in\\\\mathcal{F} such that\n\n|     |     |     |\n| --- | --- | --- |\n|  | Rρτ,ϵ​(f)=supπ∈𝒫​(Ξ×Ξ),\\[π\\]1=P{𝔼\\[π\\]2​\\[f\\]−KL⁡(π∥π0)},subscriptsuperscript𝑅𝜏italic-ϵ𝜌𝑓subscriptsupremumformulae-sequence𝜋𝒫ΞΞsubscriptdelimited-\\[\\]𝜋1𝑃subscript𝔼subscriptdelimited-\\[\\]𝜋2delimited-\\[\\]𝑓KLconditional𝜋subscript𝜋0R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)=\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\[\\\\pi\\]\\_{2}}\\[f\\]-\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}, |  |\n\nand the problem becomes independent from ρ𝜌\\\\rho, see in particular [PropositionF.1]Proposition F.1. ‣ F.1 Interpretation of the critical radius in the regularized case. ‣ Appendix F Side remarks ‣ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.",
      "citations": [
        {
          "start_pos": 2971,
          "end_pos": 2975,
          "text": "[37]",
          "paper_id": "bib.bib37",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 7488,
          "end_pos": 7491,
          "text": "[3]",
          "paper_id": "bib.bib3",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 7493,
          "end_pos": 7496,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 7951,
          "end_pos": 7954,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "6 Conclusion": {
      "content": "In this work, we provide exact generalization guarantees of (regularized) Wasserstein robust models, covering all usual machine learning situations, without restrictive assumptions (on the Wasserstein metric or the class of functions). We achieve these universal results by directly addressing the intrinsic nonsmoothness of robust problems. Our results thus give users freedom when choosing the radius ρ𝜌\\\\rho: for all usual situations, it is not necessary to consider specific regimes for ρ𝜌\\\\rho in order to expect good generalization from robust models. Further research can now focus on practical aspects: it would be of premier interest to design efficient practical procedures for selecting ρ𝜌\\\\rho, and more generally, scalable algorithms for solving distributionally robust optimization problems.",
      "citations": []
    }
  },
  "references": {
    "data": {},
    "key_map": {}
  }
}