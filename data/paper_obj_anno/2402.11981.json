{
  "title": "Universal generalization guarantees for Wasserstein distributionally robust models",
  "abstract": "Distributionally robust optimization has emerged as an attractive way to\ntrain robust machine learning models, capturing data uncertainty and\ndistribution shifts. Recent statistical analyses have proved that robust models\nbuilt from Wasserstein ambiguity sets have nice generalization guarantees,\nbreaking the curse of dimensionality. However, these results are obtained in\nspecific cases, at the cost of approximations, or under assumptions difficult\nto verify in practice. In contrast, we establish, in this article, exact\ngeneralization guarantees that cover all practical cases, including any\ntransport cost function and any loss function, potentially non-convex and\nnonsmooth. For instance, our result applies to deep learning, without requiring\nrestrictive assumptions. We achieve this result through a novel proof technique\nthat combines nonsmooth analysis rationale with classical concentration\nresults. Our approach is general enough to extend to the recent versions of\nWasserstein/Sinkhorn distributionally robust problems that involve (double)\nregularizations.",
  "paper_id": "http://arxiv.org/abs/2402.11981v2",
  "markdown_content": "# Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\n\nTam Le\nUniv. Grenoble Alpes, CNRS, Grenoble INP LJK, 38000 Grenoble, FranceJÃ©rÃ´me Malick 11footnotemark: 1\n\n###### Abstract\n\nDistributionally robust optimization has emerged as an attractive way\nto train robust machine learning models, capturing data uncertainty and distribution shifts. Recent statistical analyses have proved that robust models built from Wasserstein ambiguity sets have nice generalization guarantees, breaking the curse of dimensionality. However, these results are obtained in specific cases, at the cost of approximations, or under assumptions difficult to verify in practice. In contrast, we establish, in this article, exact generalization guarantees that cover all practical cases, including any transport cost function and any loss function, potentially non-convex and nonsmooth. For instance, our result applies to deep learning, without requiring restrictive assumptions. We achieve this result through a novel proof technique that combines nonsmooth analysis rationale with classical concentration results. Our approach is general enough to extend to the recent versions of Wasserstein/Sinkhorn distributionally robust problems that involve (double) regularizations.\n\n## 1 Introduction\n\n### 1.1 Wasserstein robustness: models and generalization\n\nMachine learning models are challenged in practice by many obstacles,\nsuch as biases in data, adversarial attacks, or data shifts between training and deployment. Towards more resilient and reliable models, distributionally robust optimization has emerged as an attractive paradigm, where training no longer relies on minimizing the empirical risk, but rather on an optimization problem that takes into account potential perturbations in the data distribution; see e.g.,â€„the review articles \\[ [23](https://ar5iv.org/html/2402.11981#bib.bib23 \"\"), [9](https://ar5iv.org/html/2402.11981#bib.bib9 \"\")\\].\n\nMore specifically, the approach consists in minimizing the worst-risk among all distributions in a neighborhood of the empirical data distribution. A natural way \\[ [27](https://ar5iv.org/html/2402.11981#bib.bib27 \"\")\\] to define such a neighborhood is to use the optimal transport distance, called the Wasserstein distance \\[ [28](https://ar5iv.org/html/2402.11981#bib.bib28 \"\")\\]. Between two distributions Qğ‘„Q and Qâ€²superscriptğ‘„â€²Q^{\\\\prime} on a sample space ÎÎ\\\\Xi, the Wasserstein distance is defined as the minimal expected cost among all coupling probability Ï€ğœ‹\\\\pi on ÎÃ—ÎÎÎ\\\\Xi\\\\times\\\\Xi having Qğ‘„Q and Qâ€²superscriptğ‘„â€²Q^{\\\\prime} as marginals:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Wcâ€‹(Q,Qâ€²):=infÏ€âˆˆğ’«â€‹(ÎÃ—Î)\\[Ï€\\]1=Q,\\[Ï€\\]2=Qâ€²ğ”¼(Î¾,Î¶)âˆ¼Ï€â€‹\\[câ€‹(Î¾,Î¶)\\],assignsubscriptğ‘Šğ‘ğ‘„superscriptğ‘„â€²subscriptinfimumğœ‹ğ’«ÎÎformulae-sequencesubscriptdelimited-\\[\\]ğœ‹1ğ‘„subscriptdelimited-\\[\\]ğœ‹2superscriptğ‘„â€²subscriptğ”¼similar-toğœ‰ğœğœ‹delimited-\\[\\]ğ‘ğœ‰ğœW\\_{c}(Q,Q^{\\\\prime}):=\\\\inf\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=Q,\\[\\\\pi\\]\\_{2}=Q^{\\\\prime}\\\\end{subarray}}\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi}\\[c(\\\\xi,\\\\zeta)\\], |  | (1) |\n\nwhere c:ÎÃ—Îâ†’â„:ğ‘â†’ÎÎâ„c\\\\colon\\\\Xi\\\\times\\\\Xi\\\\rightarrow\\\\mathbb{R} is a transport cost over the sample space ÎÎ\\\\Xi. For a class of loss functions â„±â„±\\\\mathcal{F},\nthe Wasserstein distributionally robust counterpart of the standard empirical risk minimization then writes\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | minfâˆˆâ„±â¡maxQâˆˆğ’«â€‹(Î),Wcâ€‹(P^n,Q)â‰¤Ïâ¡ğ”¼Î¾âˆ¼Qâ€‹\\[fâ€‹(Î¾)\\],subscriptğ‘“â„±subscriptformulae-sequenceğ‘„ğ’«Îsubscriptğ‘Šğ‘subscript^ğ‘ƒğ‘›ğ‘„ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]ğ‘“ğœ‰\\\\min\\_{f\\\\in\\\\mathcal{F}}~{}~{}\\\\max\\_{Q\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(\\\\widehat{P}\\_{n},Q)\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[f(\\\\xi)\\], |  | (2) |\n\nfor a chosen radius ÏğœŒ\\\\rho of the Wasserstein ball centered at the empirical data distribution, denoted P^nsubscript^ğ‘ƒğ‘›\\\\widehat{P}\\_{n}. In the degenerate case\nÏ=0ğœŒ0\\\\rho=0, we have Q=P^nğ‘„subscript^ğ‘ƒğ‘›Q=\\\\widehat{P}\\_{n} and ( [2](https://ar5iv.org/html/2402.11981#S1.E2 \"Equation 2 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) boils down to empirical risk minimization. If Ï>0ğœŒ0\\\\rho>0, the training captures data uncertainty and provides more resilient learning models; see the discussions and illustrations \\[ [33](https://ar5iv.org/html/2402.11981#bib.bib33 \"\"), [35](https://ar5iv.org/html/2402.11981#bib.bib35 \"\"), [39](https://ar5iv.org/html/2402.11981#bib.bib39 \"\"), [24](https://ar5iv.org/html/2402.11981#bib.bib24 \"\"), [26](https://ar5iv.org/html/2402.11981#bib.bib26 \"\"), [36](https://ar5iv.org/html/2402.11981#bib.bib36 \"\"), [20](https://ar5iv.org/html/2402.11981#bib.bib20 \"\"), [4](https://ar5iv.org/html/2402.11981#bib.bib4 \"\"), [7](https://ar5iv.org/html/2402.11981#bib.bib7 \"\")\\].\n\nTo support theoretically the modeling versatility and the practical success of these robust models, some statistical guarantees have been proposed in the literature.\nFor a population distribution Pğ‘ƒP, i.i.d.â€„samples Î¾1,â€¦,Î¾nsubscriptğœ‰1â€¦subscriptğœ‰ğ‘›\\\\xi\\_{1},\\\\ldots,\\\\xi\\_{n} drawn from Pğ‘ƒP,\nand the associated empirical distribution\nP^n:=1nâ€‹âˆ‘i=1nÎ´Î¾iassignsubscript^ğ‘ƒğ‘›1ğ‘›superscriptsubscriptğ‘–1ğ‘›subscriptğ›¿subscriptğœ‰ğ‘–\\\\widehat{P}\\_{n}:=\\\\frac{1}{n}\\\\sum\\_{i=1}^{n}\\\\delta\\_{\\\\xi\\_{i}},\nthe best concentration results for the Wasserstein distance \\[ [18](https://ar5iv.org/html/2402.11981#bib.bib18 \"\")\\]\ngives that if the radius ÏğœŒ\\\\rho is large enough, then the Wasserstein ball around P^nsubscript^ğ‘ƒğ‘›\\\\widehat{P}\\_{n} contains the true distribution Pğ‘ƒP with high probability, which in turn gives directly \\[ [27](https://ar5iv.org/html/2402.11981#bib.bib27 \"\")\\] a generalization bound of the form\n\n![Refer to caption](https://ar5iv.org/html/2402.11981/assets/x1.png)Figure 1: Probability of the generalization boundâ€„( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to hold, estimated from 500 logistic regression instances and their â„“1subscriptâ„“1\\\\ell\\_{1}-robust counterparts (see at the end of [Section3](https://ar5iv.org/html/2402.11981#S3 \"3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). For large ÏğœŒ\\\\rho, the bound always holds, whereas it does not for small ÏğœŒ\\\\rho. Our aim is to quantify this phenomenon, which is not explained by existing results.\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | maxQâˆˆğ’«â€‹(Î),Wcâ€‹(P^n,Q)â‰¤Ïâ¡ğ”¼Î¾âˆ¼Qâ€‹\\[fâ€‹(Î¾)\\]â‰¥ğ”¼Î¾âˆ¼Pâ€‹\\[fâ€‹(Î¾)\\].subscriptformulae-sequenceğ‘„ğ’«Îsubscriptğ‘Šğ‘subscript^ğ‘ƒğ‘›ğ‘„ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]ğ‘“ğœ‰subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘“ğœ‰\\\\max\\_{Q\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(\\\\widehat{P}\\_{n},Q)\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[f(\\\\xi)\\]\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\]. |  | (3) |\n\nThis exact bound is particularly attractive: the quantity that we compute from data and optimize by training provides a control on the idealistic population risk. However, the direct application of \\[ [18](https://ar5iv.org/html/2402.11981#bib.bib18 \"\")\\] requires a number of training samples growing exponentially in the dimension.\n\nRecent works have improved this direct approach by establishing, in various situations, generalization bounds that do not suffer from the curse of dimensionality, and rather feature radius ÏğœŒ\\\\rho scaling as Oâ€‹(1/n)ğ‘‚1ğ‘›O(1/\\\\sqrt{n})\\[ [35](https://ar5iv.org/html/2402.11981#bib.bib35 \"\"), [10](https://ar5iv.org/html/2402.11981#bib.bib10 \"\"), [3](https://ar5iv.org/html/2402.11981#bib.bib3 \"\"), [19](https://ar5iv.org/html/2402.11981#bib.bib19 \"\"), [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\"), [11](https://ar5iv.org/html/2402.11981#bib.bib11 \"\")\\]. Yet no existing result is general enough to cover all situations encountered in machine learning and to explain nice generalization properties usually observed in practice (as illustrated in [Figure1](https://ar5iv.org/html/2402.11981#S1.F1 \"In 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n\n### 1.2 Contributions and outline\n\nIn this paper, we provide exact generalization guarantees of the form ( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), that are universal, in the sense that they apply to all machine learning situations, without restrictive assumptions. Indeed, our results apply to any kind of data lying in a metric space (e.g.â€„classification and regression tasks with mixed features), as well as general classes of continuous loss functions (e.g.â€„from standard regression tasks to deep learning models).\n\nWe prove these universal results by dealing directly with the nonsmoothness of the robust objective functionâ€…( [2](https://ar5iv.org/html/2402.11981#S1.E2 \"Equation 2 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) that we tackle with\ntools from variational analysisâ€„\\[ [14](https://ar5iv.org/html/2402.11981#bib.bib14 \"\"), [31](https://ar5iv.org/html/2402.11981#bib.bib31 \"\"), [1](https://ar5iv.org/html/2402.11981#bib.bib1 \"\")\\].\nAs a nice outcome of this approach, our results are able to cover deep learning models involving nonsmooth elementary blocks, such as the popular ReLUReLU\\\\operatorname{ReLU} activation function, the max-pooling operator, or optimization layers \\[ [2](https://ar5iv.org/html/2402.11981#bib.bib2 \"\")\\]. Moreover, our approach is systematic enough to extend to the recent versions of Wasserstein distributionally robust problems that involve (double) regularizations \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\"), [38](https://ar5iv.org/html/2402.11981#bib.bib38 \"\")\\].\n\nThe paper is structured as follows.\nFirst, [Section2](https://ar5iv.org/html/2402.11981#S2 \"2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") introduces and illustrates the setting of this work. Then [Section3](https://ar5iv.org/html/2402.11981#S3 \"3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") presents and discusses the main results (Theoremsâ€„[3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") andâ€„[3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n[Section4](https://ar5iv.org/html/2402.11981#S4 \"4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") highlights our proof techniques, combining classical concentration lemma and advanced nonsmooth analysis aspects.\nFinally, [Section5](https://ar5iv.org/html/2402.11981#S5 \"5 On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") sheds some light on generalization constants and other quantities of interest appearing in the results and the proof. We differ, to the supplementary, the proofs of the succession of lemmas, as well as complementary results discussing technical assumptions of existing works.\n\n### 1.3 Related work\n\nOur work stands out from a recent line of research establishing generalization guarantees for Wasserstein distributionally robust models, breaking the curse of dimensionality.\nNotably, important results on the topic include \\[ [10](https://ar5iv.org/html/2402.11981#bib.bib10 \"\"), [11](https://ar5iv.org/html/2402.11981#bib.bib11 \"\")\\] about asymptotical results for smooth losses, and \\[ [13](https://ar5iv.org/html/2402.11981#bib.bib13 \"\"), [34](https://ar5iv.org/html/2402.11981#bib.bib34 \"\")\\] about non-asymptotically results for linear models and for smooth loss functions.\nFor nonsmooth losses, the only work we are aware of is \\[ [3](https://ar5iv.org/html/2402.11981#bib.bib3 \"\")\\] which derives results on piece-wise smooth losses (at the cost of abstract approximating constants).\nWe underline that none of existing results covers deep learning models involving nonsmooth elementary blocks.\n\nThe closest work to our paper is \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] which establishes generalization results similar to ours, namely: exact bounds ( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in a regime where Ï>Oâ€‹(1/n)ğœŒğ‘‚1ğ‘›\\\\rho>O(1/\\\\sqrt{n}). In sharp contrast with our work though, these results rely on a restrictive context and some needless assumptions (the squared norm for cğ‘c, a Gaussian reference distribution, additional growth conditions, and abstract compactness conditions111We show in [PropositionF.3](https://ar5iv.org/html/2402.11981#A6.Thmproposition3 \"Proposition F.3. â€£ F.3 On the compactness condition, Assumption 5.1 from [5] â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary that the compactness assumptions hide strong conditions on the maximizers.). Throughout our developments, we will point out further technical differences with this work.\n\n### 1.4 Notations\n\n##### On probability spaces.\n\nGiven a measurable space ÎÎ\\\\Xi, we denote the space of probability measures on ÎÎ\\\\Xi by ğ’«â€‹(Î)ğ’«Î\\\\mathcal{P}(\\\\Xi). For all Ï€âˆˆğ’«â€‹(ÎÃ—Î)ğœ‹ğ’«ÎÎ\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi), iâˆˆ{1,2}ğ‘–12i\\\\in\\\\{1,2\\\\}, we denote the ithsuperscriptğ‘–thi^{\\\\text{th}} marginal of Ï€ğœ‹\\\\pi by \\[Ï€\\]isubscriptdelimited-\\[\\]ğœ‹ğ‘–\\[\\\\pi\\]\\_{i}. We denote the Dirac mass at Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi by Î´Î¾subscriptğ›¿ğœ‰\\\\delta\\_{\\\\xi}. Given a measurable function g:Îâ†’â„:ğ‘”â†’Îâ„g:\\\\Xi\\\\to\\\\mathbb{R}, we denote the expectation of gğ‘”g with respect to Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) by ğ”¼Î¾âˆ¼Qâ€‹\\[gâ€‹(Î¾)\\]subscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]ğ‘”ğœ‰\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[g(\\\\xi)\\] and we may also use the shorthand ğ”¼Qâ€‹\\[f\\]subscriptğ”¼ğ‘„delimited-\\[\\]ğ‘“\\\\mathbb{E}\\_{Q}\\[f\\].\n\n##### On function spaces.\n\nIn (ğ’³,dist)ğ’³dist(\\\\mathcal{X},\\\\operatorname{dist}) a metric space, the uniform norm of a function fğ‘“f is â€–fâ€–âˆ=supxâˆˆğ’³\\|fâ€‹(x)\\|subscriptnormğ‘“subscriptsupremumğ‘¥ğ’³ğ‘“ğ‘¥\\\\\\|f\\\\\\|\\_{\\\\infty}=\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\|f(x)\\|. If â„±â„±\\\\mathcal{F} is a family of functions, we denote â€–â„±â€–âˆ=supfâˆˆâ„±â€–fâ€–âˆsubscriptnormâ„±subscriptsupremumğ‘“â„±subscriptnormğ‘“\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}=\\\\sup\\_{f\\\\in\\\\mathcal{F}}\\\\\\|f\\\\\\|\\_{\\\\infty}. We say fğ‘“f is _Lipschitz_ with constant Lğ¿L if for all x,yâˆˆğ’³ğ‘¥ğ‘¦ğ’³x,y\\\\in\\\\mathcal{X}, \\|fâ€‹(x)âˆ’fâ€‹(y)\\|â‰¤Lâ€‹distâ¡(x,y)ğ‘“ğ‘¥ğ‘“ğ‘¦ğ¿distğ‘¥ğ‘¦\\|f(x)-f(y)\\|\\\\leq L\\\\operatorname{dist}(x,y). For Ï•:â„Ã—ğ’³â†’â„:italic-Ï•â†’â„ğ’³â„\\\\phi\\\\colon\\\\mathbb{R}\\\\times\\\\mathcal{X}\\\\to\\\\mathbb{R}, we denote âˆ‚Î»+Ï•subscriptsuperscriptğœ†italic-Ï•\\\\partial^{+}\\_{\\\\lambda}\\\\phi the right-sided derivative with respect to Î»âˆˆâ„ğœ†â„\\\\lambda\\\\in\\\\mathbb{R}, and âˆ‚Î»Ï•subscriptğœ†italic-Ï•\\\\partial\\_{\\\\lambda}\\\\phi its derivative, whenever well-defined.\n\n## 2 Assumption and examples\n\nIn this section, we present the general framework illustrated by standard examples.\nThroughout the paper, we will make the following assumptions on the sample space ÎÎ\\\\Xi, the transport cost of the Wasserstein distance, and the space â„±â„±\\\\mathcal{F} of loss functions from ÎÎ\\\\Xi to â„â„\\\\mathbb{R}.\n\n###### Assumption 2.1.\n\n- â€¢\n\n\n(Î,d)Îğ‘‘(\\\\Xi,d) is a compact metric space.\n\n- â€¢\n\n\nc:ÎÃ—Îâ†’â„:ğ‘â†’ÎÎâ„c:\\\\Xi\\\\times\\\\Xi\\\\to\\\\mathbb{R} is jointly continuous with respect to dğ‘‘d, non-negative and câ€‹(Î¾,Î¶)=0ğ‘ğœ‰ğœ0c(\\\\xi,\\\\zeta)=0 if and only if Î¾=Î¶ğœ‰ğœ\\\\xi=\\\\zeta.\n\n- â€¢\n\n\n(â„±,âˆ¥â‹…âˆ¥âˆ)(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) is compact and every fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} is continuous.\n\n\nThis setting encompasses a wide range of machine learning scenarios, as illustrated below.\n\n##### Sample space and transport costs.\n\nThe choice of the transport cost cğ‘c depends on the nature of the data and of the potential data uncertainty. For instance, if the variables are continuous with ÎâŠ‚â„mÎsuperscriptâ„ğ‘š\\\\Xi\\\\subset\\\\mathbb{R}^{m}, we consider the distance d=âˆ¥â‹…âˆ’â‹…âˆ¥pd=\\\\\\|\\\\cdot-\\\\cdot\\\\\\|\\_{p} induced by â„“psubscriptâ„“ğ‘\\\\ell\\_{p}-norm (pâˆˆ\\[1,âˆ\\]ğ‘1p\\\\in\\[1,\\\\infty\\]) and the cost as a power (qâˆˆ\\[1,âˆ)ğ‘1q\\\\in\\[1,\\\\infty)) of the distance\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | câ€‹(Î¾,Î¾â€²)=â€–Î¾âˆ’Î¾â€²â€–pq.ğ‘ğœ‰superscriptğœ‰â€²superscriptsubscriptnormğœ‰superscriptğœ‰â€²ğ‘ğ‘c(\\\\xi,\\\\xi^{\\\\prime})=\\\\\\|\\\\xi-\\\\xi^{\\\\prime}\\\\\\|\\_{p}^{q}. |  |\\\n\\\nIf the variables are discrete with ÎâŠ‚{1,â€¦,J}mÎsuperscript1â€¦ğ½ğ‘š\\\\Xi\\\\subset\\\\left\\\\{1,\\\\ldots,J\\\\right\\\\}^{m}, we consider the distance\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | dâ€‹(Î¾,Î¾â€²)=âˆ‘i=1mğŸ™{Î¾iâ‰ Î¾iâ€²}ğ‘‘ğœ‰superscriptğœ‰â€²superscriptsubscriptğ‘–1ğ‘šsubscript1subscriptğœ‰ğ‘–superscriptsubscriptğœ‰ğ‘–â€²d(\\\\xi,\\\\xi^{\\\\prime})=\\\\sum\\_{i=1}^{m}\\\\mathds{1}\\_{\\\\left\\\\{\\\\xi\\_{i}\\\\neq\\\\xi\\_{i}^{\\\\prime}\\\\right\\\\}} |  |\\\n\\\nand the cost as a power of this distance.\\\nFinally, If we deal with mixed data, i.e. they contain both continuous and discrete variables, a sum of the previous costs can be considered. In classification, for instance, with the samples composed of features xâˆˆâ„mğ‘¥superscriptâ„ğ‘šx\\\\in\\\\mathbb{R}^{m} and a target yâˆˆ{âˆ’1,1}ğ‘¦11y\\\\in\\\\left\\\\{-1,1\\\\right\\\\}, we may take, for a chosen Îº>0ğœ…0\\\\kappa>0\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | câ€‹((x,y),(xâ€²,yâ€²))=â€–xâˆ’xâ€²â€–pq+Îºâ€‹ğŸ™{yâ‰ yâ€²}ğ‘ğ‘¥ğ‘¦superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptsubscriptnormğ‘¥superscriptğ‘¥â€²ğ‘ğ‘ğœ…subscript1ğ‘¦superscriptğ‘¦â€²c((x,y),(x^{\\\\prime},y^{\\\\prime}))=\\\\\\|x-x^{\\\\prime}\\\\\\|\\_{p}^{q}+\\\\kappa\\\\mathds{1}\\_{\\\\left\\\\{y\\\\neq y^{\\\\prime}\\\\right\\\\}} |  | (4) |\\\n\\\nwhich is obviously continuous with respect to\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | dâ€‹((x,y),(xâ€²,yâ€²))=â€–xâˆ’xâ€²â€–p+ğŸ™{yâ‰ yâ€²}.ğ‘‘ğ‘¥ğ‘¦superscriptğ‘¥â€²superscriptğ‘¦â€²subscriptnormğ‘¥superscriptğ‘¥â€²ğ‘subscript1ğ‘¦superscriptğ‘¦â€²d((x,y),(x^{\\\\prime},y^{\\\\prime}))=\\\\\\|x-x^{\\\\prime}\\\\\\|\\_{p}+\\\\mathds{1}\\_{\\\\left\\\\{y\\\\neq y^{\\\\prime}\\\\right\\\\}}. |  | (5) |\\\n\\\nThis extends to mixed data with categorical, binary, and continuous variables; see e.g.â€„\\[ [7](https://ar5iv.org/html/2402.11981#bib.bib7 \"\")\\].\\\n\\\n##### Parametric models and loss functions.\\\n\\\nOur setting covers all standard machine learning models.\\\nConsider a parametric family â„±={fâ€‹(Î¸,â‹…):Î¸âˆˆÎ˜}â„±conditional-setğ‘“ğœƒâ‹…ğœƒÎ˜\\\\mathcal{F}=\\\\left\\\\{f(\\\\theta,\\\\cdot)\\ :\\ \\\\theta\\\\in\\\\Theta\\\\right\\\\},\\\nwhere the parameter space Î˜âŠ‚â„pÎ˜superscriptâ„ğ‘\\\\Theta\\\\subset\\\\mathbb{R}^{p} compact and the loss function f:Î˜Ã—Îâ†’â„:ğ‘“â†’Î˜Îâ„f\\\\colon\\\\Theta\\\\times\\\\Xi\\\\to\\\\mathbb{R} is jointly continuous. If ÎÎ\\\\Xi is compact, such a family is compact regarding âˆ¥â‹…âˆ¥âˆ\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. This situation covers regression models, k-means clustering, and neural networks.\\\nFor example: least-squares regression\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,(x,y))=(âŸ¨Î¸,xâŸ©âˆ’y)2,ÎâŠ‚â„mÃ—â„,formulae-sequenceğ‘“ğœƒğ‘¥ğ‘¦superscriptğœƒğ‘¥ğ‘¦2Îsuperscriptâ„ğ‘šâ„f(\\\\theta,(x,y))=(\\\\langle\\\\theta,x\\\\rangle-y)^{2},\\\\quad\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\mathbb{R}, |  |\\\n\\\nlogistic regression\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,(x,y))=logâ¡(1+eâˆ’yâ€‹âŸ¨Î¸,xâŸ©),ÎâŠ‚â„mÃ—{âˆ’1,1},formulae-sequenceğ‘“ğœƒğ‘¥ğ‘¦1superscriptğ‘’ğ‘¦ğœƒğ‘¥Îsuperscriptâ„ğ‘š11f(\\\\theta,(x,y))=\\\\log\\\\left(1+e^{-y\\\\langle\\\\theta,x\\\\rangle}\\\\right),\\\\quad\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\{-1,1\\\\}, |  |\\\n\\\nand support vector machines with hinge loss\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,(x,y))=maxâ¡{0,1âˆ’yâ€‹âŸ¨Î¸,xâŸ©},ÎâŠ‚â„mÃ—{âˆ’1,1}formulae-sequenceğ‘“ğœƒğ‘¥ğ‘¦01ğ‘¦ğœƒğ‘¥Îsuperscriptâ„ğ‘š11f(\\\\theta,(x,y))=\\\\max\\\\left\\\\{0,1-y\\\\langle\\\\theta,x\\\\rangle\\\\right\\\\},\\\\hskip 8.00003pt\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\{-1,1\\\\} |  |\\\n\\\nNote that this function is not differentiable, due to the max term. The k-means model also introduces a non-differentiable loss function:\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,x)=miniâˆˆ{1,â€¦,K}â¡â€–Î¸iâˆ’xâ€–22,Î˜âŠ‚â„KÃ—m,ÎâŠ‚â„m.formulae-sequenceğ‘“ğœƒğ‘¥subscriptğ‘–1â€¦ğ¾superscriptsubscriptnormsubscriptğœƒğ‘–ğ‘¥22formulae-sequenceÎ˜superscriptâ„ğ¾ğ‘šÎsuperscriptâ„ğ‘šf(\\\\theta,x)=\\\\min\\_{i\\\\in\\\\left\\\\{1,\\\\ldots,K\\\\right\\\\}}\\\\\\|\\\\theta\\_{i}-x\\\\\\|\\_{2}^{2},\\\\quad\\\\Theta\\\\subset\\\\mathbb{R}^{K\\\\times m}\\\\!,~{}\\\\Xi\\\\subset\\\\mathbb{R}^{m}. |  |\\\n\\\nFinally, most deep learning models fall in our setting. Indeed, they involve loss functions of the form\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,(x,y))=â„“â€‹(hâ€‹(Î¸,x),y),ğ‘“ğœƒğ‘¥ğ‘¦â„“â„ğœƒğ‘¥ğ‘¦f(\\\\theta,(x,y))=\\\\ell(h(\\\\theta,x),y), |  |\\\n\\\nwhere â„“â„“\\\\ell is a dissimilarity measure, and hâ„h is a parameterized prediction function, built as a composition of affine transformations (which are the parameters to train) with activation functions (see e.g.â€„\\[ [22](https://ar5iv.org/html/2402.11981#bib.bib22 \"\"), [25](https://ar5iv.org/html/2402.11981#bib.bib25 \"\"), [30](https://ar5iv.org/html/2402.11981#bib.bib30 \"\")\\]). Our setting is general enough to encompass all continuous activation functions, even non-differentiable ones (as ReLU=maxâ¡(0,â‹…)ReLU0â‹…\\\\operatorname{ReLU}=\\\\max(0,\\\\cdot))\\\nas well as other nonsmooth elementary blocks (as max-pooling \\[ [21](https://ar5iv.org/html/2402.11981#bib.bib21 \"\")\\], sorting procedures \\[ [32](https://ar5iv.org/html/2402.11981#bib.bib32 \"\")\\], and optimization layers \\[ [2](https://ar5iv.org/html/2402.11981#bib.bib2 \"\")\\]).\\\nAs already underlined in introduction, these examples involving non-differentiable terms are not covered by existing results.\\\n\\\n## 3 Main results\\\n\\\n### 3.1 Wasserstein robust models\\\n\\\nOur main result establishes a generalization bound ( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) for Wasserstein distributionally robust optimization (WDRO). Given a distribution Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) and a loss fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, the robust risk around Qğ‘„Q with radius Ï>0ğœŒ0\\\\rho>0 is then defined as\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | RÏ,Qâ€‹(f):=maxQâ€²âˆˆğ’«â€‹(Î),Wcâ€‹(Q,Qâ€²)â‰¤Ïâ¡ğ”¼Î¾âˆ¼Qâ€²â€‹\\[fâ€‹(Î¾)\\].assignsubscriptğ‘…ğœŒğ‘„ğ‘“subscriptformulae-sequencesuperscriptğ‘„â€²ğ’«Îsubscriptğ‘Šğ‘ğ‘„superscriptğ‘„â€²ğœŒsubscriptğ”¼similar-toğœ‰superscriptğ‘„â€²delimited-\\[\\]ğ‘“ğœ‰R\\_{\\\\rho,Q}(f):=\\\\max\\_{Q^{\\\\prime}\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(Q,Q^{\\\\prime})\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q^{\\\\prime}}\\[f(\\\\xi)\\]. |  | (6) |\\\n\\\nIn particular, taking Q=P^nğ‘„subscript^ğ‘ƒğ‘›Q=\\\\widehat{P}\\_{n} and Q=Pğ‘„ğ‘ƒQ=P in the above expression, we consider the empirical robust risk, R^Ïâ€‹(f)subscript^ğ‘…ğœŒğ‘“\\\\widehat{R}\\_{\\\\rho}(f), and the true robust risk, RÏâ€‹(f)subscriptğ‘…ğœŒğ‘“R\\_{\\\\rho}(f):\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^Ïâ€‹(f):=RÏ,P^nâ€‹(f)â€‹ and â€‹RÏâ€‹(f):=RÏ,Pâ€‹(f).assignsubscript^ğ‘…ğœŒğ‘“subscriptğ‘…ğœŒsubscript^ğ‘ƒğ‘›ğ‘“ and subscriptğ‘…ğœŒğ‘“assignsubscriptğ‘…ğœŒğ‘ƒğ‘“\\\\widehat{R}\\_{\\\\rho}(f):=R\\_{\\\\rho,\\\\widehat{P}\\_{n}}(f)\\\\text{ \\\\quad and \\\\quad}R\\_{\\\\rho}(f):=R\\_{\\\\rho,P}(f). |  | (7) |\\\n\\\nOur generalization result states as follows:\\\n\\\n###### Theorem 3.1(Generalization guarantee for Wasserstein robust models).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exist Î±,Î²>0ğ›¼ğ›½0\\\\alpha,\\\\beta>0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Î±n<Ï<Ïcrit2âˆ’Î²n,ğ›¼ğ‘›ğœŒsubscriptğœŒcrit2ğ›½ğ‘›\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}, |  |\\\n\\\nthen with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ€fâˆˆâ„±,R^Ïâ€‹(f)â‰¥ğ”¼Î¾âˆ¼Pâ€‹\\[fâ€‹(Î¾)\\].formulae-sequencefor-allğ‘“â„±subscript^ğ‘…ğœŒğ‘“subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘“ğœ‰\\\\forall f\\\\in\\\\mathcal{F},\\\\quad\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\]. |  |\\\n\\\nThe quantity ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}} is a _critical radius_,\\\na relevant threshold that excludes degenerated problems and flat losses for which RÏâ€‹(f)=maxÎâ¡fsubscriptğ‘…ğœŒğ‘“subscriptÎğ‘“R\\_{\\\\rho}(f)=\\\\max\\_{\\\\Xi}f. The exact generalization guarantee thus holds for a wide range of radius ÏğœŒ\\\\rho, growing with the sample size between the two extreme cases 00 and ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}}. As in Theorem 3.1 from \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\], but adding the wide setting of [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), the sample rates are dimension-free. The constants Î±ğ›¼\\\\alpha and Î²ğ›½\\\\beta depend on the problem quantities, see [Section5](https://ar5iv.org/html/2402.11981#S5 \"5 On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for a detailed discussion.\\\n\\\n### 3.2 Regularized Wasserstein robust models\\\n\\\nPart of the success of optimal transport in machine learning is the use of regularization, and specifically entropic regularization, opening the way to nice properties and efficient computational schemes \\[ [15](https://ar5iv.org/html/2402.11981#bib.bib15 \"\"), [28](https://ar5iv.org/html/2402.11981#bib.bib28 \"\")\\]. Recall that the entropy-regularized Wasserstein distance writes, for a reference coupling Ï€0âˆˆğ’«â€‹(ÎÃ—Î)subscriptğœ‹0ğ’«ÎÎ\\\\pi\\_{0}\\\\in\\\\mathcal{P}(\\\\Xi\\\\!\\\\times\\\\!\\\\Xi)\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | WcÏ„â€‹(P,Q)=infÏ€âˆˆğ’«â€‹(ÎÃ—Î)\\[Ï€\\]1=P,\\[Ï€2\\]=Q{ğ”¼Ï€â€‹\\[c\\]+Ï„â€‹KLâ¡(Ï€âˆ¥Ï€0)}subscriptsuperscriptğ‘Šğœğ‘ğ‘ƒğ‘„subscriptinfimumğœ‹ğ’«ÎÎformulae-sequencesubscriptdelimited-\\[\\]ğœ‹1ğ‘ƒdelimited-\\[\\]subscriptğœ‹2ğ‘„subscriptğ”¼ğœ‹delimited-\\[\\]ğ‘ğœKLconditionalğœ‹subscriptğœ‹0W^{\\\\tau}\\_{c}(P,Q)=\\\\inf\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P,\\[\\\\pi\\_{2}\\]=Q\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\} |  | (8) |\\\n\\\nwhere KLKL\\\\operatorname{KL} is the Kullback-Leibler divergence w.r.t.â€„Ï€0subscriptğœ‹0\\\\pi\\_{0}:\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | KLâ¡(Ï€âˆ¥Ï€0)={âˆ«ÎÃ—Îlogâ¡dâ€‹Ï€dâ€‹Ï€0â€‹dâ€‹Ï€when â€‹Ï€â‰ªÏ€0âˆotherwise.KLconditionalğœ‹subscriptğœ‹0casessubscriptÎÎdğœ‹dsubscriptğœ‹0dğœ‹much-less-thanwhen ğœ‹subscriptğœ‹0otherwise.\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})=\\\\begin{cases}\\\\int\\_{\\\\Xi\\\\times\\\\Xi}\\\\log\\\\frac{\\\\mathrm{d}\\\\pi}{\\\\mathrm{d}\\\\pi\\_{0}}\\\\,\\\\mathrm{d}\\\\pi&\\\\text{when }\\\\pi\\\\ll\\\\pi\\_{0}\\\\\\<br>\\\\infty&\\\\text{otherwise.}\\\\end{cases} |  |\\\n\\\nRegularization have been recently studied in the context of WDRO: \\[ [38](https://ar5iv.org/html/2402.11981#bib.bib38 \"\")\\] introduces an entropic regularization in constraints for computational interests, \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] considers an entropic regularization in the objective for generalization, and \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\] studies a general regularization in both constraints and objective.\\\n\\\nFollowing the most general case \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\], we consider\\\nthe robust risk with double regularization\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | RÏ,QÏ„,Ïµâ€‹(f):=supÏ€âˆˆğ’«â€‹(ÎÃ—Î),\\[Ï€\\]1=Qğ”¼Ï€â€‹\\[c\\]+Ï„â€‹KLâ¡(Ï€âˆ¥Ï€0)â‰¤Ï{ğ”¼\\[Ï€\\]2â€‹\\[f\\]âˆ’Ïµâ€‹KLâ¡(Ï€âˆ¥Ï€0)}.assignsuperscriptsubscriptğ‘…ğœŒğ‘„ğœitalic-Ïµğ‘“subscriptsupremumformulae-sequenceğœ‹ğ’«ÎÎsubscriptdelimited-\\[\\]ğœ‹1ğ‘„subscriptğ”¼ğœ‹delimited-\\[\\]ğ‘ğœKLconditionalğœ‹subscriptğœ‹0ğœŒsubscriptğ”¼subscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]ğ‘“italic-ÏµKLconditionalğœ‹subscriptğœ‹0R\\_{\\\\rho,Q}^{\\\\tau,\\\\epsilon}(f):=\\\\!\\\\!\\\\!\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),~{}\\[\\\\pi\\]\\_{1}=Q\\\\\\<br>\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\leq\\\\rho\\\\end{subarray}}\\\\!\\\\!\\\\!\\\\left\\\\{\\\\mathbb{E}\\_{\\[\\\\pi\\]\\_{2}}\\[f\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}. |  |\\\n\\\nwith two parameters Ïµ>0italic-Ïµ0\\\\epsilon>0 and Ï„â‰¥0ğœ0\\\\tau\\\\geq 0.\\\nIntroducing the conditional moment of Ï€0subscriptğœ‹0\\\\pi\\_{0}:\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | mc=maxÎ¾âˆˆÎâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[câ€‹(Î¾,Î¶)\\],m\\_{c}=\\\\max\\_{\\\\xi\\\\in\\\\Xi}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[c(\\\\xi,\\\\zeta)\\], |  | (9) |\\\n\\\nthe generalization guarantee in this setting states as follows.\\\n\\\n###### Theorem 3.2(Generalization for double regularization).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exist Î±Ï„,Ïµ,Î²Ï„,Ïµ>0superscriptğ›¼ğœitalic-Ïµsuperscriptğ›½ğœitalic-Ïµ0\\\\alpha^{\\\\tau,\\\\epsilon}\\\\!,\\\\beta^{\\\\tau,\\\\epsilon}\\\\!>\\\\!0â€„suchâ€„thatâ€„if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | maxâ¡{mc,Î±Ï„,Ïµn}<Ï<ÏcritÏ„,Ïµ2âˆ’Î²Ï„,Ïµn,subscriptğ‘šğ‘superscriptğ›¼ğœitalic-Ïµğ‘›ğœŒsuperscriptsubscriptğœŒcritğœitalic-Ïµ2superscriptğ›½ğœitalic-Ïµğ‘›\\\\max\\\\left\\\\{m\\_{c},\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}\\\\right\\\\}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}-\\\\frac{\\\\beta^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}, |  |\\\n\\\nthen with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} and all Qğ‘„Q such that WcÏ„â€‹(P,Q)â‰¤Ïsubscriptsuperscriptğ‘Šğœğ‘ğ‘ƒğ‘„ğœŒW^{\\\\tau}\\_{c}(P,Q)\\\\leq\\\\rho,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ÏÏ„,Ïµâ€‹(f)â‰¥ğ”¼Î¶âˆ¼Qâ€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€P,Qâˆ¥Ï€0),subscriptsuperscript^ğ‘…ğœitalic-ÏµğœŒğ‘“subscriptğ”¼similar-toğœğ‘„delimited-\\[\\]ğ‘“ğœitalic-ÏµKLconditionalsuperscriptğœ‹ğ‘ƒğ‘„subscriptğœ‹0\\\\widehat{R}^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0}), |  |\\\n\\\nwhere Ï€P,Qsuperscriptğœ‹ğ‘ƒğ‘„\\\\pi^{P,Q} is the optimal coupling in ( [8](https://ar5iv.org/html/2402.11981#S3.E8 \"Equation 8 â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nThis result is similar to the one of [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), it is also similar to the only other generalization result existing for regularized WDRO \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\]. Let us explicit below the main differences. We will discuss in [Section5](https://ar5iv.org/html/2402.11981#S5 \"5 On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), the generalization constants such as the critical radius ÏcritÏ„,ÏµsuperscriptsubscriptğœŒcritğœitalic-Ïµ\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}.\\\n\\\nUnlike Wasserstein robust models ( [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), regularization leads to an inexact generalization guarantee, where the regularized empirical robust risk bounds a proxy for the true risk ğ”¼Pâ€‹\\[f\\]subscriptğ”¼ğ‘ƒdelimited-\\[\\]ğ‘“\\\\mathbb{E}\\_{P}\\[f\\]. This is in line with the regularization in optimal transport that induces a bias in the Wasserstein metric, preventing WcÏ„â€‹(P,P)subscriptsuperscriptğ‘Šğœğ‘ğ‘ƒğ‘ƒW^{\\\\tau}\\_{c}(P,P) from being null.\\\n\\\nCompared to \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\], we underline that our result covers also the double regularization case. Moreover, it is valid for an arbitrary Ï€0subscriptğœ‹0\\\\pi\\_{0} whereas the one of \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] relies on the specific form Ï€0subscriptğœ‹0\\\\pi\\_{0} involving a Gaussian term. Our result is thus more flexible, allowing to choose conjointly cğ‘c and Ï€0subscriptğœ‹0\\\\pi\\_{0}. For example, a Laplace distribution can be chosen when cğ‘c is the â„“1subscriptâ„“1\\\\ell\\_{1}-norm.\\\n\\\nBefore moving on to the proof of the generalization results, let us come back to [Figure1](https://ar5iv.org/html/2402.11981#S1.F1 \"In 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). To get this plot, we generated 500 instances of logistic regression problems with synthetic classification data (n=100ğ‘›100n=100, d=5ğ‘‘5d=5), for which we solve an associated robust counterpart (with an â„“1subscriptâ„“1\\\\ell\\_{1}-cost cğ‘c and a Laplace distribution Ï€0(â‹…\\|Î¾)\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | minÎ¸â¡maxğ”¼Ï€\\[âˆ¥â‹…âˆ¥1\\]â‰¤Ï\\[Ï€\\]1=P^n\\\\displaystyle\\\\min\\_{\\\\theta}\\\\max\\_{\\\\begin{subarray}{c}\\\\mathbb{E}\\_{\\\\pi}\\[\\\\\\|{\\\\cdot}\\\\\\|\\_{1}\\]\\\\leq\\\\rho\\\\\\<br>\\[\\\\pi\\]\\_{1}=\\\\widehat{P}\\_{n}\\\\end{subarray}} | ğ”¼(x,y)âˆ¼\\[Ï€\\]2â€‹\\[logâ¡(1+eyâ€‹âŸ¨Î¸,xâŸ©)\\].subscriptğ”¼similar-toğ‘¥ğ‘¦subscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]1superscriptğ‘’ğ‘¦ğœƒğ‘¥\\\\displaystyle\\\\mathbb{E}\\_{(x,y)\\\\sim\\[\\\\pi\\]\\_{2}}\\[\\\\log(1+e^{y\\\\langle\\\\theta,x\\\\rangle})\\]. |  |\\\n\\\nThis setting is covered by [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") but not by existing results in previous works. Let us check the realizations of the bound ( [3](https://ar5iv.org/html/2402.11981#S1.E3 \"Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Using 105superscript10510^{5} samples, we estimate the true risk ğ”¼Pâ€‹\\[f\\]subscriptğ”¼ğ‘ƒdelimited-\\[\\]ğ‘“\\\\mathbb{E}\\_{P}\\[f\\] for computed optimal solutions fğ‘“f of the 500 instances.\\\nOn the figure, we report the proportion of instances for which the bound holds and we observe that when ÏğœŒ\\\\rho increases, the bound does hold true.\\\n\\\n## 4 Proof strategy\\\n\\\nThis section presents our strategy to prove the generalization results of Sectionâ€„[3](https://ar5iv.org/html/2402.11981#S3 \"3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")â€„(Theoremsâ€„[3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\nThe strength of our approach is to use\\\nflexible nonsmooth analysis arguments, able to cover the general situation of arbitrary (continuous) cost and objective functions. After an overview of the proof in [Section4.2](https://ar5iv.org/html/2402.11981#S4.SS2 \"4.2 Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we explain the key mechanisms in Sectionsâ€„[4.3](https://ar5iv.org/html/2402.11981#S4.SS3 \"4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and how they combine with a concentration theorem ( [Section4.1](https://ar5iv.org/html/2402.11981#S4.SS1 \"4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to show the results.\\\n\\\nIn Sectionsâ€„[4.2](https://ar5iv.org/html/2402.11981#S4.SS2 \"4.2 Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), [4.3](https://ar5iv.org/html/2402.11981#S4.SS3 \"4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") we consider the standard WDRO setting of [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The extension to the regularized setting of [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is then explained in [Section4.5](https://ar5iv.org/html/2402.11981#S4.SS5 \"4.5 Extension to (double) regularization. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Furthermore, in order to focus on the rationale we do not include the proofs in the core of the paper and we refer precisely to corresponding results in the supplementary. We also underline the fundamental results of probability and (nonsmooth) analysis that are used all along. All the statements of this section implicitly assume that our [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") holds.\\\n\\\n### 4.1 Uniform concentration inequality\\\n\\\nIn order to obtain high-probability bounds guarantees, uniform on â„±â„±\\\\mathcal{F}, we rely on a standard uniform concentration inequality on a compact metric space. We recall the essential result below, highlighting the two crucial properties on the random variable: _(i) boundedness_ and _(ii) global Lipschitzness_.\\\nWe refer to e.g. \\[ [12](https://ar5iv.org/html/2402.11981#bib.bib12 \"\")\\] for general discussions, and to [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). â€£ A.1 Uniform concentration inequality â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for one-sided alternatives.\\\n\\\n###### Theorem 4.1(Uniform concentration).\\\n\\\nLet (ğ’³,dist)ğ’³dist(\\\\mathcal{X},\\\\operatorname{dist}) be a compact metric space, and X:ğ’³Ã—Îâ†’â„:ğ‘‹â†’ğ’³Îâ„X:\\\\mathcal{X}\\\\times\\\\Xi\\\\to\\\\mathbb{R} be a measurable function. Assume the following:\\\n\\\n1. (i)\\\n\\\n\\\nThere exist a,bâˆˆâ„ğ‘ğ‘â„a,b\\\\in\\\\mathbb{R} such that Xâ€‹(x,Î¾)âˆˆ\\[a,b\\]ğ‘‹ğ‘¥ğœ‰ğ‘ğ‘X(x,\\\\xi)\\\\in\\[a,b\\] for all (x,Î¾)âˆˆğ’³Ã—Îğ‘¥ğœ‰ğ’³Î(x,\\\\xi)\\\\in\\\\mathcal{X}\\\\times\\\\Xi.\\\n\\\n2. (ii)\\\n\\\n\\\nXâ€‹(â‹…,Î¾)ğ‘‹â‹…ğœ‰X(\\\\cdot,\\\\xi) is Lğ¿L-Lipschitz for all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi.\\\n\\\n\\\nThen with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | supxâˆˆğ’³\\|ğ”¼Î¾âˆ¼P^nâ€‹\\[Xâ€‹(x,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼Pâ€‹\\[Xâ€‹(x,Î¾)\\]\\|â‰¤Mn.subscriptsupremumğ‘¥ğ’³subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]ğ‘‹ğ‘¥ğœ‰subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘‹ğ‘¥ğœ‰ğ‘€ğ‘›\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\\\left\\|\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[X(x,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[X(x,\\\\xi)\\]\\\\right\\|\\\\leq\\\\frac{M}{\\\\sqrt{n}}. |  |\\\n\\\nMğ‘€M is a problem-dependent constant having the expression222The constant â„â€‹(ğ’³,dist)â„ğ’³dist\\\\mathcal{I}({\\\\mathcal{X},\\\\operatorname{dist}}) is the standard Dudleyâ€™s entropy integral measuring the complexity of the space ğ’³ğ’³\\\\mathcal{X}, that we further discuss in [DefinitionA.4](https://ar5iv.org/html/2402.11981#A1.Thmdefinition4 \"Definition A.4. â€£ A.1 Uniform concentration inequality â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | M=48â€‹Lâ€‹â„â€‹(ğ’³,dist)+(bâˆ’a)â€‹2â€‹logâ¡(2/Î´).ğ‘€48ğ¿â„ğ’³distğ‘ğ‘22ğ›¿M=48\\\\,L\\\\,\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist})+\\ (b-a)\\\\sqrt{2\\\\log(2/\\\\delta)}. |  |\\\n\\\nWe will apply this concentration result to two families of functions (Ïˆğœ“\\\\psi and Ï•italic-Ï•\\\\phi) appearing in our proof; to this end, we will establish the two points (i) and (ii) in [Lemma4.1](https://ar5iv.org/html/2402.11981#S4.Thmlemma1 \"Lemma 4.1. â€£ 4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [Lemma4.3](https://ar5iv.org/html/2402.11981#S4.Thmlemma3 \"Lemma 4.3. â€£ Dual bound on the empirical risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") respectively.\\\n\\\n### 4.2 Proofâ€™s overview\\\n\\\nCompared to the original formulation ( [6](https://ar5iv.org/html/2402.11981#S3.E6 \"Equation 6 â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), the dual representation of WDRO significantly diminishes the problemâ€™s degrees of freedom, and is usually the starting point of most studies.\\\nGiven any distribution Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi), it holds that\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | RÏ,Qâ€‹(f)=infÎ»â‰¥0{Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]},subscriptğ‘…ğœŒğ‘„ğ‘“subscriptinfimumğœ†0ğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰R\\_{\\\\rho,Q}(f)=\\\\inf\\_{\\\\lambda\\\\geq 0}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  | (10) |\\\n\\\nwhere the _dual generator_ Ï•italic-Ï•\\\\phi is a convex function with respect to Î»ğœ†\\\\lambda, and Lipschitz continuous with respect to fğ‘“f. For Wasserstein robust models, Ï•italic-Ï•\\\\phi has the expression (see e.g.â€„\\[ [8](https://ar5iv.org/html/2402.11981#bib.bib8 \"\")\\])\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Ï•â€‹(Î»,f,Î¾)=supÎ¶âˆˆÎ{fâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)}.italic-Ï•ğœ†ğ‘“ğœ‰subscriptsupremumğœÎğ‘“ğœğœ†ğ‘ğœ‰ğœ\\\\phi(\\\\lambda,f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\\\right\\\\}. |  |\\\n\\\nObserve that Ï•italic-Ï•\\\\phi is naturally convex in Î»ğœ†\\\\lambda, but also nonsmooth. The originality of our approach is to build on this nonsmoothness by using a rationale of nonsmooth analysis. Note also that the convexity of Ï•italic-Ï•\\\\phi will be a key property (see e.g. the argument ofâ€„[Figure3](https://ar5iv.org/html/2402.11981#S4.F3 \"In Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nLet us then outline the main steps to establish [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n1. 1.\\\n\\\n\\\nWe establish in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") the existence of a dual lower bound Î»lowsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{low}}, which holds with high probability and uniformly on â„±â„±\\\\mathcal{F}, whenever Ï<Ïcrit2âˆ’Î²nğœŒsubscriptğœŒcrit2ğ›½ğ‘›\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}:\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^Ïâ€‹(f)=infÎ»âˆˆ\\[Î»low,âˆ){Î»â€‹Ï+ğ”¼P^nâ€‹\\[Ï•â€‹(Î»,f)\\]}.subscript^ğ‘…ğœŒğ‘“subscriptinfimumğœ†subscriptğœ†lowğœ†ğœŒsubscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“\\\\widehat{R}\\_{\\\\rho}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\infty)}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f)\\]\\\\right\\\\}. |  |\\\n\\\n2. 2.\\\n\\\n\\\nAs explained in [Section4.3](https://ar5iv.org/html/2402.11981#S4.SS3 \"4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), this leads to\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^Ïâ€‹(f)â‰¥RÏâˆ’Î±nâ€‹(f).subscript^ğ‘…ğœŒğ‘“subscriptğ‘…ğœŒğ›¼ğ‘›ğ‘“\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f). |  |\\\n\\\n3. 3.\\\n\\\n\\\nFinally, if furthermore Î±n<Ïğ›¼ğ‘›ğœŒ\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho, then we capture the true risk on the right:\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^Ïâ€‹(f)â‰¥ğ”¼Pâ€‹\\[f\\].subscript^ğ‘…ğœŒğ‘“subscriptğ”¼ğ‘ƒdelimited-\\[\\]ğ‘“\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{P}\\[f\\]. |  |\\\n\\\n\\\n### 4.3 Concentration aspects by dual lower bound\\\n\\\nWe assume in this section that the empirical dual solution is lower bounded by a value Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 (with high probability), which means that the infimum inâ€„( [10](https://ar5iv.org/html/2402.11981#S4.E10 \"Equation 10 â€£ 4.2 Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), with Q=P^nğ‘„subscript^ğ‘ƒğ‘›Q=\\\\widehat{P}\\_{n}, may be taken over \\[Î»low,0)subscriptğœ†low0\\[\\\\lambda\\_{\\\\operatorname{low}},0) instead ofâ€„â„+subscriptâ„\\\\mathbb{R}\\_{+}. In this case, we can proceed as follows. For a distributionâ€„Qğ‘„Q, we use the shorthand ğ”¼Qâ€‹\\[Ï•\\]=ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]subscriptğ”¼ğ‘„delimited-\\[\\]italic-Ï•subscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\mathbb{E}\\_{Q}\\[\\\\phi\\]=\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]. Then we can write for Î»â‰¥Î»lowğœ†subscriptğœ†low\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}},\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | Î»â€‹Ï+ğ”¼P^nâ€‹\\[Ï•\\]ğœ†ğœŒsubscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•\\\\displaystyle\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi\\] | â‰¥Î»â€‹(Ïâˆ’(ğ”¼Pâ€‹\\[Ï•\\]âˆ’ğ”¼P^nâ€‹\\[Ï•\\]Î»))+ğ”¼Pâ€‹\\[Ï•\\]absentğœ†ğœŒsubscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•subscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†subscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•\\\\displaystyle\\\\geq\\\\lambda\\\\left(\\\\rho-\\\\left(\\\\frac{\\\\mathbb{E}\\_{P}\\[\\\\phi\\]-\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi\\]}{\\\\lambda}\\\\right)\\\\right)+\\\\mathbb{E}\\_{P}\\[\\\\phi\\] |  |\\\n|  |  | â‰¥Î»â€‹(Ïâˆ’Î±n)+ğ”¼Pâ€‹\\[Ï•\\],absentğœ†ğœŒsubscriptğ›¼ğ‘›subscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•\\\\displaystyle\\\\geq\\\\lambda(\\\\rho-\\\\alpha\\_{n})+\\\\mathbb{E}\\_{P}\\[\\\\phi\\], |  | (11) |\\\n\\\nwhere Î±nsubscriptğ›¼ğ‘›\\\\alpha\\_{n} is a formal lower bound on the quotient term (formally defined ( [4.3](https://ar5iv.org/html/2402.11981#S4.Ex22 \"4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"))).\\\nTaking the infimum over Î»â‰¥Î»lowğœ†subscriptğœ†low\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}}, we obtain\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^Ïâ€‹(f)â‰¥RÏâˆ’Î±nâ€‹(f)â‰¥ğ”¼Î¾âˆ¼Pâ€‹\\[fâ€‹(Î¾)\\],subscript^ğ‘…ğœŒğ‘“subscriptğ‘…ğœŒsubscriptğ›¼ğ‘›ğ‘“subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘“ğœ‰\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\alpha\\_{n}}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\], |  | (12) |\\\n\\\nwhenever Ï>Î±nğœŒsubscriptğ›¼ğ‘›\\\\rho>\\\\alpha\\_{n}. This is the desired inequality of [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Thus, in order to have ( [4.3](https://ar5iv.org/html/2402.11981#S4.Ex21 \"4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) with high probability for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, we introduce the function Ïˆğœ“\\\\psi of the variable Î¼=Î»âˆ’1ğœ‡superscriptğœ†1\\\\mu=\\\\lambda^{-1}:\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | Ïˆâ€‹(Î¼,f,Î¾)ğœ“ğœ‡ğ‘“ğœ‰\\\\displaystyle\\\\psi(\\\\mu,\\\\!f,\\\\xi) | :=Î¼â€‹Ï•â€‹(Î¼âˆ’1,f,Î¾)=supÎ¶âˆˆÎ{Î¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)}assignabsentğœ‡italic-Ï•superscriptğœ‡1ğ‘“ğœ‰subscriptsupremumğœÎğœ‡ğ‘“ğœğ‘ğœ‰ğœ\\\\displaystyle\\\\!:=\\\\!\\\\mu\\\\phi(\\\\mu^{-1}\\\\!,\\\\!f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)\\\\!-\\\\!c(\\\\xi,\\\\zeta)\\\\right\\\\} |  | (13) |\\\n\\\nand we study the gap Î±nsubscriptğ›¼ğ‘›\\\\alpha\\_{n} defined by\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | Î±n:=supassignsubscriptğ›¼ğ‘›supremum\\\\displaystyle\\\\alpha\\_{n}:=\\\\sup | {ğ”¼Î¾âˆ¼P\\[Ïˆ(Î¼,f,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼P^n\\[Ïˆ(Î¼,f,Î¾)\\]\\\\displaystyle\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]\\\\right. |  |\\\n|  |  | :(Î¼,f)âˆˆ(0,Î»lowâˆ’1\\]Ã—â„±}.\\\\displaystyle\\ :\\ \\\\left.(\\\\mu,f)\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}\\\\right\\\\}. |  | (14) |\\\n\\\nIn order to obtain a high probability bound of the form Î±nâ‰¤Î±nsubscriptğ›¼ğ‘›ğ›¼ğ‘›\\\\alpha\\_{n}\\\\leq\\\\frac{\\\\alpha}{\\\\sqrt{n}}, boundedness (i) and Lipschitz continuity (ii) of (Î¼,f)â†¦Ïˆâ€‹(Î¼,f,Î¾)maps-toğœ‡ğ‘“ğœ“ğœ‡ğ‘“ğœ‰(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) are required by the concentration theoremâ€„[Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). In the expression ( [13](https://ar5iv.org/html/2402.11981#S4.E13 \"Equation 13 â€£ 4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we remark that the Lipschitz constant of Ïˆâ€‹(Î¼,f,Î¾)ğœ“ğœ‡ğ‘“ğœ‰\\\\psi(\\\\mu,f,\\\\xi) explodes as Î¼â†’âˆâ†’ğœ‡\\\\mu\\\\to\\\\infty, hence we must bound Î¼=Î»âˆ’1ğœ‡superscriptğœ†1\\\\mu=\\\\lambda^{-1} above. Thus, if a lower bound Î»lowsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{low}} holds on Î»ğœ†\\\\lambda, Ïˆğœ“\\\\psi satisfies the requirements of [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n###### Lemma 4.1.\\\n\\\nGiven Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0, then for almost all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi,\\\n\\\n1. (i)\\\n\\\n\\\nFor all Î¼âˆˆ(0,Î»lowâˆ’1\\]ğœ‡0superscriptsubscriptğœ†low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Ïˆâ€‹(Î¼,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆÎ»low,â€–â„±â€–âˆÎ»low\\].ğœ“ğœ‡ğ‘“ğœ‰subscriptnormâ„±subscriptğœ†lowsubscriptnormâ„±subscriptğœ†low\\\\psi(\\\\mu,f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\]. |  |\\\n\\\n2. (ii)\\\n\\\n\\\n(Î¼,f)â†¦Ïˆâ€‹(Î¼,f,Î¾)maps-toğœ‡ğ‘“ğœ“ğœ‡ğ‘“ğœ‰(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) is Lipschitz continuous on (0,Î»lowâˆ’1\\]Ã—â„±0superscriptsubscriptğœ†low1â„±(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F} with constant â€–â„±â€–âˆ+Î»lowâˆ’1subscriptnormâ„±superscriptsubscriptğœ†low1\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\n\n\n###### Proof.\n\nSee [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). â€£ C.1 Standard WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").2 in the supplementary.\nâˆ\n\n### 4.4 Getting a dual lower bound.\n\nIn order to get a dual lower bound, we proceed in two steps:\n\n1. 1.\n\n\nWe show the existence of a dual lower bound on the true robust risk. This involves the definition of an inherent maximal radius, which plays the role of a degeneracy threshold.\n\n2. 2.\n\n\nWe show that the lower bound on the true robust risk transposes to the empirical robust risk, with high probability and uniformly on â„±â„±\\\\mathcal{F}. This is done by expressing a slope condition and applying the concentration inequality [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n\n##### Dual bound on the true risk.\n\nIn order to obtain a dual lower bound on the true robust risk, it is sufficient for the (right-sided) derivative of Î»â†¦Î»â€‹Ï+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]maps-toğœ†ğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\lambda\\\\mapsto\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\] to be negative for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} on an interval \\[0,2â€‹Î»low\\]02subscriptğœ†low\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\]333Although the factor 2 may not seem necessary at the moment, its role will become clearer in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4.SSS0.Px2 \"Dual bound on the empirical risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), with Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0. This writes:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Ïâ‰¤ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\],ğœŒsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptsuperscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰\\\\rho\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\], |  | (15) |\n\nwhich implies that ÏğœŒ\\\\rho has to be small. To obtain the condition ( [15](https://ar5iv.org/html/2402.11981#S4.E15 \"Equation 15 â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) uniformly in fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, we introduce the maximal value of ÏğœŒ\\\\rho allowed at a given Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0 (illustrated in [Figure2](https://ar5iv.org/html/2402.11981#S4.F2 \"In Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n![Refer to caption](https://ar5iv.org/html/2402.11981/assets/x2.png)Figure 2: A central object of our analysis: the maximal radius ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max}, defined from the lower envelope of derivatives of Ï•italic-Ï•\\\\phi.\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Ïmaxâ€‹(Î»)=inffâˆˆâ„±ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\].subscriptğœŒğœ†subscriptinfimumğ‘“â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptsubscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]. |  | (16) |\n\nAs illustrated by [Figure2](https://ar5iv.org/html/2402.11981#S4.F2 \"In Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} reaches its highest value at zero. This is the _critical radius_,\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ïcrit=Ïmaxâ€‹(0).subscriptğœŒcritsubscriptğœŒ0\\\\rho\\_{\\\\operatorname{crit}}=\\\\rho\\_{\\\\max}(0). |  |\n\nThis particular quantity will be discussed in [Section5.2](https://ar5iv.org/html/2402.11981#S5.SS2 \"5.2 The critical radius â€£ 5 On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). As a central result of this work, we show that ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} can be made arbitrarily close to ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}} as Î»â†’0+â†’ğœ†superscript0\\\\lambda\\\\to 0^{+}.\n\n###### Lemma 4.2.\n\nlimÎ»â†’0+Ïmaxâ€‹(Î»)=Ïcritsubscriptâ†’ğœ†superscript0subscriptğœŒğœ†subscriptğœŒcrit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}. In particular, there exists Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that for all Î»âˆˆ\\[0,2â€‹Î»low\\]ğœ†02subscriptğœ†low\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\], for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\]â‰¤âˆ’Ïcrit2.subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptsuperscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰subscriptğœŒcrit2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}. |  | (17) |\n\n###### Proof.\n\nSee [LemmaD.1](https://ar5iv.org/html/2402.11981#A4.Thmlemma1 \"Lemma D.1. â€£ D.1 Standard WDRO: continuity at zero of the maximal radius â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\nâˆ\n\nThis means that the derivative condition ( [15](https://ar5iv.org/html/2402.11981#S4.E15 \"Equation 15 â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) is satisfied whenever Ïâ‰¤Ïcrit2ğœŒsubscriptğœŒcrit2\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}. In order to transpose the inequality ( [17](https://ar5iv.org/html/2402.11981#S4.E17 \"Equation 17 â€£ Lemma 4.2. â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to the empirical problem, precisely to obtain ğ”¼Î¾âˆ¼P^nâ€‹\\[âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\]â‰¤âˆ’Ïcrit2subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]subscriptsuperscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰subscriptğœŒcrit2\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2} with high probability, we would like to apply the concentration theorem ( [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Unfortunately, the derivative âˆ‚Î»+Ï•â€‹(Î»,â‹…,Î¾)subscriptsuperscriptğœ†italic-Ï•ğœ†â‹…ğœ‰\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,\\\\cdot,\\\\xi) is discontinuous and doesnâ€™t satisfy the Lipschitz condition (ii) from [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Indeed, its expression is inherently given by the envelope formula (Theorem 2.8.2, \\[ [14](https://ar5iv.org/html/2402.11981#bib.bib14 \"\")\\]) involving an arg max:\n\n|     |     |     |\n| --- | --- | --- |\n|  | âˆ‚Î»+Ï•(Î»,f,Î¾)=âˆ’minÎ¶âˆˆÎ{c(Î¶,argâ€‹maxÎ{fâˆ’Î»c(Î¾,â‹…)}}.\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)=-\\\\min\\_{\\\\zeta\\\\in\\\\Xi}\\\\{c(\\\\zeta,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\}\\\\}. |  |\n\n![Refer to caption](https://ar5iv.org/html/2402.11981/assets/x3.png)Figure 3: Bounding from below the empirical dual solution Î»âˆ—superscriptğœ†\\\\lambda^{\\*} expresses as a slope condition (thanks to convexity of the objective).\n\n##### Dual bound on the empirical risk.\n\nWe propose a simple way to overcome the limitation highlighted above by relying on the convexity of Ï•italic-Ï•\\\\phi. Indeed, given a convex function gğ‘”g over â„+superscriptâ„\\\\mathbb{R}^{+}, the infimum of gğ‘”g has to occur on an interval \\[Î»low,+âˆ\\]subscriptğœ†low\\[\\\\lambda\\_{\\\\operatorname{low}},+\\\\infty\\] if gğ‘”g has a negative slope between Î»lowsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{low}} and 2â€‹Î»low2subscriptğœ†low2\\\\lambda\\_{\\\\operatorname{low}} ( [Figure3](https://ar5iv.org/html/2402.11981#S4.F3 \"In Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n|     |     |     |\n| --- | --- | --- |\n|  | gâ€‹(2â€‹Î»low)âˆ’gâ€‹(Î»low)Î»lowâ‰¤0âŸ¹infÎ»â‰¥Î»lowgâ€‹(Î»)=infÎ»â‰¥0gâ€‹(Î»).ğ‘”2subscriptğœ†lowğ‘”subscriptğœ†lowsubscriptğœ†low0subscriptinfimumğœ†subscriptğœ†lowğ‘”ğœ†subscriptinfimumğœ†0ğ‘”ğœ†\\\\frac{g(2\\\\lambda\\_{\\\\operatorname{low}})-g(\\\\lambda\\_{\\\\operatorname{low}})}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\leq 0\\\\implies\\\\inf\\_{\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}}}g(\\\\lambda)=\\\\inf\\_{\\\\lambda\\\\geq 0}g(\\\\lambda). |  |\n\nWe want this condition satisfied for the empirical Lagrangian function gâ€‹(Î»)=Î»â€‹Ï+ğ”¼P^nâ€‹\\[Ï•â€‹(Î»,f)\\]ğ‘”ğœ†ğœ†ğœŒsubscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“g(\\\\lambda)=\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f)\\] with high probability. For convenience, this can be expressed with the slope of ğ”¼P^nâ€‹\\[Ï•â€‹(â‹…,f)\\]subscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•â‹…ğ‘“\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\cdot,f)\\]:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | s^â€‹(f):=ğ”¼P^nâ€‹\\[Ï•â€‹(2â€‹Î»low,f)\\]âˆ’ğ”¼P^nâ€‹\\[Ï•â€‹(Î»low,f)\\]Î»lowâ‰¤âˆ’Ï.assign^ğ‘ ğ‘“subscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•2subscriptğœ†lowğ‘“subscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•subscriptğœ†lowğ‘“subscriptğœ†lowğœŒ\\\\widehat{s}(f)\\\\!:=\\\\!\\\\frac{\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\]-\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f)\\]}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\leq-\\\\rho. |  | (18) |\n\nThis is the condition we aim to obtain. To this end, we proceed by comparing the empirical slope to the true one,\n\n|     |     |     |\n| --- | --- | --- |\n|  | sâ€‹(f):=ğ”¼Pâ€‹\\[Ï•â€‹(2â€‹Î»low,f)\\]âˆ’ğ”¼Pâ€‹\\[Ï•â€‹(Î»low,f)\\]Î»low.assignğ‘ ğ‘“subscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•2subscriptğœ†lowğ‘“subscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•subscriptğœ†lowğ‘“subscriptğœ†lows(f):=\\\\frac{\\\\mathbb{E}\\_{P}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\]-\\\\mathbb{E}\\_{P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f)\\]}{\\\\lambda\\_{\\\\operatorname{low}}}. |  |\n\nIndeed, we can show that any function (f,Î¾)â†¦Ï•â€‹(Î»,f,Î¾)maps-toğ‘“ğœ‰italic-Ï•ğœ†ğ‘“ğœ‰(f,\\\\xi)\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi), with Î»âˆˆâ„+ğœ†subscriptâ„\\\\lambda\\\\in\\\\mathbb{R}\\_{+}, satisfies the requirements for the concentration theorem ( [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n###### Lemma 4.3.\n\nFor almost all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi we have\n\n1. (i)\n\n\nFor all Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0 and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ï•â€‹(Î»,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆ,â€–â„±â€–âˆ\\].italic-Ï•ğœ†ğ‘“ğœ‰subscriptnormâ„±subscriptnormâ„±\\\\phi(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\]. |  |\n\n2. (ii)\n\n\nFor all Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0, fâ†¦Ï•â€‹(Î»,f,Î¾)maps-toğ‘“italic-Ï•ğœ†ğ‘“ğœ‰f\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi) is Lipschitz continuous on â„±â„±\\\\mathcal{F} with constant 111.\n\n\n###### Proof.\n\nSee [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). â€£ C.1 Standard WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").1.\nâˆ\n\nConsequently, we can apply the concentration theorem twice, on each function Ï•â€‹(2â€‹Î»low,â‹…,â‹…)italic-Ï•2subscriptğœ†lowâ‹…â‹…\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},\\\\cdot,\\\\cdot) and Ï•â€‹(2â€‹Î»low,â‹…,â‹…)italic-Ï•2subscriptğœ†lowâ‹…â‹…\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},\\\\cdot,\\\\cdot), to obtain that s^â€‹(f)^ğ‘ ğ‘“\\\\widehat{s}(f) approximates sâ€‹(f)ğ‘ ğ‘“s(f) with high probability, up to a term of the form Î²nğ›½ğ‘›\\\\frac{\\\\beta}{\\\\sqrt{n}}:\n\n|     |     |     |\n| --- | --- | --- |\n|  | âˆ€fâˆˆâ„±,s^â€‹(f)â‰¤sâ€‹(f)+Î²n.formulae-sequencefor-allğ‘“â„±^ğ‘ ğ‘“ğ‘ ğ‘“ğ›½ğ‘›\\\\forall f\\\\in\\\\mathcal{F},\\\\quad\\\\widehat{s}(f)\\\\leq s(f)+\\\\frac{\\\\beta}{\\\\sqrt{n}}. |  |\n\nOn the other hand, sâ€‹(f)â‰¤ğ”¼Pâ€‹\\[âˆ‚Î»+Ï•â€‹(2â€‹Î»low,f)\\]ğ‘ ğ‘“subscriptğ”¼ğ‘ƒdelimited-\\[\\]subscriptsuperscriptğœ†italic-Ï•2subscriptğœ†lowğ‘“s(f)\\\\leq\\\\mathbb{E}\\_{P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\] by convexity of Ï•italic-Ï•\\\\phi, hence sâ€‹(f)â‰¤âˆ’Ïcrit2ğ‘ ğ‘“subscriptğœŒcrit2s(f)\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2} by ( [17](https://ar5iv.org/html/2402.11981#S4.E17 \"Equation 17 â€£ Lemma 4.2. â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). This means\n\n|     |     |     |\n| --- | --- | --- |\n|  | s^â€‹(f)â‰¤Î²nâˆ’Ïcrit2,^ğ‘ ğ‘“ğ›½ğ‘›subscriptğœŒcrit2\\\\widehat{s}(f)\\\\leq\\\\frac{\\\\beta}{\\\\sqrt{n}}-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}, |  |\n\nhence we have the desired condition ( [18](https://ar5iv.org/html/2402.11981#S4.E18 \"Equation 18 â€£ Dual bound on the empirical risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) when\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ï<Ïcrit2âˆ’Î²n.ğœŒsubscriptğœŒcrit2ğ›½ğ‘›\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}. |  |\n\n### 4.5 Extension to (double) regularization.\n\nThe strategy of [Section4.2](https://ar5iv.org/html/2402.11981#S4.SS2 \"4.2 Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is flexible enough to be extended to the regularized setting of [Section3.2](https://ar5iv.org/html/2402.11981#S3.SS2 \"3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Indeed, the regularized problem also has a dual representation, with a dual generator defined by\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)=(Ïµ+Î»â€‹Ï„)â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\],\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\], |  |\n\nwhere Ïµ>0italic-Ïµ0\\\\epsilon>0 and Ï„â‰¥0ğœ0\\\\tau\\\\geq 0. Strong duality has been shown in \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\]. We explain in [AppendixB](https://ar5iv.org/html/2402.11981#A2 \"Appendix B Strong duality â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), [PropositionB.2](https://ar5iv.org/html/2402.11981#A2.Thmproposition2 \"Proposition B.2 (Strong duality, regularized WDRO). â€£ Appendix B Strong duality â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") how it applies to our general setting. This regularized dual generator leads to smooth counterparts of the key nonsmooth functions Ïˆğœ“\\\\psi, ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} and ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}} of the proof. In particular, we can show the regularized version of [Lemma4.2](https://ar5iv.org/html/2402.11981#S4.Thmlemma2 \"Lemma 4.2. â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n###### Lemma 4.4.\n\nlimÎ»â†’0+ÏmaxÏ„,Ïµâ€‹(Î»)=ÏcritÏ„,Ïµsubscriptâ†’ğœ†superscript0superscriptsubscriptğœŒğœitalic-Ïµğœ†superscriptsubscriptğœŒcritğœitalic-Ïµ\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}. In particular, there exists Î»lowÏ„,Ïµ>0superscriptsubscriptğœ†lowğœitalic-Ïµ0\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}>0 such that for all Î»âˆˆ\\[0,2â€‹Î»lowÏ„,Ïµ\\]ğœ†02superscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}\\], âˆ€fâˆˆâ„±for-allğ‘“â„±\\\\forall f\\\\in\\\\mathcal{F},\n\n|     |     |     |\n| --- | --- | --- |\n|  | ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]â‰¤âˆ’ÏcritÏ„,Ïµ2.subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰superscriptsubscriptğœŒcritğœitalic-Ïµ2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}. |  |\n\nThen we obtain [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") by repeating the proof scheme of [Section4.2](https://ar5iv.org/html/2402.11981#S4.SS2 \"4.2 Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The core results that simultaneously lead to Theorems [3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") are gathered in [SectionE.1](https://ar5iv.org/html/2402.11981#A5.SS1 \"E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Due to the smoothness of ÏmaxÏ„,ÏµsuperscriptsubscriptğœŒğœitalic-Ïµ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}, an expression of Î»lowÏ„,Ïµsuperscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} can also be obtained; see [LemmaD.2](https://ar5iv.org/html/2402.11981#A4.Thmlemma2 \"Lemma D.2. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\nThe key difference brought by regularization is that the Lipschitz property of ÏˆÏ„,Ïµsuperscriptğœ“ğœitalic-Ïµ\\\\psi^{\\\\tau,\\\\epsilon} is lost when Î¼â†’0â†’ğœ‡0\\\\mu\\\\to 0. This is an inherent peculiarity of the regularized setting which may occur over the whole family â„±â„±\\\\mathcal{F} and the space ÎÎ\\\\Xi; see the example of [PropositionF.2](https://ar5iv.org/html/2402.11981#A6.Thmproposition2 \"Proposition F.2. â€£ F.2 Necessity of the dual upper-bound â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). This prevents to use the concentration result without guaranteeing that we can set a lower bound on Î¼ğœ‡\\\\mu or equivalently an upper-bound on Î»ğœ†\\\\lambda. This is the purpose of the next lemma which establishes the existence of such an upper-bound, for any distribution.\n\n###### Lemma 4.5.\n\nLet Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) and Î»up:=2â€‹â€–â„±â€–âˆÏâˆ’mcassignsubscriptğœ†up2subscriptnormâ„±ğœŒsubscriptğ‘šğ‘\\\\lambda\\_{\\\\operatorname{up}}:=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}. Then for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\n\n|     |     |     |\n| --- | --- | --- |\n|  | RÏ,Qâ€‹(f)=infÎ»âˆˆ\\[0,Î»up\\]{Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}.subscriptğ‘…ğœŒğ‘„ğ‘“subscriptinfimumğœ†0subscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰R\\_{\\\\rho,Q}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}}\\]}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\n\n###### Proof.\n\nSee [LemmaD.3](https://ar5iv.org/html/2402.11981#A4.Thmlemma3 \"Lemma D.3 (Upper bound for the regularized problem Lemma 4.5). â€£ D.2.2 Dual upper-bound â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\nâˆ\n\n## 5 On the generalization constants\n\nIn this section, we put our generalization results into perspective by further discussing the bounds Î±,Î²ğ›¼ğ›½\\\\alpha,\\\\beta, the critical radius ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}} appearing in [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), as well as their regularized counterparts of [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n### 5.1 Sample complexity\n\nWe give the complete expressions of Î±ğ›¼\\\\alpha, Î²ğ›½\\\\beta, Î±Ï„,Ïµsuperscriptğ›¼ğœitalic-Ïµ\\\\alpha^{\\\\tau,\\\\epsilon} and Î²Ï„,Ïµsuperscriptğ›½ğœitalic-Ïµ\\\\beta^{\\\\tau,\\\\epsilon} in the detailed versions of Theoremsâ€„[3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in [SectionE.2](https://ar5iv.org/html/2402.11981#A5.SS2 \"E.2 Proof of the main results â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Here we highlight their dependence from the problemâ€™s constants.\n\nFirst, in the setting of [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), Î±ğ›¼\\\\alpha and Î²ğ›½\\\\beta grow essentially with the size and the complexity of â„±â„±\\\\mathcal{F}. Indeed, we have\n\n|     |     |     |     |     |\n| --- | --- | --- | --- | --- |\n|  | Î±ğ›¼\\\\displaystyle\\\\alpha | =O(â„(â„±,âˆ¥â‹…âˆ¥âˆ)Ã—âˆ¥â„±âˆ¥âˆ),\\\\displaystyle=O\\\\big{(}\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\times\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\\\big{)}, |  | (19) |\n|  | Î²ğ›½\\\\displaystyle\\\\beta | =O(âˆ¥â„±âˆ¥âˆ+â„(â„±,âˆ¥â‹…âˆ¥âˆ)).\\\\displaystyle=O\\\\big{(}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\big{)}. |  |\n\nThe Dudleyâ€™s entropy â„(â„±,âˆ¥â‹…âˆ¥âˆ)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) quantifies the complexity of â„±â„±\\\\mathcal{F}. In the large class of Lipschitz functions, this quantity is exponential in the data dimension. In practice, most machine learning problems involve a Lipschitz parametric family of losses ( [Section2](https://ar5iv.org/html/2402.11981#S2 \"2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in which case â„(â„±,âˆ¥â‹…âˆ¥âˆ)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) becomes proportional to pğ‘\\\\sqrt{p}, where pğ‘p is the parameterâ€™s dimension (see e.g. Chapter 5.1 from \\[ [37](https://ar5iv.org/html/2402.11981#bib.bib37 \"\")\\]).\n\nThe constants Î±ğ›¼\\\\alpha and Î²ğ›½\\\\beta also grow with 1/Î»low1subscriptğœ†low1/\\\\lambda\\_{\\\\operatorname{low}} and we have Î±=Oâ€‹(1/Î»low2)ğ›¼ğ‘‚1superscriptsubscriptğœ†low2\\\\alpha=O\\\\left(1/{\\\\lambda\\_{\\\\operatorname{low}}^{2}}\\\\right) and Î²=Oâ€‹(1/Î»low)ğ›½ğ‘‚1subscriptğœ†low\\\\beta=O\\\\left(1/{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right). The constant Î»lowsubscriptğœ†low{\\\\lambda\\_{\\\\operatorname{low}}} is implicitly defined and depends on the regularity at 00 of ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} ( [16](https://ar5iv.org/html/2402.11981#S4.E16 \"Equation 16 â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), hence it may depend on â„±â„±\\\\mathcal{F}, ÎÎ\\\\Xi, cğ‘c and Pğ‘ƒP.\n\nIn the setting of [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we have similar interpretations. In addition to the conditional moment mcsubscriptğ‘šğ‘m\\_{c} ( [9](https://ar5iv.org/html/2402.11981#S3.E9 \"Equation 9 â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), the constants Î±Ï„,Ïµsuperscriptğ›¼ğœitalic-Ïµ\\\\alpha^{\\\\tau,\\\\epsilon} and Î²Ï„,Ïµsuperscriptğ›½ğœitalic-Ïµ\\\\beta^{\\\\tau,\\\\epsilon} also involve the second order conditional moment:\n\n|     |     |     |\n| --- | --- | --- |\n|  | m2,c=maxÎ¾âˆˆÎâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[câ€‹(Î¾,Î¶)2\\].m\\_{2,c}=\\\\max\\_{\\\\xi\\\\in\\\\Xi}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[c(\\\\xi,\\\\zeta)^{2}\\]. |  |\n\nThey are parameters that may be chosen in practice and related to the reference coupling Ï€0subscriptğœ‹0\\\\pi\\_{0}. For instance, if Ï€0(â‹…\\|Î¾)\\\\pi\\_{0}(\\\\cdot\\|\\\\xi) is a truncated Gaussian Ï€0(â‹…\\|Î¾)âˆeâˆ’âˆ¥â‹…âˆ’Î¾âˆ¥22â€‹Ïƒ2ğŸ™Î\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\propto e^{-\\\\frac{\\\\\\|\\\\cdot-\\\\xi\\\\\\|^{2}}{2\\\\sigma^{2}}}\\\\mathds{1}\\_{\\\\Xi} and câ€‹(Î¾,Î¶)=12â€‹â€–Î¾âˆ’Î¶â€–2ğ‘ğœ‰ğœ12superscriptnormğœ‰ğœ2c(\\\\xi,\\\\zeta)=\\\\frac{1}{2}\\\\\\|\\\\xi-\\\\zeta\\\\\\|^{2} we have mcâˆÏƒ2proportional-tosubscriptğ‘šğ‘superscriptğœ2m\\_{c}\\\\propto\\\\sigma^{2} and m2,câˆÏƒ4proportional-tosubscriptğ‘š2ğ‘superscriptğœ4m\\_{2,c}\\\\propto\\\\sigma^{4}.\n\nThe coefficients Î±Ï„,Ïµsuperscriptğ›¼ğœitalic-Ïµ\\\\alpha^{\\\\tau,\\\\epsilon} and Î²Ï„,Ïµsuperscriptğ›½ğœitalic-Ïµ\\\\beta^{\\\\tau,\\\\epsilon} exhibit similar relations with Î»lowÏ„,Ïµsuperscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}, â€–â„±â€–âˆsubscriptnormâ„±\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}, and â„(â„±,âˆ¥â‹…âˆ¥âˆ)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) to their counterparts Î±ğ›¼\\\\alpha and Î²ğ›½\\\\beta ( [19](https://ar5iv.org/html/2402.11981#S5.E19 \"Equation 19 â€£ 5.1 Sample complexity â€£ 5 On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Regarding the hyperparameters mcsubscriptğ‘šğ‘m\\_{c}, Ïµitalic-Ïµ\\\\epsilon, Ï„ğœ\\\\tau and ÏğœŒ\\\\rho, they should be of comparable order according to the expression of Î±Ï„,Ïµsuperscriptğ›¼ğœitalic-Ïµ\\\\alpha^{\\\\tau,\\\\epsilon} ( [TheoremE.2](https://ar5iv.org/html/2402.11981#A5.Thmtheorem2 \"Theorem E.2 (Generalization guarantee, regularized WDRO). â€£ E.2 Proof of the main results â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Compared to the standard setting, we have an estimate of the lower bound Î»lowÏ„,Ïµsuperscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} ( [LemmaD.2](https://ar5iv.org/html/2402.11981#A4.Thmlemma2 \"Lemma D.2. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) showing dependence on the loss family: 1/Î»lowÏ„,Ïµ=Oâ€‹(eâ€–â„±â€–âˆÏµ)1superscriptsubscriptğœ†lowğœitalic-Ïµğ‘‚superscriptğ‘’subscriptnormâ„±italic-Ïµ1/{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}=O\\\\big{(}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\big{)}.\n\n### 5.2 The critical radius\n\nIn the standard setting, the critical radius has the expression\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ïcrit=ğ”¼Î¾âˆ¼Pâ€‹\\[minâ¡{câ€‹(Î¾,Î¶):Î¶âˆˆargâ€‹maxÎâ¡f}\\].subscriptğœŒcritsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]:ğ‘ğœ‰ğœğœsubscriptargmaxÎğ‘“\\\\rho\\_{\\\\operatorname{crit}}=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\min\\\\left\\\\{c(\\\\xi,\\\\zeta)\\ :\\ \\\\zeta\\\\in\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\\\right\\\\}\\\\right\\]. |  |\n\nAssuming Ïcrit>0subscriptğœŒcrit0\\\\rho\\_{\\\\operatorname{crit}}>0 excludes losses that remain constant across all samples from the ground truth distribution Pğ‘ƒP. This assumption reasonably aligns with practice and appeared in previous works \\[ [3](https://ar5iv.org/html/2402.11981#bib.bib3 \"\"), [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\]. For instance, obtaining a predictor that precisely interpolates the ground truth distribution (leading to a loss equal to zero everywhere) is unrealistic. It also defines a threshold to exclude degenerated problems: if Ï>ÏcritğœŒsubscriptğœŒcrit\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}, then there exists fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} such that RÏâ€‹(f)=maxÎâ¡fsubscriptğ‘…ğœŒğ‘“subscriptÎğ‘“R\\_{\\\\rho}(f)=\\\\max\\_{\\\\Xi}f and the problem becomes independent from ÏğœŒ\\\\rho, see \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\].\n\nA similar interpretation can be made in the regularized case with smoothed counterparts. Indeed, we can verify that if Ï>ÏcritÏ„,ÏµğœŒsuperscriptsubscriptğœŒcritğœitalic-Ïµ\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}, then there exists fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} such that\n\n|     |     |     |\n| --- | --- | --- |\n|  | RÏÏ„,Ïµâ€‹(f)=supÏ€âˆˆğ’«â€‹(ÎÃ—Î),\\[Ï€\\]1=P{ğ”¼\\[Ï€\\]2â€‹\\[f\\]âˆ’KLâ¡(Ï€âˆ¥Ï€0)},subscriptsuperscriptğ‘…ğœitalic-ÏµğœŒğ‘“subscriptsupremumformulae-sequenceğœ‹ğ’«ÎÎsubscriptdelimited-\\[\\]ğœ‹1ğ‘ƒsubscriptğ”¼subscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]ğ‘“KLconditionalğœ‹subscriptğœ‹0R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)=\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\[\\\\pi\\]\\_{2}}\\[f\\]-\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}, |  |\n\nand the problem becomes independent from ÏğœŒ\\\\rho, see in particular [PropositionF.1](https://ar5iv.org/html/2402.11981#A6.Thmproposition1 \"Proposition F.1. â€£ F.1 Interpretation of the critical radius in the regularized case. â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\n\n## 6 Conclusion\n\nIn this work, we provide exact generalization guarantees of (regularized) Wasserstein robust models, covering all usual machine learning situations, without restrictive assumptions (on the Wasserstein metric or the class of functions). We achieve these universal results by directly addressing the intrinsic nonsmoothness of robust problems. Our results thus give users freedom when choosing the radius ÏğœŒ\\\\rho: for all usual situations, it is not necessary to consider specific regimes for ÏğœŒ\\\\rho in order to expect good generalization from robust models. Further research can now focus on practical aspects: it would be of premier interest to design efficient practical procedures for selecting ÏğœŒ\\\\rho, and more generally, scalable algorithms for solving distributionally robust optimization problems.\n\n## Acknowledgements\n\nThis research was partially supported by MIAI@Grenoble Alpes (ANR-19-P3IA-0003).\n\n## References\n\n- \\[1\\]C. Aliprantis and K. Border, Infinite Dimensional Analysis,\nSpringer Berlin, Heidelberg, 2006.\n\n- \\[2\\]B. Amos and J. Z. Kolter, Optnet: Differentiable optimization as a\nlayer in neural networks, in International Conference on Machine Learning,\nPMLR, 2017, pp. 136â€“145.\n\n- \\[3\\]Y. An and R. Gao, Generalization bounds for (wasserstein) robust\noptimization, in Advances in Neural Information Processing Systems, vol. 34,\n2021, pp. 10382â€“10392.\n\n- \\[4\\]A. Arrigo, C. Ordoudis, J. Kazempour, Z. De GrÃ¨ve, J.-F. Toubeau, and\nF. VallÃ©e, Wasserstein distributionally robust chance-constrained\noptimization for energy and reserve dispatch: An exact and physically-bounded\nformulation, European Journal of Operational Research, 296 (2022),\npp. 304â€“322.\n\n- \\[5\\]W. Azizian, F. Iutzeler, and J. Malick, Exact generalization\nguarantees for (regularized) wasserstein distributionally robust models,\narXiv preprint arXiv:2305.17076, (2023).\n\n- \\[6\\], Regularization for\nwasserstein distributionally robust optimization, ESAIM: Control,\nOptimisation and Calculus of Variations, 29 (2023), p. 33.\n\n- \\[7\\]R. Belbasi, A. Selvi, and W. Wiesemann, Itâ€™s all in the mix:\nWasserstein machine learning with mixed features, arXiv preprint\narXiv:2312.12230, (2023).\n\n- \\[8\\]J. Blanchet and K. Murthy, Quantifying distributional model risk via\noptimal transport, Mathematics of Operations Research, 44 (2019),\npp. 565â€“600.\n\n- \\[9\\]J. Blanchet, K. Murthy, and V. A. Nguyen, Statistical analysis of\nwasserstein distributionally robust estimators, in Tutorials in Operations\nResearch: Emerging Optimization Methods and Modeling Techniques with\nApplications, INFORMS, 2021, pp. 227â€“254.\n\n- \\[10\\]J. Blanchet, K. Murthy, and N. Si, Confidence regions in\nWasserstein distributionally robust estimation, Biometrika, 109 (2021),\npp. 295â€“315.\n\n- \\[11\\]J. Blanchet and A. Shapiro, Statistical limit theorems in\ndistributionally robust optimization, 2023.\n\n- \\[12\\]S. Boucheron, G. Lugosi, and P. Massart, Concentration\nInequalities: A Nonasymptotic Theory of Independence, Oxford University\nPress, 2013.\n\n- \\[13\\]R. Chen and I. C. Paschalidis, A robust learning approach for\nregression models based on distributionally robust optimization, Journal of\nMachine Learning Research, 19 (2018), pp. 1â€“48.\n\n- \\[14\\]F. Clarke, Optimization and Nonsmooth Analysis, Classics in Applied\nMathematics, Society for Industrial and Applied Mathematics, 1990.\n\n- \\[15\\]M. Cuturi, Sinkhorn distances: Lightspeed computation of optimal\ntransport, in Advances in Neural Information Processing Systems, vol. 26,\n2013.\n\n- \\[16\\]M. D. Donsker and S. R. S. Varadhan, Asymptotic evaluation of\ncertain markov process expectations for large time, i, Communications on\nPure and Applied Mathematics, 28 (1975), pp. 1â€“47.\n\n- \\[17\\]R. Durrett, Probability: Theory and Examples, Cambridge Series in\nStatistical and Probabilistic Mathematics, Cambridge University Press, 2010.\n\n- \\[18\\]N. Fournier and A. Guillin, On the rate of convergence in\nwasserstein distance of the empirical measure, Probability Theory and\nRelated Fields, 162 (2015), pp. 707â€“738.\n\n- \\[19\\]R. Gao, Finite-sample guarantees for wasserstein distributionally\nrobust optimization: Breaking the curse of dimensionality, Oper. Res., 71\n(2022), p. 2291â€“2306.\n\n- \\[20\\]R. Gao, X. Chen, and A. J. Kleywegt, Wasserstein distributionally\nrobust optimization and variation regularization, Operations Research,\n(2022).\n\n- \\[21\\]K. He, X. Zhang, S. Ren, and J. Sun, Deep residual learning for\nimage recognition, in Proceedings of the IEEE Conference on Computer Vision\nand Pattern Recognition (CVPR), June 2016.\n\n- \\[22\\]A. Krizhevsky, I. Sutskever, and G. E. Hinton, Imagenet\nclassification with deep convolutional neural networks, in Advances in\nNeural Information Processing Systems, vol. 25, 2012.\n\n- \\[23\\]D. Kuhn, P. M. Esfahani, V. A. Nguyen, and S. Shafieezadeh-Abadeh, Wasserstein distributionally robust optimization: Theory and applications in\nmachine learning, in Operations research & management science in the age of\nanalytics, Informs, 2019, pp. 130â€“166.\n\n- \\[24\\]Y. Kwon, W. Kim, J.-H. Won, and M. C. Paik, Principled learning\nmethod for wasserstein distributionally robust optimization with local\nperturbations, in International Conference on Machine Learning, PMLR, 2020,\npp. 5567â€“5576.\n\n- \\[25\\]Y. LeCun, Y. Bengio, and G. Hinton, Deep learning, Nature, 521\n(2015), pp. 436â€“444.\n\n- \\[26\\]J. Li, C. Chen, and A. M.-C. So, Fast epigraphical projection-based\nincremental algorithms for wasserstein distributionally robust support vector\nmachine, in Advances in Neural Information Processing Systems, vol. 33,\n2020, pp. 4029â€“4039.\n\n- \\[27\\]P. Mohajerin Esfahani and D. Kuhn, Data-driven distributionally\nrobust optimization using the wasserstein metric: performance guarantees and\ntractable reformulations, Mathematical Programming, 171 (2018),\npp. 115â€“166.\n\n- \\[28\\]G. PeyrÃ© and M. Cuturi, Computational optimal transport: With\napplications to data science, Found. Trends Mach. Learn., 11 (2019),\np. 355â€“607.\n\n- \\[29\\]Y. Polyanskiy and Y. Wu., Information theory: From coding to\nlearning.\n\nprepublication, 2023.\n\n- \\[30\\]J. Redmon, S. Divvala, R. Girshick, and A. Farhadi, You only look\nonce: Unified, real-time object detection, in 2016 IEEE Conference on\nComputer Vision and Pattern Recognition (CVPR), Los Alamitos, CA, USA, 2016,\nIEEE Computer Society, pp. 779â€“788.\n\n- \\[31\\]R. T. Rockafellar and R. J. B. Wets, Variational Analysis, Springer\nBerlin Heidelberg, 1998.\n\n- \\[32\\]M. E. Sander, J. Puigcerver, J. Djolonga, G. PeyrÃ©, and M. Blondel,\nFast, differentiable and sparse top-k: A convex analysis perspective,\nin Proceedings of the 40th International Conference on Machine Learning,\nICMLâ€™23, JMLR.org, 2023.\n\n- \\[33\\]S. Shafieezadeh-Abadeh, P. M. Esfahani, and D. Kuhn, Distributionally robust logistic regression, in Proceedings of the 28th\nInternational Conference on Neural Information Processing Systems - Volume 1,\nNIPSâ€™15, Cambridge, MA, USA, 2015, MIT Press, p. 1576â€“1584.\n\n- \\[34\\]S. Shafieezadeh-Abadeh, D. Kuhn, and P. M. Esfahani, Regularization\nvia mass transportation, Journal of Machine Learning Research, 20 (2019),\npp. 1â€“68.\n\n- \\[35\\]A. Sinha, H. Namkoong, and J. C. Duchi, Certifying some\ndistributional robustness with principled adversarial training, in 6th\nInternational Conference on Learning Representations, 2018.\n\n- \\[36\\]B. Taskesen, M.-C. Yue, J. Blanchet, D. Kuhn, and V. A. Nguyen, Sequential domain adaptation by synthesizing distributionally robust\nexperts, in International Conference on Machine Learning, PMLR, 2021,\npp. 10162â€“10172.\n\n- \\[37\\]M. J. Wainwright, High-Dimensional Statistics: A Non-Asymptotic\nViewpoint, Cambridge Series in Statistical and Probabilistic Mathematics,\nCambridge University Press, 2019.\n\n- \\[38\\]J. Wang, R. Gao, and Y. Xie, Sinkhorn distributionally robust\noptimization, 2023.\n\n- \\[39\\]C. Zhao and Y. Guan, Data-driven risk-averse stochastic optimization\nwith wasserstein metric, Operations Research Letters, 46 (2018),\npp. 262â€“267.\n\n\nSupplementary Material\n\nThis supplementary gathers recalls, technical results, and examples, as well as, the detailed proof of the results of the main text. The core of our contributions are presented in Appendicesâ€„[D](https://ar5iv.org/html/2402.11981#A4 \"Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") andâ€„[E](https://ar5iv.org/html/2402.11981#A5 \"Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\nThe whole supplementary is organized as follows:\n\n\\- In [AppendixA](https://ar5iv.org/html/2402.11981#A1 \"Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we recall some essential mathematical tools. They include a uniform concentration inequality ( [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). â€£ A.1 Uniform concentration inequality â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), continuity notions in nonsmooth analysis, and the envelope formula to differentiate supremum functions ( [TheoremA.1](https://ar5iv.org/html/2402.11981#A1.Thmtheorem1 \"Theorem A.1 (Envelope formula, Corollary 1, Chapter 2.8 in [14]). â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n\n\\- In [AppendixB](https://ar5iv.org/html/2402.11981#A2 \"Appendix B Strong duality â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we present strong duality results for WDRO and its regularized version. We explain in particular how the duality theorem from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\] can be easily adapted to our setting.\n\n\\- [AppendixC](https://ar5iv.org/html/2402.11981#A3 \"Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") contains preliminary computations in view of applying the uniform concentration theorem.\n\n\\- In [AppendixD](https://ar5iv.org/html/2402.11981#A4 \"Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we demonstrate the existence of a dual lower bound in the standard and regularized cases. In particular, the proofs involve the maximal radius introduced in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n\\- By using these preliminary results, in [AppendixE](https://ar5iv.org/html/2402.11981#A5 \"Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we prove our main generalization theorems ( [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Detailed versions with constantsâ€™ expressions are proved, [TheoremE.1](https://ar5iv.org/html/2402.11981#A5.Thmtheorem1 \"Theorem E.1 (Generalization guarantee, standard WDRO). â€£ E.2 Proof of the main results â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for the standard setting, and [TheoremE.2](https://ar5iv.org/html/2402.11981#A5.Thmtheorem2 \"Theorem E.2 (Generalization guarantee, regularized WDRO). â€£ E.2 Proof of the main results â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for the regularized setting.\n\n\\- [AppendixF](https://ar5iv.org/html/2402.11981#A6 \"Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") contains minor results supporting several remarks found in the article. They include the interpretation of the critical radius in the regularized case, a counter-example justifying the upper-bound in the regularized case and the interpretation of the restrictive compactness assumptions used in \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\].\n\n## Notations\n\nThroughout the proofs will use the following notations:\n\nIn Wasserstein robust models:\n\n- â€¢\n\n\nÏ•â€‹(Î»,f,Î¾)=supÎ¶âˆˆÎ{fâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)}italic-Ï•ğœ†ğ‘“ğœ‰subscriptsupremumğœÎğ‘“ğœğœ†ğ‘ğœ‰ğœ\\\\phi(\\\\lambda,f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\\\right\\\\}\n\n- â€¢\n\n\nÏˆâ€‹(Î¼,f,Î¾)=Î¼â€‹Ï•â€‹(Î¼âˆ’1,f,Î¾)ğœ“ğœ‡ğ‘“ğœ‰ğœ‡italic-Ï•superscriptğœ‡1ğ‘“ğœ‰\\\\psi(\\\\mu,f,\\\\xi)=\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi)\n\n\nIn Wasserstein robust models with double regularization:\n\n- â€¢\n\n\nÏ•Ï„,Ïµâ€‹(Î»,f,Î¾)=(Ïµ+Î»â€‹Ï„)â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\n\n- â€¢\n\n\nÏˆÏ„,Ïµâ€‹(Î¼,f,Î¾)=Î¼â€‹Ï•Ï„,Ïµâ€‹(Î¼âˆ’1,f,Î¾)superscriptğœ“ğœitalic-Ïµğœ‡ğ‘“ğœ‰ğœ‡superscriptitalic-Ï•ğœitalic-Ïµsuperscriptğœ‡1ğ‘“ğœ‰\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi)=\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},f,\\\\xi)\n\n\nGiven a measurable function h:Îâ†’â„:â„â†’Îâ„h:\\\\Xi\\\\to\\\\mathbb{R} and Ï€âˆˆğ’«â€‹(Î)ğœ‹ğ’«Î\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi) the Gibbs distribution Ï€hsuperscriptğœ‹â„\\\\pi^{h} is defined as\n\n|     |     |     |\n| --- | --- | --- |\n|  | dâ€‹Ï€hâˆehâ€‹dâ€‹Ï€.proportional-todsuperscriptğœ‹â„superscriptğ‘’â„dğœ‹\\\\mathrm{d}\\\\pi^{h}\\\\propto e^{h}\\\\mathrm{d}\\\\pi. |  |\n\n## Appendix A Recalls and technical preliminaries\n\nIn this part, we use the notation G:ğ’³â‡‰ğ’´:ğºâ‡‰ğ’³ğ’´G:\\\\mathcal{X}\\\\rightrightarrows\\\\mathcal{Y} to denote a function GğºG defined on ğ’³ğ’³\\\\mathcal{X} and valued in the set of subsets of ğ’´ğ’´\\\\mathcal{Y}.\n\nSemicontinuity notions will be necessary to understand the proof of [LemmaD.1](https://ar5iv.org/html/2402.11981#A4.Thmlemma1 \"Lemma D.1. â€£ D.1 Standard WDRO: continuity at zero of the maximal radius â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). They are regularity notions recurrently arising when manipulating nonsmooth convex functions.\n\n###### Definition A.1(Lower and upper semicontinuity, 2.42 in \\[ [1](https://ar5iv.org/html/2402.11981\\#bib.bib1 \"\")\\]).\n\nLet (ğ’³,dist)ğ’³dist(\\\\mathcal{X},\\\\operatorname{dist}) be a metric space and let f:ğ’³â†’â„:ğ‘“â†’ğ’³â„f:\\\\mathcal{X}\\\\to\\\\mathbb{R}. Then\n\n1. 1.\n\n\nfğ‘“f is called _lower semicontinuous_ if for all xâˆˆğ’³ğ‘¥ğ’³x\\\\in\\\\mathcal{X}, lim infyâ†’xfâ€‹(y)â‰¥fâ€‹(x)subscriptlimit-infimumâ†’ğ‘¦ğ‘¥ğ‘“ğ‘¦ğ‘“ğ‘¥\\\\liminf\\_{y\\\\to x}f(y)\\\\geq f(x).\n\n2. 2.\n\n\nfğ‘“f is called _upper semicontinuous_ if for all xâˆˆğ’³ğ‘¥ğ’³x\\\\in\\\\mathcal{X}, lim supyâ†’xfâ€‹(y)â‰¤fâ€‹(x)subscriptlimit-supremumâ†’ğ‘¦ğ‘¥ğ‘“ğ‘¦ğ‘“ğ‘¥\\\\limsup\\_{y\\\\to x}f(y)\\\\leq f(x).\n\n\nIn particular, if fğ‘“f is lower semicontinuous, then âˆ’fğ‘“-f is upper semicontinuous.\n\n_Outer semicontinuity_ can be seen as the set-valued counterpart of upper semicontinuity:\n\n###### Definition A.2(Outer semicontinuity).\n\nLet ğ’³ğ’³\\\\mathcal{X} and ğ’´ğ’´\\\\mathcal{Y} two metric spaces. Then a measurable and compact-valued map G:ğ’³â‡‰ğ’´:ğºâ‡‰ğ’³ğ’´G:\\\\mathcal{X}\\\\rightrightarrows\\\\mathcal{Y} is called _outer semicontinuous_ at xâˆˆğ’³ğ‘¥ğ’³x\\\\in\\\\mathcal{X} if for all open subset VâŠ‚ğ’´ğ‘‰ğ’´V\\\\subset\\\\mathcal{Y} containing Gâ€‹(x)ğºğ‘¥G(x), there exists a neighborhood Uğ‘ˆU of xğ‘¥x which is such that for all wâˆˆUğ‘¤ğ‘ˆw\\\\in U, Gâ€‹(w)âŠ‚Vğºğ‘¤ğ‘‰G(w)\\\\subset V.\n\nSemicontinuity of maximum and argâ€‹maxargmax\\\\operatorname\\*{arg\\\\,max} functions are central to the proof of [LemmaD.1](https://ar5iv.org/html/2402.11981#A4.Thmlemma1 \"Lemma D.1. â€£ D.1 Standard WDRO: continuity at zero of the maximal radius â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\n\n###### Lemma A.1(17.30 in \\[ [1](https://ar5iv.org/html/2402.11981\\#bib.bib1 \"\")\\]).\n\nLet ğ’³ğ’³\\\\mathcal{X} and ÎÎ\\\\Xi be two metric spaces and let G:ğ’³â‡‰Î:ğºâ‡‰ğ’³ÎG:\\\\mathcal{X}\\\\rightrightarrows\\\\Xi be outer semicontinuous with nonempty compact values, h:ÎÃ—Îâ†’â„:â„â†’ÎÎâ„h:\\\\Xi\\\\times\\\\Xi\\\\rightarrow\\\\mathbb{R} continuous. Then the function\n\n|     |     |     |\n| --- | --- | --- |\n|  | xâ†¦maxâ¡{hâ€‹(x,v):vâˆˆGâ€‹(x)}maps-toğ‘¥:â„ğ‘¥ğ‘£ğ‘£ğºğ‘¥x\\\\mapsto\\\\max\\\\{h(x,v)\\ :\\ v\\\\in G(x)\\\\} |  |\n\nis upper semicontinuous. In particular, uâ†¦minâ¡{hâ€‹(u,v):vâˆˆGâ€‹(x)}maps-toğ‘¢:â„ğ‘¢ğ‘£ğ‘£ğºğ‘¥u\\\\mapsto\\\\min\\\\{h(u,v)\\ :\\ v\\\\in G(x)\\\\} is lower semicontinuous.\n\n###### Lemma A.2(17.31 in \\[ [1](https://ar5iv.org/html/2402.11981\\#bib.bib1 \"\")\\]).\n\nIf ğ’³ğ’³\\\\mathcal{X} is a metric space, (Î,d)Îğ‘‘(\\\\Xi,d) is a compact metric space, and h:ğ’³Ã—Îâ†’â„:â„â†’ğ’³Îâ„h:\\\\mathcal{X}\\\\times\\\\Xi\\\\to\\\\mathbb{R} is continuous, then the function xâ†¦maxzâˆˆÎâ¡hâ€‹(x,z)maps-toğ‘¥subscriptğ‘§Îâ„ğ‘¥ğ‘§x\\\\mapsto\\\\max\\_{z\\\\in\\\\Xi}h(x,z) is continuous, and the set-valued map xâ†¦argâ€‹maxzâˆˆÎâ¡hâ€‹(x,z)maps-toğ‘¥subscriptargmaxğ‘§Îâ„ğ‘¥ğ‘§x\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{z\\\\in\\\\Xi}h(x,z) is outer semicontinuous.\n\nWe recall the definition of gradient for a nonsmooth convex function. This the _subdifferential_.\n\n###### Definition A.3(Subdifferential of convex function).\n\nLet Ï•:â„mâ†’â„:italic-Ï•â†’superscriptâ„ğ‘šâ„\\\\phi:\\\\mathbb{R}^{m}\\\\to\\\\mathbb{R} be a convex function. Then we call subdifferential of Ï•italic-Ï•\\\\phi the set-valued map âˆ‚Ï•:â„mâ‡‰â„m:italic-Ï•â‡‰superscriptâ„ğ‘šsuperscriptâ„ğ‘š\\\\partial\\\\phi:\\\\mathbb{R}^{m}\\\\rightrightarrows\\\\mathbb{R}^{m} such that for all xâˆˆâ„mğ‘¥superscriptâ„ğ‘šx\\\\in\\\\mathbb{R}^{m} and yâˆˆâ„mğ‘¦superscriptâ„ğ‘šy\\\\in\\\\mathbb{R}^{m},\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ï•â€‹(y)â‰¥Ï•â€‹(x)+âŸ¨v,yâˆ’xâŸ©â€‹ for all â€‹vâˆˆâˆ‚Ï•â€‹(x).italic-Ï•ğ‘¦italic-Ï•ğ‘¥ğ‘£ğ‘¦ğ‘¥ for all ğ‘£italic-Ï•ğ‘¥\\\\phi(y)\\\\geq\\\\phi(x)+\\\\langle v,y-x\\\\rangle\\\\text{ for all }v\\\\in\\\\partial\\\\phi(x). |  |\n\nIn particular, we may apply the envelope formula to compute the subdifferential of a maximum function:\n\n###### Theorem A.1(Envelope formula, Corollary 1, Chapter 2.8 in \\[ [14](https://ar5iv.org/html/2402.11981\\#bib.bib14 \"\")\\]).\n\nLet (Î,d)Îğ‘‘(\\\\Xi,d) be a compact metric space and g:â„mÃ—Îâ†’â„:ğ‘”â†’superscriptâ„ğ‘šÎâ„g:\\\\mathbb{R}^{m}\\\\times\\\\Xi\\\\to\\\\mathbb{R} such that\n\n1. 1.\n\n\nFor all xâˆˆâ„mğ‘¥superscriptâ„ğ‘šx\\\\in\\\\mathbb{R}^{m}, gâ€‹(x,â‹…)ğ‘”ğ‘¥â‹…g(x,\\\\cdot) is continuous.\n\n2. 2.\n\n\nFor all Î¶âˆˆÎğœÎ\\\\zeta\\\\in\\\\Xi, gâ€‹(â‹…,Î¶)ğ‘”â‹…ğœg(\\\\cdot,\\\\zeta) is convex with subdifferential âˆ‚xgâ€‹(â‹…,Î¶)subscriptğ‘¥ğ‘”â‹…ğœ\\\\partial\\_{x}g(\\\\cdot,\\\\zeta).\n\n\nThen G:=supÎ¶âˆˆÎgâ€‹(â‹…,Î¶)assignğºsubscriptsupremumğœÎğ‘”â‹…ğœG:=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}g(\\\\cdot,\\\\zeta) is convex on â„msuperscriptâ„ğ‘š\\\\mathbb{R}^{m}, and its subdifferential is given for all xâˆˆâ„mğ‘¥superscriptâ„ğ‘šx\\\\in\\\\mathbb{R}^{m} by\n\n|     |     |     |\n| --- | --- | --- |\n|  | âˆ‚Gâ€‹(x):=convâ¡{v:vâˆˆâˆ‚xgâ€‹(x,Î¶),Î¶âˆˆargâ€‹maxÎâ¡gâ€‹(x,â‹…)}.assignğºğ‘¥conv:ğ‘£formulae-sequenceğ‘£subscriptğ‘¥ğ‘”ğ‘¥ğœğœsubscriptargmaxÎğ‘”ğ‘¥â‹…\\\\partial G(x):=\\\\operatorname{conv}\\\\{v\\ :\\ v\\\\in\\\\partial\\_{x}g(x,\\\\zeta),\\\\,\\\\zeta\\\\in\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g(x,\\\\cdot)\\\\}. |  |\n\nwhere convconv\\\\operatorname{conv} denotes the convex hull of a set.\n\n### A.1 Uniform concentration inequality\n\nWe recall a concentration inequality that gives a high probability uniform bound for a family of bounded and Lipschitz functions. This is an extended version of [Theorem4.1](https://ar5iv.org/html/2402.11981#S4.Thmtheorem1 \"Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") which details the one-sided inequalities (without the absolute value). We refer the reader to \\[ [12](https://ar5iv.org/html/2402.11981#bib.bib12 \"\")\\] for a complete reference on concentration inequalities, and Lemma G.2 in \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] for the proof of such a result.\n\n###### Theorem A.2(Uniform concentration inequality, Lemma G.2 in \\[ [5](https://ar5iv.org/html/2402.11981\\#bib.bib5 \"\")\\]).\n\nLet (ğ’³,dist)ğ’³dist(\\\\mathcal{X},\\\\text{dist}) be a (totally bounded) separable metric space, Pğ‘ƒP a probability distribution on a probability space ÎÎ\\\\Xi, and P^n=1nâ€‹âˆ‘i=1nÎ´Î¾isubscript^ğ‘ƒğ‘›1ğ‘›superscriptsubscriptğ‘–1ğ‘›subscriptğ›¿subscriptğœ‰ğ‘–\\\\widehat{P}\\_{n}=\\\\frac{1}{n}\\\\sum\\_{i=1}^{n}\\\\delta\\_{\\\\xi\\_{i}} with Î¾1,â€¦,Î¾nâ€‹âˆ¼i.i.d.â€‹Psubscriptğœ‰1â€¦subscriptğœ‰ğ‘›i.i.d.similar-toğ‘ƒ\\\\xi\\_{1},\\\\ldots,\\\\xi\\_{n}\\\\overset{\\\\text{i.i.d.}}{\\\\sim}P. Consider a measurable mapping X:ğ’³Ã—Îâ†’â„:ğ‘‹â†’ğ’³Îâ„X:\\\\mathcal{X}\\\\times\\\\Xi\\\\rightarrow\\\\mathbb{R} and assume that,\n\n1. (i)\n\n\nThere is a constant L>0ğ¿0L>0 such that, for each Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, xâ†¦Xâ€‹(x,Î¾)maps-toğ‘¥ğ‘‹ğ‘¥ğœ‰x\\\\mapsto X(x,\\\\xi) is Lğ¿L-Lipschitz.\n\n2. (ii)\n\n\nXâ€‹(â‹…,Î¾)ğ‘‹â‹…ğœ‰X(\\\\cdot,\\\\xi) almost surely belongs to \\[a,b\\]ğ‘ğ‘\\[a,b\\].\n\n\nThen, for any Î´âˆˆ(0,1)ğ›¿01\\\\delta\\\\in(0,1), we respectively have\n\n1. 1.\n\n\nWith probability at least 1âˆ’Î´1ğ›¿1-\\\\delta,\n\n\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | supxâˆˆğ’³{ğ”¼Î¾âˆ¼P^nâ€‹\\[Xâ€‹(x,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼Pâ€‹\\[Xâ€‹(x,Î¾)\\]}â‰¤48â€‹Lâ€‹â„â€‹(ğ’³,dist)n+(bâˆ’a)â€‹2â€‹logâ¡1Î´n.subscriptsupremumğ‘¥ğ’³subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]ğ‘‹ğ‘¥ğœ‰subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘‹ğ‘¥ğœ‰48ğ¿â„ğ’³distğ‘›ğ‘ğ‘21ğ›¿ğ‘›\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[X(x,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[X(x,\\\\xi)\\]\\\\right\\\\}\\\\leq\\\\frac{48L\\\\mathcal{I(\\\\mathcal{X,\\\\operatorname{dist}})}}{\\\\sqrt{n}}+(b-a)\\\\sqrt{2\\\\frac{\\\\log\\\\frac{1}{\\\\delta}}{n}}. |  |\n\n2. 2.\n\n\nWith probability at least 1âˆ’Î´1ğ›¿1-\\\\delta,\n\n\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | supxâˆˆğ’³{ğ”¼Î¾âˆ¼Pâ€‹\\[Xâ€‹(x,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼P^nâ€‹\\[Xâ€‹(x,Î¾)\\]}â‰¤48â€‹Lâ€‹â„â€‹(ğ’³,dist)n+(bâˆ’a)â€‹2â€‹logâ¡1Î´n.subscriptsupremumğ‘¥ğ’³subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘‹ğ‘¥ğœ‰subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]ğ‘‹ğ‘¥ğœ‰48ğ¿â„ğ’³distğ‘›ğ‘ğ‘21ğ›¿ğ‘›\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[X(x,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[X(x,\\\\xi)\\]\\\\right\\\\}\\\\leq\\\\frac{48L\\\\mathcal{I(\\\\mathcal{X,\\\\operatorname{dist}})}}{\\\\sqrt{n}}+(b-a)\\\\sqrt{2\\\\frac{\\\\log\\\\frac{1}{\\\\delta}}{n}}. |  |\n\n\nThe quantity â„â€‹(ğ’³,dist)â„ğ’³dist\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist}) is defined as follows:\n\n###### Definition A.4.\n\nGiven a compact metric space (ğ’³,dist)ğ’³dist(\\\\mathcal{X},\\\\operatorname{dist}), _Dudleyâ€™s entropy integral_, â„â€‹(ğ’³,dist)â„ğ’³dist\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist}), is defined as\n\n|     |     |     |\n| --- | --- | --- |\n|  | â„â€‹(ğ’³,dist):=âˆ«0âˆlogâ¡Nâ€‹(t,ğ’³,dist)â€‹ğ‘‘tassignâ„ğ’³distsuperscriptsubscript0ğ‘ğ‘¡ğ’³distdifferential-dğ‘¡\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist}):=\\\\int\\_{0}^{\\\\infty}\\\\sqrt{\\\\log N(t,\\\\mathcal{X},\\\\operatorname{dist})}dt |  |\n\nwhere Nâ€‹(t,ğ’³,dist)ğ‘ğ‘¡ğ’³distN(t,\\\\mathcal{X},\\\\text{dist}) denotes the tğ‘¡t-packing number of ğ’³ğ’³\\\\mathcal{X}, which is the maximal number of points in ğ’³ğ’³\\\\mathcal{X} that are at least at a distance tğ‘¡t from each other.\n\nWe may recall some properties of Dudleyâ€™s entropy for Cartesian products and segments from â„â„\\\\mathbb{R}. These are known results, see e.g. \\[ [37](https://ar5iv.org/html/2402.11981#bib.bib37 \"\")\\] and Lemmas G.3 and G.4 from \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] for proofs.\n\n###### Lemma A.3(Dudleyâ€™s integral estimates).\n\n2. 1.\n\n\n(on Cartesian products) Let (ğ’³1,dist1)subscriptğ’³1subscriptdist1(\\\\mathcal{X}\\_{1},\\\\operatorname{dist}\\_{1}) and (ğ’³2,dist2)subscriptğ’³2subscriptdist2(\\\\mathcal{X}\\_{2},\\\\operatorname{dist}\\_{2}) be two metric spaces. Consider the product space ğ’³:=ğ’³1Ã—ğ’³2assignğ’³subscriptğ’³1subscriptğ’³2\\\\mathcal{X}:=\\\\mathcal{X}\\_{1}\\\\times\\\\mathcal{X}\\_{2} equipped with the distance dist:=dist1+dist2assigndistsubscriptdist1subscriptdist2\\\\operatorname{dist}:=\\\\operatorname{dist}\\_{1}+\\\\operatorname{dist}\\_{2}. Then we have the inequality\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | â„â€‹(ğ’³,dist)â‰¤â„â€‹(ğ’³1,dist1)+â„â€‹(ğ’³2,dist2).â„ğ’³distâ„subscriptğ’³1subscriptdist1â„subscriptğ’³2subscriptdist2\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist})\\\\leq\\\\mathcal{I}(\\\\mathcal{X}\\_{1},\\\\operatorname{dist}\\_{1})+\\\\mathcal{I}(\\\\mathcal{X}\\_{2},\\\\operatorname{dist}\\_{2}). |  |\n\n3. 2.\n\n\n(on â„â„\\\\mathbb{R}) Let c>0ğ‘0c>0. Then we have the inequality\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | â„(\\[0,c\\],\\|â‹…\\|)â‰¤3â€‹c2.\\\\mathcal{I}(\\[0,c\\],\\|\\\\cdot\\|)\\\\leq\\\\frac{3c}{2}. |  |\n\n\n## Appendix B Strong duality\n\nIn this section, we recall duality results for WDRO \\[ [8](https://ar5iv.org/html/2402.11981#bib.bib8 \"\")\\] and its regularized version \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\]. We recall the Wasserstein distance with cost cğ‘c for (Q,Qâ€²)âˆˆğ’«â€‹(Î)Ã—ğ’«â€‹(Î)ğ‘„superscriptğ‘„â€²ğ’«Îğ’«Î(Q,Q^{\\\\prime})\\\\in\\\\mathcal{P}(\\\\Xi)\\\\times\\\\mathcal{P}(\\\\Xi):\n\n|     |     |     |\n| --- | --- | --- |\n|  | Wcâ€‹(Q,Qâ€²)=inf{ğ”¼(Î¾,Î¶)âˆ¼Ï€â€‹\\[câ€‹(Î¾,Î¶)\\]:Ï€âˆˆğ’«â€‹(ÎÃ—Î),\\[Ï€\\]1=Q,\\[Ï€\\]2=Qâ€²}.subscriptğ‘Šğ‘ğ‘„superscriptğ‘„â€²infimumconditional-setsubscriptğ”¼similar-toğœ‰ğœğœ‹delimited-\\[\\]ğ‘ğœ‰ğœformulae-sequenceğœ‹ğ’«ÎÎformulae-sequencesubscriptdelimited-\\[\\]ğœ‹1ğ‘„subscriptdelimited-\\[\\]ğœ‹2superscriptğ‘„â€²W\\_{c}(Q,Q^{\\\\prime})=\\\\inf\\\\left\\\\{\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi}\\[c(\\\\xi,\\\\zeta)\\]\\ :\\ \\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),\\[\\\\pi\\]\\_{1}=Q,\\[\\\\pi\\]\\_{2}=Q^{\\\\prime}\\\\right\\\\}. |  |\n\n###### Proposition B.1(Strong duality, standard WDRO).\n\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), for any Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) and Ï>0ğœŒ0\\\\rho>0,\n\n|     |     |     |\n| --- | --- | --- |\n|  | maxWcâ€‹(Q,Qâ€²)â‰¤Ïâ¡ğ”¼Î¾âˆ¼Qâ€²â€‹\\[fâ€‹(Î¾)\\]=infÎ»â‰¥0{Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}.subscriptsubscriptğ‘Šğ‘ğ‘„superscriptğ‘„â€²ğœŒsubscriptğ”¼similar-toğœ‰superscriptğ‘„â€²delimited-\\[\\]ğ‘“ğœ‰subscriptinfimumğœ†0ğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\max\\_{W\\_{c}(Q,Q^{\\\\prime})\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q^{\\\\prime}}\\[f(\\\\xi)\\]=\\\\inf\\_{\\\\lambda\\\\geq 0}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\n\n###### Proof.\n\nThis is an application of Theorem 1 from \\[ [8](https://ar5iv.org/html/2402.11981#bib.bib8 \"\")\\]. In particular, Assumptions 1 and 2 from \\[ [8](https://ar5iv.org/html/2402.11981#bib.bib8 \"\")\\] are satisfied through [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\nâˆ\n\n###### Proposition B.2(Strong duality, regularized WDRO).\n\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), for any Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) and Ï>0ğœŒ0\\\\rho>0,\n\n|     |     |     |\n| --- | --- | --- |\n|  | maxÏ€âˆˆğ’«â€‹(ÎÃ—Î)\\[Ï€\\]1=Qğ”¼Ï€â€‹\\[c\\]+Ï„â€‹KLâ¡(Ï€âˆ¥Ï€0)â‰¤Ïâ¡{ğ”¼Î¾âˆ¼\\[Ï€\\]2â€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€âˆ¥Ï€0)}=infÎ»â‰¥0{Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]}.subscriptğœ‹ğ’«ÎÎsubscriptdelimited-\\[\\]ğœ‹1ğ‘„subscriptğ”¼ğœ‹delimited-\\[\\]ğ‘ğœKLconditionalğœ‹subscriptğœ‹0ğœŒsubscriptğ”¼similar-toğœ‰subscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]ğ‘“ğœitalic-ÏµKLconditionalğœ‹subscriptğœ‹0subscriptinfimumğœ†0ğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\max\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=Q\\\\\\<br>\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\leq\\\\rho\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim\\[\\\\pi\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\geq 0}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\n\n###### Proof.\n\nThis is an application of Theorem 3.1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\], which is a corollary to Theorem 2.1 \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\]. Note that the proofs of Theorems 2.1 and 3.1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\] can be easily extended to a general compact metric space (Î,d)Îğ‘‘(\\\\Xi,d), without being rewritten entirely. Precisely, only two arguments in their proofs rely on the real-valued setting \\[ [31](https://ar5iv.org/html/2402.11981#bib.bib31 \"\")\\] but can be directly extended to a general metric space as follows:\n\n- â€¢\n\n\nIn the proof of Theorem 2.1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\], one needs to justify\n\n\n\n\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | sup{ğ”¼Î¾âˆ¼Pâ€‹\\[Ï†â€‹(Î¾,Î¶â€‹(Î¾))\\]:Î¶:Îâ†’Îâ€‹ measurable}â‰¥ğ”¼Î¾âˆ¼Pâ€‹\\[supÎ¶âˆˆÎÏ†â€‹(Î¾,Î¶)\\].supremumconditional-setsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğœ‘ğœ‰ğœğœ‰:ğœâ†’ÎÎ measurablesubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptsupremumğœÎğœ‘ğœ‰ğœ\\\\sup\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\varphi(\\\\xi,\\\\zeta(\\\\xi))\\\\right\\]\\ :\\ \\\\zeta:\\\\Xi\\\\to\\\\Xi\\\\text{ measurable}\\\\right\\\\}\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\varphi(\\\\xi,\\\\zeta)\\\\right\\]. |  | (20) |\n\n\n\nTo this end, the authors use the notion of normal integrand from \\[ [31](https://ar5iv.org/html/2402.11981#bib.bib31 \"\")\\]. Actually, ( [20](https://ar5iv.org/html/2402.11981#A2.E20 \"Equation 20 â€£ 1st item â€£ Proof. â€£ Appendix B Strong duality â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) holds true in a compact metric space: if Ï†ğœ‘\\\\varphi is continuous, then by compactness of ÎÎ\\\\Xi, the set-valued map Î¾â†¦argâ€‹maxÎ¶âˆˆÎâ¡Ï†â€‹(Î¾,Î¶)maps-toğœ‰subscriptargmaxğœÎğœ‘ğœ‰ğœ\\\\xi\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{\\\\zeta\\\\in\\\\Xi}\\\\varphi(\\\\xi,\\\\zeta) admits a measurable selection Î¶âˆ—superscriptğœ\\\\zeta^{\\*}, by the measurable maximum theorem, see 18.19 in \\[ [1](https://ar5iv.org/html/2402.11981#bib.bib1 \"\")\\]. Such a selection Î¶âˆ—superscriptğœ\\\\zeta^{\\*} then satisfies Ï†â€‹(Î¾,Î¶âˆ—â€‹(Î¾))=supÎ¶âˆˆÎÏ†â€‹(Î¾,Î¶)ğœ‘ğœ‰superscriptğœğœ‰subscriptsupremumğœÎğœ‘ğœ‰ğœ\\\\varphi(\\\\xi,\\\\zeta^{\\*}(\\\\xi))=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\varphi(\\\\xi,\\\\zeta) for all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, hence the result.\n\n- â€¢\n\n\nIn the proof of Theorem 3.1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\], gÏ†=supÎ¶âˆˆÎÏ†â€‹(â‹…,Î¶)superscriptğ‘”ğœ‘subscriptsupremumğœÎğœ‘â‹…ğœg^{\\\\varphi}=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\varphi(\\\\cdot,\\\\zeta) is actually continuous by [LemmaA.2](https://ar5iv.org/html/2402.11981#A1.Thmlemma2 \"Lemma A.2 (17.31 in [1]). â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and the approximation by the infimal convolutions (gkÏ†)kâˆˆâ„•subscriptsuperscriptsubscriptğ‘”ğ‘˜ğœ‘ğ‘˜â„•(g\\_{k}^{\\\\varphi})\\_{k\\\\in\\\\mathbb{N}} need not be done.\n\n\nNote also that the convexity of ÎÎ\\\\Xi is not required in this proof (although stated in Assumption 1 from \\[ [6](https://ar5iv.org/html/2402.11981#bib.bib6 \"\")\\]).\nâˆ\n\n## Appendix C Concentration constants\n\nIn this part, we compute several constants in view of applying [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). â€£ A.1 Uniform concentration inequality â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for the main proofs of [AppendixE](https://ar5iv.org/html/2402.11981#A5 \"Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n### C.1 Standard WDRO\n\nThe following lemma gathers [Lemma4.1](https://ar5iv.org/html/2402.11981#S4.Thmlemma1 \"Lemma 4.1. â€£ 4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [Lemma4.3](https://ar5iv.org/html/2402.11981#S4.Thmlemma3 \"Lemma 4.3. â€£ Dual bound on the empirical risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). We compute bounds (i) and global Lipschitz constants (ii) for Ï•italic-Ï•\\\\phi and Ïˆğœ“\\\\psi.\n\n###### Lemma C.1(Concentration conditions for WDRO).\n\nwe have the following:\n\n1. 1.\n\n\n1. (i)\n\n\nFor all Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0, fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} and Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, Ï•â€‹(Î»,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆ,â€–â„±â€–âˆ\\].italic-Ï•ğœ†ğ‘“ğœ‰subscriptnormâ„±subscriptnormâ„±\\\\phi(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\].\n\n2. (ii)\n\n\nFor all Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0 and Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, fâ†¦Ï•â€‹(Î»,f,Î¾)maps-toğ‘“italic-Ï•ğœ†ğ‘“ğœ‰f\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi) is Lipschitz continuous on â„±â„±\\\\mathcal{F} with constant 111.\n\n\n2. 2.\n\n\n1. (i)\n\n\nGiven Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0, for all Î¼âˆˆ(0,Î»lowâˆ’1\\]ğœ‡0superscriptsubscriptğœ†low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\nÏˆâ€‹(Î¼,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆÎ»low,â€–â„±â€–âˆÎ»low\\]ğœ“ğœ‡ğ‘“ğœ‰subscriptnormâ„±subscriptğœ†lowsubscriptnormâ„±subscriptğœ†low\\\\psi(\\\\mu,f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\].\n\n2. (ii)\n\n\nFor all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, (Î¼,f)â†¦Ïˆâ€‹(Î¼,f,Î¾)maps-toğœ‡ğ‘“ğœ“ğœ‡ğ‘“ğœ‰(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) is Lipschitz continuous on (0,Î»lowâˆ’1\\]0superscriptsubscriptğœ†low1(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] with constant â€–â„±â€–âˆ+Î»lowâˆ’1subscriptnormâ„±superscriptsubscriptğœ†low1\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\n\n\n###### Proof.\n\n1\\. (i) Let (Î»,f,Î¾)âˆˆâ„+Ã—â„±Ã—Îğœ†ğ‘“ğœ‰subscriptâ„â„±Î(\\\\lambda,f,\\\\xi)\\\\in\\\\mathbb{R}\\_{+}\\\\times\\\\mathcal{F}\\\\times\\\\Xi. Recall that Ï•â€‹(Î»,f,Î¾):=supÎ¶âˆˆÎ{fâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)}assignitalic-Ï•ğœ†ğ‘“ğœ‰subscriptsupremumğœÎğ‘“ğœğœ†ğ‘ğœ‰ğœ\\\\phi(\\\\lambda,f,\\\\xi):=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\\\right\\\\}. Since cğ‘c is nonnegative, we have Ï•â€‹(Î»,f,Î¾)â‰¤â€–â„±â€–âˆitalic-Ï•ğœ†ğ‘“ğœ‰subscriptnormâ„±\\\\phi(\\\\lambda,f,\\\\xi)\\\\leq\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}. On the other hand, since câ€‹(Î¾,Î¾)=0ğ‘ğœ‰ğœ‰0c(\\\\xi,\\\\xi)=0, we also have Ï•â€‹(Î»,f,Î¾)â‰¥fâ€‹(Î¾)â‰¥âˆ’â€–â„±â€–âˆitalic-Ï•ğœ†ğ‘“ğœ‰ğ‘“ğœ‰subscriptnormâ„±\\\\phi(\\\\lambda,f,\\\\xi)\\\\geq f(\\\\xi)\\\\geq-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}. Finally, we have Ï•â€‹(Î»,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆ,â€–â„±â€–âˆ\\]italic-Ï•ğœ†ğ‘“ğœ‰subscriptnormâ„±subscriptnormâ„±\\\\phi(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\].\n\n(ii) Let Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0, Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi and (f,fâ€²)âˆˆâ„±Ã—â„±ğ‘“superscriptğ‘“â€²â„±â„±(f,f^{\\\\prime})\\\\in\\\\mathcal{F}\\\\times\\\\mathcal{F}. For all Î¶âˆˆÎğœÎ\\\\zeta\\\\in\\\\Xi, we have\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | fâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)âˆ’Ï•â€‹(Î»,fâ€²,Î¾)ğ‘“ğœğœ†ğ‘ğœ‰ğœitalic-Ï•ğœ†superscriptğ‘“â€²ğœ‰\\\\displaystyle f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)-\\\\phi(\\\\lambda,f^{\\\\prime},\\\\xi) | â‰¤fâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)âˆ’(fâ€²â€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶))absentğ‘“ğœğœ†ğ‘ğœ‰ğœsuperscriptğ‘“â€²ğœğœ†ğ‘ğœ‰ğœ\\\\displaystyle\\\\leq f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)-(f^{\\\\prime}(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)) |  |\n|  |  | â‰¤fâ€‹(Î¶)âˆ’fâ€²â€‹(Î¶)absentğ‘“ğœsuperscriptğ‘“â€²ğœ\\\\displaystyle\\\\leq f(\\\\zeta)-f^{\\\\prime}(\\\\zeta) |  |\n|  |  | â‰¤â€–fâˆ’fâ€²â€–âˆ.absentsubscriptnormğ‘“superscriptğ‘“â€²\\\\displaystyle\\\\leq\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. |  |\n\nTaking the supremum over Î¶âˆˆÎğœÎ\\\\zeta\\\\in\\\\Xi on the left-hand side gives Ï•â€‹(Î»,f,Î¾)âˆ’Ï•â€‹(Î»,fâ€²,Î¾)â‰¤â€–fâˆ’fâ€²â€–âˆitalic-Ï•ğœ†ğ‘“ğœ‰italic-Ï•ğœ†superscriptğ‘“â€²ğœ‰subscriptnormğ‘“superscriptğ‘“â€²\\\\phi(\\\\lambda,f,\\\\xi)-\\\\phi(\\\\lambda,f^{\\\\prime},\\\\xi)\\\\leq\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. Permuting the roles of fğ‘“f and fâ€²superscriptğ‘“â€²f^{\\\\prime} yields \\|Ï•â€‹(Î»,f,Î¾)âˆ’Ï•â€‹(Î»,fâ€²,Î¾)\\|â‰¤â€–fâˆ’fâ€²â€–âˆitalic-Ï•ğœ†ğ‘“ğœ‰italic-Ï•ğœ†superscriptğ‘“â€²ğœ‰subscriptnormğ‘“superscriptğ‘“â€²\\|\\\\phi(\\\\lambda,f,\\\\xi)-\\\\phi(\\\\lambda,f^{\\\\prime},\\\\xi)\\|\\\\leq\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. We proved that Ï•â€‹(Î»,â‹…,Î¾)italic-Ï•ğœ†â‹…ğœ‰\\\\phi(\\\\lambda,\\\\cdot,\\\\xi) is 111-Lipschitz continuous.\n\n2\\. (i) Now, let Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 and let (Î¼,f,Î¾)âˆˆ(0,Î»lowâˆ’1\\]Ã—â„±Ã—Îğœ‡ğ‘“ğœ‰0superscriptsubscriptğœ†low1â„±Î(\\\\mu,f,\\\\xi)\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}\\\\times\\\\Xi be arbitrary. Then we have\n\n|     |     |     |\n| --- | --- | --- |\n|  | Î¼â€‹Ï•â€‹(Î¼âˆ’1,f,Î¾)=supÎ¶âˆˆÎ{Î¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)}â‰¤â€–â„±â€–âˆÎ»low.ğœ‡italic-Ï•superscriptğœ‡1ğ‘“ğœ‰subscriptsupremumğœÎğœ‡ğ‘“ğœğ‘ğœ‰ğœsubscriptnormâ„±subscriptğœ†low\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)\\\\right\\\\}\\\\leq\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}. |  |\n\nOn the other hand, using câ€‹(Î¾,Î¾)=0ğ‘ğœ‰ğœ‰0c(\\\\xi,\\\\xi)=0 we obtain\n\n|     |     |     |\n| --- | --- | --- |\n|  | supÎ¶âˆˆÎ{Î¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)}â‰¥Î¼â€‹fâ€‹(Î¾)â‰¥âˆ’â€–â„±â€–âˆÎ»low,subscriptsupremumğœÎğœ‡ğ‘“ğœğ‘ğœ‰ğœğœ‡ğ‘“ğœ‰subscriptnormâ„±subscriptğœ†low\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)\\\\right\\\\}\\\\geq\\\\mu f(\\\\xi)\\\\geq-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}, |  |\n\nwhence we have Î¼â€‹Ï•â€‹(Î¼âˆ’1,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆÎ»low,â€–â„±â€–âˆÎ»low\\]ğœ‡italic-Ï•superscriptğœ‡1ğ‘“ğœ‰subscriptnormâ„±subscriptğœ†lowsubscriptnormâ„±subscriptğœ†low\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\].\n\n(ii) Toward a proof of 2. (ii), let Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0, and Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi and Î¼âˆˆ(0,Î»low\\]ğœ‡0subscriptğœ†low\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}\\]. Remark that Î¼â€‹Ï•â€‹(Î¼âˆ’1,f,Î¾)=supÎ¶âˆˆÎ{Î¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)}ğœ‡italic-Ï•superscriptğœ‡1ğ‘“ğœ‰subscriptsupremumğœÎğœ‡ğ‘“ğœğ‘ğœ‰ğœ\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)\\\\right\\\\}. The function (Î¼,f)â†¦Î¼â€‹Ï•â€‹(Î¼âˆ’1,f,Î¾)maps-toğœ‡ğ‘“ğœ‡italic-Ï•superscriptğœ‡1ğ‘“ğœ‰(\\\\mu,f)\\\\mapsto\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi) write as a composition uâˆ˜vğ‘¢ğ‘£u\\\\circ v where uâ€‹(h):=supÎ¶âˆˆÎ{hâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)}assignğ‘¢â„subscriptsupremumğœÎâ„ğœğ‘ğœ‰ğœu(h):=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{h(\\\\zeta)-c(\\\\xi,\\\\zeta)\\\\right\\\\} for hâˆˆCâ€‹(Î,â„)â„ğ¶Îâ„h\\\\in C(\\\\Xi,\\\\mathbb{R}), and vâ€‹(Î¼,f):=Î¼â€‹fassignğ‘£ğœ‡ğ‘“ğœ‡ğ‘“v(\\\\mu,f):=\\\\mu f for Î¼âˆˆ(0,Î»lowâˆ’1\\]ğœ‡0superscriptsubscriptğœ†low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]. uğ‘¢u is 1-Lipschitz continuous with respect to âˆ¥â‹…âˆ¥âˆ\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. As to vğ‘£v, we can write\n\n|     |     |     |\n| --- | --- | --- |\n|  | Î¼â€‹fâˆ’Î¼â€²â€‹fâ€²=Î¼â€‹(fâˆ’fâ€²)+fâ€²â€‹(Î¼âˆ’Î¼â€²),ğœ‡ğ‘“superscriptğœ‡â€²superscriptğ‘“â€²ğœ‡ğ‘“superscriptğ‘“â€²superscriptğ‘“â€²ğœ‡superscriptğœ‡â€²\\\\mu f-\\\\mu^{\\\\prime}f^{\\\\prime}=\\\\mu(f-f^{\\\\prime})+f^{\\\\prime}(\\\\mu-\\\\mu^{\\\\prime}), |  |\n\nwhence vğ‘£v is clearly (â€–â„±â€–âˆ+Î»lowâˆ’1)subscriptnormâ„±superscriptsubscriptğœ†low1(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1})-Lipschitz continuous on (0,Î»lowâˆ’1\\]Ã—â„±0superscriptsubscriptğœ†low1â„±(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}. By composition, uâˆ˜vğ‘¢ğ‘£u\\\\circ v is Lipschitz continuous with constant â€–â„±â€–âˆ+Î»lowâˆ’1subscriptnormâ„±superscriptsubscriptğœ†low1\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\nâˆ\n\n### C.2 Regularized WDRO\n\nWe will use the following lemma repeatedly:\n\n###### Lemma C.2(Lemma G.7 in \\[ [5](https://ar5iv.org/html/2402.11981\\#bib.bib5 \"\")\\]).\n\nLet g:Îâ†’â„:ğ‘”â†’Îâ„g:\\\\Xi\\\\to\\\\mathbb{R} be a measurable bounded function and Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi). Then one has the inequality\n\n|     |     |     |\n| --- | --- | --- |\n|  | logâ¡ğ”¼Î¶âˆ¼Qâ€‹\\[egâ€‹(Î¶)\\]â‰¤ğ”¼Î¶âˆ¼Qâ€‹\\[gâ€‹(Î¶)â€‹egâ€‹(Î¶)\\]ğ”¼Î¶âˆ¼Qâ€‹\\[egâ€‹(Î¶)\\].subscriptğ”¼similar-toğœğ‘„delimited-\\[\\]superscriptğ‘’ğ‘”ğœsubscriptğ”¼similar-toğœğ‘„delimited-\\[\\]ğ‘”ğœsuperscriptğ‘’ğ‘”ğœsubscriptğ”¼similar-toğœğ‘„delimited-\\[\\]superscriptğ‘’ğ‘”ğœ\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\\\left\\[e^{g(\\\\zeta)}\\\\right\\]\\\\leq\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[g(\\\\zeta)e^{g(\\\\zeta)}\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[e^{g(\\\\zeta)}\\]}. |  |\n\nWe prove the regularized version of [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). â€£ C.1 Standard WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\n\n###### Lemma C.3(Concentration conditions for regularized WDRO).\n\nLet Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi. Then\n\n1. 1.\n\n\n1. (i)\n\n\nFor all Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0 and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆâˆ’Î»â€‹mc,â€–â„±â€–âˆ\\].superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰subscriptnormâ„±ğœ†subscriptğ‘šğ‘subscriptnormâ„±\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\in\\\\left\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\lambda m\\_{c},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\\\right\\].\n\n2. (ii)\n\n\nFor all Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0, fâ†¦Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)maps-toğ‘“superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰f\\\\mapsto\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi) is Lipschitz continuous with constant 111.\n\n\n2. 2.\n\n\n1. (i)\n\n\nGiven Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0, for all Î¼âˆˆ\\[Î»upâˆ’1,Î»lowâˆ’1\\]ğœ‡superscriptsubscriptğœ†up1superscriptsubscriptğœ†low1\\\\mu\\\\in\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, ÏˆÏ„,Ïµâ€‹(Î¼,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆÎ»lowâˆ’mc,â€–â„±â€–âˆÎ»low\\].superscriptğœ“ğœitalic-Ïµğœ‡ğ‘“ğœ‰subscriptnormâ„±subscriptğœ†lowsubscriptğ‘šğ‘subscriptnormâ„±subscriptğœ†low\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}-m\\_{c},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\].\n\n2. (ii)\n\n\nGiven Î»up>0subscriptğœ†up0\\\\lambda\\_{\\\\operatorname{up}}>0, (Î¼,f)â†¦ÏˆÏ„,Ïµâ€‹(Î¼,f,Î¾)maps-toğœ‡ğ‘“superscriptğœ“ğœitalic-Ïµğœ‡ğ‘“ğœ‰(\\\\mu,f)\\\\mapsto\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi) is Lipschitz continuous on \\[Î»upâˆ’1,Î»lowâˆ’1\\]Ã—â„±superscriptsubscriptğœ†up1superscriptsubscriptğœ†low1â„±\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F} with constant â€–â„±â€–âˆ+Î»lowâˆ’1+(Î»upâ€‹ÏµÏµ+Î»upâ€‹Ï„)â€‹mcsubscriptnormâ„±superscriptsubscriptğœ†low1subscriptğœ†upitalic-Ïµitalic-Ïµsubscriptğœ†upğœsubscriptğ‘šğ‘\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}+\\\\left(\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}\\\\epsilon}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}\\\\right)m\\_{c}.\n\n\n###### Proof.\n\n1\\. (i) Let (Î»,f,Î¾)âˆˆâ„+Ã—â„±Ã—Îğœ†ğ‘“ğœ‰subscriptâ„â„±Î(\\\\lambda,f,\\\\xi)\\\\in\\\\mathbb{R}\\_{+}\\\\times\\\\mathcal{F}\\\\times\\\\Xi. For all Î¶âˆˆÎğœÎ\\\\zeta\\\\in\\\\Xi, efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„â‰¤eâ€–â„±â€–âˆÏµ+Î»â€‹Ï„superscriptğ‘’ğ‘“ğœğœ†ğ‘ğœ‰ğœitalic-Ïµğœ†ğœsuperscriptğ‘’subscriptnormâ„±italic-Ïµğœ†ğœe^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\leq e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon+\\\\lambda\\\\tau}}. This gives\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)â‰¤(Ïµ+Î»â€‹Ï„)â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eâ€–â„±â€–âˆÏµ+Î»â€‹Ï„\\]=â€–â„±â€–âˆ.\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\leq(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]=\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}. |  | (21) |\n\nOn the other hand, efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„â‰¥eâˆ’â€–â„±â€–âˆâˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„superscriptğ‘’ğ‘“ğœğœ†ğ‘ğœ‰ğœitalic-Ïµğœ†ğœsuperscriptğ‘’subscriptnormâ„±ğœ†ğ‘ğœ‰ğœitalic-Ïµğœ†ğœe^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\geq e^{\\\\frac{-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}, which gives\n\n|     |     |     |     |     |\n| --- | --- | --- | --- | --- |\n|  | Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\displaystyle\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi) | â‰¥(Ïµ+Î»â€‹Ï„)â€‹logâ¡(eâˆ’â€–â„±â€–âˆÏµ+Î»â€‹Ï„â€‹ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eâˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\])\\\\displaystyle\\\\geq(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\left(e^{-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{-\\\\frac{\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\\\\right) |  |\n|  |  | â‰¥âˆ’â€–â„±â€–âˆ+(Ïµ+Î»â€‹Ï„)â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eâˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]\\\\displaystyle\\\\geq-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{-\\\\frac{\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\] |  |\n|  |  | â‰¥âˆ’â€–â„±â€–âˆâˆ’Î»â€‹mc,absentsubscriptnormâ„±ğœ†subscriptğ‘šğ‘\\\\displaystyle\\\\geq-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\lambda m\\_{c}, |  | (22) |\n\nwhere for the last inequality we used Jensenâ€™s inequality on the convex function sâ†¦eâˆ’Î»â€‹sÏµ+Î»â€‹Ï„maps-toğ‘ superscriptğ‘’ğœ†ğ‘ italic-Ïµğœ†ğœs\\\\mapsto e^{-\\\\frac{\\\\lambda s}{\\\\epsilon+\\\\lambda\\\\tau}}.\n\nCombining ( [21](https://ar5iv.org/html/2402.11981#A3.E21 \"Equation 21 â€£ Proof. â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [C.2](https://ar5iv.org/html/2402.11981#A3.Ex57 \"Proof. â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆâˆ’Î»â€‹mc,â€–â„±â€–âˆ\\].superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰subscriptnormâ„±ğœ†subscriptğ‘šğ‘subscriptnormâ„±\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\lambda m\\_{c},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\]. |  |\n\n(ii) Let Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi and Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0. To compute the Lipschitz constant of fâ†¦Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)maps-toğ‘“superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰f\\\\mapsto\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi), we compute the derivative of hv:tâ†¦Ï•Ï„,Ïµâ€‹(Î»,f+tâ€‹v,Î¾):subscriptâ„ğ‘£maps-toğ‘¡superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğ‘¡ğ‘£ğœ‰h\\_{v}:t\\\\mapsto\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f+tv,\\\\xi) where tâˆˆâ„ğ‘¡â„t\\\\in\\\\mathbb{R} and for an arbitrary direction vâˆˆâ„±ğ‘£â„±v\\\\in\\\\mathcal{F}. We have\n\n|     |     |     |\n| --- | --- | --- |\n|  | hvâ€‹(t)=(Ïµ+Î»â€‹Ï„)â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)+tâ€‹vâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\].h\\_{v}(t)=(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)+tv(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]. |  |\n\nIt is easy to verify that hvâ€²â€‹(t)=ğ”¼Î¶âˆ¼Ï€0f+tâ€‹vâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„(â‹…\\|Î¾)â€‹\\[vâ€‹(Î¶)\\],h\\_{v}^{\\\\prime}(t)=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f+tv-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[v(\\\\zeta)\\\\right\\], whence \\|hvâ€²â€‹(t)\\|â‰¤â€–vâ€–âˆsubscriptsuperscriptâ„â€²ğ‘£ğ‘¡subscriptnormğ‘£\\|h^{\\\\prime}\\_{v}(t)\\|\\\\leq\\\\\\|v\\\\\\|\\_{\\\\infty}. This means that Ï•Ï„,Ïµâ€‹(Î»,â‹…,Î¾)superscriptitalic-Ï•ğœitalic-Ïµğœ†â‹…ğœ‰\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,\\\\cdot,\\\\xi) has Lipschitz constant 111.\n\n2\\. (i) Let Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 and (Î¼,f,Î¾)âˆˆ(0,Î»lowâˆ’1\\]Ã—â„±Ã—Îğœ‡ğ‘“ğœ‰0superscriptsubscriptğœ†low1â„±Î(\\\\mu,f,\\\\xi)\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}\\\\times\\\\Xi. Î»ğœ†\\\\lambda. We deduce from ( [21](https://ar5iv.org/html/2402.11981#A3.E21 \"Equation 21 â€£ Proof. â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [C.2](https://ar5iv.org/html/2402.11981#A3.Ex57 \"Proof. â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), with Î»=Î¼âˆ’1ğœ†superscriptğœ‡1\\\\lambda=\\\\mu^{-1}, that\n\n|     |     |     |\n| --- | --- | --- |\n|  | Î¼â€‹Ï•Ï„,Ïµâ€‹(Î¼âˆ’1,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆÎ»lowâˆ’mc,â€–â„±â€–âˆÎ»low\\].ğœ‡superscriptitalic-Ï•ğœitalic-Ïµsuperscriptğœ‡1ğ‘“ğœ‰subscriptnormâ„±subscriptğœ†lowsubscriptğ‘šğ‘subscriptnormâ„±subscriptğœ†low\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}-m\\_{c},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\]. |  |\n\n(ii) Now, let Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi. Our goal is to compute a Lipschitz constant of (Î¼,f)â†¦Î¼â€‹Ï•Ï„,Ïµâ€‹(Î¼âˆ’1,f,Î¾)maps-toğœ‡ğ‘“ğœ‡superscriptitalic-Ï•ğœitalic-Ïµsuperscriptğœ‡1ğ‘“ğœ‰(\\\\mu,f)\\\\mapsto\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},f,\\\\xi) on \\[Î»upâˆ’1,Î»lowâˆ’1\\]Ã—â„±superscriptsubscriptğœ†up1superscriptsubscriptğœ†low1â„±\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}. We first compute a Lipschitz constant of\n\n|     |     |     |\n| --- | --- | --- |\n|  | hf:Î¼â†¦Î¼â€‹Ï•Ï„,Ïµâ€‹(Î¼âˆ’1,f,Î¾)=(Î¼â€‹Ïµ+Ï„)â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eÎ¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ+Ï„\\]h\\_{f}:\\\\mu\\\\mapsto\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},f,\\\\xi)=(\\\\mu\\\\epsilon+\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\] |  |\n\non \\[Î»upâˆ’1,Î»lowâˆ’1\\]superscriptsubscriptğœ†up1superscriptsubscriptğœ†low1\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\], for an arbitrary fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}. The derivative of hfsubscriptâ„ğ‘“h\\_{f} is\n\n|     |     |     |\n| --- | --- | --- |\n|  | hfâ€²â€‹(Î¼)=1Î¼â€‹Ïµ+Ï„â€‹ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[(Ïµâ€‹câ€‹(Î¾,Î¶)+Ï„â€‹fâ€‹(Î¶))â€‹eÎ¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ+Ï„\\]ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eÎ¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ+Ï„\\]+Ïµâ€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eÎ¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ+Ï„\\],h\\_{f}^{\\\\prime}(\\\\mu)=\\\\frac{1}{\\\\mu\\\\epsilon+\\\\tau}\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[(\\\\epsilon c(\\\\xi,\\\\zeta)+\\\\tau f(\\\\zeta))e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]}+\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\], |  |\n\nwhich we write\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | hfâ€²â€‹(Î¼)=ğ”¼Ï€0Î¼â€‹fâˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ+Ï„(â‹…\\|Î¾)â€‹\\[Ïµâ€‹câ€‹(Î¾,Î¶)+Ï„â€‹fâ€‹(Î¶)Î¼â€‹Ïµ+Ï„\\]+Ïµâ€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eÎ¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ+Ï„\\].h\\_{f}^{\\\\prime}(\\\\mu)=\\\\mathbb{E}\\_{\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\epsilon c(\\\\xi,\\\\zeta)+\\\\tau f(\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}\\\\right\\]+\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]. |  | (23) |\n\nWe bound hfâ€²â€‹(Î¼)subscriptsuperscriptâ„â€²ğ‘“ğœ‡h^{\\\\prime}\\_{f}(\\\\mu) above. By [LemmaC.2](https://ar5iv.org/html/2402.11981#A3.Thmlemma2 \"Lemma C.2 (Lemma G.7 in [5]). â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") with Q=Ï€0(â‹…\\|Î¾)Q=\\\\pi\\_{0}(\\\\cdot\\|\\\\xi) and g=Î¼â€‹fâˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ+Ï„ğ‘”ğœ‡ğ‘“ğ‘ğœ‰â‹…ğœ‡italic-Ïµğœg=\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}, we have that\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ïµâ€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eÎ¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ+Ï„\\]â‰¤ğ”¼Î¶âˆ¼Ï€0Î¼â€‹fâˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ+Ï„(â‹…\\|Î¾)â€‹\\[Ïµâ€‹Î¼â€‹fâ€‹(Î¶)âˆ’Ïµâ€‹câ€‹(Î¾,Î¶)Î¼â€‹Ïµ+Ï„\\]\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]\\\\leq\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\epsilon\\\\mu f(\\\\zeta)-\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}\\\\right\\] |  |\n\nwhich gives hfâ€²â€‹(Î¼)â‰¤ğ”¼Î¶âˆ¼Ï€0Î¼â€‹fâˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ+Ï„â€‹\\[fâ€‹(Î¶)\\]â‰¤â€–â„±â€–âˆsuperscriptsubscriptâ„ğ‘“â€²ğœ‡subscriptğ”¼similar-toğœsuperscriptsubscriptğœ‹0ğœ‡ğ‘“ğ‘ğœ‰â‹…ğœ‡italic-Ïµğœdelimited-\\[\\]ğ‘“ğœsubscriptnormâ„±h\\_{f}^{\\\\prime}(\\\\mu)\\\\leq\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}}}\\[f(\\\\zeta)\\]\\\\leq\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}.\n\nNow we bound hfâ€²â€‹(Î¼)superscriptsubscriptâ„ğ‘“â€²ğœ‡h\\_{f}^{\\\\prime}(\\\\mu) below. We start with the first term in ( [23](https://ar5iv.org/html/2402.11981#A3.E23 \"Equation 23 â€£ Proof. â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Since cğ‘c is nonnegative, we clearly have\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ğ”¼Ï€0Î¼â€‹fâˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ+Ï„(â‹…\\|Î¾)â€‹\\[Ïµâ€‹câ€‹(Î¾,Î¶)+Ï„â€‹fâ€‹(Î¶)Î¼â€‹Ïµ+Ï„\\]â‰¥âˆ’Ï„â€‹â€–â„±â€–âˆÎ¼â€‹Ïµ+Ï„\\\\mathbb{E}\\_{\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon+\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\epsilon c(\\\\xi,\\\\zeta)+\\\\tau f(\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}\\\\right\\]\\\\geq\\\\frac{-\\\\tau\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\mu\\\\epsilon+\\\\tau} |  | (24) |\n\nAs to the second term of ( [23](https://ar5iv.org/html/2402.11981#A3.E23 \"Equation 23 â€£ Proof. â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we have by Jensenâ€™s inequality,\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Ïµâ€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eÎ¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ+Ï„\\]â‰¥âˆ’Ïµâ€‹Î¼â€‹â€–â„±â€–âˆÎ¼â€‹Ïµ+Ï„âˆ’Ïµâ€‹mcÎ¼â€‹Ïµ+Ï„\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]\\\\geq-\\\\frac{\\\\epsilon\\\\mu\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\mu\\\\epsilon+\\\\tau}-\\\\frac{\\\\epsilon m\\_{c}}{\\\\mu\\\\epsilon+\\\\tau} |  | (25) |\n\nCombining ( [24](https://ar5iv.org/html/2402.11981#A3.E24 \"Equation 24 â€£ Proof. â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [25](https://ar5iv.org/html/2402.11981#A3.E25 \"Equation 25 â€£ Proof. â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives hfâ€²â€‹(Î¼)â‰¥âˆ’â€–â„±â€–âˆâˆ’Î»upâ€‹Ïµâ€‹mcÏµ+Î»upâ€‹Ï„subscriptsuperscriptâ„â€²ğ‘“ğœ‡subscriptnormâ„±subscriptğœ†upitalic-Ïµsubscriptğ‘šğ‘italic-Ïµsubscriptğœ†upğœh^{\\\\prime}\\_{f}(\\\\mu)\\\\geq-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}\\\\epsilon m\\_{c}}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}. Finally, hfsubscriptâ„ğ‘“h\\_{f} has Lipschitz constant â€–â„±â€–âˆ+Î»upâ€‹mcÏµ+Î»upâ€‹Ï„subscriptnormâ„±subscriptğœ†upsubscriptğ‘šğ‘italic-Ïµsubscriptğœ†upğœ\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}m\\_{c}}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}\n\nSince Ï•Ï„,Ïµâ€‹(Î¼âˆ’1,â‹…,Î¾)superscriptitalic-Ï•ğœitalic-Ïµsuperscriptğœ‡1â‹…ğœ‰\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},\\\\cdot,\\\\xi) has Lipschitz constant 111, then Î¼â‰¤Î»lowâˆ’1ğœ‡superscriptsubscriptğœ†low1\\\\mu\\\\leq\\\\lambda\\_{\\\\operatorname{low}}^{-1}, the function Î¼â€‹Ï•Ï„,Ïµâ€‹(Î¼âˆ’1,â‹…,Î¾)ğœ‡superscriptitalic-Ï•ğœitalic-Ïµsuperscriptğœ‡1â‹…ğœ‰\\\\mu\\\\phi^{\\\\tau,\\\\epsilon}(\\\\mu^{-1},\\\\cdot,\\\\xi) has Lipschitz constant Î»lowâˆ’1superscriptsubscriptğœ†low1\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\n\nNow, we can obtain a Lipschitz constant for\n\n|     |     |     |\n| --- | --- | --- |\n|  | h:(Î¼,f)â†¦(Î¼â€‹Ïµ+Ï„)â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eÎ¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ+Ï„\\]=ÏˆÏ„,Ïµâ€‹(Î¼,f,Î¾).h:(\\\\mu,f)\\\\mapsto(\\\\mu\\\\epsilon+\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon+\\\\tau}}\\\\right\\]=\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi). |  |\n\nIndeed, for (Î¼,Î¼â€²)âˆˆ\\[Î»upâˆ’1,Î»lowâˆ’1\\]Ã—\\[Î»upâˆ’1,Î»lowâˆ’1\\]ğœ‡superscriptğœ‡â€²superscriptsubscriptğœ†up1superscriptsubscriptğœ†low1superscriptsubscriptğœ†up1superscriptsubscriptğœ†low1(\\\\mu,\\\\mu^{\\\\prime})\\\\in\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and (f,fâ€²)âˆˆâ„±Ã—â„±ğ‘“superscriptğ‘“â€²â„±â„±(f,f^{\\\\prime})\\\\in\\\\mathcal{F}\\\\times\\\\mathcal{F}, we can write\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | \\|hâ€‹(Î¼,f)âˆ’hâ€‹(Î¼â€²,fâ€²)\\|â„ğœ‡ğ‘“â„superscriptğœ‡â€²superscriptğ‘“â€²\\\\displaystyle\\|h(\\\\mu,f)-h(\\\\mu^{\\\\prime},f^{\\\\prime})\\| | â‰¤\\|hâ€‹(Î¼,f)âˆ’hâ€‹(Î¼â€²,f)\\|+\\|hâ€‹(Î¼â€²,f)âˆ’hâ€‹(Î¼â€²,fâ€²)\\|absentâ„ğœ‡ğ‘“â„superscriptğœ‡â€²ğ‘“â„superscriptğœ‡â€²ğ‘“â„superscriptğœ‡â€²superscriptğ‘“â€²\\\\displaystyle\\\\leq\\|h(\\\\mu,f)-h(\\\\mu^{\\\\prime},f)\\|+\\|h(\\\\mu^{\\\\prime},f)-h(\\\\mu^{\\\\prime},f^{\\\\prime})\\| |  |\n|  |  | â‰¤(â€–â„±â€–âˆ+(Î»upâ€‹ÏµÏµ+Î»upâ€‹Ï„))â€‹\\|Î¼âˆ’Î¼â€²\\|+Î»lowâˆ’1â€‹â€–fâˆ’fâ€²â€–âˆ.absentsubscriptnormâ„±subscriptğœ†upitalic-Ïµitalic-Ïµsubscriptğœ†upğœğœ‡superscriptğœ‡â€²superscriptsubscriptğœ†low1subscriptnormğ‘“superscriptğ‘“â€²\\\\displaystyle\\\\leq\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\left(\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}\\\\epsilon}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}\\\\right)\\\\right)\\|\\\\mu-\\\\mu^{\\\\prime}\\|+\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. |  |\n\nhence hâ„h has Lipschitz constant â€–â„±â€–âˆ+Î»lowâˆ’1+(Î»upâ€‹ÏµÏµ+Î»upâ€‹Ï„)â€‹mcsubscriptnormâ„±superscriptsubscriptğœ†low1subscriptğœ†upitalic-Ïµitalic-Ïµsubscriptğœ†upğœsubscriptğ‘šğ‘\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}+\\\\left(\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}\\\\epsilon}{\\\\epsilon+\\\\lambda\\_{\\\\operatorname{up}}\\\\tau}\\\\right)m\\_{c}.\nâˆ\n\n## Appendix D Dual bounds and maximal radius\n\nWe establish the existence of a dual lower bound on the true robust risk, for the standard WDRO problem in [D.1](https://ar5iv.org/html/2402.11981#A4.SS1 \"D.1 Standard WDRO: continuity at zero of the maximal radius â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and for regularized WDRO in [D.2](https://ar5iv.org/html/2402.11981#A4.SS2 \"D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The proofs involve the maximal radius introduced in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4 \"4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). For the regularized case, an estimate of the dual lower bound is provided.\n\n### D.1 Standard WDRO: continuity at zero of the maximal radius\n\nFor Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0, we consider the following quantities:\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ïcrit=inffâˆˆâ„±ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»+Ï•â€‹(0,f,Î¾)\\]Ïmaxâ€‹(Î»)=inffâˆˆâ„±ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\].formulae-sequencesubscriptğœŒcritsubscriptinfimumğ‘“â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptsubscriptğœ†italic-Ï•0ğ‘“ğœ‰subscriptğœŒğœ†subscriptinfimumğ‘“â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptsubscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰\\\\rho\\_{\\\\operatorname{crit}}=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(0,f,\\\\xi)\\]\\\\qquad\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]. |  |\n\n###### Lemma D.1.\n\nlimÎ»â†’0+Ïmaxâ€‹(Î»)=Ïcrit.subscriptâ†’ğœ†superscript0subscriptğœŒğœ†subscriptğœŒcrit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}.\n\n###### Proof.\n\nFor Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, fâˆ’Î»â€‹câ€‹(Î¾,â‹…)ğ‘“ğœ†ğ‘ğœ‰â‹…f-\\\\lambda c(\\\\xi,\\\\cdot) is continuous, hence we can apply the envelope formula ( [TheoremA.1](https://ar5iv.org/html/2402.11981#A1.Thmtheorem1 \"Theorem A.1 (Envelope formula, Corollary 1, Chapter 2.8 in [14]). â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and the right-sided derivative of Ï•italic-Ï•\\\\phi with respect to Î»ğœ†\\\\lambda is âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)=âˆ’minâ¡{câ€‹(Î¾,Î¶):Î¶âˆˆargâ€‹maxÎâ¡{fâˆ’Î»â€‹câ€‹(Î¾,â‹…)}}subscriptsuperscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰:ğ‘ğœ‰ğœğœsubscriptargmaxÎğ‘“ğœ†ğ‘ğœ‰â‹…\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)=-\\\\min\\\\left\\\\{c(\\\\xi,\\\\zeta)\\ :\\ \\\\zeta\\\\in\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\}\\\\right\\\\}. For convenience, we use the shorthand\n\n|     |     |     |\n| --- | --- | --- |\n|  | câˆ—â€‹(Î¾,K):=minâ¡{câ€‹(Î¾,z),zâˆˆK}assignsuperscriptğ‘ğœ‰ğ¾ğ‘ğœ‰ğ‘§ğ‘§ğ¾c^{\\*}(\\\\xi,K):=\\\\min\\\\{c(\\\\xi,z),z\\\\in K\\\\} |  |\n\nwhenever KâŠ‚Îğ¾ÎK\\\\subset\\\\Xi is compact. By integration, we obtain\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Ïmaxâ€‹(Î»)=ğ”¼Î¾âˆ¼Pâ€‹\\[câˆ—â€‹(Î¾,argâ€‹maxÎâ¡{fâˆ’Î»â€‹câ€‹(Î¾,â‹…)})\\].subscriptğœŒğœ†subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptğ‘ğœ‰subscriptargmaxÎğ‘“ğœ†ğ‘ğœ‰â‹…\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\})\\]. |  | (26) |\n\nIn particular,\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ïcrit=inffâˆˆâ„±â€‹ğ”¼Î¾âˆ¼Pâ€‹\\[câˆ—â€‹(Î¾,argâ€‹maxÎâ¡f)\\].subscriptğœŒcritğ‘“â„±infimumsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptğ‘ğœ‰subscriptargmaxÎğ‘“\\\\rho\\_{\\\\operatorname{crit}}=\\\\underset{f\\\\in\\\\mathcal{F}}{\\\\inf}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f)\\]. |  |\n\nTo prove the result, it is sufficient to show that lim infkâ†’âˆÏmaxâ€‹(Î»k)â‰¥Ïcritsubscriptlimit-infimumâ†’ğ‘˜subscriptğœŒsubscriptğœ†ğ‘˜subscriptğœŒcrit\\\\liminf\\_{k\\\\to\\\\infty}\\\\rho\\_{\\\\max}(\\\\lambda\\_{k})\\\\geq\\\\rho\\_{\\\\operatorname{crit}} for any positive sequence (Î»k)kâˆˆâ„•subscriptsubscriptğœ†ğ‘˜ğ‘˜â„•(\\\\lambda\\_{k})\\_{k\\\\in\\\\mathbb{N}} converging to 00. Indeed, the functions ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(â‹…,f,Î¾)\\]subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•â‹…ğ‘“ğœ‰\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\cdot,f,\\\\xi)\\] are convex hence their right-sided derivatives ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»+Ï•â€‹(â‹…,f,Î¾)\\]subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptsuperscriptğœ†italic-Ï•â‹…ğ‘“ğœ‰\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\cdot,f,\\\\xi)\\] are nonincreasing, and ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} is nonincreasing since it is an infimum over nonincreasing functions. This means lim supkâ†’âˆÏmaxâ€‹(Î»k)â‰¤Ïmaxâ€‹(0)subscriptlimit-supremumâ†’ğ‘˜subscriptğœŒsubscriptğœ†ğ‘˜subscriptğœŒ0\\\\limsup\\_{k\\\\to\\\\infty}\\\\rho\\_{\\\\max}(\\\\lambda\\_{k})\\\\leq\\\\rho\\_{\\\\max}(0) for any sequence Î»kâ†’0â†’subscriptğœ†ğ‘˜0\\\\lambda\\_{k}\\\\to 0.\n\nNow assume toward a contradiction that there exists Ïµ>0italic-Ïµ0\\\\epsilon>0 and a sequence (Î»k)kâˆˆâ„•subscriptsubscriptğœ†ğ‘˜ğ‘˜â„•(\\\\lambda\\_{k})\\_{k\\\\in\\\\mathbb{N}} from â„+subscriptâ„\\\\mathbb{R}\\_{+}, such that Î»kâ†’0â†’subscriptğœ†ğ‘˜0\\\\lambda\\_{k}\\\\to 0 as kâ†’âˆâ†’ğ‘˜k\\\\to\\\\infty, and Ïmaxâ€‹(Î»k)â‰¤Ïcritâˆ’ÏµsubscriptğœŒsubscriptğœ†ğ‘˜subscriptğœŒcrititalic-Ïµ\\\\rho\\_{\\\\max}(\\\\lambda\\_{k})\\\\leq\\\\rho\\_{\\\\operatorname{crit}}-\\\\epsilon for all kâˆˆâ„•ğ‘˜â„•k\\\\in\\\\mathbb{N}. From the expression of ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} ( [26](https://ar5iv.org/html/2402.11981#A4.E26 \"Equation 26 â€£ Proof. â€£ D.1 Standard WDRO: continuity at zero of the maximal radius â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) this means that for each kğ‘˜k, there exists fksubscriptğ‘“ğ‘˜f\\_{k} such that\nğ”¼Î¾âˆ¼Pâ€‹\\[câˆ—â€‹(Î¾,argâ€‹maxÎâ¡fkâˆ’Î»kâ€‹câ€‹(Î¾,â‹…))\\]â‰¤Ïcritâˆ’Ïµ2subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptğ‘ğœ‰subscriptargmaxÎsubscriptğ‘“ğ‘˜subscriptğœ†ğ‘˜ğ‘ğœ‰â‹…subscriptğœŒcrititalic-Ïµ2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\_{k}-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot))\\]\\\\leq\\\\rho\\_{\\\\operatorname{crit}}-\\\\frac{\\\\epsilon}{2}. By compactness of â„±â„±\\\\mathcal{F} with respect to âˆ¥â‹…âˆ¥âˆ\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}, we may assume (fk)kâˆˆâ„•subscriptsubscriptğ‘“ğ‘˜ğ‘˜â„•(f\\_{k})\\_{k\\\\in\\\\mathbb{N}} to converge to some fâˆ—âˆˆâ„±superscriptğ‘“â„±f^{\\*}\\\\in\\\\mathcal{F}. In particular, for Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, fk,âˆ’Î»kâ€‹câ€‹(Î¾,â‹…)subscriptğ‘“ğ‘˜subscriptğœ†ğ‘˜ğ‘ğœ‰â‹…f\\_{k},-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot) converges to fâˆ—superscriptğ‘“f^{\\*} as kâ†’âˆâ†’ğ‘˜k\\\\to\\\\infty.\n\nLet Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi be arbitrary. (Î»,f)â†¦argâ€‹maxÎâ¡{fâˆ’Î»â€‹câ€‹(Î¾,â‹…)}maps-toğœ†ğ‘“subscriptargmaxÎğ‘“ğœ†ğ‘ğœ‰â‹…(\\\\lambda,f)\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\} is outer semicontinuous with compact values ( [LemmaA.2](https://ar5iv.org/html/2402.11981#A1.Thmlemma2 \"Lemma A.2 (17.31 in [1]). â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and cğ‘c is jointly continuous, hence (Î»,f)â†¦câˆ—(Î¾,argâ€‹maxÎ{fâˆ’Î»c(Î¾,â‹…))}(\\\\lambda,f)\\\\mapsto c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot))\\\\right\\\\} is lower semicontinuous, see [LemmaA.1](https://ar5iv.org/html/2402.11981#A1.Thmlemma1 \"Lemma A.1 (17.30 in [1]). â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). We then have lim infkâ†’âˆcâˆ—â€‹(Î¾,argâ€‹maxÎâ¡{fkâˆ’Î»kâ€‹câ€‹(Î¾,â‹…)})â‰¥câˆ—â€‹(Î¾,argâ€‹maxÎâ¡fâˆ—)subscriptlimit-infimumâ†’ğ‘˜superscriptğ‘ğœ‰subscriptargmaxÎsubscriptğ‘“ğ‘˜subscriptğœ†ğ‘˜ğ‘ğœ‰â‹…superscriptğ‘ğœ‰subscriptargmaxÎsuperscriptğ‘“\\\\liminf\\_{k\\\\to\\\\infty}c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f\\_{k}-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot)\\\\right\\\\})\\\\geq c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f^{\\*}). By integration with respect to Î¾âˆ¼Psimilar-toğœ‰ğ‘ƒ\\\\xi\\\\sim P, we obtain\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ğ”¼Î¾âˆ¼Pâ€‹\\[câˆ—â€‹(Î¾,argâ€‹maxÎâ¡fâˆ—)\\]subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptğ‘ğœ‰subscriptargmaxÎsuperscriptğ‘“\\\\displaystyle\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f^{\\*})\\] | â‰¤ğ”¼Î¾âˆ¼Pâ€‹\\[lim infkâ†’âˆcâˆ—â€‹(Î¾,argâ€‹maxÎâ¡{fkâˆ’Î»kâ€‹câ€‹(Î¾,â‹…)})\\]absentsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptlimit-infimumâ†’ğ‘˜superscriptğ‘ğœ‰subscriptargmaxÎsubscriptğ‘“ğ‘˜subscriptğœ†ğ‘˜ğ‘ğœ‰â‹…\\\\displaystyle\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\liminf\\_{k\\\\to\\\\infty}c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f\\_{k}-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot)\\\\right\\\\})\\] |  |\n|  |  | â‰¤lim infkâ†’âˆğ”¼Î¾âˆ¼Pâ€‹\\[câˆ—â€‹(Î¾,argâ€‹maxÎâ¡{fkâˆ’Î»kâ€‹câ€‹(Î¾,â‹…)})\\]absentsubscriptlimit-infimumâ†’ğ‘˜subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptğ‘ğœ‰subscriptargmaxÎsubscriptğ‘“ğ‘˜subscriptğœ†ğ‘˜ğ‘ğœ‰â‹…\\\\displaystyle\\\\leq\\\\liminf\\_{k\\\\to\\\\infty}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f\\_{k}-\\\\lambda\\_{k}c(\\\\xi,\\\\cdot)\\\\right\\\\})\\] |  |\n|  |  | â‰¤Ïcritâˆ’Ïµ2.absentsubscriptğœŒcrititalic-Ïµ2\\\\displaystyle\\\\leq\\\\rho\\_{\\\\operatorname{crit}}-\\\\frac{\\\\epsilon}{2}. |  |\n\nSince, Ïcritâ‰¤ğ”¼Î¾âˆ¼Pâ€‹\\[câˆ—â€‹(Î¾,argâ€‹maxÎâ¡fâˆ—)\\]subscriptğœŒcritsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptğ‘ğœ‰subscriptargmaxÎsuperscriptğ‘“\\\\rho\\_{\\\\operatorname{crit}}\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[c^{\\*}(\\\\xi,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f^{\\*})\\], this yields a contradiction. Finally, limÎ»â†’0+Ïmaxâ€‹(Î»)=Ïcritsubscriptâ†’ğœ†superscript0subscriptğœŒğœ†subscriptğœŒcrit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}.\nâˆ\n\n### D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound\n\nFor Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0, we consider the regularized counterparts\n\n|     |     |     |\n| --- | --- | --- |\n|  | ÏcritÏ„,Ïµ=inffâˆˆâ„±ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»Ï•Ï„,Ïµâ€‹(0,f,Î¾)\\],superscriptsubscriptğœŒcritğœitalic-Ïµsubscriptinfimumğ‘“â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµ0ğ‘“ğœ‰\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(0,f,\\\\xi)\\], |  |\n\n|     |     |     |\n| --- | --- | --- |\n|  | ÏmaxÏ„,Ïµâ€‹(Î»)=inffâˆˆâ„±ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\].superscriptsubscriptğœŒğœitalic-Ïµğœ†subscriptinfimumğ‘“â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]. |  |\n\n#### D.2.1 Lipschitz continuity of the maximal radius\n\n###### Lemma D.2.\n\nÏmaxÏ„,Ïµ:\\[0,âˆ)â†’â„:superscriptsubscriptğœŒğœitalic-Ïµâ†’0â„\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}:\\[0,\\\\infty)\\\\to\\\\mathbb{R} is Lipschitz continuous with constant\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | 2Ïµâ€‹(Ï„2Ïµ2â€‹â€–â„±â€–âˆ2+m2,câ€‹eâ€–â„±â€–âˆÏµ+minâ¡{mcÏ„,2â€‹â€–â„±â€–âˆâ€‹mc(Ïâˆ’mc)â€‹Ïµ}).2italic-Ïµsuperscriptğœ2superscriptitalic-Ïµ2superscriptsubscriptnormâ„±2subscriptğ‘š2ğ‘superscriptğ‘’subscriptnormâ„±italic-Ïµsubscriptğ‘šğ‘ğœ2subscriptnormâ„±subscriptğ‘šğ‘ğœŒsubscriptğ‘šğ‘italic-Ïµ\\\\frac{2}{\\\\epsilon}\\\\left(\\\\frac{\\\\tau^{2}}{\\\\epsilon^{2}}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}^{2}+m\\_{2,c}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}+\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}}\\\\right). |  |\\\n\\\nIn particular, if\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Î»lowÏ„,Ïµ:=Ïµâ€‹ÏcritÏ„,Ïµ8â€‹(Ï„2Ïµ2â€‹â€–â„±â€–âˆ2+m2,câ€‹eâ€–â„±â€–âˆÏµ+minâ¡{mcÏ„,2â€‹â€–â„±â€–âˆâ€‹mc(Ïâˆ’mc)â€‹Ïµ}),assignsuperscriptsubscriptğœ†lowğœitalic-Ïµitalic-ÏµsuperscriptsubscriptğœŒcritğœitalic-Ïµ8superscriptğœ2superscriptitalic-Ïµ2superscriptsubscriptnormâ„±2subscriptğ‘š2ğ‘superscriptğ‘’subscriptnormâ„±italic-Ïµsubscriptğ‘šğ‘ğœ2subscriptnormâ„±subscriptğ‘šğ‘ğœŒsubscriptğ‘šğ‘italic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}:=\\\\frac{\\\\epsilon\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{8\\\\left(\\\\frac{\\\\tau^{2}}{\\\\epsilon^{2}}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}^{2}+m\\_{2,c}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}+\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}}\\\\right)}, |  | (27) |\\\n\\\nthen Ïmaxâ€‹(Î»)â‰¥Ïcrit2subscriptğœŒğœ†subscriptğœŒcrit2\\\\rho\\_{\\\\max}(\\\\lambda)\\\\geq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2} for all Î»âˆˆ\\[0,2â€‹Î»lowÏ„,Ïµ\\]ğœ†02superscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}\\].\\\n\\\n###### Proof.\\\n\\\nÏ•Ï„,Ïµsuperscriptitalic-Ï•ğœitalic-Ïµ\\\\phi^{\\\\tau,\\\\epsilon} is differentiable with respect to Î»ğœ†\\\\lambda and we can verify that its derivative is given by\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)=âˆ’ğ”¼Î¶âˆ¼Ï€0fâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„(â‹…\\|Î¾)â€‹\\[Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]+Ï„â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\].\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=-\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right\\]+\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]. |  |\\\n\\\nFor fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} and Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, our goal is to compute the Lipschitz constant of Î»â†¦âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)maps-toğœ†subscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\lambda\\\\mapsto\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi). The Lipschitz constant of ÏmaxÏ„,ÏµsuperscriptsubscriptğœŒğœitalic-Ïµ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon} will then be obtained by integration and taking the infimum over Lipschitz functions. We compute the appropriate quantities:\\\n\\\n1\\. We compute the derivative with respect to Î»ğœ†\\\\lambda of u1:(Î»,Î¶)â†¦âˆ’(Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„)â€‹efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„:subscriptğ‘¢1maps-toğœ†ğœğœğ‘“ğœitalic-Ïµğ‘ğœ‰ğœitalic-Ïµğœ†ğœsuperscriptğ‘’ğ‘“ğœğœ†ğ‘ğœ‰ğœitalic-Ïµğœ†ğœu\\_{1}:(\\\\lambda,\\\\zeta)\\\\mapsto-\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}. This is\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ‚Î»u1â€‹(Î»,Î¶)=(Ï„2â€‹fâ€‹(Î¶)+Ïµâ€‹Ï„â€‹câ€‹(Î¾,Î¶)(Ïµ+Î»â€‹Ï„)2+(Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶))2(Ïµ+Î»â€‹Ï„)3)â€‹efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„.subscriptğœ†subscriptğ‘¢1ğœ†ğœsuperscriptğœ2ğ‘“ğœitalic-Ïµğœğ‘ğœ‰ğœsuperscriptitalic-Ïµğœ†ğœ2superscriptğœğ‘“ğœitalic-Ïµğ‘ğœ‰ğœ2superscriptitalic-Ïµğœ†ğœ3superscriptğ‘’ğ‘“ğœğœ†ğ‘ğœ‰ğœitalic-Ïµğœ†ğœ\\\\partial\\_{\\\\lambda}u\\_{1}(\\\\lambda,\\\\zeta)=\\\\left(\\\\frac{\\\\tau^{2}f(\\\\zeta)+\\\\epsilon\\\\tau c(\\\\xi,\\\\zeta)}{(\\\\epsilon+\\\\lambda\\\\tau)^{2}}+\\\\frac{(\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta))^{2}}{(\\\\epsilon+\\\\lambda\\\\tau)^{3}}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}. |  |\\\n\\\n2\\. We compute the derivative with respect to Î»ğœ†\\\\lambda of u2:(Î»,Î¶)â†¦efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„:subscriptğ‘¢2maps-toğœ†ğœsuperscriptğ‘’ğ‘“ğœğœ†ğ‘ğœ‰ğœitalic-Ïµğœ†ğœu\\_{2}:(\\\\lambda,\\\\zeta)\\\\mapsto e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}, this is\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ‚Î»u2â€‹(Î»,Î¶)=âˆ’(Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶)(Ïµ+Î»â€‹Ï„)2)â€‹efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„.subscriptğœ†subscriptğ‘¢2ğœ†ğœğœğ‘“ğœitalic-Ïµğ‘ğœ‰ğœsuperscriptitalic-Ïµğœ†ğœ2superscriptğ‘’ğ‘“ğœğœ†ğ‘ğœ‰ğœitalic-Ïµğœ†ğœ\\\\partial\\_{\\\\lambda}u\\_{2}(\\\\lambda,\\\\zeta)=-\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{(\\\\epsilon+\\\\lambda\\\\tau)^{2}}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}. |  |\\\n\\\n3\\. We compute the derivative of U3:Î»â†¦Ï„â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]U\\_{3}:\\\\lambda\\\\mapsto\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]. This is\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | U3â€²â€‹(Î»)=âˆ’ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[(Ï„2â€‹fâ€‹(Î¶)+Ï„â€‹Ïµâ€‹câ€‹(Î¾,Î¶)(Ïµ+Î»â€‹Ï„)2)â€‹efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„2\\]ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\].U\\_{3}^{\\\\prime}(\\\\lambda)=-\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\left(\\\\frac{\\\\tau^{2}f(\\\\zeta)+\\\\tau\\\\epsilon c(\\\\xi,\\\\zeta)}{(\\\\epsilon+\\\\lambda\\\\tau)^{2}}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau^{2}}}\\\\right\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]}. |  |\\\n\\\nCombining 1, 2 and 3, we are able to compute the derivative of âˆ‚Î»Ï•Ï„,Ïµsubscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµ\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}:\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | âˆ‚Î»2Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)subscriptsuperscript2ğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\displaystyle\\\\partial^{2}\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi) | =âˆ’ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[u1â€‹(Î»,Î¶)\\]â€‹ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[âˆ‚Î»u2â€‹(Î»,Î¶)\\]ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[u2â€‹(Î»,Î¶)\\]2+U3â€²â€‹(Î»)\\\\displaystyle=-\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[u\\_{1}(\\\\lambda,\\\\zeta)\\]\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[\\\\partial\\_{\\\\lambda}u\\_{2}(\\\\lambda,\\\\zeta)\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[u\\_{2}(\\\\lambda,\\\\zeta)\\]^{2}}+U^{\\\\prime}\\_{3}(\\\\lambda) |  |\\\n|  |  | =ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[(Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶))2(Ïµ+Î»â€‹Ï„)3â€‹efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]\\\\displaystyle=\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{(\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta))^{2}}{(\\\\epsilon+\\\\lambda\\\\tau)^{3}}e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]} |  |\\\n|  |  | âˆ’ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[(Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶)(Ïµ+Î»â€‹Ï„)2)â€‹efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]â€‹ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[(Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„)â€‹efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]\\\\displaystyle\\\\quad-\\\\frac{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{(\\\\epsilon+\\\\lambda\\\\tau)^{2}}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right)e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]}{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]} |  |\\\n|  |  | =1Ïµ+Î»â€‹Ï„â€‹VarÎ¶âˆ¼Ï€fâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„(â‹…\\|Î¾)â¡(Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„),\\\\displaystyle=\\\\frac{1}{\\\\epsilon+\\\\lambda\\\\tau}\\\\operatorname{Var}\\_{\\\\zeta\\\\sim\\\\pi^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right), |  |\\\n\\\nwhere VarÎ¶âˆ¼Ï€fâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„(â‹…\\|Î¾)\\\\operatorname{Var}\\_{\\\\zeta\\\\sim\\\\pi^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)} is the variance with respect to Ï€fâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„(â‹…\\|Î¾)\\\\pi^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi).\\\n\\\nNote that all quantities can be differentiated under the (conditional) expectation since the derivatives with respect to Î»ğœ†\\\\lambda involve functions that are continuous on the compact sample space ÎÎ\\\\Xi (they are therefore bounded by a constant), see e.g. Theorem A.5.3 from \\[ [17](https://ar5iv.org/html/2402.11981#bib.bib17 \"\")\\]. By the property of the variance, we obtain\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | \\|âˆ‚Î»2Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\|subscriptsuperscript2ğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\displaystyle\\|\\\\partial^{2}\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\| | â‰¤1Ïµ+Î»â€‹Ï„â€‹ğ”¼Î¶âˆ¼Ï€0fâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„(â‹…\\|Î¾)â€‹\\[(Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„)2\\]\\\\displaystyle\\\\leq\\\\frac{1}{\\\\epsilon+\\\\lambda\\\\tau}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\left(\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right)^{2}\\\\right\\] |  |\\\n|  |  | â‰¤2Ïµ3â€‹ğ”¼Î¶âˆ¼Ï€0fâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„(â‹…\\|Î¾)â€‹\\[Ï„2â€‹â€–â„±â€–âˆ2+Ïµ2â€‹câ€‹(Î¾,Î¶)2\\].\\\\displaystyle\\\\leq\\\\frac{2}{\\\\epsilon^{3}}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\tau^{2}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}^{2}+\\\\epsilon^{2}c(\\\\xi,\\\\zeta)^{2}\\\\right\\]. |  | (28) |\\\n\\\nNow we bound the right-hand side of the last inequality. First, we have\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[câ€‹(Î¾,Î¶)2â€‹efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]â‰¤m2,câ€‹eâ€–â„±â€–âˆÏµ\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[c(\\\\xi,\\\\zeta)^{2}e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\\\\leq m\\_{2,c}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}} |  | (29) |\\\n\\\nOn the other hand, by Jensenâ€™s inequality, we have\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]â‰¥eâˆ’Î»â€‹mcÏµ+Î»â€‹Ï„âˆ’â€–â„±â€–âˆÏµ\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]\\\\geq e^{-\\\\frac{\\\\lambda m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}} |  | (30) |\\\n\\\nWe have the alternatives Î»â€‹mcÏµ+Î»â€‹Ï„â‰¤Î»upâ€‹mcÏµ=2â€‹â€–â„±â€–âˆâ€‹mc(Ïâˆ’mc)â€‹Ïµğœ†subscriptğ‘šğ‘italic-Ïµğœ†ğœsubscriptğœ†upsubscriptğ‘šğ‘italic-Ïµ2subscriptnormâ„±subscriptğ‘šğ‘ğœŒsubscriptğ‘šğ‘italic-Ïµ\\\\frac{\\\\lambda m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}\\\\leq\\\\frac{\\\\lambda\\_{\\\\operatorname{up}}m\\_{c}}{\\\\epsilon}=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon} in any case, and Î»â€‹mcÏµ+Î»â€‹Ï„â‰¤mcÏ„ğœ†subscriptğ‘šğ‘italic-Ïµğœ†ğœsubscriptğ‘šğ‘ğœ\\\\frac{\\\\lambda m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}\\\\leq\\\\frac{m\\_{c}}{\\\\tau} whenever Ï„>0ğœ0\\\\tau>0. This means Î»â€‹mcÏµ+Î»â€‹Ï„â‰¤minâ¡{mcÏ„,2â€‹â€–â„±â€–âˆâ€‹mc(Ïâˆ’mc)â€‹Ïµ}ğœ†subscriptğ‘šğ‘italic-Ïµğœ†ğœsubscriptğ‘šğ‘ğœ2subscriptnormâ„±subscriptğ‘šğ‘ğœŒsubscriptğ‘šğ‘italic-Ïµ\\\\frac{\\\\lambda m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}\\\\leq\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}.\\\n\\\nDividing ( [29](https://ar5iv.org/html/2402.11981#A4.E29 \"Equation 29 â€£ Proof. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) by ( [30](https://ar5iv.org/html/2402.11981#A4.E30 \"Equation 30 â€£ Proof. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we obtain ğ”¼Î¶âˆ¼Ï€0fâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„(â‹…\\|Î¾)â€‹\\[câ€‹(Î¾,Î¶)2\\]â‰¤m2,câ€‹eminâ¡{mcÏ„,2â€‹â€–â„±â€–âˆâ€‹mc(Ïâˆ’mc)â€‹Ïµ}â€‹e2â€‹â€–â„±â€–âˆÏµ\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[c(\\\\xi,\\\\zeta)^{2}\\\\right\\]\\\\leq m\\_{2,c}e^{\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}}e^{\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}. Reinjecting this inequality in ( [D.2.1](https://ar5iv.org/html/2402.11981#A4.Ex85 \"Proof. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | \\|âˆ‚Î»2Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\|â‰¤2Ïµâ€‹(Ï„2Ïµ2â€‹â€–â„±â€–âˆ2+m2,câ€‹e2â€‹â€–â„±â€–âˆÏµ+minâ¡{mcÏ„,2â€‹â€–â„±â€–âˆâ€‹mc(Ïâˆ’mc)â€‹Ïµ}):=L.subscriptsuperscript2ğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰2italic-Ïµsuperscriptğœ2superscriptitalic-Ïµ2superscriptsubscriptnormâ„±2subscriptğ‘š2ğ‘superscriptğ‘’2subscriptnormâ„±italic-Ïµsubscriptğ‘šğ‘ğœ2subscriptnormâ„±subscriptğ‘šğ‘ğœŒsubscriptğ‘šğ‘italic-Ïµassignğ¿\\|\\\\partial^{2}\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\|\\\\leq\\\\frac{2}{\\\\epsilon}\\\\left(\\\\frac{\\\\tau^{2}}{\\\\epsilon^{2}}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}^{2}+m\\_{2,c}e^{\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}+\\\\min\\\\left\\\\{\\\\frac{m\\_{c}}{\\\\tau},\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}}{(\\\\rho-m\\_{c})\\\\epsilon}\\\\right\\\\}}\\\\right):=L. |  | (31) |\\\n\\\nThis means that for fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, the function g:(Î»,f)â†¦ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]:ğ‘”maps-toğœ†ğ‘“subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰g:(\\\\lambda,f)\\\\mapsto\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\] is Lğ¿L-Lipschitz where Lğ¿L is given by ( [31](https://ar5iv.org/html/2402.11981#A4.E31 \"Equation 31 â€£ Proof. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nWe then show that ÏmaxÏ„,Ïµ:=inffâˆˆâ„±gâ€‹(â‹…,f)assignsuperscriptsubscriptğœŒğœitalic-Ïµsubscriptinfimumğ‘“â„±ğ‘”â‹…ğ‘“\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}:=\\\\inf\\_{f\\\\in\\\\mathcal{F}}g(\\\\cdot,f) is Lğ¿L-Lipschitz continuous. Let (Î»,Î»â€²)âˆˆâ„2ğœ†superscriptğœ†â€²superscriptâ„2(\\\\lambda,\\\\lambda^{\\\\prime})\\\\in\\\\mathbb{R}^{2}, and let (fk)kâˆˆâ„•subscriptsubscriptğ‘“ğ‘˜ğ‘˜â„•(f\\_{k})\\_{k\\\\in\\\\mathbb{N}} be a sequence from â„±â„±\\\\mathcal{F} such that gâ€‹(Î»â€²,fk)â€‹â†’kâ†’âˆâ€‹ÏmaxÏ„,Ïµâ€‹(Î»â€²)ğ‘”superscriptğœ†â€²subscriptğ‘“ğ‘˜â†’ğ‘˜â†’superscriptsubscriptğœŒğœitalic-Ïµsuperscriptğœ†â€²g(\\\\lambda^{\\\\prime},f\\_{k})\\\\underset{k\\\\to\\\\infty}{\\\\to}\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda^{\\\\prime}). Then by definition of ÏmaxÏ„,ÏµsuperscriptsubscriptğœŒğœitalic-Ïµ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}, we have for all kâˆˆâ„•ğ‘˜â„•k\\\\in\\\\mathbb{N},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ÏmaxÏ„,Ïµâ€‹(Î»)âˆ’gâ€‹(Î»â€²,fk)â‰¤gâ€‹(Î»,fk)âˆ’gâ€‹(Î»â€²,fk)â‰¤Lâ€‹\\|Î»âˆ’Î»â€²\\|.superscriptsubscriptğœŒğœitalic-Ïµğœ†ğ‘”superscriptğœ†â€²subscriptğ‘“ğ‘˜ğ‘”ğœ†subscriptğ‘“ğ‘˜ğ‘”superscriptğœ†â€²subscriptğ‘“ğ‘˜ğ¿ğœ†superscriptğœ†â€²\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)-g(\\\\lambda^{\\\\prime},f\\_{k})\\\\leq g(\\\\lambda,f\\_{k})-g(\\\\lambda^{\\\\prime},f\\_{k})\\\\leq L\\|\\\\lambda-\\\\lambda^{\\\\prime}\\|. |  |\\\n\\\nTaking the limit as kâ†’âˆâ†’ğ‘˜k\\\\to\\\\infty gives ÏmaxÏ„,Ïµâ€‹(Î»)âˆ’ÏmaxÏ„,Ïµâ€‹(Î»â€²)â‰¤Lâ€‹\\|Î»âˆ’Î»â€²\\|superscriptsubscriptğœŒğœitalic-Ïµğœ†superscriptsubscriptğœŒğœitalic-Ïµsuperscriptğœ†â€²ğ¿ğœ†superscriptğœ†â€²\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)-\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda^{\\\\prime})\\\\leq L\\|\\\\lambda-\\\\lambda^{\\\\prime}\\|. Exchanging the roles of Î»ğœ†\\\\lambda and Î»â€²superscriptğœ†â€²\\\\lambda^{\\\\prime} gives \\|ÏmaxÏ„,Ïµâ€‹(Î»)âˆ’ÏmaxÏ„,Ïµâ€‹(Î»â€²)\\|â‰¤Lâ€‹\\|Î»âˆ’Î»â€²\\|superscriptsubscriptğœŒğœitalic-Ïµğœ†superscriptsubscriptğœŒğœitalic-Ïµsuperscriptğœ†â€²ğ¿ğœ†superscriptğœ†â€²\\|\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)-\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda^{\\\\prime})\\|\\\\leq L\\|\\\\lambda-\\\\lambda^{\\\\prime}\\|, hence ÏmaxÏ„,ÏµsuperscriptsubscriptğœŒğœitalic-Ïµ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon} is Lğ¿L-Lipschitz.\\\n\\\nNow, set 2â€‹Î»lowÏ„,Ïµ:=sup{Î»âˆˆâ„+:ÏmaxÏ„,Ïµâ€‹(Î»)â‰¥ÏcritÏ„,Ïµ/2}assign2superscriptsubscriptğœ†lowğœitalic-Ïµsupremumconditional-setğœ†subscriptâ„superscriptsubscriptğœŒğœitalic-Ïµğœ†superscriptsubscriptğœŒcritğœitalic-Ïµ22\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}:=\\\\sup\\\\left\\\\{\\\\lambda\\\\in\\\\mathbb{R}\\_{+}\\ :\\ \\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)\\\\geq\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}/2\\\\right\\\\}. Then either Î»lowÏ„,Ïµ=âˆsuperscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}=\\\\infty (in which case any value Î»lowÏ„,Ïµsuperscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} satisfies the desired property), or by continuity of ÏmaxÏ„,ÏµsuperscriptsubscriptğœŒğœitalic-Ïµ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}, ÏmaxÏ„,Ïµâ€‹(2â€‹Î»lowÏ„,Ïµ)=ÏcritÏ„,Ïµ/2superscriptsubscriptğœŒğœitalic-Ïµ2superscriptsubscriptğœ†lowğœitalic-ÏµsuperscriptsubscriptğœŒcritğœitalic-Ïµ2\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon})=\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}/2 and we have ÏcritÏ„,Ïµâˆ’2â€‹Lâ€‹Î»lowÏ„,Ïµâ‰¤Ïmaxâ€‹(2â€‹Î»lowÏ„,Ïµ)=ÏcritÏ„,Ïµ/2superscriptsubscriptğœŒcritğœitalic-Ïµ2ğ¿superscriptsubscriptğœ†lowğœitalic-ÏµsubscriptğœŒ2superscriptsubscriptğœ†lowğœitalic-ÏµsuperscriptsubscriptğœŒcritğœitalic-Ïµ2\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}-2L\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}\\\\leq\\\\rho\\_{\\\\max}(2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon})=\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}/2. Finally we thus get ( [27](https://ar5iv.org/html/2402.11981#A4.E27 \"Equation 27 â€£ Lemma D.2. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\nâˆ\\\n\\\n#### D.2.2 Dual upper-bound\\\n\\\nThe following result allows to bound the dual solution above. This requirement is specific to the regularized setting, see in particular [PropositionF.2](https://ar5iv.org/html/2402.11981#A6.Thmproposition2 \"Proposition F.2. â€£ F.2 Necessity of the dual upper-bound â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for an example.\\\n\\\n###### Lemma D.3(Upper bound for the regularized problem [Lemma4.5](https://ar5iv.org/html/2402.11981\\#S4.Thmlemma5 \"Lemma 4.5. â€£ 4.5 Extension to (double) regularization. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nAssume Ï>mcğœŒsubscriptğ‘šğ‘\\\\rho>m\\_{c} and let Î»up:=2â€‹â€–â„±â€–âˆÏâˆ’mcassignsubscriptğœ†up2subscriptnormâ„±ğœŒsubscriptğ‘šğ‘\\\\lambda\\_{\\\\operatorname{up}}:=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}. For all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} and Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi),\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infÎ»âˆˆ\\[0,âˆ){Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]}=infÎ»âˆˆ\\[0,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]}.subscriptinfimumğœ†0ğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰subscriptinfimumğœ†0subscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\\\n\\\n###### Proof.\\\n\\\nLet Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi be arbitrary. Recall that\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)=âˆ’ğ”¼Î¶âˆ¼Ï€0fâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„(â‹…\\|Î¾)â€‹\\[Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]+Ï„â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\].\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=-\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right\\]+\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\]. |  |\\\n\\\nWe bound âˆ’âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)subscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi) above, uniformly in fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} and Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi. For readability of the proof, we set Ï€~0=Ï€0fâˆ’Î»â€‹câ€‹(Î¾,â‹…)Ïµ+Î»â€‹Ï„subscript~ğœ‹0superscriptsubscriptğœ‹0ğ‘“ğœ†ğ‘ğœ‰â‹…italic-Ïµğœ†ğœ\\\\tilde{\\\\pi}\\_{0}=\\\\pi\\_{0}^{\\\\frac{f-\\\\lambda c(\\\\xi,\\\\cdot)}{\\\\epsilon+\\\\lambda\\\\tau}} with a slight abuse of notation. In this case, we have\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | ğ”¼Î¶âˆ¼Ï€~0(â‹…\\|Î¾)â€‹\\[Ï„â€‹fâ€‹(Î¶)+Ïµâ€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]\\\\displaystyle\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\tilde{\\\\pi}\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau f(\\\\zeta)+\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right\\] | =ğ”¼Î¶âˆ¼Ï€~0(â‹…\\|Î¾)â€‹\\[Î»â€‹Ï„â€‹fâ€‹(Î¶)+Î»â€‹Ïµâ€‹câ€‹(Î¾,Î¶)âˆ’Ïµâ€‹fâ€‹(Î¶)+Ïµâ€‹fâ€‹(Î¶)Î»â€‹(Ïµ+Î»â€‹Ï„)\\]\\\\displaystyle=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\tilde{\\\\pi}\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\lambda\\\\tau f(\\\\zeta)+\\\\lambda\\\\epsilon c(\\\\xi,\\\\zeta)-\\\\epsilon f(\\\\zeta)+\\\\epsilon f(\\\\zeta)}{\\\\lambda(\\\\epsilon+\\\\lambda\\\\tau)}\\\\right\\] |  |\\\n|  |  | =1Î»â€‹ğ”¼Î¶âˆ¼Ï€~0(â‹…\\|Î¾)â€‹\\[fâ€‹(Î¶)\\]âˆ’ÏµÎ»â€‹ğ”¼Î¶âˆ¼Ï€~0(â‹…\\|Î¾)â€‹\\[fâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]\\\\displaystyle=\\\\frac{1}{\\\\lambda}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\tilde{\\\\pi}\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[f(\\\\zeta)\\\\right\\]-\\\\frac{\\\\epsilon}{\\\\lambda}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\tilde{\\\\pi}\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}\\\\right\\] |  |\\\n|  |  | â‰¤â€–â„±â€–âˆÎ»âˆ’ÏµÎ»â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]\\\\displaystyle\\\\leq\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda}-\\\\frac{\\\\epsilon}{\\\\lambda}\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\] |  |\\\n|  |  | â‰¤â€–â„±â€–âˆÎ»âˆ’ÏµÎ»â€‹(Ïµ+Î»â€‹Ï„)â€‹(ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[fâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)\\])\\\\displaystyle\\\\leq\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda}-\\\\frac{\\\\epsilon}{\\\\lambda(\\\\epsilon+\\\\lambda\\\\tau)}\\\\left(\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\]\\\\right) |  |\\\n|  |  | â‰¤â€–â„±â€–âˆÎ»+Ïµâ€‹â€–â„±â€–âˆÎ»â€‹(Ïµ+Î»â€‹Ï„)+Ïµâ€‹mcÏµ+Î»â€‹Ï„,absentsubscriptnormâ„±ğœ†italic-Ïµsubscriptnormâ„±ğœ†italic-Ïµğœ†ğœitalic-Ïµsubscriptğ‘šğ‘italic-Ïµğœ†ğœ\\\\displaystyle\\\\leq\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda}+\\\\frac{\\\\epsilon\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda(\\\\epsilon+\\\\lambda\\\\tau)}+\\\\frac{\\\\epsilon m\\_{c}}{\\\\epsilon+\\\\lambda\\\\tau}, |  | (32) |\\\n\\\nwhere for the third line, we used [LemmaC.2](https://ar5iv.org/html/2402.11981#A3.Thmlemma2 \"Lemma C.2 (Lemma G.7 in [5]). â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and for the fourth line, we used Jensenâ€™s inequality. On the other hand,\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | âˆ’Ï„â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\]\\\\displaystyle-\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\] | â‰¤âˆ’Ï„Ïµ+Î»â€‹Ï„â€‹ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[fâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)\\]\\\\displaystyle\\\\leq-\\\\frac{\\\\tau}{\\\\epsilon+\\\\lambda\\\\tau}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\] |  |\\\n|  |  | â‰¤Î»â€‹Ï„Î»â€‹(Ïµ+Î»â€‹Ï„)â€‹â€–â„±â€–âˆ+Î»â€‹Ï„Ïµ+Î»â€‹Ï„â€‹mcabsentğœ†ğœğœ†italic-Ïµğœ†ğœsubscriptnormâ„±ğœ†ğœitalic-Ïµğœ†ğœsubscriptğ‘šğ‘\\\\displaystyle\\\\leq\\\\frac{\\\\lambda\\\\tau}{\\\\lambda(\\\\epsilon+\\\\lambda\\\\tau)}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{\\\\lambda\\\\tau}{\\\\epsilon+\\\\lambda\\\\tau}m\\_{c} |  | (33) |\\\n\\\nSumming ( [D.2.2](https://ar5iv.org/html/2402.11981#A4.Ex89 \"Proof. â€£ D.2.2 Dual upper-bound â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [D.2.2](https://ar5iv.org/html/2402.11981#A4.Ex93 \"Proof. â€£ D.2.2 Dual upper-bound â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ’âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)â‰¤2â€‹â€–â„±â€–âˆÎ»+mc,subscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰2subscriptnormâ„±ğœ†subscriptğ‘šğ‘-\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\leq\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda}+m\\_{c}, |  |\\\n\\\nwhence assuming Ï>mcğœŒsubscriptğ‘šğ‘\\\\rho>m\\_{c}, and taking Î»=Î»up:=2â€‹â€–â„±â€–âˆÏâˆ’mcğœ†subscriptğœ†upassign2subscriptnormâ„±ğœŒsubscriptğ‘šğ‘\\\\lambda=\\\\lambda\\_{\\\\operatorname{up}}:=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}, we obtain for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} and all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | 0â‰¤Ï+âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»up,f,Î¾).0ğœŒsubscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµsubscriptğœ†upğ‘“ğœ‰0\\\\leq\\\\rho+\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda\\_{\\\\operatorname{up}},f,\\\\xi). |  |\\\n\\\nIntegrating with respect to a distribution Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) yields\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | 0â‰¤Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»up,f,Î¾)\\],0ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]subscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµsubscriptğœ†upğ‘“ğœ‰0\\\\leq\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda\\_{\\\\operatorname{up}},f,\\\\xi)\\], |  |\\\n\\\nwhich is the derivative at Î»upsubscriptğœ†up\\\\lambda\\_{\\\\operatorname{up}} of the convex function Î»â†¦Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]maps-toğœ†ğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\lambda\\\\mapsto\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\\\left\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\right\\]. This means\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infÎ»âˆˆ\\[0,âˆ){Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]}=infÎ»âˆˆ\\[0,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]}.subscriptinfimumğœ†0ğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰subscriptinfimumğœ†0subscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\\\left\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\right\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\\\left\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\\\right\\]\\\\right\\\\}. |  |\\\n\\\nâˆ\\\n\\\n## Appendix E Proof of the main results\\\n\\\nIn this section, we prove the main results of the paper: Theorems [3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). First, we establish the core concentration results in [E.1](https://ar5iv.org/html/2402.11981#A5.SS1 \"E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") that apply to standard and regularized WDRO. In particular, the slope condition presented in [Section4.4](https://ar5iv.org/html/2402.11981#S4.SS4.SSS0.Px2 \"Dual bound on the empirical risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is used there to establish the dual lower bound with high probability. Then we deduce the main theorems in [E.2](https://ar5iv.org/html/2402.11981#A5.SS2 \"E.2 Proof of the main results â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and compute the generalization constants.\\\n\\\n### E.1 Dual bounds with high probability on the empirical problem\\\n\\\nAll the results of this subsection hold for both standard and regularized cases. The proofs hold _as is_, replacing Ï•italic-Ï•\\\\phi, Ïˆğœ“\\\\psi, ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}}, ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} and Î»lowsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{low}} by Ï•Ï„,Ïµsuperscriptitalic-Ï•ğœitalic-Ïµ\\\\phi^{\\\\tau,\\\\epsilon}, ÏˆÏ„,Ïµsuperscriptğœ“ğœitalic-Ïµ\\\\psi^{\\\\tau,\\\\epsilon}, ÏcritÏ„,ÏµsuperscriptsubscriptğœŒcritğœitalic-Ïµ\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}, ÏmaxÏ„,ÏµsuperscriptsubscriptğœŒğœitalic-Ïµ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon} and Î»lowÏ„,Ïµsuperscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} respectively.\\\n\\\nFor Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0, we recall the quantities\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Ïcrit=inffâˆˆâ„±ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»+Ï•â€‹(0,f,Î¾)\\],Ïmaxâ€‹(Î»)=inffâˆˆâ„±ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\].formulae-sequencesubscriptğœŒcritsubscriptinfimumğ‘“â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptsubscriptğœ†italic-Ï•0ğ‘“ğœ‰subscriptğœŒğœ†subscriptinfimumğ‘“â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptsubscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰\\\\rho\\_{\\\\operatorname{crit}}=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(0,f,\\\\xi)\\],\\\\qquad\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]. |  |\\\n\\\n##### Problemâ€™s constants.\\\n\\\nBefore proving the next results, we introduce several quantities:\\\n\\\n###### Proposition E.1(Dual lower bound in the true problem).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exists Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that for all Î»âˆˆ\\[0,2â€‹Î»low\\]ğœ†02subscriptğœ†low\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\], Ïmaxâ€‹(Î»)â‰¥Ïcrit2subscriptğœŒğœ†subscriptğœŒcrit2\\\\rho\\_{\\\\max}(\\\\lambda)\\\\geq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}. In particular, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\]â‰¤âˆ’Ïcrit2subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptsuperscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰subscriptğœŒcrit2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}.\\\n\\\n###### Proof.\\\n\\\nThis comes from limÎ»â†’0+Ïmaxâ€‹(Î»)=Ïcritsubscriptâ†’ğœ†superscript0subscriptğœŒğœ†subscriptğœŒcrit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}. See [lemmaD.1](https://ar5iv.org/html/2402.11981#A4.Thmlemma1 \"Lemma D.1. â€£ D.1 Standard WDRO: continuity at zero of the maximal radius â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for standard WDRO and [lemmaD.2](https://ar5iv.org/html/2402.11981#A4.Thmlemma2 \"Lemma D.2. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for the regularized case.\\\nâˆ\\\n\\\nLet Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 be given by [PropositionE.1](https://ar5iv.org/html/2402.11981#A5.Thmproposition1 \"Proposition E.1 (Dual lower bound in the true problem). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). For the next results, we define the following quantities:\\\n\\\n- â€¢\\\n\\\n\\\nÎ¦Î¦\\\\Phi is the length of a segment Iğ¼I such that Ï•â€‹(Î»,f,Î¾)âˆˆIitalic-Ï•ğœ†ğ‘“ğœ‰ğ¼\\\\phi(\\\\lambda,f,\\\\xi)\\\\in I for all Î»âˆˆ{Î»low,2â€‹Î»low}ğœ†subscriptğœ†low2subscriptğœ†low\\\\lambda\\\\in\\\\{\\\\lambda\\_{\\\\operatorname{low}},2\\\\lambda\\_{\\\\operatorname{low}}\\\\}, fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} and Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi,\\\n\\\n- â€¢\\\n\\\n\\\nÎ¨Î¨\\\\Psi is the length of a segment Jğ½J such that Ïˆâ€‹(Î¼,f,Î¾)âˆˆJğœ“ğœ‡ğ‘“ğœ‰ğ½\\\\psi(\\\\mu,f,\\\\xi)\\\\in J for all Î¼âˆˆ(0,Î»lowâˆ’1\\]ğœ‡0superscriptsubscriptğœ†low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\], fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} and Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi,\\\n\\\n- â€¢\\\n\\\n\\\nLÏˆsubscriptğ¿ğœ“L\\_{\\\\psi} and Î»upâˆˆ\\[0,âˆ\\]subscriptğœ†up0\\\\lambda\\_{\\\\operatorname{up}}\\\\in\\[0,\\\\infty\\] are such that Ïˆâ€‹(â‹…,â‹…,Î¾)ğœ“â‹…â‹…ğœ‰\\\\psi(\\\\cdot,\\\\cdot,\\\\xi) is LÏˆsubscriptğ¿ğœ“L\\_{\\\\psi}-Lipschitz on \\[Î»upâˆ’1,Î»lowâˆ’1\\]Ã—â„±superscriptsubscriptğœ†up1superscriptsubscriptğœ†low1â„±\\[\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F} for all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi.\\\n\\\n\\\nWith the above quantities, we can prove the following:\\\n\\\n###### Proposition E.2(Dual lower bound with high probability).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), let Î»lowsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{low}} be given by [PropositionE.1](https://ar5iv.org/html/2402.11981#A5.Thmproposition1 \"Proposition E.1 (Dual lower bound in the true problem). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and Î»upâˆˆ\\[Î»low,âˆ\\]subscriptğœ†upsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{up}}\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\infty\\]. If Ïâ‰¤Ïcrit2âˆ’2â€‹Câ€‹(Î´)Î»lowâ€‹nğœŒsubscriptğœŒcrit22ğ¶ğ›¿subscriptğœ†lowğ‘›\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}\\\nwhere C(Î´):=48â„(â„±,âˆ¥â‹…âˆ¥âˆ)+Î¦2â€‹logâ¡4Î´C(\\\\delta):=48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\Phi\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}, then with probability 1âˆ’Î´21ğ›¿21-\\\\frac{\\\\delta}{2}, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infÎ»âˆˆ\\[0,Î»up){Î»Ï+ğ”¼Î¾âˆ¼P^n\\[Ï•(,Î»,f,Î¾)\\]}=infÎ»âˆˆ\\[Î»low,Î»up){Î»Ï+ğ”¼Î¾âˆ¼P^n\\[Ï•(Î»,f,Î¾)\\]}.\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(,\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\\\n\\\n###### Proof.\\\n\\\nLet Î»âˆˆ{Î»low,2â€‹Î»low}ğœ†subscriptğœ†low2subscriptğœ†low\\\\lambda\\\\in\\\\{\\\\lambda\\_{\\\\operatorname{low}},2\\\\lambda\\_{\\\\operatorname{low}}\\\\}. For Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, the function fâ†¦Ï•â€‹(Î»,f,Î¾)maps-toğ‘“italic-Ï•ğœ†ğ‘“ğœ‰f\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi) is Lipschitz with constant 111, see [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). â€£ C.1 Standard WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [LemmaC.3](https://ar5iv.org/html/2402.11981#A3.Thmlemma3 \"Lemma C.3 (Concentration conditions for regularized WDRO). â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Then we can apply [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). â€£ A.1 Uniform concentration inequality â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), to have with probability at least 1âˆ’Î´41ğ›¿41-\\\\frac{\\\\delta}{4}, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(2â€‹Î»low,f,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(2â€‹Î»low,f,Î¾)\\]â‰¤48â„(â„±,âˆ¥â‹…âˆ¥âˆ)n+Î¦â€‹2â€‹logâ¡4Î´n\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]\\\\leq\\\\frac{48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\sqrt{n}}+\\\\Phi\\\\sqrt{\\\\frac{2\\\\log\\\\frac{4}{\\\\delta}}{n}} |  | (34) |\\\n\\\nand with probability at least 1âˆ’Î´41ğ›¿41-\\\\frac{\\\\delta}{4}, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»low,f,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»low,f,Î¾)\\]â‰¤48â„(â„±,âˆ¥â‹…âˆ¥âˆ)n+Î¦â€‹2â€‹logâ¡4Î´n.\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]\\\\leq\\\\frac{48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\sqrt{n}}+\\\\Phi\\\\sqrt{\\\\frac{2\\\\log\\\\frac{4}{\\\\delta}}{n}}. |  | (35) |\\\n\\\nWe set C(Î´):=48â„(â„±,âˆ¥â‹…âˆ¥âˆ)+Î¦2â€‹logâ¡4Î´C(\\\\delta):=48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\Phi\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}. Intersecting the events ( [34](https://ar5iv.org/html/2402.11981#A5.E34 \"Equation 34 â€£ Proof. â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [35](https://ar5iv.org/html/2402.11981#A5.E35 \"Equation 35 â€£ Proof. â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we obtain that with probability 1âˆ’Î´21ğ›¿21-\\\\frac{\\\\delta}{2}, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  |  | ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(2â€‹Î»low,f,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»low,f,Î¾)\\]Î»lowsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•2subscriptğœ†lowğ‘“ğœ‰subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•subscriptğœ†lowğ‘“ğœ‰subscriptğœ†low\\\\displaystyle\\\\frac{\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]}{\\\\lambda\\_{\\\\operatorname{low}}} |  |\\\n|  |  | â‰¤1Î»lowâ€‹(ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(2â€‹Î»low,f,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»low,f,Î¾)\\]+2â€‹Câ€‹(Î´)n)absent1subscriptğœ†lowsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•2subscriptğœ†lowğ‘“ğœ‰subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•subscriptğœ†lowğ‘“ğœ‰2ğ¶ğ›¿ğ‘›\\\\displaystyle\\\\leq\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\left(\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]+\\\\frac{2C(\\\\delta)}{\\\\sqrt{n}}\\\\right) |  |\\\n|  |  | â‰¤ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ‚Î»+Ï•â€‹(2â€‹Î»low,f,Î¾)\\]+2â€‹Câ€‹(Î´)Î»lowâ€‹nabsentsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptsubscriptğœ†italic-Ï•2subscriptğœ†lowğ‘“ğœ‰2ğ¶ğ›¿subscriptğœ†lowğ‘›\\\\displaystyle\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial\\_{\\\\lambda}^{+}\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\]+\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}} |  |\\\n|  |  | â‰¤âˆ’Ïcrit2+2â€‹Câ€‹(Î´)Î»lowâ€‹n,absentsubscriptğœŒcrit22ğ¶ğ›¿subscriptğœ†lowğ‘›\\\\displaystyle\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}+\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}, |  | (36) |\\\n\\\nwhere we recall that for Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0, satisfies for all Î»âˆˆ\\[0,2â€‹Î»low\\]ğœ†02subscriptğœ†low\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\] and all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ‚+Ï•â€‹(Î»,f,Î¾)\\]â‰¤âˆ’Ïcrit2subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptitalic-Ï•ğœ†ğ‘“ğœ‰subscriptğœŒcrit2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}.\\\nFor Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0 and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, we set gfâ€‹(Î»)=Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]subscriptğ‘”ğ‘“ğœ†ğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰g\\_{f}(\\\\lambda)=\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]. Then from ( [E.1](https://ar5iv.org/html/2402.11981#A5.Ex100 \"Proof. â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we deduce with probability at least 1âˆ’Î´21ğ›¿21-\\\\frac{\\\\delta}{2}, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | gfâ€‹(2â€‹Î»low)âˆ’gfâ€‹(Î»low)Î»low=Ïâˆ’Ïcrit2+2â€‹Câ€‹(Î´)Î»lowâ€‹n.subscriptğ‘”ğ‘“2subscriptğœ†lowsubscriptğ‘”ğ‘“subscriptğœ†lowsubscriptğœ†lowğœŒsubscriptğœŒcrit22ğ¶ğ›¿subscriptğœ†lowğ‘›\\\\displaystyle\\\\frac{g\\_{f}(2\\\\lambda\\_{\\\\operatorname{low}})-g\\_{f}(\\\\lambda\\_{\\\\operatorname{low}})}{\\\\lambda\\_{\\\\operatorname{low}}}=\\\\rho-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}+\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}. |  |\\\n\\\nThis means that if Ïâ‰¤Ïcrit2âˆ’2â€‹Câ€‹(Î´)Î»lowâ€‹nğœŒsubscriptğœŒcrit22ğ¶ğ›¿subscriptğœ†lowğ‘›\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}, then with probability at least 1âˆ’Î´21ğ›¿21-\\\\frac{\\\\delta}{2}, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infÎ»âˆˆ\\[0,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}=infÎ»âˆˆ\\[Î»low,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}.subscriptinfimumğœ†0subscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰subscriptinfimumğœ†subscriptğœ†lowsubscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\\\n\\\nâˆ\\\n\\\nThis implies a generalization bound on the dual problem of (regularized) WDRO:\\\n\\\n###### Proposition E.3(Generalization bound on the dual problem).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), let Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 be given by [PropositionE.1](https://ar5iv.org/html/2402.11981#A5.Thmproposition1 \"Proposition E.1 (Dual lower bound in the true problem). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). If Bâ€‹(Î´)nâ‰¤Ïâ‰¤Ïcrit2âˆ’2â€‹Câ€‹(Î´)Î»lowâ€‹nğµğ›¿ğ‘›ğœŒsubscriptğœŒcrit22ğ¶ğ›¿subscriptğœ†lowğ‘›\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\leq\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}} where\\\n\\\n- â€¢\\\n\\\n\\\nB(Î´)=48LÏˆ(â„(â„±,âˆ¥â‹…âˆ¥âˆ)+2Î»low)+Î¨2â€‹logâ¡2Î´B(\\\\delta)=48L\\_{\\\\psi}\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)+\\\\Psi\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}},\\\n\\\n- â€¢\\\n\\\n\\\nC(Î´)=48â„(â„±,âˆ¥â‹…âˆ¥âˆ)+Î¦2â€‹logâ¡4Î´C(\\\\delta)=48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\Phi\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}},\\\n\\\n\\\nthen with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infÎ»âˆˆ\\[0,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}â‰¥infÎ»âˆˆ\\[0,âˆ){Î»â€‹(Ïâˆ’Bâ€‹(Î´)n)+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}.subscriptinfimumğœ†0subscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰subscriptinfimumğœ†0ğœ†ğœŒğµğ›¿ğ‘›subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\left(\\\\rho-\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\right)+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\\\n\\\n###### Proof.\\\n\\\nWe assume Î»up>Î»lowsubscriptğœ†upsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{up}}>\\\\lambda\\_{\\\\operatorname{low}}. By [TheoremA.2](https://ar5iv.org/html/2402.11981#A1.Thmtheorem2 \"Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). â€£ A.1 Uniform concentration inequality â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), applied to (Î¼,f)â†¦Î¼â€‹Ï•â€‹(Î¼âˆ’1,f,Î¾)maps-toğœ‡ğ‘“ğœ‡italic-Ï•superscriptğœ‡1ğ‘“ğœ‰(\\\\mu,f)\\\\mapsto\\\\mu\\\\phi(\\\\mu^{-1},f,\\\\xi), we obtain with probability at least 1âˆ’Î´21ğ›¿21-\\\\frac{\\\\delta}{2},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | Î±n:=sup(Î¼,f)âˆˆ(Î»upâˆ’1,Î»lowâˆ’1\\]Ã—â„±{ğ”¼Î¾âˆ¼Pâ€‹\\[Ïˆâ€‹(Î¼,f,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼P^nâ€‹\\[Ïˆâ€‹(Î¼,f,Î¾)\\]}â‰¤Bâ€‹(Î´)nassignsubscriptğ›¼ğ‘›subscriptsupremumğœ‡ğ‘“superscriptsubscriptğœ†up1superscriptsubscriptğœ†low1â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğœ“ğœ‡ğ‘“ğœ‰subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]ğœ“ğœ‡ğ‘“ğœ‰ğµğ›¿ğ‘›\\\\alpha\\_{n}:=\\\\sup\\_{(\\\\mu,f)\\\\in(\\\\lambda\\_{\\\\operatorname{up}}^{-1},\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}}\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]\\\\}\\\\leq\\\\frac{B(\\\\delta)}{\\\\sqrt{n}} |  | (37) |\\\n\\\nwhere Bâ€‹(Î´)=48â€‹LÏˆâ€‹â„â€‹(\\[0,Î»lowâˆ’1\\]Ã—â„±,dist)+Î¨â€‹2â€‹logâ¡2Î´ğµğ›¿48subscriptğ¿ğœ“â„0superscriptsubscriptğœ†low1â„±distÎ¨22ğ›¿B(\\\\delta)=48L\\_{\\\\psi}\\\\mathcal{I}(\\[0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F},\\\\operatorname{dist})+\\\\Psi\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}} and distâ¡((Î¼,f),(Î¼â€²,fâ€²)):=\\|Î¼âˆ’Î¼â€²\\|+â€–fâˆ’fâ€²â€–âˆassigndistğœ‡ğ‘“superscriptğœ‡â€²superscriptğ‘“â€²ğœ‡superscriptğœ‡â€²subscriptnormğ‘“superscriptğ‘“â€²\\\\operatorname{dist}((\\\\mu,f),(\\\\mu^{\\\\prime},f^{\\\\prime})):=\\|\\\\mu-\\\\mu^{\\\\prime}\\|+\\\\\\|f-f^{\\\\prime}\\\\\\|\\_{\\\\infty}. Furthermore, we have the inequality\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | â„(\\[0,Î»lowâˆ’1\\]Ã—â„±)â‰¤â„(â„±,âˆ¥â‹…âˆ¥âˆ)+12â€‹Î»low(1+2log2)â‰¤â„(â„±,âˆ¥â‹…âˆ¥âˆ)+2Î»low,\\\\mathcal{I}(\\[0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F})\\\\leq\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{1}{2\\\\lambda\\_{\\\\operatorname{low}}}(1+2\\\\log 2)\\\\leq\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}, |  |\\\n\\\nsee [LemmaA.3](https://ar5iv.org/html/2402.11981#A1.Thmlemma3 \"Lemma A.3 (Dudleyâ€™s integral estimates). â€£ A.1 Uniform concentration inequality â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), hence we may refine Bâ€‹(Î´)ğµğ›¿B(\\\\delta) as B(Î´)=48LÏˆ(â„(â„±,âˆ¥â‹…âˆ¥âˆ)+2Î»low)+Î¨2â€‹logâ¡2Î´.B(\\\\delta)=48L\\_{\\\\psi}\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)+\\\\Psi\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}.\\\n\\\nBy [PropositionE.2](https://ar5iv.org/html/2402.11981#A5.Thmproposition2 \"Proposition E.2 (Dual lower bound with high probability). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), if Ïâ‰¤Ïcrit2âˆ’2â€‹Câ€‹(Î´)Î»lowâ€‹nğœŒsubscriptğœŒcrit22ğ¶ğ›¿subscriptğœ†lowğ‘›\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}\\\nwhere C(Î´):=48â„(â„±,âˆ¥â‹…âˆ¥âˆ)+Î¦2â€‹logâ¡4Î´C(\\\\delta):=48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\Phi\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}, then with probability at least 1âˆ’Î´21ğ›¿21-\\\\frac{\\\\delta}{2}, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | infÎ»âˆˆ\\[0,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}=infÎ»âˆˆ\\[Î»low,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}.subscriptinfimumğœ†0subscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰subscriptinfimumğœ†subscriptğœ†lowsubscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  | (38) |\\\n\\\nFinally, combining ( [38](https://ar5iv.org/html/2402.11981#A5.E38 \"Equation 38 â€£ Proof. â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and ( [37](https://ar5iv.org/html/2402.11981#A5.E37 \"Equation 37 â€£ Proof. â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), and if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Bâ€‹(Î´)nâ‰¤Ïâ‰¤Ïcrit2âˆ’2â€‹Câ€‹(Î´)Î»lowâ€‹n,ğµğ›¿ğ‘›ğœŒsubscriptğœŒcrit22ğ¶ğ›¿subscriptğœ†lowğ‘›\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\leq\\\\rho\\\\leq\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}\\\\sqrt{n}}, |  |\\\n\\\nwe can write with probability 1âˆ’Î´1ğ›¿1-\\\\delta, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | infÎ»âˆˆ\\[0,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}=infÎ»âˆˆ\\[Î»low,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}subscriptinfimumğœ†0subscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰subscriptinfimumğœ†subscriptğœ†lowsubscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\displaystyle\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} |  |\\\n|  | â‰¥infÎ»âˆˆ\\[Î»low,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]âˆ’Î»â€‹ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]Î»}absentsubscriptinfimumğœ†subscriptğœ†lowsubscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰ğœ†subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰ğœ†\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]-\\\\lambda\\\\frac{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]}{\\\\lambda}\\\\right\\\\} |  |\\\n|  | â‰¥infÎ»âˆˆ\\[Î»low,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]âˆ’Î»â€‹Î±n}absentsubscriptinfimumğœ†subscriptğœ†lowsubscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰ğœ†subscriptğ›¼ğ‘›\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]-\\\\lambda\\\\alpha\\_{n}\\\\right\\\\} |  |\\\n|  | â‰¥infÎ»âˆˆ\\[Î»low,Î»up){Î»â€‹(Ïâˆ’Bâ€‹(Î´)n)+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}absentsubscriptinfimumğœ†subscriptğœ†lowsubscriptğœ†upğœ†ğœŒğµğ›¿ğ‘›subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\left(\\\\rho-\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\right)+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} |  |\\\n|  | â‰¥infÎ»âˆˆ\\[0,âˆ){Î»â€‹(Ïâˆ’Bâ€‹(Î´)n)+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]},absentsubscriptinfimumğœ†0ğœ†ğœŒğµğ›¿ğ‘›subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\left(\\\\rho-\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\right)+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  |\\\n\\\nIf Î»upâ‰¤Î»lowsubscriptğœ†upsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{up}}\\\\leq\\\\lambda\\_{\\\\operatorname{low}}, this means, by convexity of the inner function,\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | infÎ»âˆˆ\\[0,Î»up){Î»â€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}subscriptinfimumğœ†0subscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\displaystyle\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} | =Î»lowâ€‹Ï+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»low,f,Î¾)\\]absentsubscriptğœ†lowğœŒsubscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•subscriptğœ†lowğ‘“ğœ‰\\\\displaystyle=\\\\lambda\\_{\\\\operatorname{low}}\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\] |  |\\\n|  |  | â‰¥Î»lowâ€‹(Ïâˆ’Î±nâ€²)+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»low,f,Î¾)\\]absentsubscriptğœ†lowğœŒsuperscriptsubscriptğ›¼ğ‘›â€²subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•subscriptğœ†lowğ‘“ğœ‰\\\\displaystyle\\\\geq\\\\lambda\\_{\\\\operatorname{low}}(\\\\rho-\\\\alpha\\_{n}^{\\\\prime})+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f,\\\\xi)\\] |  |\\\n|  |  | â‰¥infÎ»âˆˆ\\[0,âˆ){Î»â€‹(Ïâˆ’Bâ€‹(Î´)n)+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]},absentsubscriptinfimumğœ†0ğœ†ğœŒğµğ›¿ğ‘›subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\displaystyle\\\\geq\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\left(\\\\rho-\\\\frac{B(\\\\delta)}{\\\\sqrt{n}}\\\\right)+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  |\\\n\\\nwhere we refined Î±nsubscriptğ›¼ğ‘›\\\\alpha\\_{n} into Î±nâ€²=supfâˆˆâ„±{ğ”¼Î¾âˆ¼Pâ€‹\\[Ïˆâ€‹(Î»lowâˆ’1,f,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼P^nâ€‹\\[Ïˆâ€‹(Î»lowâˆ’1,f,Î¾)\\]}superscriptsubscriptğ›¼ğ‘›â€²subscriptsupremumğ‘“â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğœ“superscriptsubscriptğœ†low1ğ‘“ğœ‰subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]ğœ“superscriptsubscriptğœ†low1ğ‘“ğœ‰\\\\alpha\\_{n}^{\\\\prime}=\\\\sup\\_{f\\\\in\\\\mathcal{F}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\psi(\\\\lambda\\_{\\\\operatorname{low}}^{-1},f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\psi(\\\\lambda\\_{\\\\operatorname{low}}^{-1},f,\\\\xi)\\]\\\\right\\\\}.\\\nâˆ\\\n\\\n### E.2 Proof of the main results\\\n\\\nWe are now ready to prove our main results.\\\n\\\nThe following is an extended version of the generalization result in standard WDRO ( [Theorem3.1](https://ar5iv.org/html/2402.11981#S3.Thmtheorem1 \"Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Note that the extended bound ( [39](https://ar5iv.org/html/2402.11981#A5.E39 \"Equation 39 â€£ Theorem E.1 (Generalization guarantee, standard WDRO). â€£ E.2 Proof of the main results â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) involves a control of RÏâˆ’Î±nâ€‹(f)subscriptğ‘…ğœŒğ›¼ğ‘›ğ‘“R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f), which means that R^Ïâ€‹(f)subscript^ğ‘…ğœŒğ‘“\\\\widehat{R}\\_{\\\\rho}(f) also generalize well against for distribution shifts.\\\n\\\n###### Theorem E.1(Generalization guarantee, standard WDRO).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exists Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Î±n<Ï<Ïcrit2âˆ’Î²n,ğ›¼ğ‘›ğœŒsubscriptğœŒcrit2ğ›½ğ‘›\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}, |  |\\\n\\\nwhere\\\n\\\n- â€¢\\\n\\\n\\\nÎ±=48(âˆ¥â„±âˆ¥âˆ+1Î»low)(â„(â„±,âˆ¥â‹…âˆ¥âˆ)+2Î»low)+2â€‹â€–â„±â€–âˆÎ»low2â€‹logâ¡2Î´\\\\alpha=48\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}\\\n\\\n- â€¢\\\n\\\n\\\nÎ²=96â„(â„±,âˆ¥â‹…âˆ¥âˆ)Î»low+4â€‹â€–â„±â€–âˆÎ»lowâ€‹2â€‹logâ¡4Î´\\\\beta=\\\\frac{96\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\lambda\\_{\\\\operatorname{low}}}+\\\\frac{4\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}},\\\n\\\n\\\nthen with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^Ïâ€‹(f)â‰¥RÏâˆ’Î±nâ€‹(f)â‰¥ğ”¼Î¾âˆ¼Pâ€‹\\[fâ€‹(Î¶)\\].subscript^ğ‘…ğœŒğ‘“subscriptğ‘…ğœŒğ›¼ğ‘›ğ‘“subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘“ğœ\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\zeta)\\]. |  | (39) |\\\n\\\n###### Proof.\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), let Î»lowsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{low}} be given by [PropositionE.2](https://ar5iv.org/html/2402.11981#A5.Thmproposition2 \"Proposition E.2 (Dual lower bound with high probability). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Our goal is to apply [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the standard WDRO case and to compute its constants thanks to [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). â€£ C.1 Standard WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). By [LemmaC.1](https://ar5iv.org/html/2402.11981#A3.Thmlemma1 \"Lemma C.1 (Concentration conditions for WDRO). â€£ C.1 Standard WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we have the following constants:\\\n\\\n- â€¢\\\n\\\n\\\nÎ¦=2â€‹â€–â„±â€–âˆÎ¦2subscriptnormâ„±\\\\Phi=2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\n\\\n- â€¢\\\n\\\n\\\nÎ¨=2â€‹â€–â„±â€–âˆÎ»lowÎ¨2subscriptnormâ„±subscriptğœ†low\\\\Psi=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\n\\\n- â€¢\\\n\\\n\\\nÎ»up=âˆsubscriptğœ†up\\\\lambda\\_{\\\\operatorname{up}}=\\\\infty, and LÏˆ=â€–â„±â€–âˆ+Î»lowâˆ’1subscriptğ¿ğœ“subscriptnormâ„±superscriptsubscriptğœ†low1L\\_{\\\\psi}=\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\\\n\\\n\\\nÎ±ğ›¼\\\\alpha corresponds to Bâ€‹(Î´)ğµğ›¿B(\\\\delta) in [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and Î²ğ›½\\\\beta corresponds 2â€‹Câ€‹(Î´)Î»low2ğ¶ğ›¿subscriptğœ†low\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}}, whence we obtain\\\n\\\n- â€¢\\\n\\\n\\\nÎ±=48(âˆ¥â„±âˆ¥âˆ+1Î»low)(â„(â„±,âˆ¥â‹…âˆ¥âˆ)+2Î»low)+2â€‹â€–â„±â€–âˆÎ»low2â€‹logâ¡2Î´\\\\alpha=48\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right)+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}\\\n\\\n- â€¢\\\n\\\n\\\nÎ²=2Î»low(48â„(â„±,âˆ¥â‹…âˆ¥âˆ)+2âˆ¥â„±âˆ¥âˆ2â€‹logâ¡4Î´)=96â„(â„±,âˆ¥â‹…âˆ¥âˆ)Î»low+4â€‹â€–â„±â€–âˆÎ»low2â€‹logâ¡4Î´\\\\beta=\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\left(48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}\\\\right)=\\\\frac{96\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\lambda\\_{\\\\operatorname{low}}}+\\\\frac{4\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}.\\\n\\\n\\\nBy strong duality, [PropositionB.1](https://ar5iv.org/html/2402.11981#A2.Thmproposition1 \"Proposition B.1 (Strong duality, standard WDRO). â€£ Appendix B Strong duality â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), RÏ±â€‹(f)subscriptğ‘…italic-Ï±ğ‘“R\\_{\\\\varrho}(f) and R^Ï±â€‹(f)subscript^ğ‘…italic-Ï±ğ‘“\\\\widehat{R}\\_{\\\\varrho}(f) admit the representations\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | RÏ±â€‹(f)=infÎ»âˆˆ\\[0,âˆ){Î»â€‹Ï±+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}subscriptğ‘…italic-Ï±ğ‘“subscriptinfimumğœ†0ğœ†italic-Ï±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰R\\_{\\\\varrho}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\varrho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} |  |\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^Ï±â€‹(f)=infÎ»âˆˆ\\[0,âˆ){Î»â€‹Ï±+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]},subscript^ğ‘…italic-Ï±ğ‘“subscriptinfimumğœ†0ğœ†italic-Ï±subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\widehat{R}\\_{\\\\varrho}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\infty)}\\\\left\\\\{\\\\lambda\\\\varrho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  |\\\n\\\nfor any Ï±>0italic-Ï±0\\\\varrho>0 and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}. By [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), if Î±n<Ï<Ïcrit2âˆ’Î²nğ›¼ğ‘›ğœŒsubscriptğœŒcrit2ğ›½ğ‘›\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}, then with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta, we have for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, R^Ïâ€‹(f)â‰¥RÏâˆ’Î±nâ€‹(f)subscript^ğ‘…ğœŒğ‘“subscriptğ‘…ğœŒğ›¼ğ‘›ğ‘“\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f), hence the result.\\\nâˆ\\\n\\\nThe next result corresponds to the generalization guarantee for WDRO with double regularization, [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n###### Theorem E.2(Generalization guarantee, regularized WDRO).\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exists Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | maxâ¡{mc,Î±Ï„,Ïµn}<Ï<ÏcritÏ„,Ïµ2âˆ’Î²Ï„,Ïµnsubscriptğ‘šğ‘superscriptğ›¼ğœitalic-Ïµğ‘›ğœŒsuperscriptsubscriptğœŒcritğœitalic-Ïµ2superscriptğ›½ğœitalic-Ïµğ‘›\\\\max\\\\left\\\\{m\\_{c},\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}\\\\right\\\\}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}-\\\\frac{\\\\beta^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}} |  |\\\n\\\nwhere\\\n\\\n- â€¢\\\n\\\n\\\nÎ±Ï„,Ïµ=48(âˆ¥â„±âˆ¥âˆ+1Î»lowÏ„,Ïµ+2â€‹â€–â„±â€–âˆâ€‹mcâ€‹ÏµÏµâ€‹(Ïâˆ’mc)+2â€‹Ï„â€‹â€–â„±â€–âˆ)(â„(â„±,âˆ¥â‹…âˆ¥âˆ)+2Î»lowÏ„,Ïµ)+(2â€‹â€–â„±â€–âˆÎ»lowÏ„,Ïµ+mc)2â€‹logâ¡2Î´\\\\alpha^{\\\\tau,\\\\epsilon}=48\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}\\\\epsilon}{\\\\epsilon(\\\\rho-m\\_{c})+2\\\\tau\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}\\\\right)\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}\\\\right)+\\\\left(\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\\right)\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}\\\n\\\n- â€¢\\\n\\\n\\\nÎ²Ï„,Ïµ=96â„(â„±,âˆ¥â‹…âˆ¥âˆ)Î»lowÏ„,Ïµ+4â€‹(â€–â„±â€–âˆÎ»lowÏ„,Ïµ+mc)â€‹2â€‹logâ¡4Î´\\\\beta^{\\\\tau,\\\\epsilon}=\\\\frac{96\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+4\\\\left(\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\\right)\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}},\\\n\\\n\\\nthen with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ÏÏ„,Ïµâ€‹(f)â‰¥RÏâˆ’Î±Ï„,ÏµnÏ„,Ïµâ€‹(f)â‰¥ğ”¼Î¶âˆ¼Qâ€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€P,Qâˆ¥Ï€0)superscriptsubscript^ğ‘…ğœŒğœitalic-Ïµğ‘“superscriptsubscriptğ‘…ğœŒsuperscriptğ›¼ğœitalic-Ïµğ‘›ğœitalic-Ïµğ‘“subscriptğ”¼similar-toğœğ‘„delimited-\\[\\]ğ‘“ğœitalic-ÏµKLconditionalsuperscriptğœ‹ğ‘ƒğ‘„subscriptğœ‹0\\\\widehat{R}\\_{\\\\rho}^{\\\\tau,\\\\epsilon}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}}^{\\\\tau,\\\\epsilon}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0}) |  |\\\n\\\nwhenever WcÏ„â€‹(P,Q)â‰¤Ïsubscriptsuperscriptğ‘Šğœğ‘ğ‘ƒğ‘„ğœŒW^{\\\\tau}\\_{c}(P,Q)\\\\leq\\\\rho.\\\n\\\n###### Proof.\\\n\\\nUnder [2.1](https://ar5iv.org/html/2402.11981#S2.Thmassumption1 \"Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), let Î»lowÏ„,Ïµ>0superscriptsubscriptğœ†lowğœitalic-Ïµ0\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}>0 be given by [PropositionE.2](https://ar5iv.org/html/2402.11981#A5.Thmproposition2 \"Proposition E.2 (Dual lower bound with high probability). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and assume Ï>mcğœŒsubscriptğ‘šğ‘\\\\rho>m\\_{c}. As for standard WDRO, our goal is to apply [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and to compute its constants thanks to [LemmaC.3](https://ar5iv.org/html/2402.11981#A3.Thmlemma3 \"Lemma C.3 (Concentration conditions for regularized WDRO). â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). By [LemmaC.3](https://ar5iv.org/html/2402.11981#A3.Thmlemma3 \"Lemma C.3 (Concentration conditions for regularized WDRO). â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and taking Î»up=2â€‹â€–â„±â€–âˆÏâˆ’mcsubscriptğœ†up2subscriptnormâ„±ğœŒsubscriptğ‘šğ‘\\\\lambda\\_{\\\\operatorname{up}}=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}, we have the following constants:\\\n\\\n- â€¢\\\n\\\n\\\nÎ¦=â€–â„±â€–âˆâˆ’(âˆ’â€–â„±â€–âˆâˆ’2â€‹Î»lowÏ„,Ïµâ€‹mc)=2â€‹(â€–â„±â€–âˆ+Î»lowÏ„,Ïµâ€‹mc)Î¦subscriptnormâ„±subscriptnormâ„±2superscriptsubscriptğœ†lowğœitalic-Ïµsubscriptğ‘šğ‘2subscriptnormâ„±superscriptsubscriptğœ†lowğœitalic-Ïµsubscriptğ‘šğ‘\\\\Phi=\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-(-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}m\\_{c})=2(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}m\\_{c})\\\n\\\n- â€¢\\\n\\\n\\\nÎ¨=2â€‹â€–â„±â€–âˆÎ»lowÏ„,Ïµ+mcÎ¨2subscriptnormâ„±superscriptsubscriptğœ†lowğœitalic-Ïµsubscriptğ‘šğ‘\\\\Psi=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\n\\\n- â€¢\\\n\\\n\\\nÎ»up=2â€‹â€–â„±â€–âˆÏâˆ’mcsubscriptğœ†up2subscriptnormâ„±ğœŒsubscriptğ‘šğ‘\\\\lambda\\_{\\\\operatorname{up}}=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}} and LÏˆ=â€–â„±â€–âˆ+1Î»lowÏ„,Ïµ+2â€‹â€–â„±â€–âˆâ€‹mcâ€‹ÏµÏµâ€‹(Ïâˆ’mc)+2â€‹Ï„â€‹â€–â„±â€–âˆsubscriptğ¿ğœ“subscriptnormâ„±1superscriptsubscriptğœ†lowğœitalic-Ïµ2subscriptnormâ„±subscriptğ‘šğ‘italic-Ïµitalic-ÏµğœŒsubscriptğ‘šğ‘2ğœsubscriptnormâ„±L\\_{\\\\psi}=\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}\\\\epsilon}{\\\\epsilon(\\\\rho-m\\_{c})+2\\\\tau\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}.\\\n\\\n\\\nIn [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), Î±Ï„,Ïµsuperscriptğ›¼ğœitalic-Ïµ\\\\alpha^{\\\\tau,\\\\epsilon} corresponds to Bâ€‹(Î´)ğµğ›¿B(\\\\delta) and Î²Ï„,Ïµsuperscriptğ›½ğœitalic-Ïµ\\\\beta^{\\\\tau,\\\\epsilon} corresponds to 2â€‹Câ€‹(Î´)Î»lowÏ„,Ïµ2ğ¶ğ›¿superscriptsubscriptğœ†lowğœitalic-Ïµ\\\\frac{2C(\\\\delta)}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}. In this case, we have:\\\n\\\n- â€¢\\\n\\\n\\\nÎ±Ï„,Ïµ=48(âˆ¥â„±âˆ¥âˆ+1Î»lowÏ„,Ïµ+2â€‹â€–â„±â€–âˆâ€‹mcâ€‹ÏµÏµâ€‹(Ïâˆ’mc)+2â€‹Ï„â€‹â€–â„±â€–âˆ)(â„(â„±,âˆ¥â‹…âˆ¥âˆ)+2Î»lowÏ„,Ïµ)+(2â€‹â€–â„±â€–âˆÎ»lowÏ„,Ïµ+mc)2â€‹logâ¡2Î´\\\\alpha^{\\\\tau,\\\\epsilon}=48\\\\left(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\frac{1}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}m\\_{c}\\\\epsilon}{\\\\epsilon(\\\\rho-m\\_{c})+2\\\\tau\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}\\\\right)\\\\left(\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}\\\\right)+\\\\left(\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\\right)\\\\sqrt{2\\\\log\\\\frac{2}{\\\\delta}}\\\n\\\n- â€¢\\\n\\\n\\\nÎ²Ï„,Ïµ=2Î»lowÏ„,Ïµ(48â„(â„±,âˆ¥â‹…âˆ¥âˆ)+2(âˆ¥â„±âˆ¥âˆ+Î»lowÏ„,Ïµmc)2â€‹logâ¡4Î´)\\\\beta^{\\\\tau,\\\\epsilon}=\\\\frac{2}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}\\\\left(48\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})+2(\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}m\\_{c})\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}\\\\right)\\\n\\\n\\\n\\\n\\\n\\\n=96â„(â„±,âˆ¥â‹…âˆ¥âˆ)Î»lowÏ„,Ïµ+4â€‹(â€–â„±â€–âˆÎ»lowÏ„,Ïµ+mc)â€‹2â€‹logâ¡4Î´\\\\quad\\\\quad=\\\\frac{96\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+4\\\\left(\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}+m\\_{c}\\\\right)\\\\sqrt{2\\\\log\\\\frac{4}{\\\\delta}}.\\\n\\\n\\\nBy strong duality, [PropositionB.2](https://ar5iv.org/html/2402.11981#A2.Thmproposition2 \"Proposition B.2 (Strong duality, regularized WDRO). â€£ Appendix B Strong duality â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), and by the dual upper-bound, [LemmaD.3](https://ar5iv.org/html/2402.11981#A4.Thmlemma3 \"Lemma D.3 (Upper bound for the regularized problem Lemma 4.5). â€£ D.2.2 Dual upper-bound â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), RÏ±Ï„,Ïµâ€‹(f)superscriptsubscriptğ‘…italic-Ï±ğœitalic-Ïµğ‘“R\\_{\\\\varrho}^{\\\\tau,\\\\epsilon}(f) and R^Ï±Ï„,Ïµâ€‹(f)superscriptsubscript^ğ‘…italic-Ï±ğœitalic-Ïµğ‘“\\\\widehat{R}\\_{\\\\varrho}^{\\\\tau,\\\\epsilon}(f) admit the representations\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | RÏ±Ï„,Ïµâ€‹(f)=infÎ»âˆˆ\\[0,Î»up){Î»â€‹Ï±+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]}superscriptsubscriptğ‘…italic-Ï±ğœitalic-Ïµğ‘“subscriptinfimumğœ†0subscriptğœ†upğœ†italic-Ï±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰R\\_{\\\\varrho}^{\\\\tau,\\\\epsilon}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\varrho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\} |  |\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^Ï±Ï„,Ïµâ€‹(f)=infÎ»âˆˆ\\[0,Î»up){Î»â€‹Ï±+ğ”¼Î¾âˆ¼P^nâ€‹\\[Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]},superscriptsubscript^ğ‘…italic-Ï±ğœitalic-Ïµğ‘“subscriptinfimumğœ†0subscriptğœ†upğœ†italic-Ï±subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰\\\\widehat{R}\\_{\\\\varrho}^{\\\\tau,\\\\epsilon}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}})}\\\\left\\\\{\\\\lambda\\\\varrho+\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  |\\\n\\\nfor any Ï±>0italic-Ï±0\\\\varrho>0 and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}. Recall that Ï>mcğœŒsubscriptğ‘šğ‘\\\\rho>m\\_{c}. If furthermore Î±Ï„,Ïµn<Ï<ÏcritÏ„,Ïµ2âˆ’Î²Ï„,Ïµnsuperscriptğ›¼ğœitalic-Ïµğ‘›ğœŒsuperscriptsubscriptğœŒcritğœitalic-Ïµ2superscriptğ›½ğœitalic-Ïµğ‘›\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}-\\\\frac{\\\\beta^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}, then with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta, we have for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, R^ÏÏ„,Ïµâ€‹(f)â‰¥RÏâˆ’Î±nÏ„,Ïµâ€‹(f)superscriptsubscript^ğ‘…ğœŒğœitalic-Ïµğ‘“superscriptsubscriptğ‘…ğœŒğ›¼ğ‘›ğœitalic-Ïµğ‘“\\\\widehat{R}\\_{\\\\rho}^{\\\\tau,\\\\epsilon}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}^{\\\\tau,\\\\epsilon}(f) by [PropositionE.3](https://ar5iv.org/html/2402.11981#A5.Thmproposition3 \"Proposition E.3 (Generalization bound on the dual problem). â€£ Problemâ€™s constants. â€£ E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") hence we obtain the first inequality.\\\n\\\nNow, toward the second inequality, let Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) such that WcÏ„â€‹(P,Q)â‰¤Ïsubscriptsuperscriptğ‘Šğœğ‘ğ‘ƒğ‘„ğœŒW^{\\\\tau}\\_{c}(P,Q)\\\\leq\\\\rho. Let Ï€P,Qâˆˆğ’«â€‹(ÎÃ—Î)superscriptğœ‹ğ‘ƒğ‘„ğ’«ÎÎ\\\\pi^{P,Q}\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi) satisfying \\[Ï€P,Q\\]1=Psubscriptdelimited-\\[\\]superscriptğœ‹ğ‘ƒğ‘„1ğ‘ƒ\\[\\\\pi^{P,Q}\\]\\_{1}=P, \\[Ï€P,Q\\]2=Qsubscriptdelimited-\\[\\]superscriptğœ‹ğ‘ƒğ‘„2ğ‘„\\[\\\\pi^{P,Q}\\]\\_{2}=Q and ğ”¼(Î¾,Î¶)âˆ¼Ï€P,Qâ€‹\\[câ€‹(Î¾,Î¶)\\]+Ï„â€‹KLâ¡(Ï€P,Qâˆ¥Ï€0)=WcÏ„â€‹(P,Q)subscriptğ”¼similar-toğœ‰ğœsuperscriptğœ‹ğ‘ƒğ‘„delimited-\\[\\]ğ‘ğœ‰ğœğœKLconditionalsuperscriptğœ‹ğ‘ƒğ‘„subscriptğœ‹0subscriptsuperscriptğ‘Šğœğ‘ğ‘ƒğ‘„\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi^{P,Q}}\\[c(\\\\xi,\\\\zeta)\\]+\\\\tau\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0})=W^{\\\\tau}\\_{c}(P,Q). We finally obtain for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, RÏâˆ’Î±nâ€‹(f)â‰¥ğ”¼Î¶âˆ¼Qâ€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€P,Qâˆ¥Ï€0)subscriptğ‘…ğœŒğ›¼ğ‘›ğ‘“subscriptğ”¼similar-toğœğ‘„delimited-\\[\\]ğ‘“ğœitalic-ÏµKLconditionalsuperscriptğœ‹ğ‘ƒğ‘„subscriptğœ‹0R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0}).\\\n\\\nâˆ\\\n\\\n## Appendix F Side remarks\\\n\\\nThis part contains results supporting various remarks made in the main text.\\\n\\\n### F.1 Interpretation of the critical radius in the regularized case.\\\n\\\nThe following result gives an interpretation of the critical radius ÏcritÏ„,ÏµsuperscriptsubscriptğœŒcritğœitalic-Ïµ\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon} in regularized WDRO appearing in [Theorem3.2](https://ar5iv.org/html/2402.11981#S3.Thmtheorem2 \"Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). We show that when the radius ÏğœŒ\\\\rho is larger than this value, then some robust losses become degenerated. Precisely, they become independent of ÏğœŒ\\\\rho and are equal to a regularized version of the worst-case loss maxÎâ¡fsubscriptÎğ‘“\\\\max\\_{\\\\Xi}f.\\\n\\\n###### Proposition F.1.\\\n\\\nAssume Ï>ÏcritÏ„,ÏµğœŒsuperscriptsubscriptğœŒcritğœitalic-Ïµ\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}. Then there exists fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} such that\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | RÏÏ„,Ïµâ€‹(f)=supÏ€âˆˆğ’«â€‹(ÎÃ—Î)\\[Ï€\\]1=P{ğ”¼Î¶âˆ¼\\[Ï€\\]2â€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€âˆ¥Ï€0)}.superscriptsubscriptğ‘…ğœŒğœitalic-Ïµğ‘“subscriptsupremumğœ‹ğ’«ÎÎsubscriptdelimited-\\[\\]ğœ‹1ğ‘ƒsubscriptğ”¼similar-toğœsubscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]ğ‘“ğœitalic-ÏµKLconditionalğœ‹subscriptğœ‹0R\\_{\\\\rho}^{\\\\tau,\\\\epsilon}(f)=\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}. |  |\\\n\\\n###### Proof.\\\n\\\nIn the regularized case, we can verify that the critical radius has the expression\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | ÏcritÏ„,Ïµ=inffâˆˆâ„±{ğ”¼Î¾âˆ¼Pâ€‹\\[ğ”¼Î¶âˆ¼Ï€0f/Ïµ(â‹…\\|Î¾)â€‹\\[Ï„Ïµâ€‹fâ€‹(Î¶)+câ€‹(Î¾,Î¶)\\]âˆ’Ï„â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹efâ€‹(Î¶)Ïµ\\]},\\\\displaystyle\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{f/\\\\epsilon}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau}{\\\\epsilon}f(\\\\zeta)+c(\\\\xi,\\\\zeta)\\\\right\\]-\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]\\\\right\\\\}, |  | (40) |\\\n\\\nsee for instance the proof of [LemmaD.2](https://ar5iv.org/html/2402.11981#A4.Thmlemma2 \"Lemma D.2. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Let fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} be arbitrary. Consider a coupling Ï€âˆ—âˆˆğ’«â€‹(ÎÃ—Î)superscriptğœ‹ğ’«ÎÎ\\\\pi^{\\*}\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi) such that \\[Ï€âˆ—\\]1=Psubscriptdelimited-\\[\\]superscriptğœ‹1ğ‘ƒ\\[\\\\pi^{\\*}\\]\\_{1}=P and Ï€âˆ—(â‹…\\|Î¾)=Ï€0fÏµ(â‹…\\|Î¾)\\\\pi^{\\*}(\\\\cdot\\|\\\\xi)=\\\\pi\\_{0}^{\\\\frac{f}{\\\\epsilon}}(\\\\cdot\\|\\\\xi) for almost all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi. We first verify that for a good choice of fğ‘“f, it is included in the uncertainty set defining RÏÏ„,Ïµâ€‹(f)subscriptsuperscriptğ‘…ğœitalic-ÏµğœŒğ‘“R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f).\\\n\\\nWe compute KLâ¡(Ï€âˆ—âˆ¥Ï€0)KLconditionalsuperscriptğœ‹subscriptğœ‹0\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0}). Below, we set Zâ€‹(Î¾):=ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)Ïµ\\]Z(\\\\xi):=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\].\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | KLâ¡(Ï€âˆ—âˆ¥Ï€0)KLconditionalsuperscriptğœ‹subscriptğœ‹0\\\\displaystyle\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0}) | =ğ”¼Î¾âˆ¼Pâ€‹\\[ğ”¼Î¶âˆ¼Ï€0fÏµ(â‹…\\|Î¾)â€‹\\[logâ¡(efâ€‹(Î¶)ÏµZâ€‹(Î¾))\\]\\]\\\\displaystyle=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f}{\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\log\\\\left(\\\\frac{e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}}{Z(\\\\xi)}\\\\right)\\\\right\\]\\\\right\\] |  |\\\n|  |  | =ğ”¼Î¾âˆ¼Pâ€‹\\[ğ”¼Î¶âˆ¼Ï€0fÏµ(â‹…\\|Î¾)â€‹\\[fâ€‹(Î¶)Ïµ\\]âˆ’logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)Ïµ\\]\\]\\\\displaystyle=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{f}{\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{f(\\\\zeta)}{\\\\epsilon}\\\\right\\]-\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]\\\\right\\] |  |\\\n|  |  | =ğ”¼(Î¾,Î¶)âˆ¼Ï€âˆ—â€‹\\[fâ€‹(Î¶)Ïµ\\]âˆ’ğ”¼Î¾âˆ¼Pâ€‹\\[logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)Ïµ\\]\\].\\\\displaystyle=\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi^{\\*}}\\\\left\\[\\\\frac{f(\\\\zeta)}{\\\\epsilon}\\\\right\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]\\\\right\\]. |  | (41) |\\\n\\\nThis leads to\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | ğ”¼(Î¾,Î¶)âˆ¼Ï€âˆ—â€‹\\[câ€‹(Î¾,Î¶)\\]+Ï„â€‹KLâ¡(Ï€âˆ—âˆ¥Ï€0)=ğ”¼Î¾âˆ¼Pâ€‹\\[ğ”¼Î¶âˆ¼Ï€0f/Ïµ(â‹…\\|Î¾)â€‹\\[Ï„Ïµâ€‹fâ€‹(Î¶)+câ€‹(Î¾,Î¶)\\]âˆ’Ï„â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹efâ€‹(Î¶)Ïµ\\]\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi^{\\*}}\\\\left\\[c(\\\\xi,\\\\zeta)\\\\right\\]+\\\\tau\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0})=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{f/\\\\epsilon}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\tau}{\\\\epsilon}f(\\\\zeta)+c(\\\\xi,\\\\zeta)\\\\right\\]-\\\\tau\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\] |  |\\\n\\\nwhich is the term in the infimum ( [40](https://ar5iv.org/html/2402.11981#A6.E40 \"Equation 40 â€£ Proof. â€£ F.1 Interpretation of the critical radius in the regularized case. â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Since fğ‘“f was chosen arbitrary, this means that if Ï>ÏcritÏ„,ÏµğœŒsuperscriptsubscriptğœŒcritğœitalic-Ïµ\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}, then there exists fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} such that the coupling Ï€âˆ—superscriptğœ‹\\\\pi^{\\*} defined above (depending on fğ‘“f) satisfies ğ”¼(Î¾,Î¶)âˆ¼Ï€âˆ—â€‹\\[câ€‹(Î¾,Î¶)\\]+Ï„â€‹KLâ¡(Ï€âˆ—âˆ¥Ï€0)â‰¤Ïsubscriptğ”¼similar-toğœ‰ğœsuperscriptğœ‹delimited-\\[\\]ğ‘ğœ‰ğœğœKLconditionalsuperscriptğœ‹subscriptğœ‹0ğœŒ\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi^{\\*}}\\\\left\\[c(\\\\xi,\\\\zeta)\\\\right\\]+\\\\tau\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0})\\\\leq\\\\rho, and we obtain\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | RÏÏ„,Ïµâ€‹(f)â‰¥ğ”¼Î¶âˆ¼\\[Ï€âˆ—\\]2â€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€âˆ—âˆ¥Ï€0).subscriptsuperscriptğ‘…ğœitalic-ÏµğœŒğ‘“subscriptğ”¼similar-toğœsubscriptdelimited-\\[\\]superscriptğœ‹2delimited-\\[\\]ğ‘“ğœitalic-ÏµKLconditionalsuperscriptğœ‹subscriptğœ‹0R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi^{\\*}\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0}). |  |\\\n\\\nOn the other hand by the computation ( [F.1](https://ar5iv.org/html/2402.11981#A6.Ex124 \"Proof. â€£ F.1 Interpretation of the critical radius in the regularized case. â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we have\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | RÏÏ„,Ïµâ€‹(f)â‰¥ğ”¼Î¶âˆ¼\\[Ï€âˆ—\\]2â€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€âˆ—âˆ¥Ï€0)=Ïµâ€‹ğ”¼Î¾âˆ¼Pâ€‹\\[logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)Ïµ\\]\\].R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi^{\\*}\\]\\_{2}}\\\\left\\[f(\\\\zeta)\\\\right\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{\\*}\\\\\\|\\\\pi\\_{0})=\\\\epsilon\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]\\\\right\\]. |  | (42) |\\\n\\\nBy Donsker-Varadhan variational formula \\[ [16](https://ar5iv.org/html/2402.11981#bib.bib16 \"\")\\], for almost all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi, we have\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | logğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)\\[efâ€‹(Î¶)Ïµ\\]=supÎ½âˆˆğ’«â€‹(Î){ğ”¼Î¶âˆ¼Î½\\[f(Î¶)/Ïµ\\]âˆ’KL(Î½âˆ¥Ï€0(â‹…\\|Î¾))}.\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)}{\\\\epsilon}}\\\\right\\]=\\\\sup\\_{\\\\nu\\\\in\\\\mathcal{P}(\\\\Xi)}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\nu}\\[f(\\\\zeta)/\\\\epsilon\\]-\\\\operatorname{KL}(\\\\nu\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\\right\\\\}. |  | (43) |\\\n\\\nReinjecting ( [43](https://ar5iv.org/html/2402.11981#A6.E43 \"Equation 43 â€£ Proof. â€£ F.1 Interpretation of the critical radius in the regularized case. â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in ( [42](https://ar5iv.org/html/2402.11981#A6.E42 \"Equation 42 â€£ Proof. â€£ F.1 Interpretation of the critical radius in the regularized case. â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | RÏÏ„,Ïµâ€‹(f)subscriptsuperscriptğ‘…ğœitalic-ÏµğœŒğ‘“\\\\displaystyle R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f) | â‰¥Ïµğ”¼Î¾âˆ¼P\\[supÎ½âˆˆğ’«â€‹(Î){ğ”¼Î¶âˆ¼Î½\\[f(Î¶)/Ïµ\\]âˆ’KL(Î½âˆ¥Ï€0(â‹…\\|Î¾))}\\]\\\\displaystyle\\\\geq\\\\epsilon\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\sup\\_{\\\\nu\\\\in\\\\mathcal{P}(\\\\Xi)}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\nu}\\[f(\\\\zeta)/\\\\epsilon\\]-\\\\operatorname{KL}(\\\\nu\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\\right\\\\}\\\\right\\] |  |\\\n|  |  | â‰¥supÏ€âˆˆğ’«â€‹(ÎÃ—Î)\\[Ï€\\]1=P{ğ”¼Î¾âˆ¼P\\[ğ”¼Î¶âˆ¼Ï€(â‹…\\|Î¾)\\[f(Î¶)\\]âˆ’ÏµKL(Ï€(â‹…\\|Î¾)âˆ¥Ï€0(â‹…\\|Î¾))\\]}\\\\displaystyle\\\\geq\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi(\\\\cdot\\|\\\\xi)}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi(\\\\cdot\\|\\\\xi)\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\\right\\]\\\\right\\\\} |  |\\\n|  |  | =supÏ€âˆˆğ’«â€‹(ÎÃ—Î)\\[Ï€\\]1=P{ğ”¼Î¶âˆ¼\\[Ï€\\]2â€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€âˆ¥Ï€0)},absentsubscriptsupremumğœ‹ğ’«ÎÎsubscriptdelimited-\\[\\]ğœ‹1ğ‘ƒsubscriptğ”¼similar-toğœsubscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]ğ‘“ğœitalic-ÏµKLconditionalğœ‹subscriptğœ‹0\\\\displaystyle=\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}, |  |\\\n\\\nwhere we used the chain rule for KLKL\\\\operatorname{KL} divergence (see e.g. Theorem 2.15 in \\[ [29](https://ar5iv.org/html/2402.11981#bib.bib29 \"\")\\]): KL(Ï€âˆ¥Ï€0)=ğ”¼Î¾âˆ¼P\\[KL(Ï€(â‹…\\|Î¾)âˆ¥Ï€0(â‹…\\|Î¾))\\]+KL(\\[Ï€\\]1âˆ¥\\[Ï€0\\]1)â‰¥ğ”¼Î¾âˆ¼P\\[KL(Ï€(â‹…\\|Î¾)âˆ¥Ï€0(â‹…\\|Î¾))\\]\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\operatorname{KL}(\\\\pi(\\\\cdot\\|\\\\xi)\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\]+\\\\operatorname{KL}(\\[\\\\pi\\]\\_{1}\\\\\\|\\[\\\\pi\\_{0}\\]\\_{1})\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\operatorname{KL}(\\\\pi(\\\\cdot\\|\\\\xi)\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\]. Since we clearly have RÏÏ„,Ïµâ€‹(f)â‰¤supÏ€âˆˆğ’«â€‹(ÎÃ—Î)\\[Ï€\\]1=Pâ€‹{ğ”¼Î¶âˆ¼\\[Ï€\\]2â€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€âˆ¥Ï€0)}subscriptsuperscriptğ‘…ğœitalic-ÏµğœŒğ‘“ğœ‹ğ’«ÎÎsubscriptdelimited-\\[\\]ğœ‹1ğ‘ƒsupremumsubscriptğ”¼similar-toğœsubscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]ğ‘“ğœitalic-ÏµKLconditionalğœ‹subscriptğœ‹0R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\leq\\\\underset{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\\\\n\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}{\\\\sup}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\[\\\\pi\\]\\_{2}}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}, this yields the result.\\\nâˆ\\\n\\\n### F.2 Necessity of the dual upper-bound\\\n\\\nWe exhibit an example where the function Î¼â†¦ÏˆÏ„,Ïµâ€‹(Î¼,f,Î¾)maps-toğœ‡superscriptğœ“ğœitalic-Ïµğœ‡ğ‘“ğœ‰\\\\mu\\\\mapsto\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi) is not Lipschitz as Î¼â†’0â†’ğœ‡0\\\\mu\\\\to 0. This justifies the necessity of bounding the dual solution above in the regularized case, as done in [LemmaD.3](https://ar5iv.org/html/2402.11981#A4.Thmlemma3 \"Lemma D.3 (Upper bound for the regularized problem Lemma 4.5). â€£ D.2.2 Dual upper-bound â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\\\n\\\n###### Proposition F.2.\\\n\\\nConsider Ï„=0ğœ0\\\\tau=0, Ïµ>0italic-Ïµ0\\\\epsilon>0, Î=\\[0,1\\]Î01\\\\Xi=\\[0,1\\], câ€‹(Î¾,Î¶)=\\|Î¾âˆ’Î¶\\|ğ‘ğœ‰ğœğœ‰ğœc(\\\\xi,\\\\zeta)=\\|\\\\xi-\\\\zeta\\| and assume that the reference distribution is a truncated Laplace Ï€0â€‹(dâ€‹Î¶\\|Î¾)âˆeâˆ’\\|Î¾âˆ’Î¶\\|â€‹ğŸ™\\[0,1\\]â€‹(Î¶)â€‹dâ€‹Î¶proportional-tosubscriptğœ‹0conditionaldğœğœ‰superscriptğ‘’ğœ‰ğœsubscript101ğœdğœ\\\\pi\\_{0}(\\\\mathrm{d}\\\\zeta\\|\\\\xi)\\\\propto e^{-\\|\\\\xi-\\\\zeta\\|}\\\\mathds{1}\\_{\\[0,1\\]}(\\\\zeta)\\\\mathrm{d}\\\\zeta. Assume furthermore â„±â„±\\\\mathcal{F} is a family of functions from \\[0,1\\]01\\[0,1\\] to â„â„\\\\mathbb{R} which satisfies eâˆ’2â€‹â€–â„±â€–âˆÏµâ‰¥Ïµsuperscriptğ‘’2subscriptnormâ„±italic-Ïµitalic-Ïµe^{-\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\geq\\\\epsilon.\\\n\\\nThen for almost all Î¾âˆˆ\\[0,1\\]ğœ‰01\\\\xi\\\\in\\[0,1\\] and all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, Î¼â†¦ÏˆÏ„,Ïµâ€‹(Î¼,f,Î¾)maps-toğœ‡superscriptğœ“ğœitalic-Ïµğœ‡ğ‘“ğœ‰\\\\mu\\\\mapsto\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi) is not Lipschitz at 0+superscript00^{+}.\\\n\\\n###### Proof.\\\n\\\nLet Î¾âˆˆ(0,1)ğœ‰01\\\\xi\\\\in(0,1) and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}. The expression of the derivative of Ïˆ0,Ïµsuperscriptğœ“0italic-Ïµ\\\\psi^{0,\\\\epsilon} with respect to Î¼ğœ‡\\\\mu is given by ( [23](https://ar5iv.org/html/2402.11981#A3.E23 \"Equation 23 â€£ Proof. â€£ C.2 Regularized WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ‚Î¼Ïˆ0,Ïµâ€‹(Î¼,f,Î¾)=ğ”¼Î¶âˆ¼Ï€0Î¼â€‹fâˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ(â‹…\\|Î¾)â€‹\\[Ïµâ€‹câ€‹(Î¾,Î¶)Î¼â€‹Ïµ\\]+Ïµâ€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eÎ¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ\\].\\\\partial\\_{\\\\mu}\\\\psi^{0,\\\\epsilon}(\\\\mu,f,\\\\xi)=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{\\\\mu f-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{\\\\epsilon c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}\\\\right\\]+\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{\\\\mu f(\\\\zeta)-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}}\\\\right\\]. |  |\\\n\\\nIn particular, it satisfies\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | âˆ‚Î¼Ïˆ0,Ïµâ€‹(Î¼,f,Î¾)â‰¤e2â€‹â€–â„±â€–âˆÏµâ€‹ğ”¼Î¶âˆ¼Ï€0âˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ(â‹…\\|Î¾)â€‹\\[câ€‹(Î¾,Î¶)Î¼\\]+Ïµâ€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[eâˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ\\]+â€–â„±â€–âˆ.\\\\partial\\_{\\\\mu}\\\\psi^{0,\\\\epsilon}(\\\\mu,f,\\\\xi)\\\\leq e^{\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{-\\\\frac{c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{c(\\\\xi,\\\\zeta)}{\\\\mu}\\\\right\\]+\\\\epsilon\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{-\\\\frac{c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}}\\\\right\\]+\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}. |  | (44) |\\\n\\\nOn the other hand, by Donsker-Varadhan formula \\[ [16](https://ar5iv.org/html/2402.11981#bib.bib16 \"\")\\], we can write\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | logğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)\\[eâˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ\\]=ğ”¼Î¶âˆ¼Ï€0âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ(â‹…\\|Î¾)\\[âˆ’câ€‹(Î¾,Î¶)Î¼â€‹Ïµ\\]âˆ’KL(Ï€0âˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ(â‹…\\|Î¾)âˆ¥Ï€0(â‹…\\|Î¾)).\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}}\\\\right\\]=\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{\\\\frac{-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\\\left\\[\\\\frac{-c(\\\\xi,\\\\zeta)}{\\\\mu\\\\epsilon}\\\\right\\]-\\\\operatorname{KL}\\\\left(\\\\pi\\_{0}^{\\\\frac{-c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)\\\\middle\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\right). |  |\\\n\\\nReinjecting this in ( [44](https://ar5iv.org/html/2402.11981#A6.E44 \"Equation 44 â€£ Proof. â€£ F.2 Necessity of the dual upper-bound â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) and using eâˆ’2â€‹â€–â„±â€–âˆÏµâ‰¥Ïµsuperscriptğ‘’2subscriptnormâ„±italic-Ïµitalic-Ïµe^{-\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\geq\\\\epsilon gives\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ‚Î¼ÏˆÏ„,Ïµ(Î¼,f,Î¾)â‰¤âˆ¥â„±âˆ¥âˆâˆ’KL(Ï€0âˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ(â‹…\\|Î¾)âˆ¥Ï€0(â‹…\\|Î¾)).\\\\partial\\_{\\\\mu}\\\\psi^{\\\\tau,\\\\epsilon}(\\\\mu,f,\\\\xi)\\\\leq\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}-\\\\operatorname{KL}\\\\left(\\\\pi\\_{0}^{-\\\\frac{c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)\\\\middle\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\right). |  |\\\n\\\nConsequently, to prove non-Lipschitzness of Ïˆ0,Ïµâ€‹(â‹…,f,Î¾)superscriptğœ“0italic-Ïµâ‹…ğ‘“ğœ‰\\\\psi^{0,\\\\epsilon}(\\\\cdot,f,\\\\xi) at 00, we show that\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | KL(Ï€0âˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ(â‹…\\|Î¾)âˆ¥Ï€0(â‹…\\|Î¾))â†’âˆ\\\\operatorname{KL}\\\\left(\\\\pi\\_{0}^{-\\\\frac{c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)\\\\middle\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\right)\\\\to\\\\infty |  |\\\n\\\nas Î¼â†’0â†’ğœ‡0\\\\mu\\\\to 0.\\\nWe show that Ï€0âˆ’\\|Î¾âˆ’â‹…\\|Î¼â€‹Ïµ(â‹…\\|Î¾)\\\\pi\\_{0}^{-\\\\frac{\\|\\\\xi-\\\\cdot\\|}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi) converges in law to Î´Î¾subscriptğ›¿ğœ‰\\\\delta\\_{\\\\xi}. Let Ï†:â„â†’â„:ğœ‘â†’â„â„\\\\varphi:\\\\mathbb{R}\\\\to\\\\mathbb{R} be of class Câˆsuperscriptğ¶C^{\\\\infty} with compact support. With the change of variable uâ†Î¾âˆ’Î¶Î¼â€‹Ïµâ†ğ‘¢ğœ‰ğœğœ‡italic-Ïµu\\\\leftarrow\\\\frac{\\\\xi-\\\\zeta}{\\\\mu\\\\epsilon}, we have\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ«01eâˆ’\\|Î¾âˆ’Î¶\\|Î¼â€‹Ïµâ€‹Ï†â€‹(Î¶)â€‹dÎ¶=Î¼â€‹Ïµâ€‹âˆ«â„ğŸ™\\[Î¾âˆ’1Î¼â€‹Ïµ,Î¾Î¼â€‹Ïµ\\]â€‹(u)â€‹eâˆ’\\|u\\|â€‹Ï†â€‹(Î¾+Î¼â€‹Ïµâ€‹u)â€‹du.superscriptsubscript01superscriptğ‘’ğœ‰ğœğœ‡italic-Ïµğœ‘ğœdifferential-dğœğœ‡italic-Ïµsubscriptâ„subscript1ğœ‰1ğœ‡italic-Ïµğœ‰ğœ‡italic-Ïµğ‘¢superscriptğ‘’ğ‘¢ğœ‘ğœ‰ğœ‡italic-Ïµğ‘¢differential-dğ‘¢\\\\int\\_{0}^{1}e^{-\\\\frac{\\|\\\\xi-\\\\zeta\\|}{\\\\mu\\\\epsilon}}\\\\varphi(\\\\zeta)\\\\mathrm{d}\\\\zeta=\\\\mu\\\\epsilon\\\\int\\_{\\\\mathbb{R}}\\\\mathds{1}\\_{\\\\left\\[\\\\frac{\\\\xi-1}{\\\\mu\\\\epsilon},\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}\\\\right\\]}(u)e^{-\\|u\\|}\\\\varphi(\\\\xi+\\\\mu\\\\epsilon u)\\\\mathrm{d}u. |  |\\\n\\\nAlso, we easily verify that\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ«01eâˆ’\\|Î¾âˆ’Î¶\\|Î¼â€‹Ïµâ€‹dÎ¶=âˆ«0Î¾eâˆ’Î¾âˆ’Î¶Î¼â€‹Ïµâ€‹dÎ¶+âˆ«Î¾1eâˆ’Î¶âˆ’Î¾Î¼â€‹Ïµâ€‹dÎ¶=Î¼â€‹Ïµâ€‹(2âˆ’eâˆ’Î¾Î¼â€‹Ïµâˆ’eâˆ’(1âˆ’Î¾)Î¼â€‹Ïµ),superscriptsubscript01superscriptğ‘’ğœ‰ğœğœ‡italic-Ïµdifferential-dğœsuperscriptsubscript0ğœ‰superscriptğ‘’ğœ‰ğœğœ‡italic-Ïµdifferential-dğœsuperscriptsubscriptğœ‰1superscriptğ‘’ğœğœ‰ğœ‡italic-Ïµdifferential-dğœğœ‡italic-Ïµ2superscriptğ‘’ğœ‰ğœ‡italic-Ïµsuperscriptğ‘’1ğœ‰ğœ‡italic-Ïµ\\\\int\\_{0}^{1}e^{-\\\\frac{\\|\\\\xi-\\\\zeta\\|}{\\\\mu\\\\epsilon}}\\\\mathrm{d}\\\\zeta=\\\\int\\_{0}^{\\\\xi}e^{-\\\\frac{\\\\xi-\\\\zeta}{\\\\mu\\\\epsilon}}\\\\mathrm{d}\\\\zeta+\\\\int\\_{\\\\xi}^{1}e^{-\\\\frac{\\\\zeta-\\\\xi}{\\\\mu\\\\epsilon}}\\\\mathrm{d}\\\\zeta=\\\\mu\\\\epsilon(2-e^{-\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}}-e^{\\\\frac{-(1-\\\\xi)}{\\\\mu\\\\epsilon}}), |  |\\\n\\\nhence we obtain\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | ğ”¼Î¶âˆ¼Ï€0âˆ’\\|Î¾âˆ’â‹…\\|Î¼â€‹Ïµâ€‹\\[Ï†â€‹(Î¶)\\]=âˆ«â„ğŸ™\\[Î¾âˆ’1Î¼â€‹Ïµ,Î¾Î¼â€‹Ïµ\\]â€‹(u)â€‹eâˆ’\\|u\\|â€‹Ï†â€‹(Î¾+Î¼â€‹Ïµâ€‹u)â€‹du2âˆ’eâˆ’Î¾Î¼â€‹Ïµâˆ’eâˆ’(1âˆ’Î¾)Î¼â€‹Ïµ.\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{-\\\\frac{\\|\\\\xi-\\\\cdot\\|}{\\\\mu\\\\epsilon}}}\\[\\\\varphi(\\\\zeta)\\]=\\\\frac{\\\\int\\_{\\\\mathbb{R}}\\\\mathds{1}\\_{\\\\left\\[\\\\frac{\\\\xi-1}{\\\\mu\\\\epsilon},\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}\\\\right\\]}(u)e^{-\\|u\\|}\\\\varphi(\\\\xi+\\\\mu\\\\epsilon u)\\\\mathrm{d}u}{2-e^{-\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}}-e^{\\\\frac{-(1-\\\\xi)}{\\\\mu\\\\epsilon}}}. |  | (45) |\\\n\\\nWe then have the following:\\\n\\\n- â€¢\\\n\\\n\\\n2âˆ’eâˆ’Î¾Î¼â€‹Ïµâˆ’eâˆ’(1âˆ’Î¾)Î¼â€‹Ïµ2superscriptğ‘’ğœ‰ğœ‡italic-Ïµsuperscriptğ‘’1ğœ‰ğœ‡italic-Ïµ2-e^{-\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}}-e^{\\\\frac{-(1-\\\\xi)}{\\\\mu\\\\epsilon}} converges to 222 as Î¼â†’0â†’ğœ‡0\\\\mu\\\\to 0,\\\n\\\n- â€¢\\\n\\\n\\\nFor all uâˆˆâ„ğ‘¢â„u\\\\in\\\\mathbb{R}, ğŸ™\\[Î¾âˆ’1Î¼â€‹Ïµ,Î¾Î¼â€‹Ïµ\\]â€‹(u)â€‹eâˆ’\\|u\\|â€‹Ï†â€‹(Î¾+Î¼â€‹Ïµâ€‹u)â€‹dâ€‹usubscript1ğœ‰1ğœ‡italic-Ïµğœ‰ğœ‡italic-Ïµğ‘¢superscriptğ‘’ğ‘¢ğœ‘ğœ‰ğœ‡italic-Ïµğ‘¢dğ‘¢\\\\mathds{1}\\_{\\\\left\\[\\\\frac{\\\\xi-1}{\\\\mu\\\\epsilon},\\\\frac{\\\\xi}{\\\\mu\\\\epsilon}\\\\right\\]}(u)e^{-\\|u\\|}\\\\varphi(\\\\xi+\\\\mu\\\\epsilon u)\\\\mathrm{d}u converges to eâˆ’\\|u\\|â€‹Ï†â€‹(Î¾)superscriptğ‘’ğ‘¢ğœ‘ğœ‰e^{-\\|u\\|}\\\\varphi(\\\\xi) as Î¼â†’0â†’ğœ‡0\\\\mu\\\\to 0, hence its integral with respect to uğ‘¢u converges to 2â€‹Ï†â€‹(Î¾)2ğœ‘ğœ‰2\\\\varphi(\\\\xi) by dominated convergence theorem.\\\n\\\n\\\nCombining both limits in ( [45](https://ar5iv.org/html/2402.11981#A6.E45 \"Equation 45 â€£ Proof. â€£ F.2 Necessity of the dual upper-bound â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) gives ğ”¼Î¶âˆ¼Ï€0âˆ’\\|Î¾âˆ’â‹…\\|Î¼â€‹Ïµ(â‹…\\|Î¾)â€‹\\[Ï†â€‹(Î¶)\\]â†’Ï†â€‹(Î¾)\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}^{-\\\\frac{\\|\\\\xi-\\\\cdot\\|}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)}\\[\\\\varphi(\\\\zeta)\\]\\\\to\\\\varphi(\\\\xi). This means that Ï€0âˆ’\\|Î¾âˆ’â‹…\\|Î¼â€‹Ïµ(â‹…\\|Î¾)\\\\pi\\_{0}^{-\\\\frac{\\|\\\\xi-\\\\cdot\\|}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi) converges in law to Î´Î¾subscriptğ›¿ğœ‰\\\\delta\\_{\\\\xi}. We have KL(Î´Î¾âˆ¥Ï€0(â‹…\\|Î¾))=âˆ\\\\operatorname{KL}(\\\\delta\\_{\\\\xi}\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))=\\\\infty, hence by lower semicontinuity of the KLKL\\\\operatorname{KL}-divergence for the convergence in law (or weak convergence), see e.g. Theorem 4.9 from \\[ [29](https://ar5iv.org/html/2402.11981#bib.bib29 \"\")\\], we obtain KL(Ï€0âˆ’câ€‹(Î¾,â‹…)Î¼â€‹Ïµ(â‹…\\|Î¾)âˆ¥Ï€0(â‹…\\|Î¾))âŸ¶Î¼â†’0âˆ\\\\operatorname{KL}\\\\left(\\\\pi\\_{0}^{-\\\\frac{c(\\\\xi,\\\\cdot)}{\\\\mu\\\\epsilon}}(\\\\cdot\\|\\\\xi)\\\\middle\\\\\\|\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\right)\\\\underset{\\\\mu\\\\to 0}{\\\\longrightarrow}\\\\infty. This means that Ïˆ0,Ïµâ€‹(â‹…,f,Î¾)superscriptğœ“0italic-Ïµâ‹…ğ‘“ğœ‰\\\\psi^{0,\\\\epsilon}(\\\\cdot,f,\\\\xi) is not Lipschitz near 00.\\\nâˆ\\\n\\\n### F.3 On the compactness condition, Assumption 5.1 from \\[5\\]\\\n\\\nWe justify the importance of relaxing Assumption 5.1 from \\[ [5](https://ar5iv.org/html/2402.11981#bib.bib5 \"\")\\] which corresponds to compactness of â„±â„±\\\\mathcal{F} with respect to the distance Dâ„±â€‹(f,g):=â€–fâˆ’gâ€–âˆ+dHâ€‹(argâ€‹maxÎâ¡f,argâ€‹maxÎâ¡g)assignsubscriptğ·â„±ğ‘“ğ‘”subscriptnormğ‘“ğ‘”subscriptğ‘‘ğ»subscriptargmaxÎğ‘“subscriptargmaxÎğ‘”D\\_{\\\\mathcal{F}}(f,g):=\\\\\\|f-g\\\\\\|\\_{\\\\infty}+d\\_{H}(\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g). We show that this condition is actually equivalent to assuming continuity on fâ†¦argâ€‹maxâ¡fmaps-toğ‘“argmaxğ‘“f\\\\mapsto\\\\operatorname\\*{arg\\\\,max}f, which is a strong condition and difficult to verify in practice.\\\n\\\n###### Proposition F.3.\\\n\\\nFor (f,g)âˆˆâ„±Ã—â„±ğ‘“ğ‘”â„±â„±(f,g)\\\\in\\\\mathcal{F}\\\\times\\\\mathcal{F}, define\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Dâ„±â€‹(f,g):=â€–fâˆ’gâ€–âˆ+dHâ€‹(argâ€‹maxÎâ¡f,argâ€‹maxÎâ¡g)assignsubscriptğ·â„±ğ‘“ğ‘”subscriptnormğ‘“ğ‘”subscriptğ‘‘ğ»subscriptargmaxÎğ‘“subscriptargmaxÎğ‘”D\\_{\\\\mathcal{F}}(f,g):=\\\\\\|f-g\\\\\\|\\_{\\\\infty}+d\\_{H}(\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g) |  |\\\n\\\nwhere dHsubscriptğ‘‘ğ»d\\_{H} is the Hausdorff distance on the set of compact subsets of ÎÎ\\\\Xi, ğ’¦â€‹(Î)ğ’¦Î\\\\mathcal{K}(\\\\Xi) . Assume (â„±,âˆ¥â‹…âˆ¥âˆ)(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) is compact. Then we have the equivalence\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | (â„±,Dâ„±) is compact âŸºfâ†¦argâ€‹maxÎf is continuous from (â„±,âˆ¥â‹…âˆ¥âˆ) to (ğ’¦(Î),dH).(\\\\mathcal{F},D\\_{\\\\mathcal{F}})\\\\text{ is compact }\\\\Longleftrightarrow f\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\\\text{ is continuous from }(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\text{ to }(\\\\mathcal{K}(\\\\Xi),d\\_{H}). |  |\\\n\\\n###### Proof.\\\n\\\nWe prove (â‡’)â‡’(\\\\Rightarrow). Assume (â„±,Dâ„±)â„±subscriptğ·â„±(\\\\mathcal{F},D\\_{\\\\mathcal{F}}) is compact. Let fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, and let (gk)kâˆˆâ„•subscriptsubscriptğ‘”ğ‘˜ğ‘˜â„•(g\\_{k})\\_{k\\\\in\\\\mathbb{N}} be an arbitrary sequence from â„±â„±\\\\mathcal{F} such that gksubscriptğ‘”ğ‘˜g\\_{k} converges to fğ‘“f for âˆ¥â‹…âˆ¥âˆ\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. We want to show that argâ€‹maxÎâ¡gksubscriptargmaxÎsubscriptğ‘”ğ‘˜\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g\\_{k} converges to argâ€‹maxÎâ¡fsubscriptargmaxÎğ‘“\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f for dHsubscriptğ‘‘ğ»d\\_{H}, proving the continuity of the arg max map. By compactness of (â„±,Dâ„±)â„±subscriptğ·â„±(\\\\mathcal{F},D\\_{\\\\mathcal{F}}), (gk)kâˆˆâ„•subscriptsubscriptğ‘”ğ‘˜ğ‘˜â„•(g\\_{k})\\_{k\\\\in\\\\mathbb{N}} admits accumulation points for Dâ„±subscriptğ·â„±D\\_{\\\\mathcal{F}}. Let hâ„h be any one of them. We may extract a subsequence from (gk)kâˆˆâ„•subscriptsubscriptğ‘”ğ‘˜ğ‘˜â„•(g\\_{k})\\_{k\\\\in\\\\mathbb{N}} converging to hâ„h, say gnkâ€‹â†’kâ†’âˆâ€‹hâˆˆâ„±subscriptğ‘”subscriptğ‘›ğ‘˜â†’ğ‘˜â†’â„â„±g\\_{n\\_{k}}\\\\underset{k\\\\to\\\\infty}{\\\\to}h\\\\in\\\\mathcal{F}. In particular, gnksubscriptğ‘”subscriptğ‘›ğ‘˜g\\_{n\\_{k}} converges to hâ„h for âˆ¥â‹…âˆ¥âˆ\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. We necessarily have h=fâ„ğ‘“h=f by definition of the sequence (gk)kâˆˆâ„•subscriptsubscriptğ‘”ğ‘˜ğ‘˜â„•(g\\_{k})\\_{k\\\\in\\\\mathbb{N}}. It means that (gk)kâˆˆâ„•subscriptsubscriptğ‘”ğ‘˜ğ‘˜â„•(g\\_{k})\\_{k\\\\in\\\\mathbb{N}} admits only one possible accumulation point for Dâ„±subscriptğ·â„±D\\_{\\\\mathcal{F}}, which is fğ‘“f. This implies gksubscriptğ‘”ğ‘˜g\\_{k} converges to fğ‘“f for Dâ„±subscriptğ·â„±D\\_{\\\\mathcal{F}}, hence argâ€‹maxÎâ¡gksubscriptargmaxÎsubscriptğ‘”ğ‘˜\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}g\\_{k} converges to argâ€‹maxÎâ¡fsubscriptargmaxÎğ‘“\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f.\\\n\\\nNow, we prove (â‡)â‡(\\\\Leftarrow). Let (fk)kâˆˆâ„•subscriptsubscriptğ‘“ğ‘˜ğ‘˜â„•(f\\_{k})\\_{k\\\\in\\\\mathbb{N}} be a sequence from â„±â„±\\\\mathcal{F}. By compactness of (â„±,âˆ¥â‹…âˆ¥âˆ)(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}), we may extract a converging subsequence fnkâ€‹â†’kâ†’âˆâ€‹fsubscriptğ‘“subscriptğ‘›ğ‘˜â†’ğ‘˜â†’ğ‘“f\\_{n\\_{k}}\\\\underset{k\\\\to\\\\infty}{\\\\to}f for âˆ¥â‹…âˆ¥âˆ\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. Assuming fâ†¦argâ€‹maxÎâ¡fmaps-toğ‘“subscriptargmaxÎğ‘“f\\\\mapsto\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f is continuous gives that argâ€‹maxÎâ¡fnksubscriptargmaxÎsubscriptğ‘“subscriptğ‘›ğ‘˜\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\_{n\\_{k}} converges to argâ€‹maxÎâ¡fsubscriptargmaxÎğ‘“\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f, which is the desired result.\\\nâˆ\\\n\\\n[â—„](https://ar5iv.org/html/2402.11980) [![ar5iv homepage](https://ar5iv.org/assets/ar5iv.png)](https://ar5iv.org/) [Feeling\\\\\n\\\\\nlucky?](https://ar5iv.org/feeling_lucky) [Conversion\\\\\n\\\\\nreport](https://ar5iv.org/log/2402.11981) [Report\\\\\n\\\\\nan issue](https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2402.11981) [View original\\\\\n\\\\\non arXiv](https://arxiv.org/abs/2402.11981) [â–º](https://ar5iv.org/html/2402.11982)",
  "sections": {
    "1 Introduction": {
      "content": "### 1.1 Wasserstein robustness: models and generalization\n\nMachine learning models are challenged in practice by many obstacles,\nsuch as biases in data, adversarial attacks, or data shifts between training and deployment. Towards more resilient and reliable models, distributionally robust optimization has emerged as an attractive paradigm, where training no longer relies on minimizing the empirical risk, but rather on an optimization problem that takes into account potential perturbations in the data distribution; see e.g.,â€„the review articles \\[ [23], [9]\\].\n\nMore specifically, the approach consists in minimizing the worst-risk among all distributions in a neighborhood of the empirical data distribution. A natural way \\[ [27]\\] to define such a neighborhood is to use the optimal transport distance, called the Wasserstein distance \\[ [28]\\]. Between two distributions Qğ‘„Q and Qâ€²superscriptğ‘„â€²Q^{\\\\prime} on a sample space ÎÎ\\\\Xi, the Wasserstein distance is defined as the minimal expected cost among all coupling probability Ï€ğœ‹\\\\pi on ÎÃ—ÎÎÎ\\\\Xi\\\\times\\\\Xi having Qğ‘„Q and Qâ€²superscriptğ‘„â€²Q^{\\\\prime} as marginals:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Wcâ€‹(Q,Qâ€²):=infÏ€âˆˆğ’«â€‹(ÎÃ—Î)\\[Ï€\\]1=Q,\\[Ï€\\]2=Qâ€²ğ”¼(Î¾,Î¶)âˆ¼Ï€â€‹\\[câ€‹(Î¾,Î¶)\\],assignsubscriptğ‘Šğ‘ğ‘„superscriptğ‘„â€²subscriptinfimumğœ‹ğ’«ÎÎformulae-sequencesubscriptdelimited-\\[\\]ğœ‹1ğ‘„subscriptdelimited-\\[\\]ğœ‹2superscriptğ‘„â€²subscriptğ”¼similar-toğœ‰ğœğœ‹delimited-\\[\\]ğ‘ğœ‰ğœW\\_{c}(Q,Q^{\\\\prime}):=\\\\inf\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=Q,\\[\\\\pi\\]\\_{2}=Q^{\\\\prime}\\\\end{subarray}}\\\\mathbb{E}\\_{(\\\\xi,\\\\zeta)\\\\sim\\\\pi}\\[c(\\\\xi,\\\\zeta)\\], |  | (1) |\n\nwhere c:ÎÃ—Îâ†’â„:ğ‘â†’ÎÎâ„c\\\\colon\\\\Xi\\\\times\\\\Xi\\\\rightarrow\\\\mathbb{R} is a transport cost over the sample space ÎÎ\\\\Xi. For a class of loss functions â„±â„±\\\\mathcal{F},\nthe Wasserstein distributionally robust counterpart of the standard empirical risk minimization then writes\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | minfâˆˆâ„±â¡maxQâˆˆğ’«â€‹(Î),Wcâ€‹(P^n,Q)â‰¤Ïâ¡ğ”¼Î¾âˆ¼Qâ€‹\\[fâ€‹(Î¾)\\],subscriptğ‘“â„±subscriptformulae-sequenceğ‘„ğ’«Îsubscriptğ‘Šğ‘subscript^ğ‘ƒğ‘›ğ‘„ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]ğ‘“ğœ‰\\\\min\\_{f\\\\in\\\\mathcal{F}}~{}~{}\\\\max\\_{Q\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(\\\\widehat{P}\\_{n},Q)\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[f(\\\\xi)\\], |  | (2) |\n\nfor a chosen radius ÏğœŒ\\\\rho of the Wasserstein ball centered at the empirical data distribution, denoted P^nsubscript^ğ‘ƒğ‘›\\\\widehat{P}\\_{n}. In the degenerate case\nÏ=0ğœŒ0\\\\rho=0, we have Q=P^nğ‘„subscript^ğ‘ƒğ‘›Q=\\\\widehat{P}\\_{n} and ( [2], [35], [39], [24], [26], [36], [20], [4], [7]\\].\n\nTo support theoretically the modeling versatility and the practical success of these robust models, some statistical guarantees have been proposed in the literature.\nFor a population distribution Pğ‘ƒP, i.i.d.â€„samples Î¾1,â€¦,Î¾nsubscriptğœ‰1â€¦subscriptğœ‰ğ‘›\\\\xi\\_{1},\\\\ldots,\\\\xi\\_{n} drawn from Pğ‘ƒP,\nand the associated empirical distribution\nP^n:=1nâ€‹âˆ‘i=1nÎ´Î¾iassignsubscript^ğ‘ƒğ‘›1ğ‘›superscriptsubscriptğ‘–1ğ‘›subscriptğ›¿subscriptğœ‰ğ‘–\\\\widehat{P}\\_{n}:=\\\\frac{1}{n}\\\\sum\\_{i=1}^{n}\\\\delta\\_{\\\\xi\\_{i}},\nthe best concentration results for the Wasserstein distance \\[ [18]\\]\ngives that if the radius ÏğœŒ\\\\rho is large enough, then the Wasserstein ball around P^nsubscript^ğ‘ƒğ‘›\\\\widehat{P}\\_{n} contains the true distribution Pğ‘ƒP with high probability, which in turn gives directly \\[ [27]\\] a generalization bound of the form\n\n![Refer to caption]Figure 1: Probability of the generalization boundâ€„( [3]Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to hold, estimated from 500 logistic regression instances and their â„“1subscriptâ„“1\\\\ell\\_{1}-robust counterparts (see at the end of [Section3]Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). For large ÏğœŒ\\\\rho, the bound always holds, whereas it does not for small ÏğœŒ\\\\rho. Our aim is to quantify this phenomenon, which is not explained by existing results.\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | maxQâˆˆğ’«â€‹(Î),Wcâ€‹(P^n,Q)â‰¤Ïâ¡ğ”¼Î¾âˆ¼Qâ€‹\\[fâ€‹(Î¾)\\]â‰¥ğ”¼Î¾âˆ¼Pâ€‹\\[fâ€‹(Î¾)\\].subscriptformulae-sequenceğ‘„ğ’«Îsubscriptğ‘Šğ‘subscript^ğ‘ƒğ‘›ğ‘„ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]ğ‘“ğœ‰subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘“ğœ‰\\\\max\\_{Q\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(\\\\widehat{P}\\_{n},Q)\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[f(\\\\xi)\\]\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\]. |  | (3) |\n\nThis exact bound is particularly attractive: the quantity that we compute from data and optimize by training provides a control on the idealistic population risk. However, the direct application of \\[ [18]\\] requires a number of training samples growing exponentially in the dimension.\n\nRecent works have improved this direct approach by establishing, in various situations, generalization bounds that do not suffer from the curse of dimensionality, and rather feature radius ÏğœŒ\\\\rho scaling as Oâ€‹(1/n)ğ‘‚1ğ‘›O(1/\\\\sqrt{n})\\[ [35], [10], [3], [19], [5], [11]\\]. Yet no existing result is general enough to cover all situations encountered in machine learning and to explain nice generalization properties usually observed in practice (as illustrated in [Figure1]In 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n\n### 1.2 Contributions and outline\n\nIn this paper, we provide exact generalization guarantees of the form ( [3]Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), that are universal, in the sense that they apply to all machine learning situations, without restrictive assumptions. Indeed, our results apply to any kind of data lying in a metric space (e.g.â€„classification and regression tasks with mixed features), as well as general classes of continuous loss functions (e.g.â€„from standard regression tasks to deep learning models).\n\nWe prove these universal results by dealing directly with the nonsmoothness of the robust objective functionâ€…( [2]Equation 2 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) that we tackle with\ntools from variational analysisâ€„\\[ [14], [31], [1]\\].\nAs a nice outcome of this approach, our results are able to cover deep learning models involving nonsmooth elementary blocks, such as the popular ReLUReLU\\\\operatorname{ReLU} activation function, the max-pooling operator, or optimization layers \\[ [2]\\]. Moreover, our approach is systematic enough to extend to the recent versions of Wasserstein distributionally robust problems that involve (double) regularizations \\[ [6], [38]\\].\n\nThe paper is structured as follows.\nFirst, [Section2]Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") introduces and illustrates the setting of this work. Then [Section3]Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") presents and discusses the main results (Theoremsâ€„[3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") andâ€„[3.2]Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\n[Section4]Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") highlights our proof techniques, combining classical concentration lemma and advanced nonsmooth analysis aspects.\nFinally, [Section5]On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") sheds some light on generalization constants and other quantities of interest appearing in the results and the proof. We differ, to the supplementary, the proofs of the succession of lemmas, as well as complementary results discussing technical assumptions of existing works.\n\n### 1.3 Related work\n\nOur work stands out from a recent line of research establishing generalization guarantees for Wasserstein distributionally robust models, breaking the curse of dimensionality.\nNotably, important results on the topic include \\[ [10], [11]\\] about asymptotical results for smooth losses, and \\[ [13], [34]\\] about non-asymptotically results for linear models and for smooth loss functions.\nFor nonsmooth losses, the only work we are aware of is \\[ [3]\\] which derives results on piece-wise smooth losses (at the cost of abstract approximating constants).\nWe underline that none of existing results covers deep learning models involving nonsmooth elementary blocks.\n\nThe closest work to our paper is \\[ [5]\\] which establishes generalization results similar to ours, namely: exact bounds ( [3]Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in a regime where Ï>Oâ€‹(1/n)ğœŒğ‘‚1ğ‘›\\\\rho>O(1/\\\\sqrt{n}). In sharp contrast with our work though, these results rely on a restrictive context and some needless assumptions (the squared norm for cğ‘c, a Gaussian reference distribution, additional growth conditions, and abstract compactness conditions111We show in [PropositionF.3]Proposition F.3. â€£ F.3 On the compactness condition, Assumption 5.1 from [5] â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary that the compactness assumptions hide strong conditions on the maximizers.). Throughout our developments, we will point out further technical differences with this work.\n\n### 1.4 Notations\n\n##### On probability spaces.\n\nGiven a measurable space ÎÎ\\\\Xi, we denote the space of probability measures on ÎÎ\\\\Xi by ğ’«â€‹(Î)ğ’«Î\\\\mathcal{P}(\\\\Xi). For all Ï€âˆˆğ’«â€‹(ÎÃ—Î)ğœ‹ğ’«ÎÎ\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi), iâˆˆ{1,2}ğ‘–12i\\\\in\\\\{1,2\\\\}, we denote the ithsuperscriptğ‘–thi^{\\\\text{th}} marginal of Ï€ğœ‹\\\\pi by \\[Ï€\\]isubscriptdelimited-\\[\\]ğœ‹ğ‘–\\[\\\\pi\\]\\_{i}. We denote the Dirac mass at Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi by Î´Î¾subscriptğ›¿ğœ‰\\\\delta\\_{\\\\xi}. Given a measurable function g:Îâ†’â„:ğ‘”â†’Îâ„g:\\\\Xi\\\\to\\\\mathbb{R}, we denote the expectation of gğ‘”g with respect to Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) by ğ”¼Î¾âˆ¼Qâ€‹\\[gâ€‹(Î¾)\\]subscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]ğ‘”ğœ‰\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[g(\\\\xi)\\] and we may also use the shorthand ğ”¼Qâ€‹\\[f\\]subscriptğ”¼ğ‘„delimited-\\[\\]ğ‘“\\\\mathbb{E}\\_{Q}\\[f\\].\n\n##### On function spaces.\n\nIn (ğ’³,dist)ğ’³dist(\\\\mathcal{X},\\\\operatorname{dist}) a metric space, the uniform norm of a function fğ‘“f is â€–fâ€–âˆ=supxâˆˆğ’³\\|fâ€‹(x)\\|subscriptnormğ‘“subscriptsupremumğ‘¥ğ’³ğ‘“ğ‘¥\\\\\\|f\\\\\\|\\_{\\\\infty}=\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\|f(x)\\|. If â„±â„±\\\\mathcal{F} is a family of functions, we denote â€–â„±â€–âˆ=supfâˆˆâ„±â€–fâ€–âˆsubscriptnormâ„±subscriptsupremumğ‘“â„±subscriptnormğ‘“\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}=\\\\sup\\_{f\\\\in\\\\mathcal{F}}\\\\\\|f\\\\\\|\\_{\\\\infty}. We say fğ‘“f is _Lipschitz_ with constant Lğ¿L if for all x,yâˆˆğ’³ğ‘¥ğ‘¦ğ’³x,y\\\\in\\\\mathcal{X}, \\|fâ€‹(x)âˆ’fâ€‹(y)\\|â‰¤Lâ€‹distâ¡(x,y)ğ‘“ğ‘¥ğ‘“ğ‘¦ğ¿distğ‘¥ğ‘¦\\|f(x)-f(y)\\|\\\\leq L\\\\operatorname{dist}(x,y). For Ï•:â„Ã—ğ’³â†’â„:italic-Ï•â†’â„ğ’³â„\\\\phi\\\\colon\\\\mathbb{R}\\\\times\\\\mathcal{X}\\\\to\\\\mathbb{R}, we denote âˆ‚Î»+Ï•subscriptsuperscriptğœ†italic-Ï•\\\\partial^{+}\\_{\\\\lambda}\\\\phi the right-sided derivative with respect to Î»âˆˆâ„ğœ†â„\\\\lambda\\\\in\\\\mathbb{R}, and âˆ‚Î»Ï•subscriptğœ†italic-Ï•\\\\partial\\_{\\\\lambda}\\\\phi its derivative, whenever well-defined.",
      "citations": [
        {
          "start_pos": 553,
          "end_pos": 557,
          "text": "[23]",
          "paper_id": "bib.bib23",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 559,
          "end_pos": 562,
          "text": "[9]",
          "paper_id": "bib.bib9",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 732,
          "end_pos": 736,
          "text": "[27]",
          "paper_id": "bib.bib27",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 846,
          "end_pos": 850,
          "text": "[28]",
          "paper_id": "bib.bib28",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 2495,
          "end_pos": 2498,
          "text": "[2]",
          "paper_id": "bib.bib33",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2500,
          "end_pos": 2504,
          "text": "[35]",
          "paper_id": "bib.bib35",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2506,
          "end_pos": 2510,
          "text": "[39]",
          "paper_id": "bib.bib39",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2512,
          "end_pos": 2516,
          "text": "[24]",
          "paper_id": "bib.bib24",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2518,
          "end_pos": 2522,
          "text": "[26]",
          "paper_id": "bib.bib26",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2524,
          "end_pos": 2528,
          "text": "[36]",
          "paper_id": "bib.bib36",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2530,
          "end_pos": 2534,
          "text": "[20]",
          "paper_id": "bib.bib20",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2536,
          "end_pos": 2539,
          "text": "[4]",
          "paper_id": "bib.bib4",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 2541,
          "end_pos": 2544,
          "text": "[7]",
          "paper_id": "bib.bib7",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 3093,
          "end_pos": 3097,
          "text": "[18]",
          "paper_id": "bib.bib18",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 3306,
          "end_pos": 3310,
          "text": "[27]",
          "paper_id": "bib.bib27",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 4610,
          "end_pos": 4614,
          "text": "[18]",
          "paper_id": "bib.bib18",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 4931,
          "end_pos": 4935,
          "text": "[35]",
          "paper_id": "bib.bib35",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4937,
          "end_pos": 4941,
          "text": "[10]",
          "paper_id": "bib.bib10",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4943,
          "end_pos": 4946,
          "text": "[3]",
          "paper_id": "bib.bib3",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4948,
          "end_pos": 4952,
          "text": "[19]",
          "paper_id": "bib.bib19",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4954,
          "end_pos": 4957,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4959,
          "end_pos": 4963,
          "text": "[11]",
          "paper_id": "bib.bib11",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6327,
          "end_pos": 6331,
          "text": "[14]",
          "paper_id": "bib.bib14",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6333,
          "end_pos": 6337,
          "text": "[31]",
          "paper_id": "bib.bib31",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6339,
          "end_pos": 6342,
          "text": "[1]",
          "paper_id": "bib.bib1",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6594,
          "end_pos": 6597,
          "text": "[2]",
          "paper_id": "bib.bib2",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 6767,
          "end_pos": 6770,
          "text": "[6]",
          "paper_id": "bib.bib6",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 6772,
          "end_pos": 6776,
          "text": "[38]",
          "paper_id": "bib.bib38",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8479,
          "end_pos": 8483,
          "text": "[10]",
          "paper_id": "bib.bib10",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8485,
          "end_pos": 8489,
          "text": "[11]",
          "paper_id": "bib.bib11",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8545,
          "end_pos": 8549,
          "text": "[13]",
          "paper_id": "bib.bib13",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8551,
          "end_pos": 8555,
          "text": "[34]",
          "paper_id": "bib.bib34",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 8698,
          "end_pos": 8701,
          "text": "[3]",
          "paper_id": "bib.bib3",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 8952,
          "end_pos": 8955,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "2 Assumption and examples": {
      "content": "In this section, we present the general framework illustrated by standard examples.\nThroughout the paper, we will make the following assumptions on the sample space ÎÎ\\\\Xi, the transport cost of the Wasserstein distance, and the space â„±â„±\\\\mathcal{F} of loss functions from ÎÎ\\\\Xi to â„â„\\\\mathbb{R}.\n\n###### Assumption 2.1.\n\n- â€¢\n\n\n(Î,d)Îğ‘‘(\\\\Xi,d) is a compact metric space.\n\n- â€¢\n\n\nc:ÎÃ—Îâ†’â„:ğ‘â†’ÎÎâ„c:\\\\Xi\\\\times\\\\Xi\\\\to\\\\mathbb{R} is jointly continuous with respect to dğ‘‘d, non-negative and câ€‹(Î¾,Î¶)=0ğ‘ğœ‰ğœ0c(\\\\xi,\\\\zeta)=0 if and only if Î¾=Î¶ğœ‰ğœ\\\\xi=\\\\zeta.\n\n- â€¢\n\n\n(â„±,âˆ¥â‹…âˆ¥âˆ)(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) is compact and every fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} is continuous.\n\n\nThis setting encompasses a wide range of machine learning scenarios, as illustrated below.\n\n##### Sample space and transport costs.\n\nThe choice of the transport cost cğ‘c depends on the nature of the data and of the potential data uncertainty. For instance, if the variables are continuous with ÎâŠ‚â„mÎsuperscriptâ„ğ‘š\\\\Xi\\\\subset\\\\mathbb{R}^{m}, we consider the distance d=âˆ¥â‹…âˆ’â‹…âˆ¥pd=\\\\\\|\\\\cdot-\\\\cdot\\\\\\|\\_{p} induced by â„“psubscriptâ„“ğ‘\\\\ell\\_{p}-norm (pâˆˆ\\[1,âˆ\\]ğ‘1p\\\\in\\[1,\\\\infty\\]) and the cost as a power (qâˆˆ\\[1,âˆ)ğ‘1q\\\\in\\[1,\\\\infty)) of the distance\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | câ€‹(Î¾,Î¾â€²)=â€–Î¾âˆ’Î¾â€²â€–pq.ğ‘ğœ‰superscriptğœ‰â€²superscriptsubscriptnormğœ‰superscriptğœ‰â€²ğ‘ğ‘c(\\\\xi,\\\\xi^{\\\\prime})=\\\\\\|\\\\xi-\\\\xi^{\\\\prime}\\\\\\|\\_{p}^{q}. |  |\\\n\\\nIf the variables are discrete with ÎâŠ‚{1,â€¦,J}mÎsuperscript1â€¦ğ½ğ‘š\\\\Xi\\\\subset\\\\left\\\\{1,\\\\ldots,J\\\\right\\\\}^{m}, we consider the distance\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | dâ€‹(Î¾,Î¾â€²)=âˆ‘i=1mğŸ™{Î¾iâ‰ Î¾iâ€²}ğ‘‘ğœ‰superscriptğœ‰â€²superscriptsubscriptğ‘–1ğ‘šsubscript1subscriptğœ‰ğ‘–superscriptsubscriptğœ‰ğ‘–â€²d(\\\\xi,\\\\xi^{\\\\prime})=\\\\sum\\_{i=1}^{m}\\\\mathds{1}\\_{\\\\left\\\\{\\\\xi\\_{i}\\\\neq\\\\xi\\_{i}^{\\\\prime}\\\\right\\\\}} |  |\\\n\\\nand the cost as a power of this distance.\\\nFinally, If we deal with mixed data, i.e. they contain both continuous and discrete variables, a sum of the previous costs can be considered. In classification, for instance, with the samples composed of features xâˆˆâ„mğ‘¥superscriptâ„ğ‘šx\\\\in\\\\mathbb{R}^{m} and a target yâˆˆ{âˆ’1,1}ğ‘¦11y\\\\in\\\\left\\\\{-1,1\\\\right\\\\}, we may take, for a chosen Îº>0ğœ…0\\\\kappa>0\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | câ€‹((x,y),(xâ€²,yâ€²))=â€–xâˆ’xâ€²â€–pq+Îºâ€‹ğŸ™{yâ‰ yâ€²}ğ‘ğ‘¥ğ‘¦superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptsubscriptnormğ‘¥superscriptğ‘¥â€²ğ‘ğ‘ğœ…subscript1ğ‘¦superscriptğ‘¦â€²c((x,y),(x^{\\\\prime},y^{\\\\prime}))=\\\\\\|x-x^{\\\\prime}\\\\\\|\\_{p}^{q}+\\\\kappa\\\\mathds{1}\\_{\\\\left\\\\{y\\\\neq y^{\\\\prime}\\\\right\\\\}} |  | (4) |\\\n\\\nwhich is obviously continuous with respect to\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | dâ€‹((x,y),(xâ€²,yâ€²))=â€–xâˆ’xâ€²â€–p+ğŸ™{yâ‰ yâ€²}.ğ‘‘ğ‘¥ğ‘¦superscriptğ‘¥â€²superscriptğ‘¦â€²subscriptnormğ‘¥superscriptğ‘¥â€²ğ‘subscript1ğ‘¦superscriptğ‘¦â€²d((x,y),(x^{\\\\prime},y^{\\\\prime}))=\\\\\\|x-x^{\\\\prime}\\\\\\|\\_{p}+\\\\mathds{1}\\_{\\\\left\\\\{y\\\\neq y^{\\\\prime}\\\\right\\\\}}. |  | (5) |\\\n\\\nThis extends to mixed data with categorical, binary, and continuous variables; see e.g.â€„\\[ [7]\\].\\\n\\\n##### Parametric models and loss functions.\\\n\\\nOur setting covers all standard machine learning models.\\\nConsider a parametric family â„±={fâ€‹(Î¸,â‹…):Î¸âˆˆÎ˜}â„±conditional-setğ‘“ğœƒâ‹…ğœƒÎ˜\\\\mathcal{F}=\\\\left\\\\{f(\\\\theta,\\\\cdot)\\ :\\ \\\\theta\\\\in\\\\Theta\\\\right\\\\},\\\nwhere the parameter space Î˜âŠ‚â„pÎ˜superscriptâ„ğ‘\\\\Theta\\\\subset\\\\mathbb{R}^{p} compact and the loss function f:Î˜Ã—Îâ†’â„:ğ‘“â†’Î˜Îâ„f\\\\colon\\\\Theta\\\\times\\\\Xi\\\\to\\\\mathbb{R} is jointly continuous. If ÎÎ\\\\Xi is compact, such a family is compact regarding âˆ¥â‹…âˆ¥âˆ\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}. This situation covers regression models, k-means clustering, and neural networks.\\\nFor example: least-squares regression\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,(x,y))=(âŸ¨Î¸,xâŸ©âˆ’y)2,ÎâŠ‚â„mÃ—â„,formulae-sequenceğ‘“ğœƒğ‘¥ğ‘¦superscriptğœƒğ‘¥ğ‘¦2Îsuperscriptâ„ğ‘šâ„f(\\\\theta,(x,y))=(\\\\langle\\\\theta,x\\\\rangle-y)^{2},\\\\quad\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\mathbb{R}, |  |\\\n\\\nlogistic regression\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,(x,y))=logâ¡(1+eâˆ’yâ€‹âŸ¨Î¸,xâŸ©),ÎâŠ‚â„mÃ—{âˆ’1,1},formulae-sequenceğ‘“ğœƒğ‘¥ğ‘¦1superscriptğ‘’ğ‘¦ğœƒğ‘¥Îsuperscriptâ„ğ‘š11f(\\\\theta,(x,y))=\\\\log\\\\left(1+e^{-y\\\\langle\\\\theta,x\\\\rangle}\\\\right),\\\\quad\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\{-1,1\\\\}, |  |\\\n\\\nand support vector machines with hinge loss\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,(x,y))=maxâ¡{0,1âˆ’yâ€‹âŸ¨Î¸,xâŸ©},ÎâŠ‚â„mÃ—{âˆ’1,1}formulae-sequenceğ‘“ğœƒğ‘¥ğ‘¦01ğ‘¦ğœƒğ‘¥Îsuperscriptâ„ğ‘š11f(\\\\theta,(x,y))=\\\\max\\\\left\\\\{0,1-y\\\\langle\\\\theta,x\\\\rangle\\\\right\\\\},\\\\hskip 8.00003pt\\\\Xi\\\\subset\\\\mathbb{R}^{m}\\\\times\\\\{-1,1\\\\} |  |\\\n\\\nNote that this function is not differentiable, due to the max term. The k-means model also introduces a non-differentiable loss function:\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,x)=miniâˆˆ{1,â€¦,K}â¡â€–Î¸iâˆ’xâ€–22,Î˜âŠ‚â„KÃ—m,ÎâŠ‚â„m.formulae-sequenceğ‘“ğœƒğ‘¥subscriptğ‘–1â€¦ğ¾superscriptsubscriptnormsubscriptğœƒğ‘–ğ‘¥22formulae-sequenceÎ˜superscriptâ„ğ¾ğ‘šÎsuperscriptâ„ğ‘šf(\\\\theta,x)=\\\\min\\_{i\\\\in\\\\left\\\\{1,\\\\ldots,K\\\\right\\\\}}\\\\\\|\\\\theta\\_{i}-x\\\\\\|\\_{2}^{2},\\\\quad\\\\Theta\\\\subset\\\\mathbb{R}^{K\\\\times m}\\\\!,~{}\\\\Xi\\\\subset\\\\mathbb{R}^{m}. |  |\\\n\\\nFinally, most deep learning models fall in our setting. Indeed, they involve loss functions of the form\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | fâ€‹(Î¸,(x,y))=â„“â€‹(hâ€‹(Î¸,x),y),ğ‘“ğœƒğ‘¥ğ‘¦â„“â„ğœƒğ‘¥ğ‘¦f(\\\\theta,(x,y))=\\\\ell(h(\\\\theta,x),y), |  |\\\n\\\nwhere â„“â„“\\\\ell is a dissimilarity measure, and hâ„h is a parameterized prediction function, built as a composition of affine transformations (which are the parameters to train) with activation functions (see e.g.â€„\\[ [22], [25], [30]\\]). Our setting is general enough to encompass all continuous activation functions, even non-differentiable ones (as ReLU=maxâ¡(0,â‹…)ReLU0â‹…\\\\operatorname{ReLU}=\\\\max(0,\\\\cdot))\\\nas well as other nonsmooth elementary blocks (as max-pooling \\[ [21]\\], sorting procedures \\[ [32]\\], and optimization layers \\[ [2]\\]).\\\nAs already underlined in introduction, these examples involving non-differentiable terms are not covered by existing results.\\\n\\",
      "citations": [
        {
          "start_pos": 2972,
          "end_pos": 2975,
          "text": "[7]",
          "paper_id": "bib.bib7",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 5453,
          "end_pos": 5457,
          "text": "[22]",
          "paper_id": "bib.bib22",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 5459,
          "end_pos": 5463,
          "text": "[25]",
          "paper_id": "bib.bib25",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 5465,
          "end_pos": 5469,
          "text": "[30]",
          "paper_id": "bib.bib30",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 5710,
          "end_pos": 5714,
          "text": "[21]",
          "paper_id": "bib.bib21",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 5740,
          "end_pos": 5744,
          "text": "[32]",
          "paper_id": "bib.bib32",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 5775,
          "end_pos": 5778,
          "text": "[2]",
          "paper_id": "bib.bib2",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "3 Main results\\": {
      "content": "\\\n### 3.1 Wasserstein robust models\\\n\\\nOur main result establishes a generalization bound ( [3]Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) for Wasserstein distributionally robust optimization (WDRO). Given a distribution Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) and a loss fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, the robust risk around Qğ‘„Q with radius Ï>0ğœŒ0\\\\rho>0 is then defined as\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | RÏ,Qâ€‹(f):=maxQâ€²âˆˆğ’«â€‹(Î),Wcâ€‹(Q,Qâ€²)â‰¤Ïâ¡ğ”¼Î¾âˆ¼Qâ€²â€‹\\[fâ€‹(Î¾)\\].assignsubscriptğ‘…ğœŒğ‘„ğ‘“subscriptformulae-sequencesuperscriptğ‘„â€²ğ’«Îsubscriptğ‘Šğ‘ğ‘„superscriptğ‘„â€²ğœŒsubscriptğ”¼similar-toğœ‰superscriptğ‘„â€²delimited-\\[\\]ğ‘“ğœ‰R\\_{\\\\rho,Q}(f):=\\\\max\\_{Q^{\\\\prime}\\\\in\\\\mathcal{P}(\\\\Xi),W\\_{c}(Q,Q^{\\\\prime})\\\\leq\\\\rho}\\\\mathbb{E}\\_{\\\\xi\\\\sim Q^{\\\\prime}}\\[f(\\\\xi)\\]. |  | (6) |\\\n\\\nIn particular, taking Q=P^nğ‘„subscript^ğ‘ƒğ‘›Q=\\\\widehat{P}\\_{n} and Q=Pğ‘„ğ‘ƒQ=P in the above expression, we consider the empirical robust risk, R^Ïâ€‹(f)subscript^ğ‘…ğœŒğ‘“\\\\widehat{R}\\_{\\\\rho}(f), and the true robust risk, RÏâ€‹(f)subscriptğ‘…ğœŒğ‘“R\\_{\\\\rho}(f):\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^Ïâ€‹(f):=RÏ,P^nâ€‹(f)â€‹ and â€‹RÏâ€‹(f):=RÏ,Pâ€‹(f).assignsubscript^ğ‘…ğœŒğ‘“subscriptğ‘…ğœŒsubscript^ğ‘ƒğ‘›ğ‘“ and subscriptğ‘…ğœŒğ‘“assignsubscriptğ‘…ğœŒğ‘ƒğ‘“\\\\widehat{R}\\_{\\\\rho}(f):=R\\_{\\\\rho,\\\\widehat{P}\\_{n}}(f)\\\\text{ \\\\quad and \\\\quad}R\\_{\\\\rho}(f):=R\\_{\\\\rho,P}(f). |  | (7) |\\\n\\\nOur generalization result states as follows:\\\n\\\n###### Theorem 3.1(Generalization guarantee for Wasserstein robust models).\\\n\\\nUnder [2.1]Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exist Î±,Î²>0ğ›¼ğ›½0\\\\alpha,\\\\beta>0 such that if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Î±n<Ï<Ïcrit2âˆ’Î²n,ğ›¼ğ‘›ğœŒsubscriptğœŒcrit2ğ›½ğ‘›\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}, |  |\\\n\\\nthen with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | âˆ€fâˆˆâ„±,R^Ïâ€‹(f)â‰¥ğ”¼Î¾âˆ¼Pâ€‹\\[fâ€‹(Î¾)\\].formulae-sequencefor-allğ‘“â„±subscript^ğ‘…ğœŒğ‘“subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘“ğœ‰\\\\forall f\\\\in\\\\mathcal{F},\\\\quad\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\]. |  |\\\n\\\nThe quantity ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}} is a _critical radius_,\\\na relevant threshold that excludes degenerated problems and flat losses for which RÏâ€‹(f)=maxÎâ¡fsubscriptğ‘…ğœŒğ‘“subscriptÎğ‘“R\\_{\\\\rho}(f)=\\\\max\\_{\\\\Xi}f. The exact generalization guarantee thus holds for a wide range of radius ÏğœŒ\\\\rho, growing with the sample size between the two extreme cases 00 and ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}}. As in Theorem 3.1 from \\[ [5]\\], but adding the wide setting of [2.1]Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), the sample rates are dimension-free. The constants Î±ğ›¼\\\\alpha and Î²ğ›½\\\\beta depend on the problem quantities, see [Section5]On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for a detailed discussion.\\\n\\\n### 3.2 Regularized Wasserstein robust models\\\n\\\nPart of the success of optimal transport in machine learning is the use of regularization, and specifically entropic regularization, opening the way to nice properties and efficient computational schemes \\[ [15], [28]\\]. Recall that the entropy-regularized Wasserstein distance writes, for a reference coupling Ï€0âˆˆğ’«â€‹(ÎÃ—Î)subscriptğœ‹0ğ’«ÎÎ\\\\pi\\_{0}\\\\in\\\\mathcal{P}(\\\\Xi\\\\!\\\\times\\\\!\\\\Xi)\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | WcÏ„â€‹(P,Q)=infÏ€âˆˆğ’«â€‹(ÎÃ—Î)\\[Ï€\\]1=P,\\[Ï€2\\]=Q{ğ”¼Ï€â€‹\\[c\\]+Ï„â€‹KLâ¡(Ï€âˆ¥Ï€0)}subscriptsuperscriptğ‘Šğœğ‘ğ‘ƒğ‘„subscriptinfimumğœ‹ğ’«ÎÎformulae-sequencesubscriptdelimited-\\[\\]ğœ‹1ğ‘ƒdelimited-\\[\\]subscriptğœ‹2ğ‘„subscriptğ”¼ğœ‹delimited-\\[\\]ğ‘ğœKLconditionalğœ‹subscriptğœ‹0W^{\\\\tau}\\_{c}(P,Q)=\\\\inf\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi)\\\\\\<br>\\[\\\\pi\\]\\_{1}=P,\\[\\\\pi\\_{2}\\]=Q\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\} |  | (8) |\\\n\\\nwhere KLKL\\\\operatorname{KL} is the Kullback-Leibler divergence w.r.t.â€„Ï€0subscriptğœ‹0\\\\pi\\_{0}:\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | KLâ¡(Ï€âˆ¥Ï€0)={âˆ«ÎÃ—Îlogâ¡dâ€‹Ï€dâ€‹Ï€0â€‹dâ€‹Ï€when â€‹Ï€â‰ªÏ€0âˆotherwise.KLconditionalğœ‹subscriptğœ‹0casessubscriptÎÎdğœ‹dsubscriptğœ‹0dğœ‹much-less-thanwhen ğœ‹subscriptğœ‹0otherwise.\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})=\\\\begin{cases}\\\\int\\_{\\\\Xi\\\\times\\\\Xi}\\\\log\\\\frac{\\\\mathrm{d}\\\\pi}{\\\\mathrm{d}\\\\pi\\_{0}}\\\\,\\\\mathrm{d}\\\\pi&\\\\text{when }\\\\pi\\\\ll\\\\pi\\_{0}\\\\\\<br>\\\\infty&\\\\text{otherwise.}\\\\end{cases} |  |\\\n\\\nRegularization have been recently studied in the context of WDRO: \\[ [38]\\] introduces an entropic regularization in constraints for computational interests, \\[ [5]\\] considers an entropic regularization in the objective for generalization, and \\[ [6]\\] studies a general regularization in both constraints and objective.\\\n\\\nFollowing the most general case \\[ [6]\\], we consider\\\nthe robust risk with double regularization\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | RÏ,QÏ„,Ïµâ€‹(f):=supÏ€âˆˆğ’«â€‹(ÎÃ—Î),\\[Ï€\\]1=Qğ”¼Ï€â€‹\\[c\\]+Ï„â€‹KLâ¡(Ï€âˆ¥Ï€0)â‰¤Ï{ğ”¼\\[Ï€\\]2â€‹\\[f\\]âˆ’Ïµâ€‹KLâ¡(Ï€âˆ¥Ï€0)}.assignsuperscriptsubscriptğ‘…ğœŒğ‘„ğœitalic-Ïµğ‘“subscriptsupremumformulae-sequenceğœ‹ğ’«ÎÎsubscriptdelimited-\\[\\]ğœ‹1ğ‘„subscriptğ”¼ğœ‹delimited-\\[\\]ğ‘ğœKLconditionalğœ‹subscriptğœ‹0ğœŒsubscriptğ”¼subscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]ğ‘“italic-ÏµKLconditionalğœ‹subscriptğœ‹0R\\_{\\\\rho,Q}^{\\\\tau,\\\\epsilon}(f):=\\\\!\\\\!\\\\!\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),~{}\\[\\\\pi\\]\\_{1}=Q\\\\\\<br>\\\\mathbb{E}\\_{\\\\pi}\\[c\\]+\\\\tau\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\leq\\\\rho\\\\end{subarray}}\\\\!\\\\!\\\\!\\\\left\\\\{\\\\mathbb{E}\\_{\\[\\\\pi\\]\\_{2}}\\[f\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}. |  |\\\n\\\nwith two parameters Ïµ>0italic-Ïµ0\\\\epsilon>0 and Ï„â‰¥0ğœ0\\\\tau\\\\geq 0.\\\nIntroducing the conditional moment of Ï€0subscriptğœ‹0\\\\pi\\_{0}:\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | mc=maxÎ¾âˆˆÎâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[câ€‹(Î¾,Î¶)\\],m\\_{c}=\\\\max\\_{\\\\xi\\\\in\\\\Xi}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[c(\\\\xi,\\\\zeta)\\], |  | (9) |\\\n\\\nthe generalization guarantee in this setting states as follows.\\\n\\\n###### Theorem 3.2(Generalization for double regularization).\\\n\\\nUnder [2.1]Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), there exist Î±Ï„,Ïµ,Î²Ï„,Ïµ>0superscriptğ›¼ğœitalic-Ïµsuperscriptğ›½ğœitalic-Ïµ0\\\\alpha^{\\\\tau,\\\\epsilon}\\\\!,\\\\beta^{\\\\tau,\\\\epsilon}\\\\!>\\\\!0â€„suchâ€„thatâ€„if\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | maxâ¡{mc,Î±Ï„,Ïµn}<Ï<ÏcritÏ„,Ïµ2âˆ’Î²Ï„,Ïµn,subscriptğ‘šğ‘superscriptğ›¼ğœitalic-Ïµğ‘›ğœŒsuperscriptsubscriptğœŒcritğœitalic-Ïµ2superscriptğ›½ğœitalic-Ïµğ‘›\\\\max\\\\left\\\\{m\\_{c},\\\\frac{\\\\alpha^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}\\\\right\\\\}<\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}-\\\\frac{\\\\beta^{\\\\tau,\\\\epsilon}}{\\\\sqrt{n}}, |  |\\\n\\\nthen with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta, for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} and all Qğ‘„Q such that WcÏ„â€‹(P,Q)â‰¤Ïsubscriptsuperscriptğ‘Šğœğ‘ğ‘ƒğ‘„ğœŒW^{\\\\tau}\\_{c}(P,Q)\\\\leq\\\\rho,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^ÏÏ„,Ïµâ€‹(f)â‰¥ğ”¼Î¶âˆ¼Qâ€‹\\[fâ€‹(Î¶)\\]âˆ’Ïµâ€‹KLâ¡(Ï€P,Qâˆ¥Ï€0),subscriptsuperscript^ğ‘…ğœitalic-ÏµğœŒğ‘“subscriptğ”¼similar-toğœğ‘„delimited-\\[\\]ğ‘“ğœitalic-ÏµKLconditionalsuperscriptğœ‹ğ‘ƒğ‘„subscriptğœ‹0\\\\widehat{R}^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{\\\\zeta\\\\sim Q}\\[f(\\\\zeta)\\]-\\\\epsilon\\\\operatorname{KL}(\\\\pi^{P,Q}\\\\\\|\\\\pi\\_{0}), |  |\\\n\\\nwhere Ï€P,Qsuperscriptğœ‹ğ‘ƒğ‘„\\\\pi^{P,Q} is the optimal coupling in ( [8]Equation 8 â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nThis result is similar to the one of [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), it is also similar to the only other generalization result existing for regularized WDRO \\[ [5]\\]. Let us explicit below the main differences. We will discuss in [Section5]On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), the generalization constants such as the critical radius ÏcritÏ„,ÏµsuperscriptsubscriptğœŒcritğœitalic-Ïµ\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}.\\\n\\\nUnlike Wasserstein robust models ( [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), regularization leads to an inexact generalization guarantee, where the regularized empirical robust risk bounds a proxy for the true risk ğ”¼Pâ€‹\\[f\\]subscriptğ”¼ğ‘ƒdelimited-\\[\\]ğ‘“\\\\mathbb{E}\\_{P}\\[f\\]. This is in line with the regularization in optimal transport that induces a bias in the Wasserstein metric, preventing WcÏ„â€‹(P,P)subscriptsuperscriptğ‘Šğœğ‘ğ‘ƒğ‘ƒW^{\\\\tau}\\_{c}(P,P) from being null.\\\n\\\nCompared to \\[ [5]\\], we underline that our result covers also the double regularization case. Moreover, it is valid for an arbitrary Ï€0subscriptğœ‹0\\\\pi\\_{0} whereas the one of \\[ [5]\\] relies on the specific form Ï€0subscriptğœ‹0\\\\pi\\_{0} involving a Gaussian term. Our result is thus more flexible, allowing to choose conjointly cğ‘c and Ï€0subscriptğœ‹0\\\\pi\\_{0}. For example, a Laplace distribution can be chosen when cğ‘c is the â„“1subscriptâ„“1\\\\ell\\_{1}-norm.\\\n\\\nBefore moving on to the proof of the generalization results, let us come back to [Figure1]In 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). To get this plot, we generated 500 instances of logistic regression problems with synthetic classification data (n=100ğ‘›100n=100, d=5ğ‘‘5d=5), for which we solve an associated robust counterpart (with an â„“1subscriptâ„“1\\\\ell\\_{1}-cost cğ‘c and a Laplace distribution Ï€0(â‹…\\|Î¾)\\\\pi\\_{0}(\\\\cdot\\|\\\\xi))\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | minÎ¸â¡maxğ”¼Ï€\\[âˆ¥â‹…âˆ¥1\\]â‰¤Ï\\[Ï€\\]1=P^n\\\\displaystyle\\\\min\\_{\\\\theta}\\\\max\\_{\\\\begin{subarray}{c}\\\\mathbb{E}\\_{\\\\pi}\\[\\\\\\|{\\\\cdot}\\\\\\|\\_{1}\\]\\\\leq\\\\rho\\\\\\<br>\\[\\\\pi\\]\\_{1}=\\\\widehat{P}\\_{n}\\\\end{subarray}} | ğ”¼(x,y)âˆ¼\\[Ï€\\]2â€‹\\[logâ¡(1+eyâ€‹âŸ¨Î¸,xâŸ©)\\].subscriptğ”¼similar-toğ‘¥ğ‘¦subscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]1superscriptğ‘’ğ‘¦ğœƒğ‘¥\\\\displaystyle\\\\mathbb{E}\\_{(x,y)\\\\sim\\[\\\\pi\\]\\_{2}}\\[\\\\log(1+e^{y\\\\langle\\\\theta,x\\\\rangle})\\]. |  |\\\n\\\nThis setting is covered by [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") but not by existing results in previous works. Let us check the realizations of the bound ( [3]Equation 3 â€£ 1.1 Wasserstein robustness: models and generalization â€£ 1 Introduction â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Using 105superscript10510^{5} samples, we estimate the true risk ğ”¼Pâ€‹\\[f\\]subscriptğ”¼ğ‘ƒdelimited-\\[\\]ğ‘“\\\\mathbb{E}\\_{P}\\[f\\] for computed optimal solutions fğ‘“f of the 500 instances.\\\nOn the figure, we report the proportion of instances for which the bound holds and we observe that when ÏğœŒ\\\\rho increases, the bound does hold true.\\\n\\",
      "citations": [
        {
          "start_pos": 2730,
          "end_pos": 2733,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 3432,
          "end_pos": 3436,
          "text": "[15]",
          "paper_id": "bib.bib15",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 3438,
          "end_pos": 3442,
          "text": "[28]",
          "paper_id": "bib.bib28",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 4730,
          "end_pos": 4734,
          "text": "[38]",
          "paper_id": "bib.bib38",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 4822,
          "end_pos": 4825,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 4909,
          "end_pos": 4912,
          "text": "[6]",
          "paper_id": "bib.bib6",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 5021,
          "end_pos": 5024,
          "text": "[6]",
          "paper_id": "bib.bib6",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 8030,
          "end_pos": 8033,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 9039,
          "end_pos": 9042,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 9203,
          "end_pos": 9206,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "4 Proof strategy\\": {
      "content": "\\\nThis section presents our strategy to prove the generalization results of Sectionâ€„[3]Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")â€„(Theoremsâ€„[3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2]Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\nThe strength of our approach is to use\\\nflexible nonsmooth analysis arguments, able to cover the general situation of arbitrary (continuous) cost and objective functions. After an overview of the proof in [Section4.2]Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we explain the key mechanisms in Sectionsâ€„[4.3]Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [4.4]Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and how they combine with a concentration theorem ( [Section4.1]Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) to show the results.\\\n\\\nIn Sectionsâ€„[4.2]Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), [4.3]Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [4.4]Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") we consider the standard WDRO setting of [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The extension to the regularized setting of [Theorem3.2]Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is then explained in [Section4.5]Extension to (double) regularization. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Furthermore, in order to focus on the rationale we do not include the proofs in the core of the paper and we refer precisely to corresponding results in the supplementary. We also underline the fundamental results of probability and (nonsmooth) analysis that are used all along. All the statements of this section implicitly assume that our [2.1]Assumption 2.1. â€£ 2 Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") holds.\\\n\\\n### 4.1 Uniform concentration inequality\\\n\\\nIn order to obtain high-probability bounds guarantees, uniform on â„±â„±\\\\mathcal{F}, we rely on a standard uniform concentration inequality on a compact metric space. We recall the essential result below, highlighting the two crucial properties on the random variable: _(i) boundedness_ and _(ii) global Lipschitzness_.\\\nWe refer to e.g. \\[ [12]\\] for general discussions, and to [TheoremA.2]Theorem A.2 (Uniform concentration inequality, Lemma G.2 in [5]). â€£ A.1 Uniform concentration inequality â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") for one-sided alternatives.\\\n\\\n###### Theorem 4.1(Uniform concentration).\\\n\\\nLet (ğ’³,dist)ğ’³dist(\\\\mathcal{X},\\\\operatorname{dist}) be a compact metric space, and X:ğ’³Ã—Îâ†’â„:ğ‘‹â†’ğ’³Îâ„X:\\\\mathcal{X}\\\\times\\\\Xi\\\\to\\\\mathbb{R} be a measurable function. Assume the following:\\\n\\\n1. (i)\\\n\\\n\\\nThere exist a,bâˆˆâ„ğ‘ğ‘â„a,b\\\\in\\\\mathbb{R} such that Xâ€‹(x,Î¾)âˆˆ\\[a,b\\]ğ‘‹ğ‘¥ğœ‰ğ‘ğ‘X(x,\\\\xi)\\\\in\\[a,b\\] for all (x,Î¾)âˆˆğ’³Ã—Îğ‘¥ğœ‰ğ’³Î(x,\\\\xi)\\\\in\\\\mathcal{X}\\\\times\\\\Xi.\\\n\\\n2. (ii)\\\n\\\n\\\nXâ€‹(â‹…,Î¾)ğ‘‹â‹…ğœ‰X(\\\\cdot,\\\\xi) is Lğ¿L-Lipschitz for all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi.\\\n\\\n\\\nThen with probability at least 1âˆ’Î´1ğ›¿1-\\\\delta,\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | supxâˆˆğ’³\\|ğ”¼Î¾âˆ¼P^nâ€‹\\[Xâ€‹(x,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼Pâ€‹\\[Xâ€‹(x,Î¾)\\]\\|â‰¤Mn.subscriptsupremumğ‘¥ğ’³subscriptğ”¼similar-toğœ‰subscript^ğ‘ƒğ‘›delimited-\\[\\]ğ‘‹ğ‘¥ğœ‰subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘‹ğ‘¥ğœ‰ğ‘€ğ‘›\\\\sup\\_{x\\\\in\\\\mathcal{X}}\\\\left\\|\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[X(x,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[X(x,\\\\xi)\\]\\\\right\\|\\\\leq\\\\frac{M}{\\\\sqrt{n}}. |  |\\\n\\\nMğ‘€M is a problem-dependent constant having the expression222The constant â„â€‹(ğ’³,dist)â„ğ’³dist\\\\mathcal{I}({\\\\mathcal{X},\\\\operatorname{dist}}) is the standard Dudleyâ€™s entropy integral measuring the complexity of the space ğ’³ğ’³\\\\mathcal{X}, that we further discuss in [DefinitionA.4]Definition A.4. â€£ A.1 Uniform concentration inequality â€£ Appendix A Recalls and technical preliminaries â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | M=48â€‹Lâ€‹â„â€‹(ğ’³,dist)+(bâˆ’a)â€‹2â€‹logâ¡(2/Î´).ğ‘€48ğ¿â„ğ’³distğ‘ğ‘22ğ›¿M=48\\\\,L\\\\,\\\\mathcal{I}(\\\\mathcal{X},\\\\operatorname{dist})+\\ (b-a)\\\\sqrt{2\\\\log(2/\\\\delta)}. |  |\\\n\\\nWe will apply this concentration result to two families of functions (Ïˆğœ“\\\\psi and Ï•italic-Ï•\\\\phi) appearing in our proof; to this end, we will establish the two points (i) and (ii) in [Lemma4.1]Lemma 4.1. â€£ 4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [Lemma4.3]Lemma 4.3. â€£ Dual bound on the empirical risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") respectively.\\\n\\\n### 4.2 Proofâ€™s overview\\\n\\\nCompared to the original formulation ( [6]Equation 6 â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), the dual representation of WDRO significantly diminishes the problemâ€™s degrees of freedom, and is usually the starting point of most studies.\\\nGiven any distribution Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi), it holds that\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | RÏ,Qâ€‹(f)=infÎ»â‰¥0{Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]},subscriptğ‘…ğœŒğ‘„ğ‘“subscriptinfimumğœ†0ğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰R\\_{\\\\rho,Q}(f)=\\\\inf\\_{\\\\lambda\\\\geq 0}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}, |  | (10) |\\\n\\\nwhere the _dual generator_ Ï•italic-Ï•\\\\phi is a convex function with respect to Î»ğœ†\\\\lambda, and Lipschitz continuous with respect to fğ‘“f. For Wasserstein robust models, Ï•italic-Ï•\\\\phi has the expression (see e.g.â€„\\[ [8]\\])\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Ï•â€‹(Î»,f,Î¾)=supÎ¶âˆˆÎ{fâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)}.italic-Ï•ğœ†ğ‘“ğœ‰subscriptsupremumğœÎğ‘“ğœğœ†ğ‘ğœ‰ğœ\\\\phi(\\\\lambda,f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)\\\\right\\\\}. |  |\\\n\\\nObserve that Ï•italic-Ï•\\\\phi is naturally convex in Î»ğœ†\\\\lambda, but also nonsmooth. The originality of our approach is to build on this nonsmoothness by using a rationale of nonsmooth analysis. Note also that the convexity of Ï•italic-Ï•\\\\phi will be a key property (see e.g. the argument ofâ€„[Figure3]In Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")).\\\n\\\nLet us then outline the main steps to establish [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n1. 1.\\\n\\\n\\\nWe establish in [Section4.4]Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") the existence of a dual lower bound Î»lowsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{low}}, which holds with high probability and uniformly on â„±â„±\\\\mathcal{F}, whenever Ï<Ïcrit2âˆ’Î²nğœŒsubscriptğœŒcrit2ğ›½ğ‘›\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}:\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^Ïâ€‹(f)=infÎ»âˆˆ\\[Î»low,âˆ){Î»â€‹Ï+ğ”¼P^nâ€‹\\[Ï•â€‹(Î»,f)\\]}.subscript^ğ‘…ğœŒğ‘“subscriptinfimumğœ†subscriptğœ†lowğœ†ğœŒsubscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“\\\\widehat{R}\\_{\\\\rho}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[\\\\lambda\\_{\\\\operatorname{low}},\\\\infty)}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f)\\]\\\\right\\\\}. |  |\\\n\\\n2. 2.\\\n\\\n\\\nAs explained in [Section4.3]Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), this leads to\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^Ïâ€‹(f)â‰¥RÏâˆ’Î±nâ€‹(f).subscript^ğ‘…ğœŒğ‘“subscriptğ‘…ğœŒğ›¼ğ‘›ğ‘“\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\frac{\\\\alpha}{\\\\sqrt{n}}}(f). |  |\\\n\\\n3. 3.\\\n\\\n\\\nFinally, if furthermore Î±n<Ïğ›¼ğ‘›ğœŒ\\\\frac{\\\\alpha}{\\\\sqrt{n}}<\\\\rho, then we capture the true risk on the right:\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | R^Ïâ€‹(f)â‰¥ğ”¼Pâ€‹\\[f\\].subscript^ğ‘…ğœŒğ‘“subscriptğ”¼ğ‘ƒdelimited-\\[\\]ğ‘“\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq\\\\mathbb{E}\\_{P}\\[f\\]. |  |\\\n\\\n\\\n### 4.3 Concentration aspects by dual lower bound\\\n\\\nWe assume in this section that the empirical dual solution is lower bounded by a value Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 (with high probability), which means that the infimum inâ€„( [10]Equation 10 â€£ 4.2 Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), with Q=P^nğ‘„subscript^ğ‘ƒğ‘›Q=\\\\widehat{P}\\_{n}, may be taken over \\[Î»low,0)subscriptğœ†low0\\[\\\\lambda\\_{\\\\operatorname{low}},0) instead ofâ€„â„+subscriptâ„\\\\mathbb{R}\\_{+}. In this case, we can proceed as follows. For a distributionâ€„Qğ‘„Q, we use the shorthand ğ”¼Qâ€‹\\[Ï•\\]=ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]subscriptğ”¼ğ‘„delimited-\\[\\]italic-Ï•subscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\mathbb{E}\\_{Q}\\[\\\\phi\\]=\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]. Then we can write for Î»â‰¥Î»lowğœ†subscriptğœ†low\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}},\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | Î»â€‹Ï+ğ”¼P^nâ€‹\\[Ï•\\]ğœ†ğœŒsubscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•\\\\displaystyle\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi\\] | â‰¥Î»â€‹(Ïâˆ’(ğ”¼Pâ€‹\\[Ï•\\]âˆ’ğ”¼P^nâ€‹\\[Ï•\\]Î»))+ğ”¼Pâ€‹\\[Ï•\\]absentğœ†ğœŒsubscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•subscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†subscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•\\\\displaystyle\\\\geq\\\\lambda\\\\left(\\\\rho-\\\\left(\\\\frac{\\\\mathbb{E}\\_{P}\\[\\\\phi\\]-\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi\\]}{\\\\lambda}\\\\right)\\\\right)+\\\\mathbb{E}\\_{P}\\[\\\\phi\\] |  |\\\n|  |  | â‰¥Î»â€‹(Ïâˆ’Î±n)+ğ”¼Pâ€‹\\[Ï•\\],absentğœ†ğœŒsubscriptğ›¼ğ‘›subscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•\\\\displaystyle\\\\geq\\\\lambda(\\\\rho-\\\\alpha\\_{n})+\\\\mathbb{E}\\_{P}\\[\\\\phi\\], |  | (11) |\\\n\\\nwhere Î±nsubscriptğ›¼ğ‘›\\\\alpha\\_{n} is a formal lower bound on the quotient term (formally defined ( [4.3]Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"))).\\\nTaking the infimum over Î»â‰¥Î»lowğœ†subscriptğœ†low\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}}, we obtain\\\n\\\n|     |     |     |     |\\\n| --- | --- | --- | --- |\\\n|  | R^Ïâ€‹(f)â‰¥RÏâˆ’Î±nâ€‹(f)â‰¥ğ”¼Î¾âˆ¼Pâ€‹\\[fâ€‹(Î¾)\\],subscript^ğ‘…ğœŒğ‘“subscriptğ‘…ğœŒsubscriptğ›¼ğ‘›ğ‘“subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]ğ‘“ğœ‰\\\\widehat{R}\\_{\\\\rho}(f)\\\\geq R\\_{\\\\rho-\\\\alpha\\_{n}}(f)\\\\geq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[f(\\\\xi)\\], |  | (12) |\\\n\\\nwhenever Ï>Î±nğœŒsubscriptğ›¼ğ‘›\\\\rho>\\\\alpha\\_{n}. This is the desired inequality of [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Thus, in order to have ( [4.3]Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) with high probability for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, we introduce the function Ïˆğœ“\\\\psi of the variable Î¼=Î»âˆ’1ğœ‡superscriptğœ†1\\\\mu=\\\\lambda^{-1}:\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | Ïˆâ€‹(Î¼,f,Î¾)ğœ“ğœ‡ğ‘“ğœ‰\\\\displaystyle\\\\psi(\\\\mu,\\\\!f,\\\\xi) | :=Î¼â€‹Ï•â€‹(Î¼âˆ’1,f,Î¾)=supÎ¶âˆˆÎ{Î¼â€‹fâ€‹(Î¶)âˆ’câ€‹(Î¾,Î¶)}assignabsentğœ‡italic-Ï•superscriptğœ‡1ğ‘“ğœ‰subscriptsupremumğœÎğœ‡ğ‘“ğœğ‘ğœ‰ğœ\\\\displaystyle\\\\!:=\\\\!\\\\mu\\\\phi(\\\\mu^{-1}\\\\!,\\\\!f,\\\\xi)=\\\\sup\\_{\\\\zeta\\\\in\\\\Xi}\\\\left\\\\{\\\\mu f(\\\\zeta)\\\\!-\\\\!c(\\\\xi,\\\\zeta)\\\\right\\\\} |  | (13) |\\\n\\\nand we study the gap Î±nsubscriptğ›¼ğ‘›\\\\alpha\\_{n} defined by\\\n\\\n|     |     |     |     |     |\\\n| --- | --- | --- | --- | --- |\\\n|  | Î±n:=supassignsubscriptğ›¼ğ‘›supremum\\\\displaystyle\\\\alpha\\_{n}:=\\\\sup | {ğ”¼Î¾âˆ¼P\\[Ïˆ(Î¼,f,Î¾)\\]âˆ’ğ”¼Î¾âˆ¼P^n\\[Ïˆ(Î¼,f,Î¾)\\]\\\\displaystyle\\\\left\\\\{\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]-\\\\mathbb{E}\\_{\\\\xi\\\\sim\\\\widehat{P}\\_{n}}\\[\\\\psi(\\\\mu,f,\\\\xi)\\]\\\\right. |  |\\\n|  |  | :(Î¼,f)âˆˆ(0,Î»lowâˆ’1\\]Ã—â„±}.\\\\displaystyle\\ :\\ \\\\left.(\\\\mu,f)\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F}\\\\right\\\\}. |  | (14) |\\\n\\\nIn order to obtain a high probability bound of the form Î±nâ‰¤Î±nsubscriptğ›¼ğ‘›ğ›¼ğ‘›\\\\alpha\\_{n}\\\\leq\\\\frac{\\\\alpha}{\\\\sqrt{n}}, boundedness (i) and Lipschitz continuity (ii) of (Î¼,f)â†¦Ïˆâ€‹(Î¼,f,Î¾)maps-toğœ‡ğ‘“ğœ“ğœ‡ğ‘“ğœ‰(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) are required by the concentration theoremâ€„[Theorem4.1]Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). In the expression ( [13]Equation 13 â€£ 4.3 Concentration aspects by dual lower bound â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), we remark that the Lipschitz constant of Ïˆâ€‹(Î¼,f,Î¾)ğœ“ğœ‡ğ‘“ğœ‰\\\\psi(\\\\mu,f,\\\\xi) explodes as Î¼â†’âˆâ†’ğœ‡\\\\mu\\\\to\\\\infty, hence we must bound Î¼=Î»âˆ’1ğœ‡superscriptğœ†1\\\\mu=\\\\lambda^{-1} above. Thus, if a lower bound Î»lowsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{low}} holds on Î»ğœ†\\\\lambda, Ïˆğœ“\\\\psi satisfies the requirements of [Theorem4.1]Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"):\\\n\\\n###### Lemma 4.1.\\\n\\\nGiven Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0, then for almost all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi,\\\n\\\n1. (i)\\\n\\\n\\\nFor all Î¼âˆˆ(0,Î»lowâˆ’1\\]ğœ‡0superscriptsubscriptğœ†low1\\\\mu\\\\in(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\] and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\\\n\\\n\\\n\\\n|     |     |     |\\\n| --- | --- | --- |\\\n|  | Ïˆâ€‹(Î¼,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆÎ»low,â€–â„±â€–âˆÎ»low\\].ğœ“ğœ‡ğ‘“ğœ‰subscriptnormâ„±subscriptğœ†lowsubscriptnormâ„±subscriptğœ†low\\\\psi(\\\\mu,f,\\\\xi)\\\\in\\\\left\\[-\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}},\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right\\]. |  |\\\n\\\n2. (ii)\\\n\\\n\\\n(Î¼,f)â†¦Ïˆâ€‹(Î¼,f,Î¾)maps-toğœ‡ğ‘“ğœ“ğœ‡ğ‘“ğœ‰(\\\\mu,f)\\\\mapsto\\\\psi(\\\\mu,f,\\\\xi) is Lipschitz continuous on (0,Î»lowâˆ’1\\]Ã—â„±0superscriptsubscriptğœ†low1â„±(0,\\\\lambda\\_{\\\\operatorname{low}}^{-1}\\]\\\\times\\\\mathcal{F} with constant â€–â„±â€–âˆ+Î»lowâˆ’1subscriptnormâ„±superscriptsubscriptğœ†low1\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\lambda\\_{\\\\operatorname{low}}^{-1}.\n\n\n###### Proof.\n\nSee [LemmaC.1]Lemma C.1 (Concentration conditions for WDRO). â€£ C.1 Standard WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").2 in the supplementary.\nâˆ\n\n### 4.4 Getting a dual lower bound.\n\nIn order to get a dual lower bound, we proceed in two steps:\n\n1. 1.\n\n\nWe show the existence of a dual lower bound on the true robust risk. This involves the definition of an inherent maximal radius, which plays the role of a degeneracy threshold.\n\n2. 2.\n\n\nWe show that the lower bound on the true robust risk transposes to the empirical robust risk, with high probability and uniformly on â„±â„±\\\\mathcal{F}. This is done by expressing a slope condition and applying the concentration inequality [Theorem4.1]Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n\n##### Dual bound on the true risk.\n\nIn order to obtain a dual lower bound on the true robust risk, it is sufficient for the (right-sided) derivative of Î»â†¦Î»â€‹Ï+ğ”¼Î¾âˆ¼Pâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]maps-toğœ†ğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰\\\\lambda\\\\mapsto\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\] to be negative for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} on an interval \\[0,2â€‹Î»low\\]02subscriptğœ†low\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\]333Although the factor 2 may not seem necessary at the moment, its role will become clearer in [Section4.4]Dual bound on the empirical risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), with Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0. This writes:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Ïâ‰¤ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\],ğœŒsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptsuperscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰\\\\rho\\\\leq\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\], |  | (15) |\n\nwhich implies that ÏğœŒ\\\\rho has to be small. To obtain the condition ( [15]Equation 15 â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) uniformly in fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F}, we introduce the maximal value of ÏğœŒ\\\\rho allowed at a given Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0 (illustrated in [Figure2]In Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n![Refer to caption]Figure 2: A central object of our analysis: the maximal radius ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max}, defined from the lower envelope of derivatives of Ï•italic-Ï•\\\\phi.\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | Ïmaxâ€‹(Î»)=inffâˆˆâ„±ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ’âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\].subscriptğœŒğœ†subscriptinfimumğ‘“â„±subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]superscriptsubscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\inf\\_{f\\\\in\\\\mathcal{F}}\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[-\\\\partial\\_{\\\\lambda}^{+}\\\\phi(\\\\lambda,f,\\\\xi)\\]. |  | (16) |\n\nAs illustrated by [Figure2]In Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} reaches its highest value at zero. This is the _critical radius_,\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ïcrit=Ïmaxâ€‹(0).subscriptğœŒcritsubscriptğœŒ0\\\\rho\\_{\\\\operatorname{crit}}=\\\\rho\\_{\\\\max}(0). |  |\n\nThis particular quantity will be discussed in [Section5.2]The critical radius â€£ 5 On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). As a central result of this work, we show that ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} can be made arbitrarily close to ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}} as Î»â†’0+â†’ğœ†superscript0\\\\lambda\\\\to 0^{+}.\n\n###### Lemma 4.2.\n\nlimÎ»â†’0+Ïmaxâ€‹(Î»)=Ïcritsubscriptâ†’ğœ†superscript0subscriptğœŒğœ†subscriptğœŒcrit\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}. In particular, there exists Î»low>0subscriptğœ†low0\\\\lambda\\_{\\\\operatorname{low}}>0 such that for all Î»âˆˆ\\[0,2â€‹Î»low\\]ğœ†02subscriptğœ†low\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}\\], for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ‚Î»+Ï•â€‹(Î»,f,Î¾)\\]â‰¤âˆ’Ïcrit2.subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptsuperscriptğœ†italic-Ï•ğœ†ğ‘“ğœ‰subscriptğœŒcrit2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}. |  | (17) |\n\n###### Proof.\n\nSee [LemmaD.1]Lemma D.1. â€£ D.1 Standard WDRO: continuity at zero of the maximal radius â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\nâˆ\n\nThis means that the derivative condition ( [15]\\]) involving an arg max:\n\n|     |     |     |\n| --- | --- | --- |\n|  | âˆ‚Î»+Ï•(Î»,f,Î¾)=âˆ’minÎ¶âˆˆÎ{c(Î¶,argâ€‹maxÎ{fâˆ’Î»c(Î¾,â‹…)}}.\\\\partial^{+}\\_{\\\\lambda}\\\\phi(\\\\lambda,f,\\\\xi)=-\\\\min\\_{\\\\zeta\\\\in\\\\Xi}\\\\{c(\\\\zeta,\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}\\\\left\\\\{f-\\\\lambda c(\\\\xi,\\\\cdot)\\\\right\\\\}\\\\}. |  |\n\n![Refer to caption]Figure 3: Bounding from below the empirical dual solution Î»âˆ—superscriptğœ†\\\\lambda^{\\*} expresses as a slope condition (thanks to convexity of the objective).\n\n##### Dual bound on the empirical risk.\n\nWe propose a simple way to overcome the limitation highlighted above by relying on the convexity of Ï•italic-Ï•\\\\phi. Indeed, given a convex function gğ‘”g over â„+superscriptâ„\\\\mathbb{R}^{+}, the infimum of gğ‘”g has to occur on an interval \\[Î»low,+âˆ\\]subscriptğœ†low\\[\\\\lambda\\_{\\\\operatorname{low}},+\\\\infty\\] if gğ‘”g has a negative slope between Î»lowsubscriptğœ†low\\\\lambda\\_{\\\\operatorname{low}} and 2â€‹Î»low2subscriptğœ†low2\\\\lambda\\_{\\\\operatorname{low}} ( [Figure3]In Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n|     |     |     |\n| --- | --- | --- |\n|  | gâ€‹(2â€‹Î»low)âˆ’gâ€‹(Î»low)Î»lowâ‰¤0âŸ¹infÎ»â‰¥Î»lowgâ€‹(Î»)=infÎ»â‰¥0gâ€‹(Î»).ğ‘”2subscriptğœ†lowğ‘”subscriptğœ†lowsubscriptğœ†low0subscriptinfimumğœ†subscriptğœ†lowğ‘”ğœ†subscriptinfimumğœ†0ğ‘”ğœ†\\\\frac{g(2\\\\lambda\\_{\\\\operatorname{low}})-g(\\\\lambda\\_{\\\\operatorname{low}})}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\leq 0\\\\implies\\\\inf\\_{\\\\lambda\\\\geq\\\\lambda\\_{\\\\operatorname{low}}}g(\\\\lambda)=\\\\inf\\_{\\\\lambda\\\\geq 0}g(\\\\lambda). |  |\n\nWe want this condition satisfied for the empirical Lagrangian function gâ€‹(Î»)=Î»â€‹Ï+ğ”¼P^nâ€‹\\[Ï•â€‹(Î»,f)\\]ğ‘”ğœ†ğœ†ğœŒsubscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•ğœ†ğ‘“g(\\\\lambda)=\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda,f)\\] with high probability. For convenience, this can be expressed with the slope of ğ”¼P^nâ€‹\\[Ï•â€‹(â‹…,f)\\]subscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•â‹…ğ‘“\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\cdot,f)\\]:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n|  | s^â€‹(f):=ğ”¼P^nâ€‹\\[Ï•â€‹(2â€‹Î»low,f)\\]âˆ’ğ”¼P^nâ€‹\\[Ï•â€‹(Î»low,f)\\]Î»lowâ‰¤âˆ’Ï.assign^ğ‘ ğ‘“subscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•2subscriptğœ†lowğ‘“subscriptğ”¼subscript^ğ‘ƒğ‘›delimited-\\[\\]italic-Ï•subscriptğœ†lowğ‘“subscriptğœ†lowğœŒ\\\\widehat{s}(f)\\\\!:=\\\\!\\\\frac{\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\]-\\\\mathbb{E}\\_{\\\\widehat{P}\\_{n}}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f)\\]}{\\\\lambda\\_{\\\\operatorname{low}}}\\\\leq-\\\\rho. |  | (18) |\n\nThis is the condition we aim to obtain. To this end, we proceed by comparing the empirical slope to the true one,\n\n|     |     |     |\n| --- | --- | --- |\n|  | sâ€‹(f):=ğ”¼Pâ€‹\\[Ï•â€‹(2â€‹Î»low,f)\\]âˆ’ğ”¼Pâ€‹\\[Ï•â€‹(Î»low,f)\\]Î»low.assignğ‘ ğ‘“subscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•2subscriptğœ†lowğ‘“subscriptğ”¼ğ‘ƒdelimited-\\[\\]italic-Ï•subscriptğœ†lowğ‘“subscriptğœ†lows(f):=\\\\frac{\\\\mathbb{E}\\_{P}\\[\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\]-\\\\mathbb{E}\\_{P}\\[\\\\phi(\\\\lambda\\_{\\\\operatorname{low}},f)\\]}{\\\\lambda\\_{\\\\operatorname{low}}}. |  |\n\nIndeed, we can show that any function (f,Î¾)â†¦Ï•â€‹(Î»,f,Î¾)maps-toğ‘“ğœ‰italic-Ï•ğœ†ğ‘“ğœ‰(f,\\\\xi)\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi), with Î»âˆˆâ„+ğœ†subscriptâ„\\\\lambda\\\\in\\\\mathbb{R}\\_{+}, satisfies the requirements for the concentration theorem ( [Theorem4.1]Theorem 4.1 (Uniform concentration). â€£ 4.1 Uniform concentration inequality â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")):\n\n###### Lemma 4.3.\n\nFor almost all Î¾âˆˆÎğœ‰Î\\\\xi\\\\in\\\\Xi we have\n\n1. (i)\n\n\nFor all Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0 and fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\n\n\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ï•â€‹(Î»,f,Î¾)âˆˆ\\[âˆ’â€–â„±â€–âˆ,â€–â„±â€–âˆ\\].italic-Ï•ğœ†ğ‘“ğœ‰subscriptnormâ„±subscriptnormâ„±\\\\phi(\\\\lambda,f,\\\\xi)\\\\in\\[-\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty},\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\]. |  |\n\n2. (ii)\n\n\nFor all Î»â‰¥0ğœ†0\\\\lambda\\\\geq 0, fâ†¦Ï•â€‹(Î»,f,Î¾)maps-toğ‘“italic-Ï•ğœ†ğ‘“ğœ‰f\\\\mapsto\\\\phi(\\\\lambda,f,\\\\xi) is Lipschitz continuous on â„±â„±\\\\mathcal{F} with constant 111.\n\n\n###### Proof.\n\nSee [LemmaC.1]Lemma C.1 (Concentration conditions for WDRO). â€£ C.1 Standard WDRO â€£ Appendix C Concentration constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").1.\nâˆ\n\nConsequently, we can apply the concentration theorem twice, on each function Ï•â€‹(2â€‹Î»low,â‹…,â‹…)italic-Ï•2subscriptğœ†lowâ‹…â‹…\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},\\\\cdot,\\\\cdot) and Ï•â€‹(2â€‹Î»low,â‹…,â‹…)italic-Ï•2subscriptğœ†lowâ‹…â‹…\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},\\\\cdot,\\\\cdot), to obtain that s^â€‹(f)^ğ‘ ğ‘“\\\\widehat{s}(f) approximates sâ€‹(f)ğ‘ ğ‘“s(f) with high probability, up to a term of the form Î²nğ›½ğ‘›\\\\frac{\\\\beta}{\\\\sqrt{n}}:\n\n|     |     |     |\n| --- | --- | --- |\n|  | âˆ€fâˆˆâ„±,s^â€‹(f)â‰¤sâ€‹(f)+Î²n.formulae-sequencefor-allğ‘“â„±^ğ‘ ğ‘“ğ‘ ğ‘“ğ›½ğ‘›\\\\forall f\\\\in\\\\mathcal{F},\\\\quad\\\\widehat{s}(f)\\\\leq s(f)+\\\\frac{\\\\beta}{\\\\sqrt{n}}. |  |\n\nOn the other hand, sâ€‹(f)â‰¤ğ”¼Pâ€‹\\[âˆ‚Î»+Ï•â€‹(2â€‹Î»low,f)\\]ğ‘ ğ‘“subscriptğ”¼ğ‘ƒdelimited-\\[\\]subscriptsuperscriptğœ†italic-Ï•2subscriptğœ†lowğ‘“s(f)\\\\leq\\\\mathbb{E}\\_{P}\\[\\\\partial^{+}\\_{\\\\lambda}\\\\phi(2\\\\lambda\\_{\\\\operatorname{low}},f)\\] by convexity of Ï•italic-Ï•\\\\phi, hence sâ€‹(f)â‰¤âˆ’Ïcrit2ğ‘ ğ‘“subscriptğœŒcrit2s(f)\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2} by ( [17]Equation 17 â€£ Lemma 4.2. â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). This means\n\n|     |     |     |\n| --- | --- | --- |\n|  | s^â€‹(f)â‰¤Î²nâˆ’Ïcrit2,^ğ‘ ğ‘“ğ›½ğ‘›subscriptğœŒcrit2\\\\widehat{s}(f)\\\\leq\\\\frac{\\\\beta}{\\\\sqrt{n}}-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}, |  |\n\nhence we have the desired condition ( [18]Equation 18 â€£ Dual bound on the empirical risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) when\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ï<Ïcrit2âˆ’Î²n.ğœŒsubscriptğœŒcrit2ğ›½ğ‘›\\\\rho<\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}}{2}-\\\\frac{\\\\beta}{\\\\sqrt{n}}. |  |\n\n### 4.5 Extension to (double) regularization.\n\nThe strategy of [Section4.2]Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") is flexible enough to be extended to the regularized setting of [Section3.2]Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Indeed, the regularized problem also has a dual representation, with a dual generator defined by\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)=(Ïµ+Î»â€‹Ï„)â€‹logâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[efâ€‹(Î¶)âˆ’Î»â€‹câ€‹(Î¾,Î¶)Ïµ+Î»â€‹Ï„\\],\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)=(\\\\epsilon+\\\\lambda\\\\tau)\\\\log\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\\\left\\[e^{\\\\frac{f(\\\\zeta)-\\\\lambda c(\\\\xi,\\\\zeta)}{\\\\epsilon+\\\\lambda\\\\tau}}\\\\right\\], |  |\n\nwhere Ïµ>0italic-Ïµ0\\\\epsilon>0 and Ï„â‰¥0ğœ0\\\\tau\\\\geq 0. Strong duality has been shown in \\[ [6]\\]. We explain in [AppendixB]Appendix B Strong duality â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), [PropositionB.2]Proposition B.2 (Strong duality, regularized WDRO). â€£ Appendix B Strong duality â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") how it applies to our general setting. This regularized dual generator leads to smooth counterparts of the key nonsmooth functions Ïˆğœ“\\\\psi, ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} and ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}} of the proof. In particular, we can show the regularized version of [Lemma4.2]Lemma 4.2. â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n###### Lemma 4.4.\n\nlimÎ»â†’0+ÏmaxÏ„,Ïµâ€‹(Î»)=ÏcritÏ„,Ïµsubscriptâ†’ğœ†superscript0superscriptsubscriptğœŒğœitalic-Ïµğœ†superscriptsubscriptğœŒcritğœitalic-Ïµ\\\\lim\\_{\\\\lambda\\\\to 0^{+}}\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}(\\\\lambda)=\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}. In particular, there exists Î»lowÏ„,Ïµ>0superscriptsubscriptğœ†lowğœitalic-Ïµ0\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}>0 such that for all Î»âˆˆ\\[0,2â€‹Î»lowÏ„,Ïµ\\]ğœ†02superscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\\\in\\[0,2\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}\\], âˆ€fâˆˆâ„±for-allğ‘“â„±\\\\forall f\\\\in\\\\mathcal{F},\n\n|     |     |     |\n| --- | --- | --- |\n|  | ğ”¼Î¾âˆ¼Pâ€‹\\[âˆ‚Î»Ï•Ï„,Ïµâ€‹(Î»,f,Î¾)\\]â‰¤âˆ’ÏcritÏ„,Ïµ2.subscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]subscriptğœ†superscriptitalic-Ï•ğœitalic-Ïµğœ†ğ‘“ğœ‰superscriptsubscriptğœŒcritğœitalic-Ïµ2\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\[\\\\partial\\_{\\\\lambda}\\\\phi^{\\\\tau,\\\\epsilon}(\\\\lambda,f,\\\\xi)\\]\\\\leq-\\\\frac{\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}}{2}. |  |\n\nThen we obtain [Theorem3.2]Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") by repeating the proof scheme of [Section4.2]Proofâ€™s overview â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). The core results that simultaneously lead to Theorems [3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2]Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") are gathered in [SectionE.1]E.1 Dual bounds with high probability on the empirical problem â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Due to the smoothness of ÏmaxÏ„,ÏµsuperscriptsubscriptğœŒğœitalic-Ïµ\\\\rho\\_{\\\\max}^{\\\\tau,\\\\epsilon}, an expression of Î»lowÏ„,Ïµsuperscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} can also be obtained; see [LemmaD.2]Lemma D.2. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\nThe key difference brought by regularization is that the Lipschitz property of ÏˆÏ„,Ïµsuperscriptğœ“ğœitalic-Ïµ\\\\psi^{\\\\tau,\\\\epsilon} is lost when Î¼â†’0â†’ğœ‡0\\\\mu\\\\to 0. This is an inherent peculiarity of the regularized setting which may occur over the whole family â„±â„±\\\\mathcal{F} and the space ÎÎ\\\\Xi; see the example of [PropositionF.2]Proposition F.2. â€£ F.2 Necessity of the dual upper-bound â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). This prevents to use the concentration result without guaranteeing that we can set a lower bound on Î¼ğœ‡\\\\mu or equivalently an upper-bound on Î»ğœ†\\\\lambda. This is the purpose of the next lemma which establishes the existence of such an upper-bound, for any distribution.\n\n###### Lemma 4.5.\n\nLet Qâˆˆğ’«â€‹(Î)ğ‘„ğ’«ÎQ\\\\in\\\\mathcal{P}(\\\\Xi) and Î»up:=2â€‹â€–â„±â€–âˆÏâˆ’mcassignsubscriptğœ†up2subscriptnormâ„±ğœŒsubscriptğ‘šğ‘\\\\lambda\\_{\\\\operatorname{up}}:=\\\\frac{2\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\rho-m\\_{c}}. Then for all fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F},\n\n|     |     |     |\n| --- | --- | --- |\n|  | RÏ,Qâ€‹(f)=infÎ»âˆˆ\\[0,Î»up\\]{Î»â€‹Ï+ğ”¼Î¾âˆ¼Qâ€‹\\[Ï•â€‹(Î»,f,Î¾)\\]}.subscriptğ‘…ğœŒğ‘„ğ‘“subscriptinfimumğœ†0subscriptğœ†upğœ†ğœŒsubscriptğ”¼similar-toğœ‰ğ‘„delimited-\\[\\]italic-Ï•ğœ†ğ‘“ğœ‰R\\_{\\\\rho,Q}(f)=\\\\inf\\_{\\\\lambda\\\\in\\[0,\\\\lambda\\_{\\\\operatorname{up}}\\]}\\\\left\\\\{\\\\lambda\\\\rho+\\\\mathbb{E}\\_{\\\\xi\\\\sim Q}\\[\\\\phi(\\\\lambda,f,\\\\xi)\\]\\\\right\\\\}. |  |\n\n###### Proof.\n\nSee [LemmaD.3]Lemma D.3 (Upper bound for the regularized problem Lemma 4.5). â€£ D.2.2 Dual upper-bound â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.\nâˆ",
      "citations": [
        {
          "start_pos": 3535,
          "end_pos": 3539,
          "text": "[12]",
          "paper_id": "bib.bib12",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 6992,
          "end_pos": 6995,
          "text": "[8]",
          "paper_id": "bib.bib8",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 20320,
          "end_pos": 20324,
          "text": "[15]",
          "paper_id": "bib.bib14",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 27116,
          "end_pos": 27119,
          "text": "[6]",
          "paper_id": "bib.bib6",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "5 On the generalization constants": {
      "content": "In this section, we put our generalization results into perspective by further discussing the bounds Î±,Î²ğ›¼ğ›½\\\\alpha,\\\\beta, the critical radius ÏcritsubscriptğœŒcrit\\\\rho\\_{\\\\operatorname{crit}} appearing in [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), as well as their regularized counterparts of [Theorem3.2]Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\").\n\n### 5.1 Sample complexity\n\nWe give the complete expressions of Î±ğ›¼\\\\alpha, Î²ğ›½\\\\beta, Î±Ï„,Ïµsuperscriptğ›¼ğœitalic-Ïµ\\\\alpha^{\\\\tau,\\\\epsilon} and Î²Ï„,Ïµsuperscriptğ›½ğœitalic-Ïµ\\\\beta^{\\\\tau,\\\\epsilon} in the detailed versions of Theoremsâ€„[3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") and [3.2]Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in [SectionE.2]E.2 Proof of the main results â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"). Here we highlight their dependence from the problemâ€™s constants.\n\nFirst, in the setting of [Theorem3.1]Theorem 3.1 (Generalization guarantee for Wasserstein robust models). â€£ 3.1 Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), Î±ğ›¼\\\\alpha and Î²ğ›½\\\\beta grow essentially with the size and the complexity of â„±â„±\\\\mathcal{F}. Indeed, we have\n\n|     |     |     |     |     |\n| --- | --- | --- | --- | --- |\n|  | Î±ğ›¼\\\\displaystyle\\\\alpha | =O(â„(â„±,âˆ¥â‹…âˆ¥âˆ)Ã—âˆ¥â„±âˆ¥âˆ),\\\\displaystyle=O\\\\big{(}\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\times\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}\\\\big{)}, |  | (19) |\n|  | Î²ğ›½\\\\displaystyle\\\\beta | =O(âˆ¥â„±âˆ¥âˆ+â„(â„±,âˆ¥â‹…âˆ¥âˆ)).\\\\displaystyle=O\\\\big{(}\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}+\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty})\\\\big{)}. |  |\n\nThe Dudleyâ€™s entropy â„(â„±,âˆ¥â‹…âˆ¥âˆ)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) quantifies the complexity of â„±â„±\\\\mathcal{F}. In the large class of Lipschitz functions, this quantity is exponential in the data dimension. In practice, most machine learning problems involve a Lipschitz parametric family of losses ( [Section2]Assumption and examples â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) in which case â„(â„±,âˆ¥â‹…âˆ¥âˆ)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) becomes proportional to pğ‘\\\\sqrt{p}, where pğ‘p is the parameterâ€™s dimension (see e.g. Chapter 5.1 from \\[ [37]\\]).\n\nThe constants Î±ğ›¼\\\\alpha and Î²ğ›½\\\\beta also grow with 1/Î»low1subscriptğœ†low1/\\\\lambda\\_{\\\\operatorname{low}} and we have Î±=Oâ€‹(1/Î»low2)ğ›¼ğ‘‚1superscriptsubscriptğœ†low2\\\\alpha=O\\\\left(1/{\\\\lambda\\_{\\\\operatorname{low}}^{2}}\\\\right) and Î²=Oâ€‹(1/Î»low)ğ›½ğ‘‚1subscriptğœ†low\\\\beta=O\\\\left(1/{\\\\lambda\\_{\\\\operatorname{low}}}\\\\right). The constant Î»lowsubscriptğœ†low{\\\\lambda\\_{\\\\operatorname{low}}} is implicitly defined and depends on the regularity at 00 of ÏmaxsubscriptğœŒ\\\\rho\\_{\\\\max} ( [16]Equation 16 â€£ Dual bound on the true risk. â€£ 4.4 Getting a dual lower bound. â€£ 4 Proof strategy â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), hence it may depend on â„±â„±\\\\mathcal{F}, ÎÎ\\\\Xi, cğ‘c and Pğ‘ƒP.\n\nIn the setting of [Theorem3.2]Theorem 3.2 (Generalization for double regularization). â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\"), we have similar interpretations. In addition to the conditional moment mcsubscriptğ‘šğ‘m\\_{c} ( [9]Equation 9 â€£ 3.2 Regularized Wasserstein robust models â€£ 3 Main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")), the constants Î±Ï„,Ïµsuperscriptğ›¼ğœitalic-Ïµ\\\\alpha^{\\\\tau,\\\\epsilon} and Î²Ï„,Ïµsuperscriptğ›½ğœitalic-Ïµ\\\\beta^{\\\\tau,\\\\epsilon} also involve the second order conditional moment:\n\n|     |     |     |\n| --- | --- | --- |\n|  | m2,c=maxÎ¾âˆˆÎâ¡ğ”¼Î¶âˆ¼Ï€0(â‹…\\|Î¾)â€‹\\[câ€‹(Î¾,Î¶)2\\].m\\_{2,c}=\\\\max\\_{\\\\xi\\\\in\\\\Xi}\\\\mathbb{E}\\_{\\\\zeta\\\\sim\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)}\\[c(\\\\xi,\\\\zeta)^{2}\\]. |  |\n\nThey are parameters that may be chosen in practice and related to the reference coupling Ï€0subscriptğœ‹0\\\\pi\\_{0}. For instance, if Ï€0(â‹…\\|Î¾)\\\\pi\\_{0}(\\\\cdot\\|\\\\xi) is a truncated Gaussian Ï€0(â‹…\\|Î¾)âˆeâˆ’âˆ¥â‹…âˆ’Î¾âˆ¥22â€‹Ïƒ2ğŸ™Î\\\\pi\\_{0}(\\\\cdot\\|\\\\xi)\\\\propto e^{-\\\\frac{\\\\\\|\\\\cdot-\\\\xi\\\\\\|^{2}}{2\\\\sigma^{2}}}\\\\mathds{1}\\_{\\\\Xi} and câ€‹(Î¾,Î¶)=12â€‹â€–Î¾âˆ’Î¶â€–2ğ‘ğœ‰ğœ12superscriptnormğœ‰ğœ2c(\\\\xi,\\\\zeta)=\\\\frac{1}{2}\\\\\\|\\\\xi-\\\\zeta\\\\\\|^{2} we have mcâˆÏƒ2proportional-tosubscriptğ‘šğ‘superscriptğœ2m\\_{c}\\\\propto\\\\sigma^{2} and m2,câˆÏƒ4proportional-tosubscriptğ‘š2ğ‘superscriptğœ4m\\_{2,c}\\\\propto\\\\sigma^{4}.\n\nThe coefficients Î±Ï„,Ïµsuperscriptğ›¼ğœitalic-Ïµ\\\\alpha^{\\\\tau,\\\\epsilon} and Î²Ï„,Ïµsuperscriptğ›½ğœitalic-Ïµ\\\\beta^{\\\\tau,\\\\epsilon} exhibit similar relations with Î»lowÏ„,Ïµsuperscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}, â€–â„±â€–âˆsubscriptnormâ„±\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}, and â„(â„±,âˆ¥â‹…âˆ¥âˆ)\\\\mathcal{I}(\\\\mathcal{F},\\\\\\|\\\\cdot\\\\\\|\\_{\\\\infty}) to their counterparts Î±ğ›¼\\\\alpha and Î²ğ›½\\\\beta ( [19]Equation 19 â€£ 5.1 Sample complexity â€£ 5 On the generalization constants â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Regarding the hyperparameters mcsubscriptğ‘šğ‘m\\_{c}, Ïµitalic-Ïµ\\\\epsilon, Ï„ğœ\\\\tau and ÏğœŒ\\\\rho, they should be of comparable order according to the expression of Î±Ï„,Ïµsuperscriptğ›¼ğœitalic-Ïµ\\\\alpha^{\\\\tau,\\\\epsilon} ( [TheoremE.2]Theorem E.2 (Generalization guarantee, regularized WDRO). â€£ E.2 Proof of the main results â€£ Appendix E Proof of the main results â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")). Compared to the standard setting, we have an estimate of the lower bound Î»lowÏ„,Ïµsuperscriptsubscriptğœ†lowğœitalic-Ïµ\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon} ( [LemmaD.2]Lemma D.2. â€£ D.2.1 Lipschitz continuity of the maximal radius â€£ D.2 Regularized WDRO: Lipschitz maximal radius and upper-bound â€£ Appendix D Dual bounds and maximal radius â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\")) showing dependence on the loss family: 1/Î»lowÏ„,Ïµ=Oâ€‹(eâ€–â„±â€–âˆÏµ)1superscriptsubscriptğœ†lowğœitalic-Ïµğ‘‚superscriptğ‘’subscriptnormâ„±italic-Ïµ1/{\\\\lambda\\_{\\\\operatorname{low}}^{\\\\tau,\\\\epsilon}}=O\\\\big{(}e^{\\\\frac{\\\\\\|\\\\mathcal{F}\\\\\\|\\_{\\\\infty}}{\\\\epsilon}}\\\\big{)}.\n\n### 5.2 The critical radius\n\nIn the standard setting, the critical radius has the expression\n\n|     |     |     |\n| --- | --- | --- |\n|  | Ïcrit=ğ”¼Î¾âˆ¼Pâ€‹\\[minâ¡{câ€‹(Î¾,Î¶):Î¶âˆˆargâ€‹maxÎâ¡f}\\].subscriptğœŒcritsubscriptğ”¼similar-toğœ‰ğ‘ƒdelimited-\\[\\]:ğ‘ğœ‰ğœğœsubscriptargmaxÎğ‘“\\\\rho\\_{\\\\operatorname{crit}}=\\\\mathbb{E}\\_{\\\\xi\\\\sim P}\\\\left\\[\\\\min\\\\left\\\\{c(\\\\xi,\\\\zeta)\\ :\\ \\\\zeta\\\\in\\\\operatorname\\*{arg\\\\,max}\\_{\\\\Xi}f\\\\right\\\\}\\\\right\\]. |  |\n\nAssuming Ïcrit>0subscriptğœŒcrit0\\\\rho\\_{\\\\operatorname{crit}}>0 excludes losses that remain constant across all samples from the ground truth distribution Pğ‘ƒP. This assumption reasonably aligns with practice and appeared in previous works \\[ [3], [5]\\]. For instance, obtaining a predictor that precisely interpolates the ground truth distribution (leading to a loss equal to zero everywhere) is unrealistic. It also defines a threshold to exclude degenerated problems: if Ï>ÏcritğœŒsubscriptğœŒcrit\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}, then there exists fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} such that RÏâ€‹(f)=maxÎâ¡fsubscriptğ‘…ğœŒğ‘“subscriptÎğ‘“R\\_{\\\\rho}(f)=\\\\max\\_{\\\\Xi}f and the problem becomes independent from ÏğœŒ\\\\rho, see \\[ [5]\\].\n\nA similar interpretation can be made in the regularized case with smoothed counterparts. Indeed, we can verify that if Ï>ÏcritÏ„,ÏµğœŒsuperscriptsubscriptğœŒcritğœitalic-Ïµ\\\\rho>\\\\rho\\_{\\\\operatorname{crit}}^{\\\\tau,\\\\epsilon}, then there exists fâˆˆâ„±ğ‘“â„±f\\\\in\\\\mathcal{F} such that\n\n|     |     |     |\n| --- | --- | --- |\n|  | RÏÏ„,Ïµâ€‹(f)=supÏ€âˆˆğ’«â€‹(ÎÃ—Î),\\[Ï€\\]1=P{ğ”¼\\[Ï€\\]2â€‹\\[f\\]âˆ’KLâ¡(Ï€âˆ¥Ï€0)},subscriptsuperscriptğ‘…ğœitalic-ÏµğœŒğ‘“subscriptsupremumformulae-sequenceğœ‹ğ’«ÎÎsubscriptdelimited-\\[\\]ğœ‹1ğ‘ƒsubscriptğ”¼subscriptdelimited-\\[\\]ğœ‹2delimited-\\[\\]ğ‘“KLconditionalğœ‹subscriptğœ‹0R^{\\\\tau,\\\\epsilon}\\_{\\\\rho}(f)=\\\\sup\\_{\\\\begin{subarray}{c}\\\\pi\\\\in\\\\mathcal{P}(\\\\Xi\\\\times\\\\Xi),\\[\\\\pi\\]\\_{1}=P\\\\end{subarray}}\\\\left\\\\{\\\\mathbb{E}\\_{\\[\\\\pi\\]\\_{2}}\\[f\\]-\\\\operatorname{KL}(\\\\pi\\\\\\|\\\\pi\\_{0})\\\\right\\\\}, |  |\n\nand the problem becomes independent from ÏğœŒ\\\\rho, see in particular [PropositionF.1]Proposition F.1. â€£ F.1 Interpretation of the critical radius in the regularized case. â€£ Appendix F Side remarks â€£ Universal Generalization Guarantees for Wasserstein Distributionally Robust Models\") in the supplementary.",
      "citations": [
        {
          "start_pos": 2971,
          "end_pos": 2975,
          "text": "[37]",
          "paper_id": "bib.bib37",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        },
        {
          "start_pos": 7488,
          "end_pos": 7491,
          "text": "[3]",
          "paper_id": "bib.bib3",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 7493,
          "end_pos": 7496,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": false,
          "citation_type": null,
          "nearest_citations": null
        },
        {
          "start_pos": 7951,
          "end_pos": 7954,
          "text": "[5]",
          "paper_id": "bib.bib5",
          "single_citation": true,
          "citation_type": "others",
          "nearest_citations": null
        }
      ]
    },
    "6 Conclusion": {
      "content": "In this work, we provide exact generalization guarantees of (regularized) Wasserstein robust models, covering all usual machine learning situations, without restrictive assumptions (on the Wasserstein metric or the class of functions). We achieve these universal results by directly addressing the intrinsic nonsmoothness of robust problems. Our results thus give users freedom when choosing the radius ÏğœŒ\\\\rho: for all usual situations, it is not necessary to consider specific regimes for ÏğœŒ\\\\rho in order to expect good generalization from robust models. Further research can now focus on practical aspects: it would be of premier interest to design efficient practical procedures for selecting ÏğœŒ\\\\rho, and more generally, scalable algorithms for solving distributionally robust optimization problems.",
      "citations": []
    }
  },
  "references": {
    "data": {},
    "key_map": {}
  }
}